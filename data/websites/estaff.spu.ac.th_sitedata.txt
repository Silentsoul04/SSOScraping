{"link":"http://estaff.spu.ac.th/estafflogin.cfm","html":"<head><script type=\"text/javascript\">/* <![CDATA[ */_cf_loadingtexthtml=\"<img alt=' ' src='/CFIDE/scripts/ajax/resources/cf/images/loading.gif'/>\";\n_cf_contextpath=\"\";\n_cf_ajaxscriptsrc=\"/CFIDE/scripts/ajax\";\n_cf_jsonprefix='//';\n_cf_websocket_port=8575;\n_cf_flash_policy_port=1243;\n/* ]]> */</script><script type=\"text/javascript\" src=\"/CFIDE/scripts/ajax/messages/cfmessage.js\"></script>\n<script type=\"text/javascript\" src=\"/CFIDE/scripts/ajax/package/cfajax.js\"></script>\n\n<script type=\"text/javascript\">/* <![CDATA[ */\n\tColdFusion.Ajax.importTag('CFAJAXPROXY');\n/* ]]> */</script>\n\n<script type=\"text/javascript\">/* <![CDATA[ */\n\tvar _cf_estaff=ColdFusion.AjaxProxy.init('/services/estaff.cfc','emp');\n\t_cf_estaff.prototype.getEmployees=function(username,password) { return ColdFusion.AjaxProxy.invoke(this, \"getEmployees\",\"7BFE941612149C4C83822A99DEB1\", {username:username,password:password});};\n/* ]]> */</script>\n<script type=\"text/javascript\" src=\"/CFIDE/scripts/cfform.js\"></script>\n<script type=\"text/javascript\" src=\"/CFIDE/scripts/masks.js\"></script>\n\n    <title>e-staff | Welcome</title>\n    \n    <!-- // Meta //  -->\n    <meta charset=\"utf-8\">   \n    <meta name=\"description\" content=\"\">\n    <meta name=\"keywords\" content=\"\">\n    <!--[if IE]>\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=EmulateIE7\">\n    <![endif]-->\n    \n    <!-- // Stylesheets // -->\n    <link rel=\"stylesheet\" href=\"css/login.css\">\n\n    <!-- http://allinthehead.com/retro/319/how-to-set-an-apple-touch-icon-for-any-site -->\n    <link rel=\"apple-touch-icon\" href=\"images/apple-touch-icon.png\">\n    <link rel=\"shortcut icon\" href=\"images/favicon.ico\">\n        \n    <!-- All JavaScript at the bottom, except for Modernizr which enables HTML5 elements & feature detects -->\n    <script src=\"js/modernizr-1.7.min.js\"></script>\n   <script type=\"text/javascript\">\nString.prototype.trim = function() { return this.replace(/^\\s+|\\s+$/g,\"\"); }\n            // Function to find the index in an array of the first entry \n            // with a specific value.\n            // It is used to get the index of a column in the column list.\n Array.prototype.findIdx = function(value){\n\tfor (var i=0; i < this.length; i++) {\n\t\t  if (this[i] == value) {\n\t\t\treturn i;\n\t\t  }\n\t}\n}\n\n\n// Use an asynchronous call to get the employees for the \n            // drop-down employee list from the ColdFusion server.\n            var getEmployees = function(){\n\t\t\t\t\t//alert('f.password.value='+f.password.value);\n                // create an instance of the proxy. \n\t\t\t\t\n                var e = new emp();\n                // Setting a callback handler for the proxy automatically makes\n                // the proxy's calls asynchronous.\n\t\t\t\t\n                e.setCallbackHandler(populateEmployees);\n                e.setErrorHandler(myErrorHandler);\n\t\t\t  \n            // The proxy getEmployees function represents the CFC\n            // getEmployees function.\n              //  e.getEmployees();\n\t\t\t\t// mmsshow.innerHTML = \"\";\n\t\t\t\tvar f = document.userForm;\n\t\t\t\t//alert('f.password.value='+f.password.value);\n\t\t\t\t  e.getEmployees (\n\t\t\t\t\t f.username.value,\n\t\t\t\t\t f.password.value\n\t\t\t\t  );\n            }\n            \n            // Callback function to handle the results returned by the\n            // getEmployees function and populate the drop-down list.\n\t\t\t\n\t\t\t\n            var populateEmployees = function(res)\n            {\n\t\t\t\t\n\t\t\t\ttxtpostOfficeBox = \"postOfficeBox\";\n\t\t\t\ttxtpostOfficeBox=txtpostOfficeBox.toUpperCase();\n\t\t\t\ttxtsAMAccountName = \"sAMAccountName\";\n\t\t\t\ttxtsAMAccountName=txtsAMAccountName.toUpperCase();\n\t\t\t\ttxtmail = \"mail\";\n\t\t\t\ttxtmail=txtmail.toUpperCase();\n\t\t\t\ttxtdisplayname = \"displayname\";\n\t\t\t\ttxtdisplayname=txtdisplayname.toUpperCase();\n\t\t\t\ttxtmmsresult = \"mmsresult\";\n\t\t\t\ttxtmmsresult=txtmmsresult.toUpperCase();\n\t\t\t\ttxtloginstatus = \"loginstatus\";\n\t\t\t\ttxtloginstatus=txtloginstatus.toUpperCase();\n\t\t\t\t\t\t\t\n\t\t\t\t//vname=res.DATA[0][res.COLUMNS.findIdx('EMP_NAMETH')];\n\t\t\t\tvpostOfficeBox=res.DATA[0][res.COLUMNS.findIdx(txtpostOfficeBox)];\n\t\t\t\tvsAMAccountName=res.DATA[0][res.COLUMNS.findIdx(txtsAMAccountName)];\n\t\t\t\tvmail=res.DATA[0][res.COLUMNS.findIdx(txtmail)];\n\t\t\t\tvdisplayname=res.DATA[0][res.COLUMNS.findIdx(txtdisplayname)];\n\t\t\t\tvmmsresult=res.DATA[0][res.COLUMNS.findIdx(txtmmsresult)];\n\t\t\t\tvloginstatus=res.DATA[0][res.COLUMNS.findIdx(txtloginstatus)];\n\t\t\t\t\n\t\t\t\t//alert('vloginstatus='+vloginstatus);\n\t\t\t\t//alert('vmmsresult='+vmmsresult);\n\t\t\t\t\n\t\n\t\t\t\tif(vloginstatus=='N'){\n\t\t\t\t//\talert(\"txtmmsresult1=\"+vmmsresult);\n\t\t\t\t\t// mmsshow.innerHTML = '<div class=\"login-box-error-small corners\"><p>'+vmmsresult+'</p></div>';\n\t\t\t\t\tdocument.getElementById(\"mmsshow\").innerHTML = '<div class=\"login-box-error-small corners\"><p>'+vmmsresult+'</p></div>';\n\t\t\t\t\t  \n\t\t\t\t}else{\n\t\t\t\t\t//mmsshow.innerHTML = '<div class=\"login-box-true-small corners\"><p>'+vmmsresult+'</p></div>';\n\t\t\t\t\t//session_user_id='';\n\t\t\t\t//\talert(\"txtmmsresult2=\"+vmmsresult);\n\t\t\t\t\tdocument.getElementById(\"mmsshow\").innerHTML = '<div class=\"login-box-true-small corners\"><p>'+vmmsresult+'</p></div>';\n\t\t\t\t\twindow.location = \"estaffmain.cfm\";\n\t\t\t\t}\n\t\t\t\t\n              //  with(document.simpleAJAX){\n//                    var option = new Option();\n//                    option.text='Select Employee';\n//                    option.value='0';\n//                    employee.options[0] = option;\n//                    for(i=0;i<res.DATA.length;i++){\n//                        var option = new Option();\n//                        option.text=res.DATA[i][res.COLUMNS.findIdx('FIRSTNAME')]\n//                            + ' ' + res.DATA[i][[res.COLUMNS.findIdx('LASTNAME')]];\n//                        option.value=res.DATA[i][res.COLUMNS.findIdx('EMP_ID')];\n//                        employee.options[i+1] = option;\n//                    }\n//                }    \n            }\n\t\t\t\n\t\t\t// Error handler for the asynchronous functions.\n            var myErrorHandler = function(statusCode, statusMsg)\n            {\n                alert('Statusaaa: ' + statusCode + ', ' + statusMsg);\n            }\n\n  getEmployees2 = function() {\n\t//   alert(\"submitForm\");\n\t   getEmployees();\n  // console.log('running...'); \n   //ColdFusion.Ajax.submitForm('userForm', 'services/estaff.cfc?method=getEmployees', populateEmployees2, myErrorHandler);\n  // console.log('done...');\n    return false; \n   }\n</script> \n<script type=\"text/javascript\">\n<!--\n    _CF_checkuserForm = function(_CF_this)\n    {\n        //reset on submit\n        _CF_error_exists = false;\n        _CF_error_messages = new Array();\n        _CF_error_fields = new Object();\n        _CF_FirstErrorField = null;\n\n\n        //display error messages and return success\n        if( _CF_error_exists )\n        {\n            if( _CF_error_messages.length > 0 )\n            {\n                // show alert() message\n                _CF_onErrorAlert(_CF_error_messages);\n                // set focus to first form error, if the field supports js focus().\n                if( _CF_this[_CF_FirstErrorField].type == \"text\" )\n                { _CF_this[_CF_FirstErrorField].focus(); }\n\n            }\n            return false;\n        }else {\n            // run userdefined onSubmit javascript. \n            return false;\n            return true;\n        }\n    }\n//-->\n</script>\n</head>\n<body><span></span>\n<div id=\"header_logo_banner\">\n<div class=\"piclogo\"><img src=\"images/spu_logo3.png\" width=\"366\" height=\"63\"> </div>\n\n</div>\n    <div id=\"container\">\n        \n         \n  <form name=\"userForm\" id=\"userForm\" action=\"/estafflogin.cfm\" method=\"post\" onsubmit=\"return _CF_checkuserForm(this)\">\n        \n<div id=\"login-box\" class=\"corners shadow\">\n                <div class=\"login-box-header corners\">\n                <div class=\"piclogoestaff\"><img src=\"images/estaff2.png\"> </div>\n                    <h2>LOGIN</h2>\n                </div>\n               \n                <div class=\"login-box-row-wrap corners\">\n                  \n                    <label for=\"username\">Username:</label>\n                  \n                    <input name=\"username\" type=\"text\" id=\"username\" class=\"input-1\">\n                </div>\n                <div class=\"login-box-row-wrap corners\">\n                    <div style=\"height: 0px;\">\n                        <label for=\"password\">Password:</label>\n                        \n                        <input name=\"password\" type=\"password\" id=\"password\" class=\"input-1 password\">\n                    <a href=\"#\" class=\"show-password-link\" style=\"left: 330px; top: 13px;\">Show</a><input class=\"password-showing\" type=\"text\" style=\"display: none; left: 126px; top: 6px;\"></div>    \n                    \n                </div>\n                <div class=\"login-box-row corners\">\n                     \n                    \n                   \n                   \n                    <input name=\"submit1\" type=\"submit\" value=\"Login\" id=\"submit\" onclick=\"javascript:getEmployees2();\" class=\"button\">\n                 \n                    \n                </div>\n                <br>\n                 <div id=\"mmsshow\">\n               \n                </div>\n                \n                \n\n                  \n                \n                \n                \n                <div class=\"loader corners\" style=\"display: none;\">\n                \n                </div>\n                <div class=\"inner99  login-box-error-small corners\" style=\"height: 50px;\"><p style=\"color:#000;\">Browser ไม่ใช่ Internet Explorer <br>ไม่รองรับ กับ <b>บางระบบ</b>ของ Website e-Staff</p></div>\n                <div><a href=\"http://userportal.spu.ac.th/ForgotPassword.aspx\" target=\"_blank\">ลืมรหัสผ่าน / Forgot your Password</a></div>\n            </div>\n            </form>\n\n        \n        \n    </div><!-- END \"#container\" -->\n        \n        \n<!-- // Javascript/jQuery // -->\n    <!-- Grab Google CDN's jQuery. fall back to local if necessary -->\n  \n    <script>!window.jQuery && document.write('<script src=\"js/jquery-1.6.min.js\"><\\/script>')</script><script src=\"js/jquery-1.6.min.js\"></script>\n    <script src=\"js/showpassword.js\"></script>\n    <script src=\"js/login.js\"></script>\n    \n   <script type=\"text/javascript\">  \n\n  <!--\n/*Creat by Ryan McLaughlin*/\n/*jQuery.each( jQuery.browser, function( i, val ) {\n  $( \"<div>\" + i + \" : <span>\" + val + \"</span>\" ).appendTo( document.body );\n});*/\n\nfunction detectIE() {\n    var ua = window.navigator.userAgent;\n    var msie = ua.indexOf('MSIE ');\n    var trident = ua.indexOf('Trident/');\n\n    if (msie > 0) {\n        // IE 10 or older => return version number\n        return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\n    }\n\n    if (trident > 0) {\n        // IE 11 (or newer) => return version number\n        var rv = ua.indexOf('rv:');\n        return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\n    }\n\n    // other browser\n    return false;\n}\n\n//alert('IE ' + detectIE());\n//$(\".bbox\").removeClass(\"login-box-error-small corners\");\nif(detectIE()){\n\tvvv=\"\";\n\tver=8;\n\tif(detectIE() < ver){\n\t\t $(\".inner99\").addClass(\" login-box-error-small corners \");\n\t\tvvv=\"Internet Explorer version ต่ำกว่า v.\"+ver+\" <br>ไม่รองรับ กับ Website e-Staff\";\n\t\t\n\t\t  $( \"<p style='color:#000'>\"+ vvv +\"</p>\" ).appendTo( \".inner99\" );\n\t}\n\t\n}else{\n\t$(\".inner99\").addClass(\" login-box-error-small corners \");\n\t$(\".inner99\").height(50);\n\tvvv=\"Browser ไม่ใช่ Internet Explorer <br>ไม่รองรับ กับ <b>บางระบบ</b>ของ Website e-Staff\";\n\t  \n\t  $( \"<p style='color:#000;'>\"+ vvv +\"</p>\" ).appendTo( \".inner99\" );\n}\n //$( \"<div>\" + version + \" : <span>\" + browser + \"</span>\" ).appendTo( document.body );\n // $( \"<div>\" + version + \" : <span>\" + detectIE() + \"</span>\" ).appendTo( document.body );\n\n// Now you have two variables, browser and version\n// which have the right info\n\n//-->\n</script> \n        <p style=\"height:30px;\">\n\n </p></body>"}
