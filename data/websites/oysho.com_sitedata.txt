{"link":"oysho.com","html":"<head>\n    <!-- BEGIN pre-common head -->\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"> \n\n<meta content=\"Tendencias primavera verano 2017 en Oysho online. Compra los bikinis, bañadores, pijamas, sujetadores o ropa deportiva más soft &amp; chic. ¡Lo último a un clic!\" name=\"description\">\n<title>Tendencias Primavera Verano 2017 en moda de mujer | Oysho </title>\n<link rel=\"canonical\" href=\"https://www.oysho.com/\">\n<link rel=\"alternate\" media=\"only screen and (max-width: 640px)\" href=\"https://www.oysho.com/m/\">\n<link rel=\"alternate\" media=\"handheld\" href=\"https://www.oysho.com/m/\">\n<link rel=\"alternate\" hreflang=\"x-default\" href=\"https://www.oysho.com/\">\n<link rel=\"alternate\" hreflang=\"fr-DZ\" href=\"https://www.oysho.com/dz/\">\n<link rel=\"alternate\" hreflang=\"en-DZ\" href=\"https://www.oysho.com/dz/en/\">\n<link rel=\"alternate\" hreflang=\"es-AD\" href=\"https://www.oysho.com/ad/\">\n<link rel=\"alternate\" hreflang=\"fr-AD\" href=\"https://www.oysho.com/ad/fr/\">\n<link rel=\"alternate\" hreflang=\"en-AD\" href=\"https://www.oysho.com/ad/en/\">\n<link rel=\"alternate\" hreflang=\"en-AM\" href=\"https://www.oysho.com/am/\">\n<link rel=\"alternate\" hreflang=\"de-AT\" href=\"https://www.oysho.com/at/\">\n<link rel=\"alternate\" hreflang=\"en-AT\" href=\"https://www.oysho.com/at/en/\">\n<link rel=\"alternate\" hreflang=\"en-AZ\" href=\"https://www.oysho.com/az/\">\n<link rel=\"alternate\" hreflang=\"en-BH\" href=\"https://www.oysho.com/bh/\">\n<link rel=\"alternate\" hreflang=\"fr-BE\" href=\"https://www.oysho.com/be/\">\n<link rel=\"alternate\" hreflang=\"en-BE\" href=\"https://www.oysho.com/be/en/\">\n<link rel=\"alternate\" hreflang=\"nl-BE\" href=\"https://www.oysho.com/be/nl/\">\n<link rel=\"alternate\" hreflang=\"bg-BG\" href=\"https://www.oysho.com/bg/\">\n<link rel=\"alternate\" hreflang=\"en-BG\" href=\"https://www.oysho.com/bg/en/\">\n<link rel=\"alternate\" hreflang=\"zh-CN\" href=\"https://www.oysho.cn/cn/\">\n<link rel=\"alternate\" hreflang=\"en-CN\" href=\"https://www.oysho.cn/cn/en/\">\n<link rel=\"alternate\" hreflang=\"es-CO\" href=\"https://www.oysho.com/co/\">\n<link rel=\"alternate\" hreflang=\"en-CO\" href=\"https://www.oysho.com/co/en/\">\n<link rel=\"alternate\" hreflang=\"hr-HR\" href=\"https://www.oysho.com/hr/\">\n<link rel=\"alternate\" hreflang=\"en-HR\" href=\"https://www.oysho.com/hr/en/\">\n<link rel=\"alternate\" hreflang=\"cs-CZ\" href=\"https://www.oysho.com/cz/\">\n<link rel=\"alternate\" hreflang=\"en-CZ\" href=\"https://www.oysho.com/cz/en/\">\n<link rel=\"alternate\" hreflang=\"da-DK\" href=\"https://www.oysho.com/dk/\">\n<link rel=\"alternate\" hreflang=\"en-DK\" href=\"https://www.oysho.com/dk/en/\">\n<link rel=\"alternate\" hreflang=\"de-DE\" href=\"https://www.oysho.com/de/\">\n<link rel=\"alternate\" hreflang=\"en-DE\" href=\"https://www.oysho.com/de/en/\">\n<link rel=\"alternate\" hreflang=\"es-EC\" href=\"https://www.oysho.com/ec/\">\n<link rel=\"alternate\" hreflang=\"en-EC\" href=\"https://www.oysho.com/ec/en/\">\n<link rel=\"alternate\" hreflang=\"en-EG\" href=\"https://www.oysho.com/eg/\">\n<link rel=\"alternate\" hreflang=\"es-ES\" href=\"https://www.oysho.com/es/\">\n<link rel=\"alternate\" hreflang=\"ca-ES\" href=\"https://www.oysho.com/es/ca/\">\n<link rel=\"alternate\" hreflang=\"gl-ES\" href=\"https://www.oysho.com/es/gl/\">\n<link rel=\"alternate\" hreflang=\"eu-ES\" href=\"https://www.oysho.com/es/eu/\">\n<link rel=\"alternate\" hreflang=\"en-ES\" href=\"https://www.oysho.com/es/en/\">\n<link rel=\"alternate\" hreflang=\"es-IC\" href=\"https://www.oysho.com/ic/\">\n<link rel=\"alternate\" hreflang=\"en-IC\" href=\"https://www.oysho.com/ic/en/\">\n<link rel=\"alternate\" hreflang=\"et-EE\" href=\"https://www.oysho.com/ee/\">\n<link rel=\"alternate\" hreflang=\"en-EE\" href=\"https://www.oysho.com/ee/en/\">\n<link rel=\"alternate\" hreflang=\"en-FI\" href=\"https://www.oysho.com/fi/\">\n<link rel=\"alternate\" hreflang=\"fr-FR\" href=\"https://www.oysho.com/fr/\">\n<link rel=\"alternate\" hreflang=\"en-FR\" href=\"https://www.oysho.com/fr/en/\">\n<link rel=\"alternate\" hreflang=\"en-GE\" href=\"https://www.oysho.com/ge/\">\n<link rel=\"alternate\" hreflang=\"el-GR\" href=\"https://www.oysho.com/gr/\">\n<link rel=\"alternate\" hreflang=\"en-GR\" href=\"https://www.oysho.com/gr/en/\">\n<link rel=\"alternate\" hreflang=\"es-GT\" href=\"https://www.oysho.com/gt/\">\n<link rel=\"alternate\" hreflang=\"en-GT\" href=\"https://www.oysho.com/gt/en/\">\n<link rel=\"alternate\" hreflang=\"en-HK\" href=\"https://www.oysho.com/hk/\">\n<link rel=\"alternate\" hreflang=\"en-HU\" href=\"https://www.oysho.com/hu/\">\n<link rel=\"alternate\" hreflang=\"en-ID\" href=\"https://www.oysho.com/id/\">\n<link rel=\"alternate\" hreflang=\"en-IE\" href=\"https://www.oysho.com/ie/\">\n<link rel=\"alternate\" hreflang=\"it-IT\" href=\"https://www.oysho.com/it/\">\n<link rel=\"alternate\" hreflang=\"en-IT\" href=\"https://www.oysho.com/it/en/\">\n<link rel=\"alternate\" hreflang=\"en-JO\" href=\"https://www.oysho.com/jo/\">\n<link rel=\"alternate\" hreflang=\"en-KZ\" href=\"https://www.oysho.com/kz/\">\n<link rel=\"alternate\" hreflang=\"en-KW\" href=\"https://www.oysho.com/kw/\">\n<link rel=\"alternate\" hreflang=\"lv-LV\" href=\"https://www.oysho.com/lv/\">\n<link rel=\"alternate\" hreflang=\"en-LV\" href=\"https://www.oysho.com/lv/en/\">\n<link rel=\"alternate\" hreflang=\"en-LB\" href=\"https://www.oysho.com/lb/\">\n<link rel=\"alternate\" hreflang=\"lt-LT\" href=\"https://www.oysho.com/lt/\">\n<link rel=\"alternate\" hreflang=\"en-LT\" href=\"https://www.oysho.com/lt/en/\">\n<link rel=\"alternate\" hreflang=\"fr-LU\" href=\"https://www.oysho.com/lu/\">\n<link rel=\"alternate\" hreflang=\"de-LU\" href=\"https://www.oysho.com/lu/de/\">\n<link rel=\"alternate\" hreflang=\"en-LU\" href=\"https://www.oysho.com/lu/en/\">\n<link rel=\"alternate\" hreflang=\"en-MO\" href=\"https://www.oysho.com/mo/\">\n<link rel=\"alternate\" hreflang=\"en-MT\" href=\"https://www.oysho.com/mt/\">\n<link rel=\"alternate\" hreflang=\"fr-MA\" href=\"https://www.oysho.com/ma/\">\n<link rel=\"alternate\" hreflang=\"en-MA\" href=\"https://www.oysho.com/ma/en/\">\n<link rel=\"alternate\" hreflang=\"en-ME\" href=\"https://www.oysho.com/me/\">\n<link rel=\"alternate\" hreflang=\"es-MX\" href=\"https://www.oysho.com/mx/\">\n<link rel=\"alternate\" hreflang=\"en-MX\" href=\"https://www.oysho.com/mx/en/\">\n<link rel=\"alternate\" hreflang=\"nl-NL\" href=\"https://www.oysho.com/nl/\">\n<link rel=\"alternate\" hreflang=\"en-NL\" href=\"https://www.oysho.com/nl/en/\">\n<link rel=\"alternate\" hreflang=\"en-OM\" href=\"https://www.oysho.com/om/\">\n<link rel=\"alternate\" hreflang=\"es-PA\" href=\"https://www.oysho.com/pa/\">\n<link rel=\"alternate\" hreflang=\"en-PA\" href=\"https://www.oysho.com/pa/en/\">\n<link rel=\"alternate\" hreflang=\"pl-PL\" href=\"https://www.oysho.com/pl/\">\n<link rel=\"alternate\" hreflang=\"en-PL\" href=\"https://www.oysho.com/pl/en/\">\n<link rel=\"alternate\" hreflang=\"pt-PT\" href=\"https://www.oysho.com/pt/\">\n<link rel=\"alternate\" hreflang=\"en-PT\" href=\"https://www.oysho.com/pt/en/\">\n<link rel=\"alternate\" hreflang=\"en-QA\" href=\"https://www.oysho.com/qa/\">\n<link rel=\"alternate\" hreflang=\"es-DO\" href=\"https://www.oysho.com/do/\">\n<link rel=\"alternate\" hreflang=\"en-DO\" href=\"https://www.oysho.com/do/en/\">\n<link rel=\"alternate\" hreflang=\"ro-RO\" href=\"https://www.oysho.com/ro/\">\n<link rel=\"alternate\" hreflang=\"en-RO\" href=\"https://www.oysho.com/ro/en/\">\n<link rel=\"alternate\" hreflang=\"ru-RU\" href=\"https://www.oysho.com/ru/\">\n<link rel=\"alternate\" hreflang=\"en-RU\" href=\"https://www.oysho.com/ru/en/\">\n<link rel=\"alternate\" hreflang=\"en-SA\" href=\"https://www.oysho.com/sa/\">\n<link rel=\"alternate\" hreflang=\"en-RS\" href=\"https://www.oysho.com/rs/\">\n<link rel=\"alternate\" hreflang=\"sk-SK\" href=\"https://www.oysho.com/sk/\">\n<link rel=\"alternate\" hreflang=\"en-SK\" href=\"https://www.oysho.com/sk/en/\">\n<link rel=\"alternate\" hreflang=\"en-SI\" href=\"https://www.oysho.com/si/\">\n<link rel=\"alternate\" hreflang=\"en-KR\" href=\"https://www.oysho.com/kr/\">\n<link rel=\"alternate\" hreflang=\"en-SE\" href=\"https://www.oysho.com/se/\">\n<link rel=\"alternate\" hreflang=\"de-CH\" href=\"https://www.oysho.com/ch/\">\n<link rel=\"alternate\" hreflang=\"it-CH\" href=\"https://www.oysho.com/ch/it/\">\n<link rel=\"alternate\" hreflang=\"fr-CH\" href=\"https://www.oysho.com/ch/fr/\">\n<link rel=\"alternate\" hreflang=\"en-CH\" href=\"https://www.oysho.com/ch/en/\">\n<link rel=\"alternate\" hreflang=\"fr-TN\" href=\"https://www.oysho.com/tn/\">\n<link rel=\"alternate\" hreflang=\"en-TN\" href=\"https://www.oysho.com/tn/en/\">\n<link rel=\"alternate\" hreflang=\"tr-TR\" href=\"https://www.oysho.com/tr/\">\n<link rel=\"alternate\" hreflang=\"en-TR\" href=\"https://www.oysho.com/tr/en/\">\n<link rel=\"alternate\" hreflang=\"en-UA\" href=\"https://www.oysho.com/ua/\">\n<link rel=\"alternate\" hreflang=\"en-AE\" href=\"https://www.oysho.com/ae/\">\n<link rel=\"alternate\" hreflang=\"en-GB\" href=\"https://www.oysho.com/gb/\">\n\n<!-- BEGIN SPOT=OY3_ESpot_HeadBegin -->\n<meta name=\"apple-itunes-app\" content=\"app-id=464273021\"><meta name=\"yandex-verification\" content=\"fd22b9cffd2b2850\">\n<meta name=\"msvalidate.01\" content=\"74DF6E0399EC886717E63B1B4A0FDE59\"><iframe src=\"javascript:void(0)\" title=\"\" style=\"width: 0px; height: 0px; border: 0px; display: none;\"></iframe><script async=\"\" src=\"https://connect.facebook.net/en_US/fbevents.js\"></script><script async=\"\" src=\"//www.googletagmanager.com/gtm.js?id=GTM-WNGV5L\"></script><script type=\"text/javascript\" async=\"\" src=\"https://ssl.google-analytics.com/ga.js\"></script><script type=\"text/javascript\">\n\n\ttry\n\t{\n        if(!window.console)\n            {\n                console = {log: function() {}};\n            }\n\t}\ncatch(e)\n\t{\n\t} \n\n</script><script src=\"//cdn.optimizely.com/js/2706060415.js\"></script><iframe src=\"https://a2659630112.cdn.optimizely.com/client_storage/a2659630112.html\"></iframe>\n<!-- END SPOT=OY3_ESpot_HeadBegin -->\n\n<!-- BEGIN SPOT=OY3_ESpot_WorldWidePageHead -->\n\n<!-- END SPOT=OY3_ESpot_WorldWidePageHead -->\n\n<link rel=\"stylesheet\" type=\"text/css\" href=\"/static/itxwebstandard/css/itx-core-main.min.css?t=20170419233702db714465006\">\n\n<script type=\"text/javascript\" src=\"/static/itxwebstandard/js/itx-core-api.min.js?t=20170419233702db714465006\"></script>\n<script type=\"text/javascript\" src=\"/static/itxwebstandard/js/64009600/-5/60361120/OY3_ESpot_I18N.min.js?t=20170422040205714465006\"></script>\n\n<!-- Begin JS Attachments -->\n<!-- End JS Attachments -->\n\n<!-- Begin CSS Attachments -->\n<!-- End CSS Attachments -->\n\n\n<script type=\"text/javascript\">\n\tinditex.iBrand = \"oysho\";\n\tinditex.iBrandId = 6;\n\tinditex.iIsMobile = false;\n\tinditex.iIsMobileOn = true;\n\tinditex.iPage = \"ItxWorldWidePage\";\n\tinditex.iParams = {};\n\tinditex.iStoreId = 64009600;\n\tinditex.iStoreIdentifier = \"OyshoES\";\n\tinditex.iLangId = -5;\n\tinditex.iCatalogId = 60361120;\n\tinditex.iLayout = \"itxwebstandard\";\n\tinditex.iRegistryTs = \"20170422040205714465006\";\n\tinditex.iCustomTs = \"20170419233702db714465006\";\n\tinditex.iProxyHostMobile = \"www.oysho.com\";\n\tinditex.iProxyHostStandard = \"www.oysho.com\";\n\tinditex.iProxyPortMobile = 80;\n\tinditex.iProxyPortStandard = 80;\n\tinditex.iProxySecurePortMobile = 443;\n\tinditex.iProxySecurePortStandard = 443;\n\tinditex.iProxyContextPathMobile = \"/m/\";\n\tinditex.iProxyContextPathStandard = \"/\";\n\tinditex.iSecureSet = [\"ItxIFrameHelperPage\",\"ItxMyAccountAccessPage\",\"ItxMyAccountDetailBookingPage\",\"ItxMyAccountHomePage\",\"ItxOrderDetailPage\",\"ItxMyAccountPersonalPage\",\"ItxMyAccountOrdersPage\",\"ItxOrderCheckoutPage\",\"ItxMyAccountAddressBookPage\",\"ItxMyAccountListPaymentCardPage\",\"ItxMyAccountOrderDetailPage\",\"ItxMyAccountBookingPage\",\"ItxMyAccountRequestReturnPage\",\"ItxMyAccountMenuPage\",\"ItxAjaxLogonPage\",\"ItxMyAccountStoresPage\",\"ItxUserResetPasswordPage\",\"ItxMyAccountStoresLocatorPage\",\"ItxUserRegistrationPage\",\"ItxMyAccountNewsletterPage\",\"ItxMyAccountInvoicesPage\"];\n\tinditex.iLocale = \"es_ES\";\n\tinditex.iCountryCode = \"ES\";\n\tinditex.iCountryName = \"España\";\n\tinditex.iSpotPrefix = \"OY3_ESpot_\";\n\tinditex.iCategoryId = null;\n\tinditex.iCategoryKey = null;\n\tinditex.iProductId = null;\n\tinditex.iMaxLastProductListLength = 10;\n\tinditex.iAsyncPaymentPollingTries = 5;\n\tinditex.iAsyncPaymentPollingInterval = 5000;\n\tinditex.iGoogleMapsUser = \"gme-itxecommerceireland\";\n\tinditex.iGoogleMapsKey = \"ABQIAAAAuLM0t2_kkFjBTv19NCnv4xQ1eARysJDSA6Rsmys1__vV4q3ogRSAPpMJQEtE6PZS8bUt68TqwWpmdA\";\n\tinditex.iGoogleMapsChannel = \"Oysho\";\n\tinditex.iGaKeyAnt = \"UA-2867281-1\";\n\tinditex.iGaKey1 = null;\n\tinditex.iGaKey2 = null;\n    inditex.iGooglePlacesKey = null;\n    inditex.iGooglePlacesEnabled = true;\n\tinditex.iGaDomain = \".www.oysho.com\";\n\tinditex.iEnableUniversalAnalytics = null;\n\tinditex.iAppId = 1;\n\tinditex.iIsWebResponsive = false;\n\tinditex.iSolrPublicUrlServer = \"www.oysho.com/data\";\n\tinditex.iTmpUrlLangStandard = true;\n\tinditex.iTmpUrlLangMobile = true;\n\tinditex.iMaxProductsShopCart = 25;\n\tinditex.iMaxProductsWishList = 1000;\n\tinditex.iGoogleMapsRegexPublic = \"^$\";\n\tinditex.iSecureEnabled = true;\n\tinditex.iBaiduMapsKey = \"\";\n\tinditex.iBaiduHttps = false;\n\tinditex.iMapLocationFromStoreEnabled = true;\n\tinditex.iSequenceFromStockEnabled = true;\n    inditex.iEnableOptimizelyAnalyticsIntegration = false;\n    inditex.iParseMspotEnabled = false;\n    inditex.iGoogleMapsRegion = false;\n    inditex.iGoogleMapsLanguage = true;\n    inditex.iSafeCartEnabled = false;\n    inditex.iMpulseEnabled = true;\n    inditex.iProxyRestContextPathMobile = \"/itxrest/\";\n\tinditex.iProxyRestContextPathStandard = \"/itxrest/\";\n\tinditex.iRestVersion = \"2\";\n</script>\n\n<!-- Google Analytics -->\n\t<script type=\"text/javascript\">\n\t\tvar _gaq = _gaq || [];\n\t\twindow['ga-disable-'+inditex.iGaKeyAnt] = true; \n\t\t(function() {\n\t\t\tvar ga = document.createElement('script');\n\t\t\tga.type = 'text/javascript';\n\t\t\tga.async = true;\n\t\t\tga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';\n\t\t\tvar s = document.getElementsByTagName('script')[0];\n\t\t\ts.parentNode.insertBefore(ga, s);\n\t\t})();\n\t</script>\n<!-- End Google Analytics -->\n<!-- END pre-common head -->\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n\n<!--[if IE]><link rel=\"StyleSheet\" media=\"all\" type=\"text/css\" href=\"/static/itxwebstandard/css/productPage_ie.css?t=20170419233702db714465006\"/><![endif]-->\n<!--[if IE]><link rel=\"StyleSheet\" media=\"all\" type=\"text/css\" href=\"/static/itxwebstandard/css/main_hacks.css?t=20170419233702db714465006\"/><![endif]-->\n\n<link rel=\"shortcut icon\" type=\"image/x-icon\" href=\"https://static.oysho.net/6/static2/itxwebstandard/images/favicon.ico?t=20170422040205714465006\">\n<script type=\"text/javascript\">\n\n    window.Inditex = window.inditex;\n\n\t\tInditex.iXBindType = 'click';\n\n    inditex.onReady(function() {\n\n      inditex.drawHeader();\n\n    });\n\n\t</script>\n\n\t\t<script>\n\n\t\t\t/**\n\t\t\t * Stores Object\n\t\t\t */\n\n\t\t \tInditex.iDrawHeaderOnReady = false;\n\t\t\tInditex.onReady(function() {\n        Inditex.iXStores = inditex.iStoreListJSON;\n\t\t\t\tnew ItxWorldWidePageClass();\n\t\t\t});\n\t\t\t$(document).ready(function(){\n\t\t\t\tinditex.xManageCookies();\n\t\t\t})\n\t\t</script>\n<!-- END page head -->\n\n<!-- BEGIN post-common head -->\n<script type=\"text/javascript\" src=\"https://static.oysho.net/6/static2/itxwebstandard/js/itx-custom-api.min.js?t=20170422040205714465006\"></script>\n\n<!-- BEGIN SPOT=OY3_ESpot_Inditex -->\n<!-- FIX_ECOMOYSH-4436 -->\n<script>\nOrderValidationClass.prototype._submit = function () {\n  var self = this;\n  var data = '';\n  var paymentMethod = self.activePaymentMethod;\n  var index;\n\n  if (inditex.iStoreJSON.countryCode === 'TR' && !$('.js-legal-sections-checkbox').hasClass('active')) {\n    self._paymentMethodErrorTrigger({\n      error: Inditex.text('MUST_ACCEPT_BUY_CODITIONS_AND_POLICY_PRIVACY'),\n      isTurkey: true\n    });\n    return false;\n  }\n\n  self.walletCardSelected = $('.walletCardMethod').hasClass('active');\n  self.card = undefined;\n  if (paymentMethod) {\n    self.card = {};\n    self.card.paymentMethodKind = paymentMethod.kind;\n    self.card.paymentMethodType = paymentMethod.type;\n  }\n\n  if (self.walletCardSelected) {\n    self.card.cardHash = paymentMethod.hash;\n    self.card.paymentMethodKind = self.card.paymentMethodType = 'walletcard';\n    for (var i = 0; i < Inditex.iXPayment.paymentMethods.length; i++) {\n      var paymentMethod = Inditex.iXPayment.paymentMethods[i];\n      // Si el c�digo pasado concuerda con el tipo credit_cardinstallments mostramos el select, si no, ocultamos\n\n      if (self.activePaymentMethod.paymentCode == paymentMethod.code) {\n\n        if (paymentMethod.kind == 'credit_card_installments' || paymentMethod.kind == 'credit_card') {\n          self.card.cvv2 = $('#extraValidation').val();\n        }\n        if (paymentMethod.kind == 'credit_card_installments' && $(\"#iModalidadPagoSelectedCreditCardCodeCC\").val() != \"\") {\n          data += \"&installmentsCode_0=\" + encodeURIComponent($(\"#iModalidadPagoSelectedCreditCardCodeCC\").val());\n        }\n        if (paymentMethod.kind == 'affinity') {\n          self.card.paymentModeId = $('#iModalidadPagoSelectedCreditCardCodeCC').val();\n        }\n      }\n    }\n    self.bill = $('#Chk_Shi_Addr_Bill_input').length && !$('#Chk_Shi_Addr_Bill_input').is(\":hidden\") || self.isCompany;\n\n    if (!self.isCompany) {\n      if ($(\"#Chk_Shi_Addr_Bill_input\").val() != undefined) {\n        self.nifPay = $(\"#Chk_Shi_Addr_Bill_input\").val();\n      }\n    } else {\n      self.nifPay = self.vatin;\n    }\n  } else {\n    if (paymentMethod && paymentMethod.kind == 'mobile') {\n      self.openMobilePopup();\n      return;\n    }\n    self.bill = $('#Chk_Shi_Addr_Bill_input').length && !$('#Chk_Shi_Addr_Bill_input').is(\":hidden\") || self.isCompany;\n\n    if (!self.isCompany) {\n      if ($(\"#Chk_Shi_Addr_Bill_input\").val() != undefined) {\n        self.nifPay = $(\"#Chk_Shi_Addr_Bill_input\").val();\n      }\n    } else {\n      self.nifPay = self.vatin;\n    }\n\n    if (paymentMethod) {\n      data += \"&cardType_\" + index + \"=\" + encodeURIComponent(paymentMethod.name);\n      if (paymentMethod.kind == \"credit_card\") {\n        self.card.number = $('#card_number').val().replace(/ /g, '');\n        self.card.month = $('#iMonthSelectedCreditCard').val();\n        self.card.year = $('#iYearSelectedCreditCard').val();\n        self.card.cvv2 = $('#card_number_cvv2').val();\n        self.card.holder = $('#card_owner').val();\n      } else if (paymentMethod.kind == 'credit_card_installments') {\n        self.card.number = $('#card_number').val().replace(/ /g, '');\n        self.card.month = $('#iMonthSelectedCreditCard').val();\n        self.card.year = $('#iYearSelectedCreditCard').val();\n        self.card.cvv2 = $('#card_number_cvv2').val();\n        self.card.holder = $('#card_owner').val();\n        if ($('#iModalidadPagoSelectedCreditCardCode').val() != '') {\n          self.card.paymentModeId = $('#iModalidadPagoSelectedCreditCardCode').val();\n        }\n        data += \"&installmentsCode_\" + index + \"=\" + encodeURIComponent($('#iModalidadPagoSelectedCreditCardCode').val() || \"1\");\n      } else if (paymentMethod.kind == \"affinity\") {\n        self.card.number = $('#card_number').val().replace(/ /g, '');\n        self.card.vatin = $('#nif').val();\n        self.card.holder = $('#card_owner').val();\n        self.card.paymentModeId = $('#iModalidadPagoSelectedCreditCardCode').val();\n      } else if (paymentMethod.kind == \"qiwi\") {\n        self.card.phoneNumber = $(\"#\" + formName + ' #phoneCountryCode_0').val() + $(\"#\" + formName + ' #numTlf').val();\n      } else if (paymentMethod.kind == \"p24\") {\n        self.card.eShopperCode = Inditex.iStoreJSON.countryCode;\n      } else if (paymentMethod.kind == \"ideal\") {\n        self.card.eShopperCode = $('#idealBanksSelect').val();\n      } else if (paymentMethod.kind == \"inwallet\") {\n        self.card.cardHash = $(\"#inWalletCardHash\").val();\n        var paymentModeId = $('#iModalidadPagoSelectedCreditCardCode').val();\n        self.card.paymentModeId = (paymentModeId && paymentModeId.length) ? paymentModeId : undefined;\n      } else if (paymentMethod.kind == \"kinvoice\" || paymentMethod.kind == \"kaccount\") {\n        var kbPNO = $('#Chk_Payment .OY_form #birthDate').val();\n        if (kbPNO.indexOf('-') > 0) {\n          var values = kbPNO.split(\"-\");\n          self.card.kbPNO = values[2] + values[1] + values[0];\n        } else {\n          self.card.kbPNO = kbPNO.replace(/\\//g, \"\");\n        }\n        self.card.kbGender = $('#Chk_Payment .OY_form a[rel=\"klarnaRadios\"].active').parent().find('input').val();\n        if ($('#Chk_Payment .OY_form').find('input[name=kl_address1]').length) {\n          self.card.kl_address1 = $('#Chk_Payment .OY_form').find('input[name=kl_address1]').val();\n          self.card.kl_zipCode = $('#Chk_Payment .OY_form').find('input[name=kl_zipCode]').val();\n          self.card.kl_city = $('#Chk_Payment .OY_form').find('input[name=kl_city]').val();\n          self.card.kl_state = $('#Chk_Payment .OY_form').find('input[name=kl_state]').val();\n        }\n      }\n    }\n  }\n\n  var onStart = function () {\n    Inditex.xPopupTramitando();\n    // Tag manager\n    $.event.trigger({\n      type: 'orderCheckoutPage.sendPayment',\n      cardType: (self.card) ? self.card.paymentMethodType : undefined\n    });\n  };\n\n  var onError = function (key, message) {\n    Inditex.xCloseOverlay();\n    if ($('.paymentMethodcont.selectable.active .OY_radio.paymentMethod.active').length &&\n      $('.paymentMethodcont.selectable.active .OY_radio.paymentMethod.active').attr('data-type') == 'KINVOICE' &&\n      key != 'DynamicError.genericProblem') {\n      var textBottomPopup = key;\n    } else {\n      var textBottomPopup = inditex.text('CHK_CHECK_DATA');\n    }\n    Inditex.xOpenErrorPopUp(350, 100, message, textBottomPopup);\n    // Tag manager\n    $.event.trigger({\n      type: 'orderCheckoutPage.paymentError',\n      errorCode: key,\n      errorMessage: message\n    });\n  };\n\n  var onAuthAgain = function () {\n    Inditex.xCloseOverlay();\n    self._requestPassword();\n  };\n\n  if (typeof self.nifPay === 'undefined' || self.nifPay === undefined) {\n    self.nifPay = null;\n  }\n\n  var checkoutData = {\n    \"card\": self.card,\n    \"addressId\": inditex.iXShopCart.billingAddressId,\n    \"vatin\": self.nifPay,\n    \"invoice\": self.bill ? '1' : '0',\n    \"onStart\": onStart,\n    \"onError\": onError,\n    \"onAuthAgain\": onAuthAgain\n  };\n\n  if (self.authAgain) {\n    checkoutData.password = self.authAgain;\n  }\n\n  inditex.submitPayment(checkoutData);\n};\n</script>\n<!-- END FIX_ECOMOYSH-4436 --><!-- FIX_ECOMOYSH-4500 -->\n<script>\nItxMiniShopCartDisplayClass.prototype.setShopCartBannerMesage = function () {\n  var self = this;\n  var mensaje = \"\";\n  var totalPedido = self.options.shop_cart.totalProduct;\n\n  if (inditex.limitBanner && inditex.limitBanner.threshold) {\n  \n\tvar margin = (inditex.limitBanner.margin != undefined) ? inditex.limitBanner.margin : 0;\n\n    if (inditex.limitBanner.threshold - margin > totalPedido) {\n      var resta = inditex.limitBanner.threshold - totalPedido;\n      mensaje = inditex.limitBanner.message_left;\n      mensaje = mensaje.replace(\"{@}\", inditex.formatPrice(resta).replace(\"$\", \"&#36;\"));\n    } else {\n      mensaje = inditex.limitBanner.message_reached;\n    }\n    var dBannerLimit = $(\"<div></div>\").addClass(\"MSMessage\").html(mensaje);\n    return dBannerLimit;\n\n  }\n};\n\nfunction setShopCartBannerMesage() {\n  var mensaje = \"\";\n  var totalPedido = inditex.iXShopCart.totalProduct;\n\n  if (inditex.limitBanner && inditex.limitBanner.threshold) {\n\tvar margin = (inditex.limitBanner.margin != undefined) ? inditex.limitBanner.margin : 0;\n\t\n    if (inditex.limitBanner.threshold - margin > totalPedido) {\n      var resta = inditex.limitBanner.threshold - totalPedido;\n      mensaje = inditex.limitBanner.message_left;\n      mensaje = mensaje.replace(\"{@}\", inditex.formatPrice(resta).replace(\"$\", \"&#36;\"));\n    } else {\n      mensaje = inditex.limitBanner.message_reached;\n    }\n    var dBannerLimit = $(\"<div></div>\").addClass(\"MSMessage\").html(mensaje);\n    return dBannerLimit;\n  }\n}\n</script>\n<!-- END FIX_ECOMOYSH-4500 -->\n<script>\nItxMyAccountHomePageClass.prototype._init = function (loadMenu, noPageView) {\n  var self = this;\n  self.sections = Inditex.iXMyAccountSections;\n\n  if (loadMenu) {\n    //Cargamos en la cabecera del pop up el nombre del usuario\n    Inditex.getUserJSON(function (aJson) {\n      var firstName = aJson.firstName == '-' ? '' : aJson.firstName;\n      var lastName = aJson.lastName == '-' ? '' : aJson.lastName;\n      if (Inditex.isPatronymic() && aJson.middleName && null != aJson.middleName && aJson.middleName != \"\") {\n        $('#myAccountNameHeader').html(Inditex.htmlEncodeObject(firstName) + '&nbsp;' + Inditex.htmlEncodeObject(aJson.middleName) + '&nbsp;' + Inditex.htmlEncodeObject(lastName));\n      } else {\n        $('#myAccountNameHeader').html(Inditex.htmlEncodeObject(firstName) + '&nbsp;' + Inditex.htmlEncodeObject(lastName));\n      }\n\n      var logout = $('.logout');\n      if (!logout.length || logout.length == 0) {\n        $('#myAccountNameHeader').parent().prepend('<a class=\"logout\" href=\"\">' + inditex.text(\"ITX_HEADER_DISPLAY_DISCONNECT\") + '</a>');\n      }\n      $('.myaccount .logout').bind(Inditex.iXBindType, function (e) {\n        e.preventDefault();\n        var iHomeUrl = inditex.generateUrl(\"ItxHomePage\", {\n          \"storeId\": inditex.iStoreId,\n          \"langId\": inditex.iLangId,\n          \"catalogId\": inditex.iCatalogId\n        });\n        inditex.xRestLogout().done(function () {\n          window.location = iHomeUrl;\n        });\n      });\n      if (Inditex.iXWalletCardsJSON && Inditex.iXWalletCardsJSON.length) {\n        $('#myAccountLinkListPaymentCard').removeClass('hide');\n\n        // -- mostrar en enlace de comprar rápida del Mspot\n        var myAccountLinkListPaymentCardMspot = $('#myAccountLinkListPaymentCardMspot');\n        if (myAccountLinkListPaymentCardMspot) {\n          myAccountLinkListPaymentCardMspot.removeClass('hide');\n        }\n\n      } else {\n        $('#myAccountLinkListPaymentCard').remove();\n      }\n\n      if (aJson.pendingTransfers != null && aJson.pendingTransfers.length != 0) {\n        $('#myAccountManualTranfer').removeClass('hide');\n\n        var transferenciaManualMspot = $('#myAccountManualTranferMspot')\n        if (transferenciaManualMspot) {\n          transferenciaManualMspot.removeClass('hide');\n        }\n      }\n    });\n  }\n\n\n\n  //iniciamos home\n  Inditex.iXObjHome = this;\n  $('ul.guide_menu li a.guide_element, strong a.guide_element').on('click', function (e) {\n    e.preventDefault();\n    var related = $(this).attr('rel');\n    self.loadMyAccountSection(related);\n  });\n  $('.overlay_content').addClass('fixedHeight');\n  $('.overlay').attr('height', '571px');\n\n\n\n  $('.overlay_content').mCustomScrollbar('destroy');\n  $('.overlay_content').mCustomScrollbar({\n    theme: 'dark-3',\n    advanced: {\n      updateOnContentResize: true\n    },\n    callbacks: {\n      whileScrolling: function () {\n        $('.shop_guide > .guide_menu, .shop_guide > .title').css({\n          top: -this.mcs.top\n        });\n      }\n    }\n  });\n  // .mCustomScrollbar.mCS_no_scrollbar\n  $('.overlay_content').addClass('fixedHeight');\n\n  // Tag Manager\n  $.event.trigger({\n    type: 'userAccount.load'\n  });\n  if (!noPageView) {\n    $.event.trigger({\n      type: 'userAccount.setPageView',\n      pageType: 'menu_usuario',\n      pageTitle: ''\n    });\n  }\n\n\n  self.hideReturns();\n  self.hideFavouriteStores();\n\n};\n</script><!-- FIX ECOMOSYH-4641 -->\n<script>\n// Función principal que dibuja la pantalla de detalle de un producto\nItxProductPageClass.prototype._draw = function () {\n  var self = this,\n    productsArray;\n\n  var productColors = self.isBundleSpecial ? self.iProductInfo.bundleProductSummaries[0].detail.colors : self.iProductInfo.detail.colors;\n\n  // Se selecciona el color a mostrar\n  if ((self.iColorId != null) && (self.iColorId != \"\")) {\n    // Se ha pasado un color como parÃ¡metro\n    for (var i = 0; i < productColors.length; i++) {\n      var test = productColors[i].id.match(/(0*)(.*)/);\n\n      var test2 = self.iColorId.match(/(0*)(.*)/);\n\n      productColors[i].id = test[test.length - 1];\n\n      self.iColorId = test2[test2.length - 1];\n\n      if (parseInt(productColors[i].id) == parseInt(self.iColorId)) {\n        self.iColorInfo = productColors[i];\n        break;\n      }\n    }\n  } else {\n    // No se ha elegido ningÃºn color y por lo tanto se muestra el primer color\n    if (!productColors.length < 1) {\n      self.iColorInfo = productColors[0];\n      self.iColorId = productColors[0].id;\n    }\n  }\n\n  // Si no hay color seleccionado se coje el primero del producto relacionado\n  if (((self.iColorInfo == null) || (self.iColorInfo == \"undefined\")) && self.iProductInfo.detail.colors.length > 0) {\n    self.iColorInfo = self.iProductInfo.detail.colors[0];\n  }\n\n  if (self.iContainer != 'popupContent') {\n    $('.share_content').show();\n    $('#extra_product_page').show();\n  }\n\n  // InformaciÃ³n bÃ¡sica\n\n  // Si es un bundle no mostramos el producto principal\n  if (!self.isBundle || self.iContainer == 'popupContent') {\n\n    self._drawReference();\n    self._drawName();\n    self._drawPrices();\n    self._drawModelHeight();\n    self._drawDescription();\n    self._drawComposition();\n    self._drawStockPopup();\n    self._drawCare();\n    self._drawColorSelector();\n    self._drawSizes();\n    self._drawAlertChooseSize();\n    self._drawNotifyInfos();\n\n\n\n    //  Añadir mostrar link mas detalles\n    var seeMoreButton = $(\"#\" + self.iContainer + \" #see_more\");\n    seeMoreButton.html('<a href=\"#\">' + Inditex.text(\"ItxProductPage.more_details\") + '</a>');\n    seeMoreButton.find('a').attr('href', inditex.generateUrl(\"ItxProductPage\", {\n      \"storeId\": Inditex.iStoreId,\n      \"langId\": Inditex.iLangId,\n      \"catalogId\": Inditex.iCatalogId,\n      \"categoryId\": self.iCategoryId,\n      \"productId\": self.iProductId,\n      \"typeCategory\": \"0\"\n    }));\n\n    if (seeMoreButton.innerWidth() +\n      $(\"#\" + self.iContainer + \" #addShopCart\").innerWidth() >\n      $(\"#\" + self.iContainer + \" .product_footer\").innerWidth()) {\n      seeMoreButton.css({\n        top: 10\n      });\n    }\n\n  }\n\n  // Obtencion del array de urls de imagenes de la pagina\n  self._getProdImgUrls();\n\n\n  // Imágenes auxiliares\n  if (!self.isBundle && self.iContainer == \"mainContent\") {\n\n    self._drawProductImages();\n\n  } else if (self.isBundle && self.iContainer != \"popupContent\") {\n\n    self._drawMainBundleImages();\n    self._drawAuxBundleImages();\n\n  } else {\n\n    // Imagen principal\n    //self._drawPopUpMainImage();\n    self._drawPopUpImageSlider();\n    //productos relacionados\n    //self._drawPopUpAuxImages();\n\n  };\n\n  //Si el color esta agotado dibujamos boton de ver disponibilidad\n  if ((self.iVisibilityMap[self.iProductInfo.id] == \"hidden\") || (self.iVisibilityMap[self.iProductInfo.id] == \"sold_out\")) {\n    self._drawShowAvaliabilityButton();\n\n  } else {\n    //Si la tienda lo permite anhadimos\n    //el boton de consulta de disponibilidad en tienda\n    if (!self.isBundle) {\n      if (Inditex.iStoreJSON.details.availabilityStockStore && self.iContainer != \"popupContent\") {\n        self._drawAvailabilityStockStoreLink();\n      }\n    }\n\n\n  }\n\n  // Botones para comprar el artÃ­culo\n  self._drawCartButton();\n\n\n  // Información para el usuario\n  if (!self.isBundle) {\n    self._drawSizeGuide();\n    self._drawShippingAndReturn();\n  }\n  // Si no es popup\n  if (self.iContainer == \"mainContent\") {\n    // Navegacion productos\n    self._drawProductNavigation();\n\n    // Ponemos o no el texto del STOCK para productBean\n    self._getStockTag(self.iProductInfo.tags);\n\n    // Productos relacionados\n    if (!self.isBundle) {\n      self._drawLikeProducts();\n    };\n  } else {\n    //Si es el pop up de detalle eliminamos la informacion extra\n    Inditex.xLoadCustomSelect(\"popupContent #selectProductSize\");\n\n    //Inditex.xLoadExtraInformation(\"popupContent #extra_product_page\");\n    $(\"#popupContent .product_sizes\").attr(\"id\", \"rel\" + self.iProductId)\n\n\n    self.slideExtraInfo(\"popupContent #extra_product_page\", function () {\n      $(\"#extra_product_page div.description\").mCustomScrollbar();\n    });\n  }\n\n  if (self.isBundle && self.iContainer != \"popupContent\") {\n\n    // Borramos los elementos innecesarios del html\n    $('#extra_product_page').remove();\n    $('#product_thumbs').remove();\n\n    var productos = new Array()\n      // Recogemos los productos relacionados\n    if (self.iProductInfo.bundleProductSummaries.length > 0) {\n      $.each(self.iProductInfo.bundleProductSummaries, function (i, relProd) {\n        productos.push(relProd.id);\n        // Se selecciona el color a mostrar\n        if (typeof relProd.iColorId != 'undefined' && ((relProd.iColorId != null) && (self.iColorId != \"\"))) {\n          // Se ha pasado un color como parÃ¡metro\n          for (var i = 0; i < relProd.detail.colors.length; i++) {\n            if (relProd.detail.colors[i].id == relProd.iColorId) {\n              relProd.iColorInfo = relProd.detail.colors[i];\n              break;\n            }\n          }\n        } else {\n          // No se ha elegido ningÃºn color y por lo tanto se muestra el primer color\n          if (!relProd.detail.colors.length < 1) {\n            relProd.iColorInfo = relProd.detail.colors[0];\n            relProd.iColorId = relProd.detail.colors[0].id;\n          }\n        }\n      });\n      productos = self._removeDuplic(productos);\n    }\n\n\n    self._loadRelatedProducts();\n\n    // AÃ±adimos el nombre del producto bundle\n\n    $('#productos.relacionados h3').remove();\n\n    $('#productos.relacionados').prepend(\"<h3>\" + self.iProductInfo.name + \"</h3>\");\n\n  }\n\n\n\n  self.clickToCallBind();\n\n};\n\n// Añadir alerta de selecciona talla\nItxProductPageClass.prototype._drawAlertChooseSize = function () {\n  var self = this;\n  var sizesList = $(\"#\" + self.iContainer + \" #sizes_list\");\n  if (!self.checkChooseColor){\n  var sizeInfoAlert = $('<div>')\n    .addClass('size_info icon-ico-info-l hidden')\n    .attr('id', 'size_info_' + self.iProductInfo.id)\n    .html(Inditex.text('select_size'))\n    .insertAfter(sizesList)\n    self.checkChooseColor = 1;\n}\n}\n\n// Dibuja las tallas disponibles para este color\n// En caso de que haya varias tallas con el mismo nombre, se añade\n// la primera que tenga stock. En caso de que ninguna tenga stock\n// se añade la primera.\nItxProductPageClass.prototype._drawSizes = function () {\n  var self, sizesList, sizes, span, addToSizes;\n  self = this;\n  self.currentColorPrices = {};\n  $('.product_info #skuAvailability').text(' ').removeClass();\n  sizesList = $(\"#\" + self.iContainer + \" #sizes_list\");\n  sizes = [];\n  addToSizes = 1;\n\n  // Si no hay tallas disponibles se muestra el boton \"Ver disponibilidad\"\n  if (self.iColorInfo.sizes.length === 0) {\n    setTimeout(function () {\n      self.disponibilityCartAnimation();\n    }, 500);\n  }\n\n  // Se recorren las tallas para comprobar si alguna se repite\n  for (var i = 0; i < self.iColorInfo.sizes.length; i++) {\n    for (var j = 0; j < sizes.length; j++) {\n      if (self.iColorInfo.sizes[i].name == sizes[j].name) {\n        addToSizes = 0;\n        if (((self.iVisibilityMap[sizes[j].sku] == \"hidden\") || (self.iVisibilityMap[sizes[j].sku] == \"sold_out\") || (self.iVisibilityMap[sizes[j].sku] == \"coming_soon\") || (self.iVisibilityMap[sizes[j].sku] == \"back_soon\")) && (self.iVisibilityMap[self.iColorInfo.sizes[i].sku] != \"sold_out\") && (self.iVisibilityMap[self.iColorInfo.sizes[i].sku] != \"hidden\") && (self.iVisibilityMap[self.iColorInfo.sizes[i].sku] != \"back_soon\") && (self.iVisibilityMap[self.iColorInfo.sizes[i].sku] != \"coming_soon\")) {\n          // Si:\n          //    La talla es repetida\n          //    && la talla que teníamos tiene visibilidad hidden\n          //    && la talla nueva tiene visibilidad distinta de hidden\n          // entonces se substituye\n          sizes[j] = self.iColorInfo.sizes[i];\n        }\n      }\n    }\n    if (addToSizes == 1) {\n      sizes.push(self.iColorInfo.sizes[i]);\n      self.currentColorPrices[self.iColorInfo.sizes[i].sku] = {};\n      self.currentColorPrices[self.iColorInfo.sizes[i].sku].oldPrice = self.iColorInfo.sizes[i].oldPrice;\n      self.currentColorPrices[self.iColorInfo.sizes[i].sku].price = self.iColorInfo.sizes[i].price;\n    }\n    addToSizes = 1;\n  }\n\n  var multiplier = Math.floor(sizes.length / 6);\n\n  /* Se ordenan las tallas segun el cmapo 'position' */\n  sizes = _.sortBy(sizes, 'position');\n\n  $(\"#\" + self.iContainer + \" #size_name\").text(Inditex.text(\"size\"));\n  var notify_legend = false;\n\n  for (var i = 0; i < sizes.length; i++) {\n    span = $(\"<span></span>\");\n    span.attr('data-id', sizes[i].mastersSizeId);\n    var spanTxt = sizes[i].name;\n\n    span.html(spanTxt);\n\n    var li = $(\"<li></li>\");\n    li.attr(\"id\", sizes[i].name.replace(/ /g, \"\").replace(/\\(/g, \"\").replace(/\\)/g, \"\").replace(/\\//g, \"-\"));\n    li.attr(\"alt\", sizes[i].sku);\n    li.append(span);\n    if (i % 6 == 0 && i != 0 && (self.iContainer == \"mainContent\")) {\n      sizesList.append($(\"<li>\").addClass(\"dotted\"));\n    }\n\n    if ((self.iVisibilityMap[sizes[i].sku] != \"show\") && (self.iVisibilityMap[sizes[i].sku] != \"in_stock\")) {\n      // Si no está disponible\n\n      if ((self.iAvailabilityMap[sizes[i].sku] == \"back_soon\") || (self.iAvailabilityMap[sizes[i].sku] == \"coming_soon\")) {\n        li.append(self.backSoonSign(sizes[i].sku, 'notifyBackSoon'));\n        notify_legend = true;\n      }\n\n      li.addClass(\"disabled\").bind(Inditex.iXBindType, function (event) {\n\n        self._showAvailabilityLabel($(this).attr('alt'));\n        //Cambiamos el estado de la animacion para parar la animación del add to cart\n        self.animationState = 1;\n\n        var isButtonAnimated = $('#rel' + self.iProductId + ' .sizes_list').data(\"isButtonAnimated\");\n\n        if (parseInt(isButtonAnimated) != 1) {\n          $(this).siblings().removeClass(\"active\");\n          $(this).addClass(\"active\");\n\n          if (!$(\"#\" + self.iContainer + \" div#addShopCart\").hasClass(\"disponibilityMode\") && !self.isMoving) {\n\n            $(\"#\" + self.iContainer + \" #addShopCart .addButton\").addClass(\"moving\");\n            self.disponibilityCartAnimation();\n\n          } else if (!self.isMoving) {\n\n            self.animationState = 0;\n\n          }\n        }\n        $(\"#\" + self.iContainer + \" div#addShopCart\").removeClass().addClass(\"disponibilityMode\").attr('alt', $(this).attr(\"alt\"));\n\n      });\n\n\n      if (self.iStoreInfo.details.stockNotification) {\n        var legend = $(\"<div></div>\");\n        legend.html(Inditex.text(\"checkVisibility\"));\n        legend.addClass(\"legend\");\n\n        legend.bind(Inditex.iXBindType, function (event) {\n          event.preventDefault();\n          var id = $(this).parents().filter('.custom_form_select').attr('id');\n          Inditex.xCloseCustomSelect(id);\n\n          var sku = $(this).parent().attr('alt');\n\n          var url = Inditex.generateUrl(\"ItxStoreStockPage\", {\n            \"storeId\": Inditex.iStoreId,\n            \"catalogId\": inditex.iCatalogId,\n            \"langId\": Inditex.iLangId\n          });\n\n          var height = 510;\n          if (Inditex.xIsIPad() || Inditex.xIsIPad_5()) {\n            height = 540;\n          }\n          if (self.iContainer == \"mainContent\") {\n            setTimeout(function () {\n              Inditex.popupUrl(url, 910, height, function () {\n                new ItxStoreStockPageClass(self.iProductInfo, self.iColorId, sku);\n                Inditex.xLoadCustomSelect('selectProductSizeOverlay2');\n              });\n            }, 250);\n          } else {\n            setTimeout(function () {\n              Inditex.popupLoadUrl(url, 910, height, function () {\n                new ItxStoreStockPageClass(self.iProductInfo, self.iColorId, sku);\n                Inditex.xLoadCustomSelect('selectProductSizeOverlay2');\n              });\n            }, 250);\n          }\n        });\n\n        li.prepend(legend);\n      }\n    }\n\n    sizesList.append(li);\n  }\n  if (notify_legend) {\n    $('.notify_legend').show();\n  } else {\n    $('.notify_legend').hide();\n  }\n\n  $('#popupContent').off('click.aux03', '#sizes_list li:not(\".disabled\")').on('click.aux03', '#sizes_list li:not(\".disabled\")', function () {\n\n    self._hideSizesInfoAlert();\n\n    $('#rel' + self.iProductId + ' .product_sizes .size_name').html($(this).attr('id'));\n    $('#rel' + self.iProductId + ' .product_sizes').attr('data-name', $(this).attr('id'));\n    $('#rel' + self.iProductId + ' .product_sizes').attr('data-id', $(this).attr('alt'));\n    self._showAvailabilityLabel($(this).attr('alt'));\n\n    if (self.comprando != true) {\n      var isMoving = $('#rel' + self.iProductId + ' .sizes_list').data(\"isButtonAnimated\");\n\n      if (parseInt(isMoving) != 1) {\n        $(this).siblings('li').removeClass('active');\n        $(this).addClass('active');\n        self.globSize = $(this).attr(\"alt\");\n      }\n\n      self._drawBundlePricesPopUp(self, $(this).attr('alt'));\n      self.reAddAnimation();\n\n      $(\"div#popupContent #addShopCart\").removeClass().addClass(\"addMode\").attr(\"rel\", \"active-mode\"); //cambiamos el tipo de boton\n\n      $(this).siblings('li').css('background-color', 'transparent');\n      $(this).css('background-color', '#e4e4e4');\n      // CÃ³digo para popups\n      $('#popupContent .product_sizes').attr('data-name', $(this).attr('id'));\n      $('#popupContent .product_sizes').attr('data-id', $(this).attr('alt'));\n      $('#popupContent').attr('data-id', self.iProductInfo.id);\n    }\n    // Tag manager\n    $.event.trigger({\n      type: 'productPage.selectSize',\n      reference: self.iProductInfo.detail.reference,\n      label: self.iProductInfo.detail.reference + '_' + $(this).find('span').attr('data-id') + '-talla_' + $(this).find('span').attr('data-id'),\n      size: $(this).find('span').attr('data-id')\n    });\n  });\n\n  if (self.iContainer === \"mainContent\") {\n    $('.product_sizes').off('click.aux01', '#sizes_list li:not(\".disabled\")').on('click.aux01', '#sizes_list li:not(\".disabled\")', function () {\n      /* Mostrar disponibilidad de producto seleccionado  */\n      var skuId = $(this).attr('alt');\n      self._showAvailabilityLabel(skuId);\n      self._updatePrice(skuId);\n      if ($('.overlay').css('display') !== 'block') {\n        self.iContainer = 'mainContent';\n      }\n      var isMoving = $('#rel' + self.iProductId + ' .sizes_list').data(\"isButtonAnimated\");\n\n      $('#rel' + self.iProductId + ' .product_sizes').attr('data-name', $(this).attr('id'));\n      $('#rel' + self.iProductId + ' .product_sizes').attr('data-id', $(this).attr('alt'));\n\n      if (($(\"#addShopCart .disabledButton\").attr(\"style\") ? $(\"#addShopCart .disabledButton\").attr(\"style\").match(\"top: 0px\") : false) == \"top: 0px\") {\n\n        self.reAddAnimation();\n\n      }\n      if ($(\"#addShopCart\").hasClass(\"disponibilityMode\")) {\n\n        self.reAddAnimation();\n\n      } else {\n        self._showAvailabilityLabel(skuId);\n\n        if (parseInt(isMoving) != 1) {\n\n          if ($(\"#addShopCart\").attr(\"rel\") == \"disabled-mode\") {\n            if (($(\"#addShopCart .addButton\").attr(\"style\") ? $(\"#addShopCart .addButton\").attr(\"style\").match(\"top: 0px\") : false) == \"top: 0px\") {\n              self.reAddAnimation();\n            }\n          } else {\n            self.reAddAnimation();\n          }\n          /* Se setean las propiedades para el track de colbenson */\n          $(\"#addShopCart\").removeClass().addClass(\"addMode\").attr(\"rel\", \"active-mode\"); //cambiamos el tipo de boton\n        }\n\n      }\n\n      if (parseInt(isMoving) != 1) {\n        $(this).siblings('li').removeClass('active');\n        $(this).addClass('active');\n        $(this).css('background-color', '#e4e4e4');\n        $(this).siblings('li').css('background-color', 'transparent');\n        self.globSize = $(this).attr(\"alt\");\n      };\n\n      // Tag manager\n      $.event.trigger({\n        type: 'productPage.selectSize',\n        reference: self.iProductInfo.detail.reference,\n        label: self.iProductInfo.detail.reference + '_' + $(this).find('span').attr('data-id') + '-talla_' + $(this).find('span').attr('data-id'),\n        size: $(this).find('span').attr('data-id')\n      });\n\n    });\n  }\n};\n</script>\n<!-- FIN FIX ECOMOSYH-4641 --><!-- FIX_ECOMOYSH-4557 -->\n<script>\nItxOrderCheckoutPageClass.prototype._paymentRefreshRequestedBinding = function () {\n  var self = this;\n  $(document).off('paymentRefreshRequested.chk').on('paymentRefreshRequested.chk', function (options) {\n    //console.log('trigger paymentRefreshRequested.chk');\n    var dataPayment = {\n      CODallowed: options.CODallowed,\n      zipCodeAddressSelected: options.zipCode\n    };\n    var dataShipping = {};\n\n    if (!!options.distantSaleContract) dataPayment.distantSaleContract = options.distantSaleContract;\n    if (!!options.shippingPrice) {\n      dataPayment.shippingPrice = dataShipping.shippingPrice = options.shippingPrice;\n    }\n    if (!!options.districtCode) {\n      //console.log('districtCode', options.districtCode);\n      dataPayment.activeDistrictCode = dataShipping.activeDistrictCode = options.districtCode;\n    }\n    if (!!options.zipCode) dataShipping.activeZipCode = options.zipCode;\n\n    // Update payment methods\n    self.payment._update(dataPayment);\n    // Update Shipping methods\n    self.shipping._update(dataShipping);\n  });\n};\n\nItxOrderCheckoutPageClass.prototype._initStep2Cont = function () {\n  var self = this;\n\n  initialize();\n\n  // Initialize step 2\n  function initialize(options) {\n\n    var defaults = {\n      billingAddress: null,\n      CODallowed: true,\n      zipCode: function () {\n        if (self.isRegistered) {\n          if (inditex.iUserAddressBook.addresses.length) {\n            var address = _.findWhere(inditex.iUserAddressBook.addresses, {\n              id: inditex.iXShopCart.shipping.shippingData.addressId\n            });\n            if (address) {\n              return address.zipCode;\n            }\n            return inditex.iUserAddressBook.addresses[0].zipCode;\n          }\n        }\n        return '';\n      }(),\n      activeDistrictCode: (self.isRegistered && inditex.iUserAddressBook.addresses.length && inditex.iStoreJSON.details.enableDistrict) ? inditex.iUserAddressBook.addresses[0].colony.split('#')[0] : null\n    };\n\n    options = $.extend(defaults, options);\n\n    self.isCompany = (self.isRegistered) ? inditex.iUserJSON.isCompany : false;\n    $('#isCompany').val(self.isCompany);\n    // Show step 2\n    self.showStep(2);\n\n    // New shopCart\n    self.renderShopCart();\n    self.bindShopCart();\n    self.shopCart = new ItxShopCartPageClass();\n\n    // passByShopCart == true; indica que ha pasado por la cesta\n    var passByShopCart = window.sessionStorage.getItem('passByShopCart');\n\n    // seccion \"codigo promocional\" configurable por variable\n    // si passByShopCart == true, no se mostrara la seccion\n    if (Inditex.iStoreJSON.details.showPromoCodeFormCheckout && !passByShopCart) {\n      self.shopCart.loadPromotionCode('#Chk_FinalPay_Promos');\n      self.shopCart.addPromoCodeBinding();\n    }\n    // el siguiente evento instancia el TagManager\n    $.event.trigger({\n      type: 'orderCheckoutPage.loadShopCart'\n    });\n\n    // si passByShopCart == true, no se mostrara el PackingGift\n    if (!passByShopCart) {\n      self.shopCart.loadPackingGift();\n      self.shopCart.openPackingGiftBinding();\n      self._packingGiftRefreshBind();\n    }\n    window.sessionStorage.removeItem('passByShopCart');\n\n    self.shopCart.deletePromoCodeBinding();\n    self.setProductsNumberTitle();\n\n    // New PaymentPage (wait until shipping y loaded)\n    $(document).off('shippingPageLoaded.chk').on('shippingPageLoaded.chk', function (options2) {\n      var opt = $.extend(options, options2);\n      //console.log('shippingPageLoaded.chk', opt);\n      self.payment = new ItxPaymentPageClass({\n        isRegistered: self.isRegistered,\n        isWalletUser: inditex.iUserJSON.isWalletUser,\n        showGiftCards: true,\n        billingAddress: opt.billingAddress,\n        shippingPrice: opt.shippingPrice,\n        CODallowed: opt.CODallowed,\n        zipCodeAddressSelected: options.zipCode,\n        activeDistrictCode: opt.activeDistrictCode\n      });\n      self.payment._init();\n    });\n\n    var shipOpt = {\n      isRegistered: self.isRegistered,\n      isCompany: self.isCompany,\n      activeZipCode: options.zipCode,\n      activeDistrictCode: options.activeDistrictCode,\n      isWalletUser: inditex.iUserJSON.isWalletUser,\n      address: inditex.iUserJSON.isWalletUser ? {\n        id: inditex.iUserJSON.primaryAddressId\n      } : options.billingAddress\n    };\n    if (inditex.iStoreJSON.details.enableDistrict) {\n      shipOpt.activeDistrictCode = options.activeDistrictCode;\n    } else {\n      shipOpt.activeZipCode = options.zipCode;\n    }\n\n    // New Shipping Page\n    self.shipping = new ItxShippingPage(shipOpt);\n    self.shipping._init();\n\n    self.setScrollBinding();\n  }\n};\n\nItxPaymentPageClass.prototype._validacionsPayment = function (pMethod) {\n  var self = this,\n    retorno = true;\n\n  if (pMethod.kind != \"gift_card\" || !self.isBuyingAGiftCard()) {\n    retorno = true;\n  } else retorno = false;\n\n  var kindSelected = self.shippingKindSelected ? self.shippingKindSelected : inditex.activeShippingMethod ? inditex.activeShippingMethod.kind : '';\n  if (retorno && (['cod', 'pod'].indexOf(pMethod.kind.toLowerCase()) >= 0) && kindSelected) {\n    // :: Payment-cod/POD esta configurado para los siguientes paises\n    // - Spain solo permite payment-cod con envio a tienda (pickup)\n    // - Rusia y Spain son los unicos con payment-cod con envio a tienda (pickup)\n    // - Rusia tiene también payment-cod con envio a domicilio (delivery)\n    // - China solo tiene payment-cod con envio a domicilio (delivery)\n    retorno = self._validateShippingMethodsWithCODenabled(kindSelected);\n    if (retorno) {\n      //if ((kindSelected == 'pickup' && (self.isRusia || self.isSpain)) || (kindSelected == 'delivery' && (self.isRusia || self.isChina))) {\n      retorno = self._validateUsersWithCODenabled();\n      if (kindSelected == 'pickup' && retorno) {\n        //\n        //console.log('_validatePickupForPaymentCOD');\n        retorno = self._validatePickupForPaymentCOD();\n        //\n      } else if (kindSelected == 'delivery' && retorno) {\n        //\n        //console.log('_validateDeliveryForPaymentCOD');\n        retorno = self._validateDeliveryForPaymentCOD();\n        //\n      } else if (kindSelected == 'droppoint') {\n        //\n        retorno = true;\n        //\n      }\n    } else {\n      retorno = false;\n    }\n  }\n  //console.groupEnd();\n  return retorno;\n};\n\nItxPaymentPageClass.prototype._validateDeliveryForPaymentCOD = function () {\n  var self = this,\n    retorno = true;\n  zipCodeOrDistrict = (inditex.iStoreJSON.details.enableDistrict) ? (self.activeDistrictCode ? self.activeDistrictCode : null) : (self.zipCodeAddressSelected ? self.zipCodeAddressSelected : null);\n  if (zipCodeOrDistrict) {\n    //console.log('zipCodeOrDistrict: ' + zipCodeOrDistrict);\n    retorno = inditex.iXIsZipCodeValidForShipping(zipCodeOrDistrict, true);\n  }\n  return retorno;\n};\n</script>\n<!-- END FIX_ECOMOYSH-4557 -->\n<!-- FIX ECOMOYSH-4627 -->\n<script>\n/* Dibujar breadcrumb para pedido tipo delivery */\nItxMyAccountOrderDetailPageClass.prototype._drawDeliveryBreadcrumb = function () {\n  var self = this,\n    orderStatus = self.pedido.status;\n  /* Insertar estado de pedido */\n  /* Si el pedido es tipo DELIVERY breadcrumb de 3 estados, si el pedido es PICKUP o DROPPOINT breadcrumb de 4 estados */\n  var elementoBreadCrumb = self.pedido.shipping.kind == 'delivery' ? $('.orderStatus.threeSteps .first-row') : $('.orderStatus.fourSteps .first-row');\n\n  var arrayElements;\n  if (self.pedido.shipping.kind == 'delivery') {\n\tarrayElements = [elementoBreadCrumb.find('.realizado'),\n\t\telementoBreadCrumb.find('.transito'),\n        elementoBreadCrumb.find('.entregado')];\n  } else {                \n\tarrayElements = [elementoBreadCrumb.find('.realizado'),\n\t\telementoBreadCrumb.find('.transito'),\n\t\telementoBreadCrumb.find('.puntoRecogida'),\n\t\telementoBreadCrumb.find('.entregado')];\n  }\n\n  if (self.pedido.shipping.kind == 'pickup') {\n    elementoBreadCrumb.find('.tienda').removeClass('hidden');\n    elementoBreadCrumb.find('.droppoint').addClass('hidden');\n  }\n\n  if (self.pedido.deliveryDate) {\n    $('.deliveryDate').html(Inditex.xFormatDate(self.pedido.deliveryDate));\n  } else {\n    $('.deliveryDate').hide();\n    $('.deliveryDate').parent().hide();\n  }\n\n\n  if (inditex.orderTransit.indexOf(orderStatus) != -1) {\n    self.setOrderTransit(arrayElements);\n  } else if (inditex.orderDeliveredPoint.indexOf(orderStatus) != -1) {\n    self.setOrderDropPoint(arrayElements);\n  } else if (inditex.orderDelivered.indexOf(orderStatus) != -1) {\n    self.setOrderDelivered(arrayElements);\n  }\n  elementoBreadCrumb.parent().parent('table').removeClass('hide');\n}\n\n\nItxMyAccountOrderDetailPageClass.prototype._drawTrackingDetails = function () {\n  var self = this,\n    listElements = $('.trackingDetails ul'),\n    trackingNum = Object.keys(self.pedido.orderTracking)[0],\n    trackingInfo = self.pedido.orderTracking[trackingNum];\n\n  if (trackingInfo != undefined || trackingInfo.fechaEstimada != NaN) {\n    $('.trackingDetails').addClass('active');\n    $('.trackingDetails .trackingImg').attr('src', inditex.getDynamicResourceUrl(inditex.iStoreJSON, '/images/transito1.png'));\n    $('.orderStatus .deliveryDate').html(Inditex.xFormatDate(trackingInfo.fechaEstimada))\n\n    _.each(trackingInfo.statusTracking, function (statusTracking) {\n      var trackingDate = Inditex.xFormatDate(statusTracking.fechaActualizacion)\n      var trackingTime = statusTracking.fechaActualizacion.split(' ')[1].substring(0, 5);\n\n      var trackingSubStatus = statusTracking.subStatus;\n      var trackingDescription = self.orderTrackingStatus[trackingSubStatus];\n\n      var trackingDateTime = $('<span>').html(trackingDate + ' - ' + trackingTime + 'h' + '  ' + Inditex.text(trackingDescription).toLowerCase())\n      var listElement = $('<li>').append(trackingDateTime)\n      listElements.append(listElement)\n    })\n\n    $('.trackingFooter .trackingHere').attr('href', trackingInfo.urlTracking);\n    $('.orderStatus .deliveryDate').show()\n    $('.orderStatus .deliveryDate').closest('td').show()\n\n  }\n}\n\nItxMyAccountOrderDetailPageClass.prototype.setOrderDelivered = function (arrayElements) {\n  var self = this;\n  self.setOrderStatus(arrayElements[0], 'orderDone', false);\n  self.setOrderStatus(arrayElements[1], 'orderTransitDone', false);\n\n  if (self.pedido.shipping.kind != 'delivery' && arrayElements[2].length == 1) {\n    self.setOrderStatus(arrayElements[2], 'orderStoreDone', false);\n  } else {\n\tself.setOrderStatus(arrayElements[2], 'orderDeliveredDone', true)\n  }\n\n  if ( self.pedido.shipping.kind != 'delivery' && arrayElements[3].length == 1) {\n\tself.setOrderStatus(arrayElements[3], 'orderDeliveredDone', true)\n  }\n}\n\n</script>\n<!-- FIN FIX ECOMOYSH-4627 --><!-- FIX_ECOMOYSH-4669 -->\n<script>\nItxProductPageClass.prototype._getProdImgUrlsMain = function () {\n\n  var self = this;\n  var result = [];\n  var imagen = self.iColorInfo.image;\n  var imageIndex = 3;\n  var status = self.isBundleSpecial ? self.iProductInfo.bundleProductSummaries[0].detail.colors[0].image.type : self.iProductInfo.detail.colors[0].image.type;\n  var style = null;\n  if (imagen.style && imagen.style[0]) {\n    style = imagen.style[0];\n  }\n  var urls = Inditex.getProductImageUrls(imagen, 1, imageIndex, null, style);\n  var urls2 = Inditex.getProductImageUrls(imagen, 2, imageIndex, null, style);\n  //var url5 = Inditex.getProductImageUrls(imagen, 5, imageIndex, null, style);\n  var url6 = Inditex.getProductImageUrls(imagen, 6, imageIndex, null, style);\n  self.iProdImgUrls[0] = inditex.xGetImagesArray(status, urls2, urls, null, url6[0]);\n};\n\nItxProductPageClass.prototype._getProdImgUrlsZoom = function () {\n\n  var self = this;\n\n  var result = [];\n  var imagen = self.isBundle ? self.iProductInfo.image : self.iColorInfo.image;\n\n  // Imagen principal\n  var status = self.isBundleSpecial ? self.iProductInfo.bundleProductSummaries[0].detail.colors[0].image.type : self.iProductInfo.detail.colors[0].image.type;\n  var urls = Inditex.getProductImageUrls(imagen, 1, 1);\n  var urls2 = Inditex.getProductImageUrls(imagen, 2, 1);\n  //var url5 = Inditex.getProductImageUrls(imagen, 5, 1);\n  var url6 = Inditex.getProductImageUrls(imagen, 6, 1);\n\n  self.iProdImgUrls[2] = inditex.xGetImagesArray(status, urls2, urls, null, url6[0]);\n\n};\n</script>\n<!-- FIN FIX_ECOMOYSH-4669 --><!-- FIX_ECOMOYSH-4674 -->\n<script>\nGiftCardHandlerClass.prototype._updateGiftCard = function (options, isDelete) {\n  var self = this,\n    totBalance = 0,\n    arrBalances = _.pluck(self.savedCards, 'balance');\n\n  if (inditex.iXIsWalletUser) {\n    if (isDelete) {\n      $.event.trigger({\n        type: 'payment.deleteGiftCardInformationWallet',\n        card: options\n      });\n    } else {\n      $.event.trigger({\n        type: 'payment.addGiftCardInformationWallet',\n        options: options\n      });\n    }\n  } else {\n    $.event.trigger({\n      type: \"payment.addGiftCardInformation\",\n      origin: \"ItxOrderCheckoutPageClass\",\n      savedCards: self.savedCards\n    });\n\n    $.each(arrBalances, function (index, item) {\n      totBalance += parseInt(item);\n    });\n    if (Inditex.iXShopCart.totalOrder > totBalance) {\n      $.event.trigger({\n        type: 'payment.loadDefaultPaymentMethod'\n      });\n    }\n  }\n};\n</script>\n<!-- END FIX_ECOMOYSH-4674 -->\n<!-- FIX_ECOMOYSH-4675 -->\n<script>\nItxMyAccountRequestReturnPageClass.prototype._bindings = function () {\n\n  var self = this;\n\n  Inditex.xLoadCustomSelect(\"iAddressCollectionForm #selectProvince\", null, function (elementSelected) {\n    $(\"#iAddressCollectionForm #iStateSelect\").val(elementSelected.attr(\"id\"));\n    // Es necesario validar el campo manualmente para que desaparezca el error\n    $(\"#iAddressCollectionForm #iStateSelect\").validationEngine('validate');\n  });\n\n  // -- recarga la página\n  $('#gobackbuttonFirstStep, #drop_point_request_end').unbind().bind(Inditex.iXBindType, function (e) {\n    e.preventDefault();\n    self._dropPointReturn = false;\n    Inditex.iXObjMenu.loadMyAccountSection('RequestReturn');\n  });\n\n  // -- volver al listado de pedidos\n  $('#gobackbuttonStep2').unbind().bind(Inditex.iXBindType, function (e) {\n    // -- pedido actual que se está devolviendo, se hace un copia de él\n    self.orderTransaction = undefined;\n    // -- identificadores de los items seleccionados\n    self.orderItemsIdSelected = [];\n    self.goToStep(2);\n\n  });\n\n  // -- ir al listado de items del pedido\n  $(document).off(Inditex.iXBindType, 'a[id^=return_order_]').on(Inditex.iXBindType, 'a[id^=return_order_]', function (e) {\n    var idCompose = e.target.id;\n    var orderItemId = idCompose.split('_')[2];\n\n    // -- creación de una copia del pedido seleccionado\n    self.orderTransaction = JSON.parse(JSON.stringify($(e.target).data('order')));\n    self._renderOrderItems(orderItemId);\n\n    self.goToStep(3);\n\n    // Tag manager\n    $.event.trigger({\n      type: 'tagManager.setGenericAction',\n      cf: 'perfil_usuario',\n      category: 'devoluciones',\n      action: 'seleccionar_pedido',\n      label: orderItemId\n    });\n\n    // Tag manager\n    $.event.trigger({\n      type: 'userAccount.setPageView',\n      pageType: 'devoluciones',\n      pageTitle: 'lista_articulos',\n      extraParamsUser: true,\n      customData: {\n        dimension20: undefined,\n        dimension50: undefined,\n        dimension57: undefined\n      }\n    });\n\n  });\n\n  // -- volver al listado de presentación de los items de los pedidos\n  $('#gobackbuttonStep3').unbind().bind(Inditex.iXBindType, function (e) {\n    $(\".formError\").remove(); // -- eliminación de los mensajes de validación de error\n    $('label.AccRR_zip_lbl').removeAttr('style'); //-- eliminacion de los estilos inline\n    self.goToStep(3);\n  });\n\n  // -- volver al listado de pedir la dirección\n  $('#gobackbuttonStep4').unbind().bind(Inditex.iXBindType, function (e) {\n    if (self.showChargeForm) {\n      self.goToStep(7);\n    } else {\n      if (self._storeReturn == true) {\n        self.goToStep(3);\n      } else {\n        self.goToStep(4);\n      }\n    }\n\n  });\n\n  // -- volver al listado de pedir la dirección\n  $('#gobackbuttonStep4bis').unbind().bind(Inditex.iXBindType, function (e) {\n    self.goToStep(4);\n  });\n\n  $('#requestReturn').unbind().bind(Inditex.iXBindType, function (e) {\n    e.preventDefault();\n    self._dropPointReturn = false;\n    $('#requestReturnFirstStep').hide();\n    $('#requestReturnSteps .homeReturn').show();\n    $('#requestReturnSteps .storeReturn').hide();\n    self._storeReturn = false;\n    self._renderListOrders('delivery');\n    // Tag manager\n    $.event.trigger({\n      type: 'tagManager.setGenericAction',\n      cf: 'perfil_usuario',\n      category: 'devoluciones',\n      action: 'solicitar_recogida',\n      label: ''\n    });\n  });\n\n  $('#requestStore').unbind().bind(Inditex.iXBindType, function (e) {\n    e.preventDefault();\n    self._dropPointReturn = false;\n    $('#requestReturnFirstStep').hide();\n    $('#requestReturnSteps .homeReturn').hide();\n    $('#requestReturnSteps .storeReturn').show();\n    self._storeReturn = true;\n    self._renderListOrders();\n  });\n\n  $('#locateStoresButton').unbind().bind(Inditex.iXBindType, function (e) {\n    e.preventDefault();\n\n    var url = inditex.getGenericUrl('ItxMyAccountStoresLocatorPage');\n    if (!inditex.iXMyAccountMap) {\n      inditex.xGetUrlContent(url).done(function (atext) {\n        $('#account_content').html(atext);\n        inditex.iXMyAccountMapInstance = new ItxMyAccountStoresLocatorPageClass('RequestReturn');\n      }).Catch(function (aStatus) {\n        Inditex.xOpenErrorPopUp(350, 200);\n      });\n    } else {\n      $('#account_content').html(inditex.iXMyAccountMap);\n      inditex.iXMyAccountMapInstance._binding(true);\n    }\n    // Tag manager\n    $.event.trigger({\n      type: 'tagManager.setGenericAction',\n      cf: 'localizador_tiendas',\n      category: 'devoluciones',\n      action: 'localizar_tienda',\n      label: ''\n    });\n  });\n\n  $('#gonextbutton1').unbind().bind(Inditex.iXBindType, function () {\n    // -- se guarda la información de los items seleccionados para devolver\n    // -- y se va a la siguiente página para introducir la dirección de envío\n    var result = self._submitSelectionOrderReturn();\n\n    if (result == true) {\n      if (self._storeReturn && !self._dropPointReturn) {\n        var result = self._submitAddressCollection(\"step5\");\n        if (self.isOfType('COD') && self.orderTransaction.shipping.kind == 'delivery') {\n          self.showChargeForm = true;\n          $(\"#CODForm #phoneCountryCodeCOD\").val(self.iStoreInfo.details.phoneCountryCode);\n          $(\"#CODForm #custmOrdNum\").val(self.orderTransaction.id);\n\n          var importe = 0;\n\n          if (self.orderSelected && self.orderSelected.items != null) {\n            $.each(self.orderTransaction.returnItem, function (index, item) {\n              var id = item.skuId;\n              var unitsReturn = item.quantityReturn;\n              $.each(self.orderSelected.items, function (index, orderItem) {\n                if (orderItem.sku == id) {\n                  importe += orderItem.unitPrice * unitsReturn;\n                }\n              });\n            });\n          }\n\n\n          if (importe != 0) {\n            $(\"#CODForm #importe\").val($('<div></div>').html(Inditex.formatPrice(importe)).text());\n          }\n\n          self.goToStep(7);\n        } else {\n          if (result == true) {\n            self.goToStep(5);\n          } else {\n            return result;\n          }\n        }\n        if (self.isOfType('POD')) {\n          $(\"#bankInfoReturn\").removeClass('hide');\n\n        } else {\n          $(\"#bankInfoReturn\").addClass('hide');\n          $(\"#bankInfoReturn\").remove();\n        }\n\n\n        $('.devStoreHide').attr('style', 'display: none;');\n        self.goToStep(5);\n\n      } else if (self._dropPointReturn) {\n        $(\"#boxNumberDropoff\").validationEngine('validate');\n        $('#confirmButton').trigger('click');\n      } else {\n\n        self._populateFormAddress();\n\n        if (self.isOfType('POD')) {\n          $(\"#bankInfoReturn\").removeClass('hide');\n\n        } else {\n          $(\"#bankInfoReturn\").addClass('hide');\n          $(\"#bankInfoReturn\").remove();\n        }\n\n        self.goToStep(4);\n      }\n\n      // Tag manager\n      $.event.trigger({\n        type: 'userAccount.setPageView',\n        pageType: 'devoluciones',\n        pageTitle: 'direccion_recogida',\n        extraParamsUser: true\n      });\n\n      $.event.trigger({\n        type: 'tagManager.loadFormValidation',\n        cf: 'perfil_usuario',\n        formName: 'iAddressCollectionForm',\n        inputs: $('#iAddressCollectionForm input[type=text]'),\n        category: 'devoluciones_direccion_recogida'\n      });\n    }\n\n\n  });\n\n  $('#gonextbutton2').unbind().bind(Inditex.iXBindType, function () {\n    // -- se guarda la informaci�n de la direcci�n de env�o\n    // -- se redirige a la direcci�n de confirmaci�n o datos de cobro\n    var result = self._submitAddressCollection(\"step5\");\n    if (self.isOfType('COD') && self.orderTransaction.shipping.kind == 'delivery') {\n      self.showChargeForm = true;\n      $(\"#CODForm #phoneCountryCodeCOD\").val(self.iStoreInfo.details.phoneCountryCode);\n      $(\"#CODForm #custmOrdNum\").val(self.orderTransaction.id);\n\n      var importe = 0;\n\n      if (self.orderSelected && self.orderSelected.items != null) {\n        $.each(self.orderTransaction.returnItem, function (index, item) {\n          var id = item.skuId;\n          var unitsReturn = item.quantityReturn;\n          $.each(self.orderSelected.items, function (index, orderItem) {\n            if (orderItem.sku == id) {\n              importe += orderItem.unitPrice * unitsReturn;\n            }\n          });\n        });\n      }\n\n\n      if (importe != 0) {\n        $(\"#CODForm #importe\").val($('<div></div>').html(Inditex.formatPrice(importe)).text());\n      }\n\n      if (result == true) {\n        self.goToStep(7);\n      } else {\n        return result;\n      }\n    } else {\n      if (result == true) {\n        self.goToStep(5);\n      } else {\n        return result;\n      }\n    }\n    if (self.isChina && self.isOfType('POD')) {\n      $(\"#bankInfoReturn\").removeClass('hide');\n      $('#bankName').autocomplete({\n        appendTo: \".bank-suggestions\",\n        source: function (request, response) {\n          var encoding = 'zh_CN'; // Debería ser inditex.iLocale pero solo está configurado para zh_CN\n          var url = self.searchUrl.replace(/\\$1/g, encoding).replace(/\\*/g, '\"').replace('$2', request.term.toUpperCase()) + '&rows=50';\n          $.ajax({\n            url: url,\n            dataType: \"json\",\n            success: function (data) {\n                var banks = [];\n                if (data.response.numFound > 0) {\n                  banks = data.response.docs.map(function (bank) {\n                    return {\n                      label: bank['name_' + encoding].replace(/_/g, ' ').trim(),\n                      value: bank.bankCode\n                    };\n                  });\n                }\n                response(banks);\n              } //,\n              //jsonp: \"jsonCallback\"\n          });\n        },\n        focus: function (event, ui) {\n          $(\"#bankName\").val(ui.item.label);\n          return false;\n        },\n        select: function (event, ui) {\n          $(\"#bankName\").val(ui.item.label);\n          $('input[name=bankCode]').val(ui.item.value);\n\n          return false;\n        }\n      });\n\n\n    } else {\n      $(\"#bankInfoReturn\").addClass('hide');\n      $(\"#bankInfoReturn\").remove();\n    }\n\n    // Tag manager\n    $.event.trigger({\n      type: 'userAccount.setPageView',\n      pageType: 'devoluciones',\n      pageTitle: 'confirmacion',\n      extraParamsUser: true,\n      'customData': {\n        'dimension50': $('div [id^=\"returnReason_\"] .custom_form_select_name').text(),\n        'dimension57': '<Tipo de devolución>'\n      }\n    });\n\n  });\n\n  $('#iAddressCollectionForm').submit(function () {\n    // -- se guarda la información de la dirección de envío\n    // -- se redirige a la dirección de conformación\n    var result = self._submitAddressCollection(\"step5\");\n    if (!result) {\n      return result;\n    }\n    var isCashPayment = (self.isRussia && self.isOfType('COD')) ||\n      (self.isChina && self.isOfType('POD'));\n\n    if (self.orderTransaction.payment != null && self.orderTransaction.payment.length > 0 && isCashPayment && self.orderTransaction.shipping.kind == 'delivery') {\n      self.showChargeForm = true;\n      $(\"#CODForm #phoneCountryCodeCOD\").val(self.iStoreInfo.details.phoneCountryCode);\n      $(\"#CODForm #custmOrdNum\").val(self.orderTransaction.id);\n\n      var importe = 0;\n\n      if (self.orderSelected && self.orderSelected.items != null) {\n        $.each(self.orderTransaction.returnItem, function (index, item) {\n          var id = item.skuId;\n          var unitsReturn = item.quantityReturn;\n          $.each(self.orderSelected.items, function (index, orderItem) {\n            if (orderItem.sku == id) {\n              importe += orderItem.unitPrice * unitsReturn;\n            }\n          });\n        });\n      }\n\n      if (importe != 0) {\n        $(\"#CODForm #importe\").val($('<div></div>').html(Inditex.formatPrice(importe)).text());\n      }\n\n      self.goToStep(7);\n    } else {\n      if (result == true) {\n        self.goToStep(5);\n      } else {\n        return result;\n      }\n    }\n    return false;\n  });\n\n  $('#gonextbutton3').unbind().bind(Inditex.iXBindType, function () {\n    // -- se guarda la información de la dirección de envío\n    // -- se redirige a la dirección de conformación\n    var result = self._submitChargeCod();\n\n    if (result == true) {\n      self.goToStep(5);\n    } else {\n      return result;\n    }\n  });\n\n  $('#confirmButton').unbind().bind(Inditex.iXBindType, function () {\n    if (!self._dropPointReturn) {\n      self._renderDetailReturn(\"step6\");\n\n\n\n      /*********************************************************************************\n       * EN ESTE PUNTO SE TIENE TODO LA INFORMACIÓN EN LA VARIABLE self.orderTransaction\n       * ES UN JSON CON LA MISMA ESTRUCTURA QUE UN ITEM DEL ORDER-LIST.JSON. y al que se\n       * le ha añadido la nueva información que se ha indicado a lo largo del proceso\n       *********************************************************************************/\n\n      var returnData = {};\n\n      if (self.isChina) {\n        var result = self._submitBankInfo(\"step6\");\n        if (result == false) {\n          return;\n        }\n      }\n\n      //address\n      var address = {};\n      address[\"firstName\"] = self.orderTransaction.address.firstName;\n      address[\"lastName\"] = self.orderTransaction.address.lastName;\n      var addressLines = [];\n      $.each(self.orderTransaction.address.addressLines, function (indexItem, item) {\n        addressLines.push(item);\n      });\n      address[\"addressLines\"] = addressLines;\n      address[\"city\"] = self.orderTransaction.address.city;\n      address[\"stateCode\"] = self.orderTransaction.address.stateCode;\n      address[\"countryCode\"] = Inditex.iStoreJSON.countryCode;\n      address[\"zipCode\"] = self.orderTransaction.address.zipCode;\n      var phones = [];\n      $.each(self.orderTransaction.address.phones, function (indexItem, item) {\n        var phones_1 = {};\n        phones_1[\"countryCode\"] = item.countryCode;\n        phones_1[\"subscriberNumber\"] = item.subscriberNumber;\n        phones.push(phones_1);\n      });\n      address[\"phones\"] = phones;\n      if (Inditex.isPatronymic()) {\n        address[\"middleName\"] = self.orderTransaction.address.middleName;\n      }\n      if (Inditex.iStoreJSON.countryCode == \"MX\") {\n        address[\"colony\"] = $(\"#colony\").val();\n        address[\"municipality\"] = $(\"#municipality\").val();\n      }\n      if (self.isChina || self.isTurkey) {\n        address[\"colony\"] = self.orderTransaction.address.colony;\n        address[\"municipality\"] = self.orderTransaction.address.municipality;\n      }\n      address['isCompany'] = false;\n      address['company'] = null;\n      address['gender'] = '';\n      returnData[\"address\"] = address;\n\n\n      //returnLines\n      var returnLines = [];\n      $.each(self.orderTransaction.returnItem, function (indexItem, item) {\n        var returnLine = {};\n        returnLine[\"catentryId\"] = parseInt(item.skuId);\n        returnLine[\"quantity\"] = parseInt(item.quantityReturn);\n        returnLine[\"returnReasonId\"] = parseInt(item.reason.id);\n        returnLine[\"comment\"] = item.reason.comment;\n        returnLines.push(returnLine);\n      });\n      returnData[\"returnLines\"] = returnLines;\n\n      //returnReason\n      returnData[\"returnReason\"] = \"\";\n      returnData[\"isStoreReturn\"] = 0;\n\n      //numBobxes\n      returnData[\"numBoxes\"] = parseInt($(\"#iAddressCollectionForm #boxNumber\").val());\n\n      //cashReturnForm\n      var cashReturnForm = {};\n      var returnMethodForm = {};\n      if (self.isChina) {\n\n        if (self.orderTransaction.bankInfo && self.orderTransaction.bankInfo.firstNameCOD && self.orderTransaction.bankInfo.bankCOD && self.orderTransaction.bankInfo.bankNumCOD) {\n          cashReturnForm[\"associatedPaymentMethod\"] = \"1\";\n          cashReturnForm[\"firstName\"] = self.orderTransaction.bankInfo.firstNameCOD;\n          returnMethodForm[\"bankName\"] = self.orderTransaction.bankInfo.bankCOD;\n          returnMethodForm[\"accountNumber\"] = self.orderTransaction.bankInfo.bankNumCOD;\n          cashReturnForm['returnMethodForm'] = returnMethodForm;\n          returnData[\"cashReturnForm\"] = cashReturnForm;\n        }\n      }\n\n      //Si se mostro el formulario de datos de cobro\n      if (self.showChargeForm) {\n\n        // En la variable self.CODFormData se almacenan los parametros\n        //introducidos en el formulario de datos de cobro.\n        //Para ver las variables disponibles consultar el metodo _submitChargeCod()\n        var paramsCharge = self.CODFormData;\n        if (self.isBankWire) {\n          cashReturnForm[\"associatedPaymentMethod\"] = \"1\";\n          cashReturnForm[\"firstName\"] = $(\"#nameCOD\").val();\n          cashReturnForm[\"middleName\"] = $(\"#segundodoNombreCOD\").val();\n          cashReturnForm[\"lastName\"] = $(\"#lastNameCOD\").val();\n\n          returnMethodForm[\"bankName\"] = $(\"#bankName\").val();\n          returnMethodForm[\"accountNumber\"] = $(\"#accountNumber\").val();\n          returnMethodForm[\"bicCode\"] = $(\"#bicCode\").val();\n          returnMethodForm[\"innCode\"] = $(\"#innCode\").val();\n          cashReturnForm[\"returnMethodForm\"] = returnMethodForm;\n\n        } else {\n          //TODO Recoger datos de giro postal y procesarlos\n          cashReturnForm[\"associatedPaymentMethod\"] = \"2\";\n          cashReturnForm[\"firstName\"] = $(\"#nameCOD\").val();\n          cashReturnForm[\"middleName\"] = $(\"#segundodoNombreCOD\").val();\n          cashReturnForm[\"lastName\"] = $(\"#lastNameCOD\").val();\n\n          returnMethodForm[\"address\"] = $(\"#addressCOD\").val();\n          returnMethodForm[\"zipCode\"] = $(\"#zipCodeCOD\").val();\n          returnMethodForm[\"city\"] = $(\"#cityCOD\").val();\n          returnMethodForm[\"state\"] = $(\"#stateCOD\").val();\n          returnMethodForm[\"country\"] = self.orderTransaction.address.countryCode;\n          returnMethodForm[\"phonePrefix\"] = $(\"#phoneCountryCodeCOD\").val();\n          returnMethodForm[\"phone\"] = $(\"#phoneSubscriberNumberCOD\").val();\n          cashReturnForm[\"returnMethodForm\"] = returnMethodForm;\n        }\n        returnData[\"cashReturnForm\"] = cashReturnForm;\n      }\n\n      inditex.xRestReturnRequest(self.orderSelected.id, returnData).done(function () {\n        self.goToStep(6);\n\n        // Tag manager\n        $.event.trigger({\n          type: 'tagManager.setGenericAction',\n          cf: 'perfil_usuario',\n          category: 'devoluciones_confirmacion',\n          action: 'socitar_recogida_ok',\n          label: ''\n        });\n      }).Catch(function (error) {\n        if (error.errorMessage) Inditex.xOpenErrorPopUp(360, 200, Inditex.text(\"DEFAULT_ERROR_MESSAGE_TITLE\"), error.description);\n        else Inditex.xOpenErrorPopUp(360, 200);\n        // Tag manager\n        $.event.trigger({\n          type: 'userAccount.setServerError',\n          category: 'devoluciones_confirmacion',\n          errorCode: error.code || null,\n          errorMessage: error.errorMessage,\n          formName: 'iAddressCollectionForm'\n        });\n      });\n\n    } else {\n      self.dropPointRequestData();\n    }\n\n\n  });\n\n  Inditex.xBindThisForRadio($(\"#CodType1\"), 'CodType', function () {\n    // giro postal\n    $(\".formError\").remove();\n    $('#bankNameLabel').addClass('hide');\n    $('#innCodeLabel').addClass('hide');\n    $('#accountNumberLabel').addClass('hide');\n    $('#bicCodeLabel').addClass('hide');\n    $('#cityLabel').removeClass('hide');\n    $('#zipCodeLabel').removeClass('hide');\n    $('#phoneNumberLabel').removeClass('hide');\n    $('#addressLabel').removeClass('hide');\n    $('#regionLabel').removeClass('hide');\n    $('.overlay').find('.overlay_content').mCustomScrollbar('update');\n  });\n  Inditex.xBindThisForRadio($(\"#CodType2\"), 'CodType', function () {\n    // transferencia bancaria\n    $(\".formError\").remove();\n    $('#bankNameLabel').removeClass('hide');\n    $('#innCodeLabel').removeClass('hide');\n    $('#accountNumberLabel').removeClass('hide');\n    $('#bicCodeLabel').removeClass('hide');\n    $('#cityLabel').addClass('hide');\n    $('#zipCodeLabel').addClass('hide');\n    $('#phoneNumberLabel').addClass('hide');\n    $('#addressLabel').addClass('hide');\n    $('#regionLabel').addClass('hide');\n    $('.overlay').find('.overlay_content').mCustomScrollbar('update');\n  });\n\n  //A�adir evento de aparici�n de mensaje de Error en el campo de C�digo Postal:\n  $(\"#zipCode\").bind(\"jqv.field.result\", function (event, field, errorFound, prompText) {\n\n    // Objeto jquery del label al que hay que a�adirle la clase para que tenga m�s margen.\n    var label = $(event.target).parent();\n\n    //Llamada a funci�n encargada de moridficar el tama�o del margen.\n    self._inputErrorMargin(label, prompText);\n  });\n\n  Inditex.xLoadCustomSelect(\"iAddressCollectionForm #selectProvince\", null, function (elementSelected) {\n    $(\"#iAddressCollectionForm #iStateSelect\").val(elementSelected.attr(\"id\"));\n    // Es necesario validar el campo manualmente para que desaparezca el error\n    $(\"#iAddressCollectionForm #iStateSelect\").validationEngine('validate');\n    $(\"#iAddressCollectionForm #iStateSelect\").trigger(\"change\");\n  });\n\n  $('#requestDropPoint').off().on('click', function (e) {\n    //console.log('drop1');\n    e.preventDefault();\n    self._storeReturn = false;\n    $('#requestReturnFirstStep').hide();\n    $('#step1').show();\n  });\n\n  $('#drop_point_request').off().on('click', function (e) {\n    //console.log('drop2');\n    e.preventDefault();\n    $('#step1').hide();\n    self._renderListOrders('droppoint');\n    self._dropPointReturn = true;\n  });\n};\n\nItxMyAccountRequestReturnPageClass.prototype._renderListOrders = function (shippingKind) {\n  var self = this;\n  $(\"#myAccountOrderItemsReturn tbody tr\").remove();\n\n  if (self.iOrderListInfo && self.iOrderListInfo.length > 0) {\n    // 1) xConfiguracion SHIPPING_METHODS_RESTRICTED_COD\n    // 2) Continuamos cargando los pedidos; _endRenderListOrders()\n    self._continueRenderListOrders(shippingKind);\n  }\n\n  $('#step2').show();\n\n  // Tag manager\n  $.event.trigger({\n    type: 'userAccount.setPageView',\n    pageType: 'devolucion',\n    pageTitle: 'lista_pedidos',\n    extraParamsUser: true,\n    customData: {\n      dimension20: '',\n      dimension57: ''\n    }\n  });\n};\n\nItxMyAccountRequestReturnPageClass.prototype._continueRenderListOrders = function (shippingKind) {\n  var self = this,\n    datos = [];\n\n  Inditex.getXconfiguracionValue('SHIPPING_METHODS_RESTRICTED_COD', function (data, value) {\n    datos.push({\n      'data': data,\n      'value': value\n    });\n    self._endRenderListOrders(datos, shippingKind);\n  });\n};\n\nItxMyAccountRequestReturnPageClass.prototype._endRenderListOrders = function (pValues, shippingKind) {\n  var self = this;\n  self.shippingMethodsWithCODenabled = pValues[0] ? pValues[0].value : null;\n  // para probar\n  //self.shippingMethodsWithCODenabled = \"delivery|pickup\";\n  var table = $(\"#myAccountOrderItemsReturn\");\n  //console.log('self.allowedReturnStatus', self.allowedReturnStatus);\n  //console.log('self.iOrderListInfo', self.iOrderListInfo);\n  $.each(self.iOrderListInfo, function (index, order) {\n    if (self._isCorrectState(order, shippingKind) == true) {\n      var row = self._renderListOrder(order, Inditex.iStoreJSON.details.showHomeReturnRequest);\n      if (row) {\n        row.appendTo(table);\n      }\n    }\n  });\n};\n\nItxMyAccountRequestReturnPageClass.prototype._isCorrectState = function (order, shippingKind) {\n  var self = this,\n    result = false;\n\n  if (order.status) {\n    if ($.inArray(order.status, self.allowedReturnStatus) != -1) {\n      result = true;\n      //console.log('order status ok', order);\n    }\n    if (result && ['cod', 'pod'].indexOf(order.payment[0].kind.toLowerCase()) < 0) {\n      result = true;\n    } else if (result && shippingKind && self.shippingMethodsWithCODenabled.split('|').indexOf(shippingKind) >= 0) {\n      result = true;\n    } else {\n      result = false;\n    }\n  }\n  return result;\n};\n</script>\n<!-- END FIX_ECOMOYSH-4675 --><!-- FIX ECOMOYSH-4659 -->\n<script>\nItxGiftCardVirtualPageClass.prototype._init = function () {\n\n   var self = this;\n  // El primer número indiica las horas que van a pasar hasta que se active la tarjeta\n   inditex.iTRVMinTime = 2 * 60 * 60 * 1000;\n\n   if (inditex.iUserJSON.identity.userId == -1002) {\n     var actions = [];\n\n\n     actions.push({\n       \"action\": \"user:loginGuest\",\n       \"params\": {\n         \"storeId\": inditex.iStoreId\n       },\n       \"data\": {\n         \"id\": inditex.iStoreId\n       }\n     });\n\n\n     inditex.execute({\n       \"actions\": actions,\n       \"onFinish\": function (status, response) {\n         if (status == 1) {\n           inditex.iUserJSON.identity = response.identity;\n         }\n       }\n     });\n   }\n\n   var msg = inditex.text('gift_card_blocked_message');\n\n   $('.giftcard_page_right').prepend('<p class=\"card_activ_msg\">' + msg + '</p>')\n\n   $.datetimepicker.setLocale(inditex.iLocale.split('_')[0]);\n\n   var d = new Date();\n   var tomorrow = new Date(d.getTime() + inditex.iTRVMinTime);\n\n   $(\"#sendTime\").datetimepicker({\n     datepicker: false,\n     format: 'H:i'\n   }).on('keypress', function () {\n     return false\n   });\n\n   $(\"#sendDate\").datetimepicker({\n     timepicker: false,\n     format: 'd/m/Y',\n     minDate: tomorrow,\n     yearStart: d.getFullYear(),\n     onSelectDate: function (date) {\n\n       $(\"#sendTime\").datetimepicker('reset');\n\n       var eq = date.setHours(0, 0, 0, 0) == tomorrow.setHours(0, 0, 0, 0);\n\n       $(\"#sendTime\").datetimepicker('setOptions', {\n         minTime: eq ? d.getTime() : 1\n       });\n     }\n   }).on('keypress', function () {\n     return false\n   });\n\n   //--- new props ---\n   inditex.iXGiftCardMenu('#iUrlGiftCardVirtualPage');\n   //-----------------\n\n\n   // Obtencion del array de urls de imagenes de la pagina\n   self._getProdImgUrls();\n\n   // Imagen principal\n   self._drawMainImage();\n\n   // Imï¿½genes auxiliares\n   //self._drawAuxImages();\n\n   $('form[name=\"iVirtualGiftCardForm\"]').validationEngine({\n     promptPosition: 'bottomLeft',\n     autoPositionUpdate: true,\n     showOneMessageByField: true,\n     scroll: false,\n     focusFirstField: false\n   });\n\n   $(\"#iVirtualGiftCardForm #phoneCountryCode_0\").val(self.iStoreInfo.details.phoneCountryCode);\n\n   self.rangePrice = self._getRangePrice();\n\n   var maxPrice = 0;\n   self.currentSku = undefined;\n\n   if (self.rangePrice.length > 0) {\n     maxPrice = self.rangePrice.length - 1;\n     self.currentSku = self.rangePrice[0];\n   }\n\n\n   $(\"#slider_horizontal\").slider({\n     orientation: \"horizontal\",\n     range: \"max\",\n     max: maxPrice,\n     min: 0,\n     value: 0,\n     step: 1,\n     slide: function (event, ui) {\n       self.currentSku = self.rangePrice[ui.value];\n       $(\"#slider_amount\").html(inditex.formatPrice(self.currentSku.price));\n       setTimeout(function () {\n         $('#slider_amount').css('left', self.xKnowLeftPosition());\n       }, 25);\n     },\n     start: function (event, ui) {\n       $('#slider_amount').css('left', self.xKnowLeftPosition());\n     },\n     stop: function (event, ui) {\n       $('#slider_amount').css('left', self.xKnowLeftPosition());\n     },\n     change: function (event, ui) {\n       // evento de cambio de un valor a otro\n     },\n     create: function (event, ui) {\n       var price = 0;\n       if (self.currentSku) {\n         price = self.currentSku.price;\n       }\n       $('#slider_amount').css('left', self.xKnowLeftPosition()).html(inditex.formatPrice(price));\n     }\n   }).draggable(); // necesario para touch devices\n\n   // -- mostrar las condiciones de uso\n   $('#use_conditions').bind(inditex.iXBindType, function (e) {\n     e.preventDefault();\n     var url = inditex.generateUrl(\"ItxStandardGiftCardConditionsPage\", {\n       \"storeId\": inditex.iStoreId,\n       \"langId\": inditex.iLangId,\n       \"catalogId\": inditex.iCatalogId\n     }, true);\n     window.open(url, 'condiciones', 'width=600,height=600,scrollbars=yes');\n   });\n\n   // -- mostrar las condiciones de compra\n   $('#buy_conditions').bind(inditex.iXBindType, function (e) {\n     e.preventDefault();\n     inditex.xShowShopGuide(8, false);\n   });\n\n   // -- mostrar las condiciones de uso de la tarjeta regalo\n   $('#use_conditions').bind(inditex.iXBindType, function (e) {\n     e.preventDefault();\n     var url = inditex.generateUrl(\"ItxStandardGiftCardConditionsPage\", {\n       \"storeId\": inditex.iStoreId,\n       \"langId\": inditex.iLangId,\n       \"catalogId\": inditex.iCatalogId\n     }, true);\n     window.open(url, 'condiciones', 'width=600,height=600,scrollbars=yes');\n   });\n\n   // -- aï¿½adir a la cesta\n   $('#addShopCard').bind(inditex.iXBindType, function (e) {\n     e.preventDefault();\n     self._submitForm();\n   });\n\n   // --abrir news letter\n   $('.share_content .share_elements span[rel=email]').unbind().bind(inditex.iXBindType, function (e) {\n     var url = inditex.generateUrl('ItxDetailSendToFriendPage', {}, true);\n     inditex.popupUrl(url, 650, 540, function () {\n       new ItxDetailSendToFriendPageClass();\n     });\n   });\n\n };\n</script>\n<!-- FIN FIX ECOMOYSH-4659 --><!-- FIX_ECOMOYSH-4681 -->\n<script>\nItxCategoryPageClass.prototype._compruebaUnSkuInStock = function (pProducts, pStocks) {\n  var productos = [],\n    nSkuInStock = 0,\n    nTallas = 0,\n    product = null;\n\n  /*Filtra mocacos que no contengan informacion en bundleproductusummaries e imprime caracteristicas demandadas*/\n  jsonProductosMocacosFiltered = _.filter(pProducts, function (item) {\n    return (item.onSpecial && item.type == 'BundleBean') ? item.bundleProductSummaries.length > 0 : item\n  });\n\n  /*Filtra productos que no contengan informacion en detail e imprime caracteristicas demandadas*/\n  jsonProductosFiltered = _.filter(jsonProductosMocacosFiltered, function (item) {\n    return (item.detail.colors && item.detail.colors.length > 0 && item.detail.colors[0].image) || item.type == 'BundleBean'\n  });\n\n  $.each(jsonProductosFiltered, function (productIndex, itemProduct) {\n    product = itemProduct;\n    nTallas = 0;\n    if (itemProduct.type == \"BundleBean\" && itemProduct.onSpecial) {\n      product = itemProduct.bundleProductSummaries[0];\n    }\n    if (product.detail.colors) {\n      if (product.detail.colors.length == 1) {\n        var arrTallas = product.detail.colors[0].sizes;\n        if (arrTallas) {\n          // recogemos el numero de tallas del unico color que tiene el producto\n          nTallas = arrTallas.length;\n          if (nTallas > 1) {\n            // tratamiento para productos\n            for (var t = 1; t < arrTallas.length; t++) {\n              if (arrTallas[t].name == arrTallas[t - 1].name) {\n                nTallas--;\n              }\n            }\n          }\n        } else {\n          nTallas = 0;\n        }\n      } else {\n        // si entra aqui es que tiene 2 tallas o más, ya que tiene más de 1 color\n        nTallas = product.detail.colors.length;\n      }\n    }\n    var objStock = _.findWhere(pStocks, {\n      productId: itemProduct.id\n    });\n\n    if (objStock != null) {\n      for (var i = 0, nSkuInStock = 0; i < objStock.stocks.length; i++) {\n        if (objStock.stocks[i].availability == \"in_stock\") nSkuInStock++;\n      }\n      if (nSkuInStock == 1 && nTallas != 1) {\n        product.idCapaDestino = \"parrillaImagenesOneSkuStock\";\n      } else {\n        product.idCapaDestino = \"parrillaImagenes\";\n      }\n    }\n  });\n};\n</script>\n<!-- FIX_ECOMOYSH-4681 --><!-- BEGIN FIX_ECOMOYSH-4616 -->\n<script>\nItxColbensonConfigurationClass.prototype._getColbensonConfiguration = function() {\n\n\tvar self = this;\n\n\t// Buscamos el entorno en el que nos encontramos\n\tif (self._searchEngine.inditexIns.iIsMobile) {\n\t\tself.colbensonScope = \"mobile\";\n\t} else {\n\t\tself.colbensonScope = \"desktop\";\n\t}\n\n\t// Buscamos el lenguage de la store actual\n\tvar country_lang_id = self._searchEngine.inditexIns.iLangId;\n\tvar numLanguages = self._searchEngine.inditexIns.iStoreJSON.supportedLanguages.length;\n\n\tfor (var i = numLanguages - 1; i >= 0; i--) {\n\t\tif(self._searchEngine.inditexIns.iStoreJSON.supportedLanguages[i].id == country_lang_id){\n\t\t\tself.colbensonLang = self._searchEngine.inditexIns.iStoreJSON.supportedLanguages[i].code.toLowerCase();\n\t\t}\n\t}\n\n\tif (self._searchEngine.inditexIns.iIsMockup) {\n\t\t// Entorno de pruebas en la maqueta\n\n\t\t// Buscamos el ID de la Store Actual\n\t\tself.colbensonStore = self.colbensonMockupConfiguration.colbensonStore;\n\n\t\t// Buscamos el ID del catalogo\n\t\tself.colbensonCatalogue = self.colbensonMockupConfiguration.colbensonCatalogue;\n\n\t\t// Buscamos el Warehouse en el json de la Store Actual\n\t\tself.colbensonWarehouse = self.colbensonMockupConfiguration.colbensonWarehouse;\n\t\t// Buscamos el lenguage de la store actual\n\t\tself.colbensonLang = \"es\";\n\t} else {\n\t\t// Entorno de producción\n\n\t\t// Buscamos el ID de la Store Actual\n\t\tself.colbensonStore = self._searchEngine.inditexIns.iStoreJSON.id;\n\n\t\t// Buscamos el ID del catalogo\n\t\tself.colbensonCatalogue = self._searchEngine.inditexIns.iCatalogId;\n\n\t\t// Buscamos el Warehouse en el json de la Store Actual\n\t\tself.colbensonWarehouse = self._searchEngine.inditexIns.iStoreJSON.ffmcenter;\n\n\t\t// Buscamos el lenguage de la store actual\n\t\tvar country_lang_id = self._searchEngine.inditexIns.iLangId;\n\t\tvar numLanguages = self._searchEngine.inditexIns.iStoreJSON.supportedLanguages.length;\n\t\n\n\t\tfor (var i = numLanguages - 1; i >= 0; i--) {\n\t\t\tif(self._searchEngine.inditexIns.iStoreJSON.supportedLanguages[i].id == country_lang_id) {\n\t\t\t\t\n\t\t\t\t////self.colbensonLang = self._searchEngine.inditexIns.iStoreJSON.supportedLanguages[i].code.toLowerCase();\n\t\t\t\tself.colbensonLang = inditex.iSeoParamMap[\"langId\"][country_lang_id];\n\n\t\t\t}\n\t\t\t\n\t\t}\n\t}\n\n\tself._okColbensonConfiguration = true;\n\tself._checkAtributes();\n\n}\n</script>\n<!-- END FIX_ECOMOYSH-4616 --><!-- FIX_ECOMOYSH-4712 -->\n<script>\nItxProductPageClass.prototype._drawColorSelector = function () {\n  var self = this,\n    colorSelector, colorImages, img, span, colorId, colorName;\n\n  //En el caso de Alemania(DE) se reduce el espacio del selector de colores para poder incluir información de tasas\n  //Falta texto DE Taxes, comprobar si en AT tambien ocurre\n  if (self.iContainer == 'popupContent') {\n    $('#popupContent div.color_palette').css('max-width', \"175px\");\n    // $(\"<div id='mspot-productTaxes'>productTaxes</div>\").insertAfter('div.content_wrapper div.content div.color_palette');\n  }\n\n  var productColors = self.isBundleSpecial ? self.iProductInfo.bundleProductSummaries[0].detail.colors : self.iProductInfo.detail.colors;\n\n  if (self.iContainer == 'mainContent') {\n    if ($('#productos #colorSelector').length) {\n      colorSelector = $('#productos #colorSelector');\n    } else {\n      colorSelector = $(\"<div id='colorSelector' class='color_palette'></div>\");\n    }\n  } else {\n\n    if ($('#popupContent #colorSelector').length) {\n      colorSelector = $('#popupContent #colorSelector');\n    } else {\n      colorSelector = $(\"<div id='colorSelector' class='color_palette'></div>\");\n    }\n  }\n\n  colorName = $('<span id=\"colorName\" class=\"color_name\"></span>');\n  colorSelector.append(colorName);\n\n  for (var i = 0; i < productColors.length; i++) {\n    var style = null;\n    if (productColors[i].image.style && productColors[i].image.style[0]) {\n      style = productColors[i].image.style[0];\n    }\n    colorImages = Inditex.getProductImageUrls(productColors[i].image, 3, 5, null, style);\n    if (!colorImages) continue;\n    img = $(\"<img />\").attr(\"src\", colorImages[0]);\n    span = $(\"<span></span>\");\n    span.attr(\"id\", productColors[i].id);\n\n    if (parseInt(productColors[i].id) == parseInt(self.iColorId)) {\n      span.addClass(\"active\");\n      colorName.html(productColors[i].name);\n    } else {\n      span.bind(Inditex.iXBindType, function (event) {\n        self._changeColor($(this).attr(\"id\"));\n      });\n    }\n\n    span.append(img);\n    // Colocamos el selector dependiendo si el bundle o no\n    colorSelector.append(span);\n    if (self.iContainer == 'mainContent') {\n\n      if (self.isBundle) {\n        $('#productos > div:first-child > .product_sizes').after(colorSelector);\n      } else {\n        $('#productos > div:first-child > .product_sizes').before(colorSelector);\n      }\n    } else {\n      $('#popupContent #colorSelector').before(colorSelector);\n    }\n  }\n\n};\n</script>\n<!-- END FIX_ECOMOYSH-4712 --><!-- FIX_ECOMOYSH-4516 -->\n<script>\n// Prepare the form\nWalletCardClass.prototype._prepareForm = function () {\n  var self = this;\n  var chkCheckbox = {\n    checkTxt: \"\",\n    type: \"checkbox\",\n    id: \"policy_checkbox\",\n    name: \"policy_checkbox\",\n    lopd: {\n      isMandatory: false,\n      isRegistered: self.isRegistered,\n      policies: [{\n        privacy_policy: true,\n        terms: true\n      }],\n      method: self.methodKind,\n    },\n    validate: \"required\",\n    size: 12\n  };\n\n  // GiftCard Policies\n  if (self.methodKind == 'gift_card') chkCheckbox.lopd.policies[0].gc_terms = true;\n\n  // Generate Form\n  self.form = new Form({\n\n    validation_options: {\n      promptPosition: 'bottomLeft',\n      showOneMessageByField: true,\n      scroll: false,\n      focusFirstField: false\n    },\n    fields: [\n      chkCheckbox\n    ],\n    addRequiredFieldsNote: true,\n    addMSpotPromo: true\n  });\n\n  // Load Affinity and creditCard Installment modes\n  if (self.methodKind == 'affinity' || self.methodKind == 'credit_card_installments') {\n    self._loadAffinityModes();\n  }\n\n  // Load requestPaymentDetails\n  if (self.walletCard.requestPaymentDetails && self.walletCard.requestPaymentDetails == '1') {\n    self._loadRequestPaymentDetails();\n  }\n};\n\n// Load Affinity modes\nWalletCardClass.prototype._loadAffinityModes = function () {\n  var self = this;\n  var modes = [];\n\n  if (!!self.walletCard.paymentModes.length) {\n    for (var i = 0; i < self.walletCard.paymentModes.length; i++) {\n      var mode = self.walletCard.paymentModes[i];\n      modes.push({\n        id: mode.id,\n        value: mode.name\n      });\n    }\n\n    var selectDefault = _.findWhere(modes, {\n      id: 99\n    });\n\n    // Generate the field\n    var modeElem = self.form._generateField({\n      type: \"select\",\n      label: (selectDefault) ? selectDefault.value : Inditex.text('CHK_LABEL_AFF_PAYMENTMODE'),\n      id: \"iModalidadPagoSelectedCreditCardCodeCC\",\n      name: \"iModalidadPagoSelectedCreditCardCodeCC\",\n      validate: \"required\",\n      size: 3,\n      value: (selectDefault) ? selectDefault.id : \"\",\n      selectValues: modes\n    });\n\n    self.el.find('.OY_select').remove();\n    self.el.append(modeElem.find('.OY_select'));\n    self.el.find('.OY_select .OY_option').on('click', function () {\n      self.el.find('.OY_select').removeClass('icon-ico-info');\n    });\n  }\n};\n\nPayment_affinityClass.prototype._loadBindings = function () {\n\n  var self = this;\n\n  /* Anyade un espacio en blanco para separar el numero en bloques de 4 */\n  $('#Chk_Pay_forms #card_number').off('keyup').on('keyup', function (e) {\n    var key = e.keyCode,\n      textLenght = $(this).val().replace(/ /g, '').length;\n\n    if (((key > 95 && key < 106) || (key > 47 && key < 58)) &&\n      textLenght > 0 && textLenght % 4 === 0) {\n\n      $(this).val(function (i, value) {\n        return value + ' ';\n      });\n    }\n  });\n\n  $('#Chk_Pay_forms').off('change', '#card_number, #nif').on('change', '#card_number, #nif', function () {\n    $('#Chk_Pay_forms #nif').val($('#Chk_Pay_forms #nif').val().toUpperCase());\n    validateCards($('#Chk_Pay_forms #card_number')) === true && $('#Chk_Pay_forms #card_number').val() != '' ? self._loadPaymentModes() : self._disablePaymentModes();\n  });\n\n  if ($('#Chk_Pay_forms #card_number').val() != '' && $('#Chk_Pay_forms #nif').val() != '') {\n    $('#Chk_Pay_forms').trigger('change');\n  }\n};\n\nPayment_affinityClass.prototype._loadPaymentModes = function () {\n  var self = this;\n  var cardNumber = $('#Chk_Pay_forms #card_number').val();\n  var nif = $('#Chk_Pay_forms #nif').val();\n  Inditex.xRestGetPaymentModes(inditex.iXShopCart.id, self.method.type, cardNumber.replace(/\\s/g, ''), nif || '', 0).done(function (paymentModes) {\n    var optArr = new Array();\n    $.each(paymentModes, function (i, val) {\n      optArr.push({\n        id: val.id,\n        value: val.name\n      })\n    });\n\n    var selectDefault = _.findWhere(optArr, {\n      id: 99\n    });\n\n    self.form._updateField({\n      elem: $('#Chk_Pay_forms #iModalidadPagoSelectedCreditCardCode'),\n      label: (selectDefault) ? selectDefault.value : Inditex.text(\"CHK_LABEL_AFF_PAYMENTMODE\"),\n      type: \"select\",\n      id: \"iModalidadPagoSelectedCreditCardCode\",\n      name: \"iModalidadPagoSelectedCreditCardCode\",\n      validate: \"required\",\n      size: 3,\n      containerClass: 'fitWidth no_margin_right',\n      value: (selectDefault) ? selectDefault.id : \"\",\n      selectValues: optArr\n    });\n\n  }).Catch(function (error) {\n    Inditex.xOpenErrorPopUp(350, 290);\n  });\n\n};\n\nOrderValidationClass.prototype._validatePaymentMethod = function (aCallback) {\n  var self = this,\n    valid = true;\n\n  // If the order is totally paid using giftCard\n  if (!!self.giftCards.savedCards && self._giftCardPaidOrder()) {\n    if (aCallback) {\n      aCallback(true);\n    } else {\n      return true;\n    }\n  }\n\n  if (inditex.iXShopCart.totalOrder == 0 && inditex.iXShopCart.items.length > 0) {\n    if (aCallback) {\n      aCallback(true);\n      return;\n    }\n    return true;\n  }\n\n  // If not payment method\n  if (!self.activePaymentMethod) {\n    //console.log('no hay metodo de pago');\n    showError(Inditex.text(\"CHK_ERROR_NOPAYMENT\"));\n    if (aCallback) {\n      aCallback(false);\n    } else {\n      return false;\n    }\n  } else {\n    // If actived method is gitfCard, return false\n    if (self.activePaymentMethod.kind == \"gift_card\") {\n      showError(Inditex.text(\"CHK_ERROR_PAY_GIFTCARD\"));\n      if (aCallback) {\n        aCallback(false);\n      } else {\n        return false;\n      }\n    }\n\n    // If Payment method is Klarna, make its special validation\n    if (self.activePaymentMethod.kind == \"kaccount\" || self.activePaymentMethod.kind == \"kinvoice\") {\n      var KlValidation = self.isValidKlarna();\n      if (KlValidation != 0) {\n        showError(self.showKlarnaError(KlValidation));\n        if (aCallback) {\n          aCallback(false);\n        } else {\n          return false;\n        }\n      }\n    }\n\n    // If Payment Method is inWallet, make its special validation\n    if (self.activePaymentMethod.kind == \"inwallet\") {\n      if ($('#inWalletCardHash').attr('disabled') == 'disabled') {\n        showError(Inditex.text(\"CHK_ERROR_IW_NOCARD\"));\n        if (aCallback) {\n          aCallback(false);\n        } else {\n          return false;\n        }\n      }\n    }\n    // * *\n    // Restriccion para no poder comprar caja-regalo con metodo de pago cod/POD\n    if (self.activePaymentMethod.kind && ['cod', 'pod'].indexOf(self.activePaymentMethod.kind.toLowerCase()) >= 0) {\n      var itemGiftPack = _.findWhere(Inditex.iXShopCart.items, {\n        reference: 'XGIFTSKU'\n      });\n      if (itemGiftPack) {\n        showError(Inditex.text(\"VALIDATION_ERROR_MESSAGE_PACKINGIFT_COD\")); // No se puede realizar una compra de caja regalo con envío contrarrembolso.\n        if (aCallback) {\n          aCallback(false);\n        } else {\n          return false;\n        }\n      }\n    }\n\n    if (self.activePaymentMethod.kind && ['cod', 'pod'].indexOf(self.activePaymentMethod.kind.toLowerCase()) >= 0 && !!self.isChina) {\n      self._isExcludedDistrict({\n        onSuccess: function (excluded) {\n          if (!!excluded) {\n            // If it's not a valid district\n            showError(Inditex.text(\"CHK_ERROR_COD_NOT_ALLOWED\"))\n            if (aCallback) {\n              aCallback(false);\n            } else {\n              return false;\n            }\n          } else {\n            if ($('#Chk_Pay_forms .OY_form').validationEngine('validate')) {\n              if (aCallback) {\n                aCallback(true);\n              } else {\n                return true;\n              }\n            } else {\n              showError('');\n              if (aCallback) {\n                aCallback(false);\n              } else {\n                return false;\n              }\n            }\n          }\n        }\n      }, self.activeShippingMethod.kind);\n    } else {\n      var passed = false;\n      // Launch validate function\n      if ($('#Chk_Pay_forms .OY_form').validationEngine('validate')) {\n        passed = true;\n      } else {\n        showError('');\n        passed = false;\n      }\n      //Wallet User && Affinity wallet selected\n      if (!passed || (self.activePaymentMethod.code == 7 && $('.OY_ul_Wallet_container #iModalidadPagoSelectedCreditCardCodeCC').val() == '')) {\n        passed = false;\n        $('.OY_ul_Wallet_container #iModalidadPagoSelectedCreditCardCodeCC_select.OY_select').addClass('icon-ico-info');\n      } else {\n        passed = true;\n        $('.OY_ul_Wallet_container #iModalidadPagoSelectedCreditCardCodeCC_select.OY_select').removeClass('icon-ico-info');\n      }\n      if (aCallback) {\n        aCallback(passed);\n      } else {\n        return passed;\n      }\n    }\n  }\n\n  function showError(error) {\n    self._paymentMethodErrorTrigger({\n      error: error\n    });\n  }\n};\n</script>\n<!-- END FIX_ECOMOYSH-4516 --><!-- FIX_ECOMOYSH-4713 -->\n<script>\nItxProductPageClass.prototype._drawName = function() {\n    var self = this\n      , product = self.isBundleSpecial ? self.iProductInfo.bundleProductSummaries[0] : self.iProductInfo;\n\t\n\tvar url = inditex.generateUrl(\"ItxProductPage\", {\n            storeId: Inditex.iStoreId,\n            langId: Inditex.iLangId,\n            catalogId: Inditex.iCatalogId,\n            categoryId: 0,\n            productId: self.iProductId,\n            typeCategory: \"0\"\n        });\n\t  \n    \"popupContent\" == self.iContainer ? ($(\"#\" + self.iContainer + \" #productName\").html('\\x3ca href\\x3d\"' + url + '\"\\x3e' + product.name + \"\\x3c/a\\x3e\")) : $(\"#\" + self.iContainer + \" #productName\").text(product.name);\n    product.detail.description ? $(\"#\" + self.iContainer + \" #productShortDescription\").text(product.detail.description) : product.detail.longDescription ? $(\"#\" + self.iContainer + \" #productShortDescription\").text(product.detail.longDescription) : $(\"#\" + self.iContainer + \" #productShortDescription\").hide()\n};\n\n\nItxNewProductPageClass.prototype._bindSelectorsBundle = function (product) {\n  var self = this;\n\n  $(document).on('mouseover', '.add_button_single:not(.active)', function () {\n    var productId = $(this).parent().attr('id').split('_').pop();\n    $('#size_selector_name_' + productId).addClass('uncompleted');\n  });\n\n  $(document).on('mouseleave', '.add_button_single:not(.active)', function () {\n    var productId = $(this).parent().attr('id').split('_').pop();\n    $('#size_selector_name_' + productId).removeClass('uncompleted');\n  });\n\n  $(document).on('click', '.add_button_single:not(.active)', function () {\n    var productId = $(this).parent().attr('id').split('_').pop();\n    $('#size_selector_name_' + productId).removeClass('uncompleted').addClass('uncompleted-alert');\n    $('#sizeSelector_' + productId).addClass('uncompleted-alert');\n    $('#alert_icon_' + productId).addClass('uncompleted-alert');\n    inditex.xOpenCustomSelect('sizeSelector_' + productId);\n  });\n\n\n  $(document).on('click', '.add_button_single.active', function () {\n    var productId = $(this).parent().attr('id').split('_').pop();\n    var sizeSku = $('#size_selector_name_' + productId + ' span').attr('id');\n    var selectedProduct = _.findWhere(self.iBundleProduct.bundleProductSummaries, {\n      id: parseInt(productId)\n    });\n\n    var selectedSize = _.findWhere(selectedProduct.detail.colors[0].sizes, {\n      sku: parseInt(sizeSku)\n    });\n    var fromSearch = window.sessionStorage.getItem('fromSearch');\n    self._addToList(selectedSize, \"shopCart\", 1, selectedProduct);\n\n\n\n\n              $.event.trigger({\n            type: 'productPage.addToCartBundle',\n            productIndex: selectedProduct,\n            size: $('#size_selector_name_' + productId + ' span').attr('id') != undefined ? $('#size_selector_name_' + productId + ' span').attr('id') : product.detail.colors[0].sizes[0].sku,\n            list: (getURLParameter('search-term') !== null || fromSearch != 'undefined') ? 'buscador' : 'parrilla_' + (window.sessionStorage.getItem('productActionFieldList') || '')\n          });\n\n        //  self._addToCartBundle();\n\n\n\n    self._resetSizesBundle(selectedProduct.id);\n  });\n\n  $(document).on('click mouseover mouseleave', '#add_bundle_button:not(.active)', function (event) {\n    $('.add_button_single:not(.active)').trigger(event.type);\n  });\n\n  $(document).on('click', '#add_bundle_button.active', function () {\n    var addProductActive = $('.add_button_single.active');\n    if (addProductActive.length == 2) {\n      addProductActive.trigger('click');\n    }\n    var productId = $(this).parent().attr('id').split('_').pop();\n    self._resetSizesBundle(productId);\n  });\n\n  $(document).on('click', '.notify_legend', function () {\n    var sku = $(this).attr('data-sku');\n    var url = Inditex.generateUrl('ItxBackSoonNotifyPage', {\n      'storeId': Inditex.iStoreId,\n      'langId': Inditex.iLangId,\n      'catalogId': Inditex.iCatalogId\n    });\n    Inditex.popupUrl(url, 360, 520, function () {\n      new ItxBackSoonNotifyPageClass(sku);\n      $('div.inner_overlay_form label input').css(\"padding-left\", \"0px\");\n\n    });\n\n  });\n\n  $(document).on('click', '.view_availability', function (event) {\n    event.preventDefault();\n    var productId = $(this).attr('id').split('_')[2];\n    var product = _.findWhere(self.iBundleProduct.bundleProductSummaries, {\n      id: parseInt(productId)\n    });\n    var url = Inditex.generateUrl(\"ItxStoreStockPage\", {\n      \"storeId\": Inditex.iStoreId,\n      \"langId\": Inditex.iLangId,\n      \"catalogId\": Inditex.iCatalogId\n    }, true);\n\n    var height = (Inditex.xIsIPad() || Inditex.xIsIPad_5()) ? 540 : 510;\n    var fnPopup = (self.iContainer == 'mainContent') ? Inditex.popupUrl : Inditex.popupLoadUrl;\n\n    setTimeout(function () {\n      fnPopup(url, 910, height, function () {\n        $('.overlay').addClass('no-border-popup');\n        new ItxStoreStockPageClass(product, product.detail.colors[0].id, product.detail.colors[0].sizes[0].sku);\n        Inditex.xLoadCustomSelect('selectProductSizeOverlay2');\n\n      });\n    }, 250);\n\n    // TODO Tag manager\n    // $.event.trigger({\n    //   type: 'productPage.viewAvailability',\n    //   size: $('#size_selector_name_' + productId + ' span').attr('id') != undefined ? $('#size_selector_name_' + productId + ' span').attr('id') : product.detail.colors[0].sizes[0].sku,\n    //   selectedColorId: product.detail.colors[0].id\n    // });\n  });\n};\n</script>\n<!-- END FIX_ECOMOYSH-4713 -->\n<!-- END SPOT=OY3_ESpot_Inditex -->\n\n<link rel=\"stylesheet\" type=\"text/css\" href=\"https://static.oysho.net/6/static2/itxwebstandard/css/itx-custom-main.min.css?t=20170422040205714465006\">\n\n<!-- Begin Mpulse -->\n<script type=\"text/javascript\">\nif ((window.inditex && window.inditex.iPage == \"ItxOrderConfirmationPage\") || window.isIframe){\n\twindow.BOOMR_config = { autorun: false };\n}\n(function() {\n    if (window.BOOMR && window.BOOMR.version) {\n        return;\n    }\n    var dom, doc, where, iframe = document.createElement(\"iframe\"),\n        win = window;\n\n    function boomerangSaveLoadTime(e) {\n        win.BOOMR_onload = (e && e.timeStamp) || new Date().getTime();\n    }\n    if (win.addEventListener) {\n        win.addEventListener(\"load\", boomerangSaveLoadTime, false);\n    } else if (win.attachEvent) {\n        win.attachEvent(\"onload\", boomerangSaveLoadTime);\n    }\n\n    iframe.src = \"javascript:void(0)\";\n    iframe.title = \"\";\n    iframe.role = \"presentation\";\n    (iframe.frameElement || iframe).style.cssText = \"width:0;height:0;border:0;display:none;\";\n    where = document.getElementsByTagName(\"script\")[0];\n    where.parentNode.insertBefore(iframe, where);\n\n    try {\n        doc = iframe.contentWindow.document;\n    } catch (e) {\n        dom = document.domain;\n        iframe.src = \"javascript:var d=document.open();d.domain='\" + dom + \"';void(0);\";\n        doc = iframe.contentWindow.document;\n    }\n    doc.open()._l = function() {\n        var js = this.createElement(\"script\");\n        if (dom) {\n            this.domain = dom;\n        }\n        js.id = \"boomr-if-as\";\n        js.src = \"//c.go-mpulse.net/boomerang/\" +\n             \"ETNXK-63DEQ-EFQAE-W6SEJ-K7LEC\";\n        BOOMR_lstart = new Date().getTime();\n        this.body.appendChild(js);\n    };\n    doc.write('<body onload=\"document._l();\">');\n    doc.close();\n})();\n</script>\n<!-- End Mpulse -->\n<!-- BEGIN SPOT=OY3_ESpot_HeadEnd -->\n<link rel=\"apple-touch-icon\" sizes=\"57x57\" href=\"https://static.oysho.net/6/static2/images/oysho_57.png?t=20170422040205714465006\">\n<link rel=\"apple-touch-icon\" sizes=\"114x114\" href=\"https://static.oysho.net/6/static2/images/oysho_114.png?t=20170422040205714465006\">\n<link rel=\"apple-touch-icon\" sizes=\"1024x1024\" href=\"https://static.oysho.net/6/static2/images/oysho_1024.png?t=20170422040205714465006\"><script>\n    inditex.setDeviceTest(\"ItxStandardUserResetPasswordPage\", true);\n    inditex.setDeviceTest(\"ItxShopCartPage\", true);\n    inditex.setDeviceTest(\"ItxMSpotPage\", true);\n</script>\n<!-- END SPOT=OY3_ESpot_HeadEnd -->\n\n<!-- END post-common head -->\n\t</head>\n\t<body data-ga-logic=\"/Worldwide\">\n<!-- BEGIN SPOT=OY3_ESpot_BodyBegin -->\n<!-- Google Tag Manager -->\n<noscript>&lt;iframe src=\"//www.googletagmanager.com/ns.html?id=GTM-WNGV5L\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"&gt;&lt;/iframe&gt;</noscript>\n<script>\n(function(w,d,s,l,i){\nw[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});\nvar f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j, f);\n})(window,document,'script','dataLayer','GTM-WNGV5L');\n</script>\n<!-- End Google Tag Manager -->\n<!-- END SPOT=OY3_ESpot_BodyBegin -->\n\n\n\n<div class=\"invisible_layer\"></div>\n\n<div class=\"fullscreen_layer\">\n  <div class=\"photo\">\n    <div class=\"arrow left\"></div>\n    <img id=\"full_photo\" class=\"full_photo_fullscreen full_photo_fullscreen_tablet\">\n    <div class=\"arrow right\"></div>\n  </div>\n</div>\n\n<div class=\"overlay_shadow_zoom\"></div>\n\n<div class=\"overlay_shadow\"></div>\n\n<div class=\"overlay\">\n  <div class=\"close\">&nbsp;</div>\n  <div class=\"overlay_content\"></div>\n</div>\n\n<div class=\"absolute_overlay\">\n  <div class=\"absolute_content\"></div>\n  <div class=\"close\">&nbsp;</div>\n</div>\n\n<!-- Maps -->\n<div class=\"overlay_shadow_map\"></div>\n\n<div class=\"overlay_map\">\n  <div class=\"close\">&nbsp;</div>\n  <div class=\"overlay_content_map\"></div>\n</div>\n\n<div class=\"absolute_overlay_map\">\n  <div class=\"absolute_content_map\"></div>\n  <div class=\"close\">&nbsp;</div>\n</div>\n\n\n    <div id=\"iContent\" class=\"worldWide_bodyWrapper\" style=\"position: fixed; overflow: hidden;\">\n<!-- BEGIN SPOT=OY3_ESpot_WorldWide -->\n<img src=\"https://static.oysho.net/6/static2//SS16/ww/ww_ss17.jpg?t=20170422040205714465006\" width=\"1150\" height=\"575\" style=\"position: absolute; left: -182.5px; top: 0px;\">\n<style> \n.footer_cookies { \n       display: block !important; \n} \na#promo_HeaderTop ,.topHeader_Close {\n    display: none;\n}\n</style> <script type=\"text/javascript\">\n    try {\n        if (inditex != null && inditex.iPage == \"ItxWorldWidePage\" && location.hostname.indexOf(\".cn\") != -1){    \n            window.location.href = window.location.href.replace(\".cn\", \".com\");\n        }\n    } catch(e){\n    }\n</script>\n\n<!-- END SPOT=OY3_ESpot_WorldWide -->\n\t\t\t<div id=\"cookiesWarn\" style=\"display: block;\">\n<!-- BEGIN SPOT=OY3_ESpot_CookiesWarn -->\n<div id=\"footer_cookies\" class=\"footer_cookies\" style=\"display: block;\">\n<div class=\"separador\"></div>\n  <a id=\"closed_cookies\" class=\"closed\" href=\"#\">\n  <img src=\"https://static.oysho.net/6/static2/itxwebstandard/images/close_buttton_popup.png?t=20170422040205714465006\">\n  </a>\n<p>\n  Utilizamos cookies propias y de terceros para mejorar tu experiencia y nuestros servicios, analizando la navegación en nuestro sitio web. Si continuas navegando, consideramos que aceptas su uso.\n<a id=\"read_more_coockies\" class=\"link\" href=\"javascript:;\">POLÍTICA DE COOKIES.</a>\n</p>\n</div>\n<style>\n.footer_cookies p { \n    margin: 0 auto; \n    padding-top: 15px !important; \n    text-align: center; \n    text-transform: none; \n    width: 440px !important; \n}\n</style>\n<script type=\"text/javascript\">\ninditex.onReady(function(){\n\tvar oldItxAjaxUserRegistrationPageClassInit = ItxAjaxUserRegistrationPageClass.prototype._init;\n\tItxAjaxUserRegistrationPageClass.prototype._init = function() {\n\t\tjQuery('input[name^=addressLine_0]').attr('maxlength',100);\n\t\toldItxAjaxUserRegistrationPageClassInit.call(this);\n\t};\n\n\tvar oldItxMyAccountPersonalPageClassInit = ItxMyAccountPersonalPageClass.prototype._init;\n\tItxMyAccountPersonalPageClass.prototype._init = function() {\t\t\n\t\tjQuery('input[name^=addressLine_0]').attr('maxlength',100);\n\t\toldItxMyAccountPersonalPageClassInit.call(this);\n\t};\n\t\n\tvar oldItxMyAccountRequestReturnPageClassInit = ItxMyAccountRequestReturnPageClass.prototype._init;\n\tItxMyAccountRequestReturnPageClass.prototype._init = function() {\t\t\n\t\tjQuery('input[name^=addressLine_0]').attr('maxlength',100);\n\t\toldItxMyAccountRequestReturnPageClassInit.call(this);\n\t};\n\t\n\tvar oldItxMyAccountAddressBookPageClassInit = ItxMyAccountAddressBookPageClass.prototype._init;\n\tItxMyAccountAddressBookPageClass.prototype._init = function() {\t\t\n\t\tjQuery('input[name^=addressLine_0]').attr('maxlength',100);\n\t\toldItxMyAccountAddressBookPageClassInit.call(this);\n\t};\n\n\t\n\tvar oldItxAjaxAddressDisplayClassInit = ItxAjaxAddressDisplayClass.prototype._init;\n\tItxAjaxAddressDisplayClass.prototype._init = function() {\t\t\n\t\tjQuery('input[name^=addressLine_0]').attr('maxlength', 100);\n\t\toldItxAjaxAddressDisplayClassInit.call(this);\n\t};\n\t\n\tvar oldItxDeliveryPointPageClassInit = ItxDeliveryPointPageClass.prototype._init;\n\tItxDeliveryPointPageClass.prototype._init = function() {\t\t\n\t\tjQuery('input[name^=addressLine_0]').attr('maxlength', 100);\n\t\tjQuery('input[name^=addressLine_1]').attr('maxlength', 50);\n\t\toldItxDeliveryPointPageClassInit.call(this);\n\t};\n});\n</script>\n<!-- END SPOT=OY3_ESpot_CookiesWarn -->\n\t\t\t</div>\n\n    </div>\n    <div class=\"worldWide_content\">\n<!-- BEGIN SPOT=OY3_ESpot_WorldWide_Logo -->\n<h1><img src=\"https://static.oysho.net/6/static2/itxwebstandard/images/logo_white.png?t=20170422040205714465006\" border=\"0\" alt=\"Oysho\" class=\"logo\"></h1>\n<!-- END SPOT=OY3_ESpot_WorldWide_Logo -->\n\t\t\t<div class=\"worldWide_select\">\n\t\t\t\t<div class=\"worldWide_country\" id=\"selectCountry\" style=\"display: none;\">\n\t\t\t\t\t<span id=\"nameWW_country\"> <!-- Carga dinamica de elemento seleccionado --> </span>\n\t\t\t\t\t<div class=\"worldWide_listCountry\">\n\t\t\t\t\t\t<div class=\"innerListCountry\">\n\t\t\t\t\t\t\t<!-- Carga dinamica de elementos -->\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"outerListCountry\">\n\t\t\t\t\t\t\tshop online available\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"worldWide_lang\" id=\"selectLang\">\n\t\t\t\t\t<span id=\"nameWW_lang\"> <!-- Carga dinamica de elemento seleccionado --> </span>\n\t\t\t\t\t<div class=\"worldWide_listLang\">\n\t\t\t\t\t\t<!-- Carga dinamica de elementos -->\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"worldWide_go\">\n\t\t\t\t\tCONTINUARItxWorldWidePage.canarias=Si nos visitas desde Canarias, haz click\n\t\t\t\t</div>\n\n\t\t\t</div>\n    </div>\n<!-- BEGIN SPOT=OY3_ESpot_BodyEnd -->\n\t<script type=\"application/ld+json\">\n\t\t{\n\t\t  \"@context\": \"https://schema.org\",\n\t\t  \"@type\": \"Organization\",\n\t\t  \"name\": \"Oysho\",\n\t\t  \"url\": \"https://www.oysho.com\",\n\t\t  \"logo\": \"https://www.oysho.com/static/itxwebstandard/images/logo_black.png?t=20160316010154db\",\n\t\t  \"sameAs\" : [\n\t\t\t\t\"https://www.facebook.com/oysho\",\n\t\t\t\t\"https://twitter.com/Oysho\",\n\t\t\t\t\"https://www.instagram.com/oysho/\",\t\n\t\t\t\t\"https://es.pinterest.com/oyshostore/\",\n\t\t\t\t\"https://www.youtube.com/user/OYSHOtv\"\n\t\t\t\t],\t\t\n\t\t\t\"contactPoint\": [{\n\t\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+34 900 456 004\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"ES\",\n\t\t\t\t\"availableLanguage\": [\"Spanish\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+33 800 91 88 82\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"FR\",\n\t\t\t\t\"availableLanguage\": [\"French\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+39 800 875 531\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"IT\",\n\t\t\t\t\"availableLanguage\": [\"Italian\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+351 800 834 290\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"PT\",\n\t\t\t\t\"availableLanguage\": [\"Portuguese\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+44  08082340208\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"GB\",\n\t\t\t\t\"availableLanguage\": \"English\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+30 800 341 206\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"GR\",\n\t\t\t\t\"availableLanguage\": [\"Greek\",\"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+48 800 341 12 06\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"PL\",\n\t\t\t\t\"availableLanguage\": [\"Polish\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+41 800 837 869\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"CH\",\n\t\t\t\t\"availableLanguage\": [\"Italian\", \"English\", \"French\", \"German\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+31 800 023 42 54\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"NL\",\n\t\t\t\t\"availableLanguage\": [\"Dutch\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+32 800 784 09 \",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"BE\",\n\t\t\t\t\"availableLanguage\": [\"English\", \"French\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+352 800 274 30\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"LU\",\n\t\t\t\t\"availableLanguage\": [\"French\", \"German\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+43 800 297 668\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"AT\",\n\t\t\t\t\"availableLanguage\": [\"German\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+49 800 1888 926\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"DE\",\n\t\t\t\t\"availableLanguage\": [\"German\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+86 400 920 8586\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"CN\",\n\t\t\t\t\"availableLanguage\": [\"Chinese\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+7 810800 244 95011\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"RU\",\n\t\t\t\t\"availableLanguage\": [\"Russian\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+52 01 800 283 4389 \",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"MX\",\n\t\t\t\t\"availableLanguage\": [\"Spanish\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+40 0800400804\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"RO\",\n\t\t\t\t\"availableLanguage\": [\"Romanian\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+46 020100435\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"SE\",\n\t\t\t\t\"availableLanguage\": \"English\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+45 80250598\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"DK\",\n\t\t\t\t\"availableLanguage\": \"English\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+353 1800553430\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"IE\",\n\t\t\t\t\"availableLanguage\": \"English\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+385 0800777933\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"HR\",\n\t\t\t\t\"availableLanguage\": [\"Croatian\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+420 0800050331\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"CZ\",\n\t\t\t\t\"availableLanguage\": [\"Czech\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+421  0800134321\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"SK\",\n\t\t\t\t\"availableLanguage\": [\"Slovak\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+36 0680982543\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"HU\",\n\t\t\t\t\"availableLanguage\": \"English\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+359  008001214428 \",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"BG\",\n\t\t\t\t\"availableLanguage\": [\"Bulgarian\", \"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+358  0800417529\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"FI\",\n\t\t\t\t\"availableLanguage\": \"English\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+370  880033164\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"LT\",\n\t\t\t\t\"availableLanguage\": \"English\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+371  80005397\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"LV\",\n\t\t\t\t\"availableLanguage\": \"English\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+372  8000044639\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"EE\",\n\t\t\t\t\"availableLanguage\": \"English\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+386  080081812\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"SI\",\n\t\t\t\t\"availableLanguage\": \"English\"\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+357  80091041\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"CY\",\n\t\t\t\t\"availableLanguage\": [\"Greek\",\"English\"]\n\t\t\t},\n\t\t\t{\n\t\t\t\"@type\": \"ContactPoint\",\n\t\t\t\t\"telephone\": \"+356  80062681\",\n\t\t\t\t\"contactType\": \"customer service\",\n\t\t\t\t\"contactOption\": \"TollFree\",\n\t\t\t\t\"areaServed\": \"MT\",\n\t\t\t\t\"availableLanguage\": \"English\"\n\t\t\t}]\n\t\t}\n\t\t</script>\n            <div class=\"retailRocket\" data-retailrocket-markup-block=\"573ef33165bf19152c258082\" data-stock=\"es_ES\"></div>\n\n<script type=\"text/javascript\">\n\n             inditex.onReady(function(){\n                        var ilocale= Inditex.iLocale;\n                     $('.retailRocket').attr('data-stock',ilocale); \n            });\n\n</script>\n<!-- END SPOT=OY3_ESpot_BodyEnd -->\n\n<script type=\"text/javascript\">\n\t(function(){\n\t\tvar re = new RegExp(\"^(http|https)://\" + location.host + \"$\");\n\t\tvar PATTERN_VAR = new RegExp(\"\\\\{[*a-zA-Z]+\\\\}\");\n\t\tvar appId = 1;\n\t\tvar restMap = {\n\t\t\t\"akamai:location\": [\"GET\", \"/user-location-detection\"],\n\t\t\t\"bam:physicalStores1\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/physical-store\"],\n\t\t\t\"bam:physicalStores2\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/physical-stores\"],\n\t\t\t\"bam:physicalStore\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/physical-store/{physicalStoreId}\"],\n\t\t\t\"bam:states\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/state\"],\n\t\t\t\"bam:country\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/country\"],\n\t\t\t\"bam:addFavouriteStore\": [\"POST\", \"/itxrest/2/bam/store/{storeId}/favourite-store\"],\n\t\t\t\"bam:deleteFavouriteStore\": [\"DELETE\", \"/itxrest/2/bam/store/{storeId}/favourite-store/{favouriteStoreId}\"],\n\t\t\t\"bam:bamStock\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/bam-stock\"],\n\t\t\t\"bam:dropPoint\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/drop-point\"],\n\t\t\t\"bam:dropPointLists\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/drop-point-lists\"],\n\t\t\t\"bam:packStation\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/packstation\"],\n\t\t\t\"bam:dropPointState\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/itx-drop-point/state\"],\n\t\t\t\"bam:dropPointMunicipality\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/itx-drop-point/municipality\"],\n\t\t\t\"bam:dropPointColony\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/itx-drop-point/colony\"],\n\t\t\t\"bam:dropPointItx\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/itx-drop-point\"],\n\t\t\t\"bam:districts\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/districts\"],\n\t\t\t\"bam:cities\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/cities\"],\n\t\t\t\"bam:citiesPhysicalStore\": [\"GET\", \"/itxrest/2/bam/store/{storeId}/cities-physical-store\"],\n\t\t\t\"booking:addBooking\": [\"POST\", \"/itxrest/2/booking/store/{storeId}\"],\n\t\t\t\"booking:getBookingsByUser\": [\"GET\", \"/itxrest/2/booking/store/{storeId}\"],\n\t\t\t\"booking:getBookingById\": [\"GET\", \"/itxrest/2/booking/store/{storeId}/{bookingId}\"],\n\t\t\t\"booking:deleteBookingById\": [\"DELETE\", \"/itxrest/2/booking/store/{storeId}/{bookingId}\"],\n\t\t\t\"catalog:stores\": [\"GET\", \"/itxrest/2/catalog/store\"],\n\t\t\t\"catalog:store\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}\"],\n\t\t\t\"catalog:categories\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/category\"],\n\t\t\t\"catalog:category\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/category/{categoryId}\"],\n\t\t\t\"catalog:products\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/category/{categoryId}/product\"],\n\t\t\t\"catalog:productsByCategoryKey\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/categoryKey/{categoryKey}/product\"],\n\t\t\t\"catalog:productsBySearchTerm\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/product\"],\n\t\t\t\"catalog:productDetail\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/category/{categoryId}/product/{productId}/detail\"],\n\t\t\t\"catalog:productsByPartNumber\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/product/{partNumber}\"],\n\t\t\t\"catalog:productsByShortURL\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/shortURL/{shortURL}\"],\n\t\t\t\"catalog:bundleColors\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/product/{partNumber}/bundleColors\"],\n\t\t\t\"catalog:productStock\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/product/{productId}/stock\"],\n\t\t\t\"catalog:productsStock\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/product/stock\"],\n\t\t\t\"catalog:categoryStock\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/category/{categoryId}/stock\"],\n\t\t\t\"catalog:returnReason\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/return-reason\"],\n\t\t\t\"catalog:sendToAFriend\": [\"POST\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/category/{categoryId}/product/{productId}/sendtoafriend\"],\n\t\t\t\"catalog:stockNotification\": [\"POST\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/category/{categoryId}/product/{productId}/stocknotification\"],\n\t\t\t\"catalog:getProductStock\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/product/stock\"],\n\t\t\t\"catalog:colbenson\": [\"GET\", \"/itxrest/2/catalog/store/{storeId}/{catalogId}/colbenson\"],\n\t\t\t\"giftCard:physicalGiftCard\": [\"GET\", \"/itxrest/2/giftcard/store/{storeId}/{catalogId}/physicalgiftcard\"],\n\t\t\t\"giftCard:virtualGiftCard\": [\"GET\", \"/itxrest/2/giftcard/store/{storeId}/{catalogId}/virtualgiftcard\"],\n\t\t\t\"giftCard:addPhysicalGiftCardToShopCart\": [\"POST\", \"/itxrest/2/giftcard/store/{storeId}/cart/physicalgiftcard\"],\n\t\t\t\"giftCard:addVirtualGiftCardToShopCart\": [\"POST\", \"/itxrest/2/giftcard/store/{storeId}/cart/virtualgiftcard\"],\n\t\t\t\"giftCard:physicalGiftCardData\": [\"GET\", \"/itxrest/2/giftcard/store/{storeId}/physicalgiftcard/{orderItemId}/data\"],\n\t\t\t\"giftCard:virtualGiftCardData\": [\"GET\", \"/itxrest/2/giftcard/store/{storeId}/virtualgiftcard/{orderItemId}/data\"],\n\t\t\t\"giftCard:updatePhysicalGiftCardData\": [\"POST\", \"/itxrest/2/giftcard/store/{storeId}/physicalgiftcard/{orderItemId}\"],\n\t\t\t\"giftCard:updateVirtualGiftCardData\": [\"POST\", \"/itxrest/2/giftcard/store/{storeId}/virtualgiftcard/{orderItemId}\"],\n\t\t\t\"giftCard:giftCardBalance\": [\"PUT\", \"/itxrest/2/giftcard/store/{storeId}/balance\"],\n\t\t\t\"giftCard:activateGiftCard\": [\"PUT\", \"/itxrest/2/giftcard/store/{storeId}/activate\"],\n\t\t\t\"marketing:marketingSpots\": [\"GET\", \"/itxrest/2/marketing/store/{storeId}/{catalogId}/spot\"],\n\t\t\t\"oam:crash\": [\"POST\", \"/itxrest/2/oam/crash\"],\n\t\t\t\"oam:xconfiguracion\": [\"GET\", \"/itxrest/2/oam/store/{storeId}/xconfiguracion\"],\n\t\t\t\"oam:launch\": [\"POST\", \"/itxrest/2/oam/store/{storeId}/launch\"],\n\t\t\t\"oam:pushToken\": [\"PUT\", \"/itxrest/2/oam/store/{storeId}/push-token\"],\n\t\t\t\"order:addToCart\": [\"POST\", \"/itxrest/2/order/store/{storeId}/cart\"],\n\t\t\t\"order:updateCart\": [\"PUT\", \"/itxrest/2/order/store/{storeId}/cart\"],\n\t\t\t\"order:deleteFromCart\": [\"DELETE\", \"/itxrest/2/order/store/{storeId}/cart/{sku}\"],\n\t\t\t\"order:miniCart\": [\"GET\", \"/itxrest/2/order/store/{storeId}/minicart\"],\n\t\t\t\"order:shoppingCart\": [\"GET\", \"/itxrest/2/order/store/{storeId}/cart\"],\n\t\t\t\"order:shippingMethods1\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/shipping\"],\n\t\t\t\"order:shippingMethods2\": [\"GET\", \"/itxrest/2/order/store/{storeId}/{catalogId}/shipping\"],\n\t\t\t\"order:shippingMethods3\": [\"GET\", \"/itxrest/2/order/store/{storeId}/{catalogId}/shipping/default\"],\n\t\t\t\"order:paymentMethods\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/payment\"],\n\t\t\t\"order:getIdealBanks\": [\"GET\", \"/itxrest/2/order/store/{storeId}/ideal-banks\"],\n\t\t\t\"order:paymentModes\": [\"PUT\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/payment/{policy}/mode\"],\n\t\t\t\"order:checkoutShipping\": [\"POST\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/checkout/shipping\"],\n\t\t\t\"order:postPunchout\": [\"POST\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/punchout/{acquirer}/policy/{policyName}\"],\n\t\t\t\"order:getPunchout\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/punchout/{acquirer}/policy/{policyName}\"],\n\t\t\t\"order:cancel\": [\"DELETE\", \"/itxrest/2/order/store/{storeId}/order/{orderId}\"],\n\t\t\t\"order:cancelGuest\": [\"DELETE\", \"/itxrest/2/order/store/{storeId}/order-guest/{orderId}\"],\n\t\t\t\"order:orders\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order\"],\n\t\t\t\"order:order\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order/{orderId}\"],\n\t\t\t\"order:orderGuest\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order-guest/{orderId}\"],\n\t\t\t\"order:orderConfirmation\": [\"GET\", \"/itxrest/2/order/store/{storeId}/{catalogId}/order/{orderId}\"],\n\t\t\t\"order:orderSummary\": [\"POST\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/summary\"],\n\t\t\t\"order:addPromoCode\": [\"POST\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/promoCode\"],\n\t\t\t\"order:deletePromoCode\": [\"DELETE\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/promoCode/{promoCode}\"],\n\t\t\t\"order:addGiftpacking\": [\"POST\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/giftpacking\"],\n\t\t\t\"order:deleteGiftPacking\": [\"DELETE\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/giftpacking\"],\n\t\t\t\"order:returnRequest\": [\"POST\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/return-request\"],\n\t\t\t\"order:returnRequestGuest\": [\"POST\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/return-request-guest\"],\n\t\t\t\"order:RMAList\": [\"GET\", \"/itxrest/2/order/store/{storeId}/rma-list\"],\n\t\t\t\"order:getGiftTicket\": [\"POST\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/giftTicket\"],\n\t\t\t\"order:rma\": [\"GET\", \"/itxrest/2/order/store/{storeId}/rma/{rmaId}\"],\n\t\t\t\"order:cardsAdjustments\": [\"POST\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/checkout/card-adjustments\"],\n\t\t\t\"order:deleteCardsAdjustments\": [\"PUT\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/checkout/card-adjustments\"],\n\t\t\t\"order:asyncCheckout\": [\"POST\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/asynccheckout\"],\n\t\t\t\"order:asyncRepay\": [\"POST\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/asyncrepay\"],\n\t\t\t\"order:paymentStatus\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/payment-status\"],\n\t\t\t\"order:generateInvoice\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/invoice/{invoiceId}\"],\n\t\t\t\"order:generateInvoiceMobile\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/invoiceMobile/{invoiceId}\"],\n\t\t\t\"order:getOrderIdfromBarcode\": [\"GET\", \"/itxrest/2/order/store/{storeId}/barcode/{barcode}/captcha/{captcha}\"],\n\t\t\t\"order:klarnaAccountStaticOptObj\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/klarna\"],\n\t\t\t\"order:paymentSelected\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/paymentselected\"],\n\t\t\t\"order:shippingDate\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/shippingDate\"],\n\t\t\t\"order:shippingRange\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/shippingRange\"],\n\t\t\t\"order:orderGuest\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order-guest/{orderId}\"],\n\t\t\t\"order:manualTransfer\": [\"POST\", \"/itxrest/2/order/store/{storeId}/rma/{rmaId}/manualTransfer\"],\n\t\t\t\"order:unboundPayment\": [\"POST\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/checkout/unboundpayment\"],\n\t\t\t\"order:ticket\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/ticket\"],\n\t\t\t\"order:ticket-guest\": [\"GET\", \"/itxrest/2/order/store/{storeId}/order/{orderId}/ticket-guest\"],\n\t\t\t\"secure:getCaptcha\": [\"GET\", \"/itxrest/2/secure/store/{storeId}/captcha/image\"],\n\t\t\t\"secure:getNativeCaptcha\": [\"GET\", \"/itxrest/2/secure/store/{storeId}/captcha\"],\n\t\t\t\"user:loginGuest\": [\"POST\", \"/itxrest/2/user/store/{storeId}/guest-identity\"],\n\t\t\t\"user:login\": [\"POST\", \"/itxrest/2/user/store/{storeId}/identity\"],\n\t\t\t\"user:currentUser\": [\"POST\", \"/itxrest/2/user/store/{storeId}/current-user\"],\n\t\t\t\"user:logout\": [\"DELETE\", \"/itxrest/2/user/store/{storeId}/identity\"],\n\t\t\t\"user:register\": [\"POST\", \"/itxrest/2/user/store/{storeId}/user\"],\n\t\t\t\"user:resetPassword\": [\"PUT\", \"/itxrest/2/user/store/{storeId}/password\"],\n\t\t\t\"user:updateUserEmail\": [\"POST\", \"/itxrest/2/user/store/{storeId}/email\"],\n\t\t\t\"user:updateUserPassword\": [\"POST\", \"/itxrest/2/user/store/{storeId}/password\"],\n\t\t\t\"user:addressBook\": [\"GET\", \"/itxrest/2/user/store/{storeId}/address\"],\n\t\t\t\"user:addressInfoById\": [\"GET\", \"/itxrest/2/user/store/{storeId}/address/{addressId}\"],\n\t\t\t\"user:addressInfoByIdGuest\": [\"GET\", \"/itxrest/2/user/store/{storeId}/address-guest/{addressId}\"],\n\t\t\t\"user:addUpdateAddress\": [\"POST\", \"/itxrest/2/user/store/{storeId}/address\"],\n\t\t\t\"user:receiveNotReceiveInvoice\": [\"PUT\", \"/itxrest/2/user/store/{storeId}/invoice\"],\n\t\t\t\"user:deleteAddress\": [\"DELETE\", \"/itxrest/2/user/store/{storeId}/address/{addressId}\"],\n\t\t\t\"user:invoices\": [\"GET\", \"/itxrest/2/user/store/{storeId}/invoices\"],\n\t\t\t\"user:newsletterStatus\": [\"GET\", \"/itxrest/2/user/store/{storeId}/newsletter\"],\n\t\t\t\"user:subscribeNewsletterRequest\": [\"POST\", \"/itxrest/2/user/store/{storeId}/newsletter-request\"],\n\t\t\t\"user:unsubscribeNewsletterRequest\": [\"DELETE\", \"/itxrest/2/user/store/{storeId}/newsletter-request\"],\n\t\t\t\"user:subscribeNewsletterConfirmation\": [\"POST\", \"/itxrest/2/user/store/{storeId}/newsletter-confirmation\"],\n\t\t\t\"user:unsubscribeNewsletterConfirmation\": [\"DELETE\", \"/itxrest/2/user/store/{storeId}/newsletter-confirmation\"],\n\t\t\t\"user:updateResetUserPassword\": [\"POST\", \"/itxrest/2/user/store/{storeId}/password-reset\"],\n\t\t\t\"user:contact\": [\"POST\", \"/itxrest/2/user/store/{storeId}/contact\"],\n\t\t\t\"user:receiveNotReceiveEInvoice\": [\"PUT\", \"/itxrest/2/user/store/{storeId}/orderId/{orderId}/einvoice\"],\n\t\t\t\"user:getPoliciesUser\": [\"POST\", \"/itxrest/2/user/store/{storeId}/policy\"],\n\t\t\t\"user:userAvailableData\": [\"GET\", \"/itxrest/2/user/store/{storeId}/availableData\"],\n\t\t\t\"user:validateSMSCode\": [\"POST\", \"/itxrest/2/user/store/{storeId}/validate\"],\n\t\t\t\"wallet:makeCardDefault\": [\"PUT\", \"/itxrest/2/wallet/store/{storeId}/make-default\"],\n\t\t\t\"wallet:deleteCard\": [\"DELETE\", \"/itxrest/2/wallet/store/{storeId}/card/{hash}\"],\n\t\t\t\"wallet:orderPreview\": [\"GET\", \"/itxrest/2/wallet/store/{storeId}/order-preview\"],\n\t\t\t\"wallet:walletInfo\": [\"GET\", \"/itxrest/2/wallet/store/{storeId}/order/{orderId}/wallet-info\"],\n\t\t\t\"wallet:getWalletCards\": [\"GET\", \"/itxrest/2/wallet/store/{storeId}/cards\"],\n\t\t\t\"wallet:getWalletCards2\": [\"POST\", \"/itxrest/2/wallet/store/{storeId}/cards2\"],\n\t\t\t\"wallet:saveWalletData\": [\"POST\", \"/itxrest/2/wallet/store/{storeId}/order/{orderId}/save-wallet-data\"],\n\t\t\t\"wallet:deleteWalletData\": [\"POST\", \"/itxrest/2/wallet/store/{storeId}/delete-wallet-data\"],\n\t\t\t\"wallet:paymentWalletQR\": [\"GET\", \"/itxrest/2/wallet/store/{storeId}/order/{orderId}/qr-payment-token\"],\n\t\t\t\"wallet:walletQRCards\": [\"GET\", \"/itxrest/2/wallet/store/{storeId}/order/{orderId}/qr-cards\"],\n\t\t\t\"wishList:addToWishList\": [\"POST\", \"/itxrest/2/wish/store/{storeId}/wishlist\"],\n\t\t\t\"wishList:updateWishList\": [\"PUT\", \"/itxrest/2/wish/store/{storeId}/wishlist\"],\n\t\t\t\"wishList:wishListByUser\": [\"GET\", \"/itxrest/2/wish/store/{storeId}/wishlist\"],\n\t\t\t\"wishList:wishListById\": [\"GET\", \"/itxrest/2/wish/store/{storeId}/wishlist/{wihsListId}/{userId}\"],\n\t\t\t\"wishList:addWishListToOrder\": [\"POST\", \"/itxrest/2/wish/store/{storeId}/wishlist/addorder\"],\n\t\t\t\"wishList:sendWishListByEmail\": [\"POST\", \"/itxrest/2/wish/store/{storeId}/wishlist/sendemail\"],\n\t\t\t\"sfi:banks\": [\"GET\", \"/itxrest/2/sfi/store/{storeId}/banks\"],\n\t\t\t\"cb:getCart\": [\"GET\", \"/2/store/{storeId}/order/cart\"],\n\t\t\t\"cb:safeCart\": [\"PUT\", \"/2/store/{storeId}/order/cart\"],\n\t\t\t\"cb:deleteCart\": [\"DELETE\", \"/2/store/{storeId}/order/cart\"],\n\t\t\t\"support:workgroups\": [\"GET\", \"/itxrest/2/support/store/{storeId}/chat/workGroups\"]\n\t\t};\n\t\t\n\t\tvar TS_CACHE = 600000;\n\t\t\n\t\tvar handleLocalStorageDesync = false;\n\t\t\n\t\tif (handleLocalStorageDesync && isLocalStorageSupported()) {\n\t\t\tif (getCookie(\"parentDomain\")) {\n\t\t\t\t//Si existe el parentDomain en la cookie pero no en el localStorage, o si el valor almacenado en la cookie es distinto al almacenado en el localStorage,\n\t\t\t\t//quiere decir que el navegador no está compartiendo el localStorage entre http y https.\n\t\t\t\tif (!localStorage.getItem(\"parentDomain\") || getCookie(\"parentDomain\") !== localStorage.getItem(\"parentDomain\")) {\n\t\t\t\t\tlocalStorage.removeItem(\"cache-shop-cart\");\n\t\t\t\t\tsetCookie(\"parentDomain\", document.referrer, undefined);\n\t\t\t\t\tlocalStorage.setItem(\"parentDomain\", document.referrer);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsetCookie(\"parentDomain\", document.referrer, undefined);\n\t\t\t\tlocalStorage.setItem(\"parentDomain\", document.referrer);\n\t\t\t}\n\t\t}\n\t\t\n\t\tvar isPersistCartCouchBaseEnabled = false;\n\t\tvar safeCartServiceTimeout = 5000;\n\t\t\n\t\tvar dummyUserJson = {\n\t\t\t    \"identity\": {\n\t\t\t        \"userId\": -1002,\n\t\t\t        \"WCToken\": null,\n\t\t\t        \"WCTrustedToken\": null,\n\t\t\t        \"WCPersistent\": null\n\t\t\t    },\n\t\t\t    \"primaryAddressId\": null,\n\t\t\t    \"email\": null,\n\t\t\t    \"firstName\": null,\n\t\t\t    \"middleName\": null,\n\t\t\t    \"lastName\": null,\n\t\t\t    \"userType\": \"G\",\n\t\t\t    \"isWalletUser\": null,\n\t\t\t    \"isShippingWalletValid\": null,\n\t\t\t    \"hasSecurePassword\": null,\n\t\t\t    \"userLanguage\": null,\n\t\t\t    \"rememberMe\": null,\n\t\t\t    \"shopCart\": {\n\t\t\t        \"id\": null,\n\t\t\t        \"isNoNexus\": null,\n\t\t\t        \"status\": null,\n\t\t\t        \"totalOrder\": null,\n\t\t\t        \"totalProduct\": null,\n\t\t\t        \"totalAdjustment\": null,\n\t\t\t        \"adjustment\": null,\n\t\t\t        \"promotion\": null,\n\t\t\t        \"tax\": null,\n\t\t\t        \"shippingPrice\": null,\n\t\t\t        \"shippingTax\": null,\n\t\t\t        \"items\": [],\n\t\t\t        \"taxArray\": null,\n\t\t\t        \"shippingTaxArray\": null\n\t\t\t    },\n\t\t\t    \"wishCart\": {\n\t\t\t        \"id\": null,\n\t\t\t        \"items\": []\n\t\t\t    },\n\t\t\t    \"pendingTransfers\": null,\n\t\t\t    \"restrictedBooking\": null,\n\t\t\t    \"personalDataLevel\": null,\n\t\t\t    \"isBuyer\": null\n\t\t\t};\n\t\t\n\t\tfunction message(event) {\n\t\t\t\n\t\t\tvar origin = event.origin;\n\t\t\tvar data = event.data;\n\t\t\t\n\t\t\tif (event.source == parent) {\n\t\t\t\t\n\t\t\t\tif (!(new RegExp(\"(http|https)://\" + location.hostname + \"(:[0-9]+)?\").test(origin))){\n\t      \t\t\treturn;\n\t      \t\t}\n\t      \t\t\t      \t\t\n\t\t\t\tonMessage(JSON.parse(data), function(json) {\n\t\t\t\t\twindow.parent.postMessage(JSON.stringify(json), origin);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction onMessage(json, callback) {\n\t      \tvar json;\n\t      \t\t\t\n\t      \tisPersistCartCouchBaseEnabled = json.iSafeCartEnabled;\t\t\n\t      \t\n\t      \tif ((json.action == \"set\") || (json.action == \"get\")) {\n\t      \t\tstorage(json, callback);\n\t      \t} else if (/^(http|https):/.test(json.action)) {\n\t      \t\tjson.url = json.action.replace(\"http:\", \"https:\");\n\t  \t\t\tjson.method = \"GET\";\n\t  \t\t\tajax(json, function(){\n\t      \t\t\tcallback(json);\n\t     \t\t});\n\t      \t} else if (restMap[json.action]) {\n\t      \t\tjson.sendRequest = true;\n\t      \t\tjson.status = 1;\n\t      \t\tprocessPreRestAction(json, function() {\n\t       \t\t\tjson.contentType = \"application/json\"; \n\t       \t\t\tif (json.sendRequest == true){\n\t\t        \t\trest(json, function(){ \n\t\t        \t\t\tprocessPostRestAction(json, function() {\n\t\t        \t\t\t\tcallback(json);\n\t\t        \t\t\t});\t\t \t\t        \t\t\t\t\n\t\t        \t\t});\n\t       \t\t\t} else {\n\t       \t\t\t\tprocessPostRestAction(json, function() {\n\t        \t\t\t\tcallback(json);\n\t        \t\t\t});\n\t       \t\t\t}\n\t       \t\t});\t        \t\t\t\t\n\t      \t} else {\n\t      \t\tjson.status = 0;\n\t\t\t\tjson.value = null;\n\t\t\t\tcallback(json);\n\t      \t}\n\t\t}\n\t\t\t\t\t\t\n\t\tfunction rest(request, finish) {\n\t\t\tvar url, t, k, v, params, flag, re, i;\n\t\t\t\n\t\t\tparams = request.params || {};\n\t\t\tif (request.appId) {\n\t\t\t\tparams.appId = request.appId;\n\t\t\t} else {\n\t\t\t\tparams.appId = appId;\n\t\t\t}\n\t\t\tif(request.js_return){\n\t\t\t\trequest.data.jsReturn = request.js_return\n\t\t\t}\n\t\n\t\t\turl = restMap[request.action][1];\n\t\t\t\n\t\t\twhile (t = PATTERN_VAR.exec(url)) {\n\t\t\t\tk = t[0].slice(1, -1);\n\t\t\t\tv = params[k];\n\t\t\t\t\n\t\t\t\tif (v == undefined) {\n\t\t\t\t\trequest.status = 404;\n\t\t\t\t\tif (typeof finish == \"function\"){\n\t\t\t\t\t\tfinish();\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\turl = url.replace(t[0], v);\n\t\t\t\tdelete params[k];\n\t\t\t}\n\t\t\t\n\t\t\tflag = true;\n\t\t\tfor (k in params) {\n\t\t\t\tif (typeof params[k] === \"object\") {\n\t\t\t\t\tt = params[k];\n\t\t\t\t} else {\n\t\t\t\t\tt = [params[k]];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor (i = 0; i < t.length; i++) {\n\t\t\t\t\turl += flag ? \"?\" : \"&\";\n\t\t\t\t\tflag = false;\n\t\t\t\t\turl += encodeURIComponent(k);\n\t\t\t\t\turl += \"=\";\n\t\t\t\t\turl += encodeURIComponent(t[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\trequest.url = url;\n\t\t\trequest.method = restMap[request.action][0];\t\t\t\t\t\n\t\t\tajax(request, function(){\n\t\t\t\t//Miramos si es un error de sesi�n expirada y redirigimos a la p�gina de sesi�n expirada\n\t\t\t\tif (request.value && request.value.code && request.value.code == 4){\n\t\t\t\t\trequest.sessionExpired = true;\t\t\t\t\t\n\t\t\t\t\tdummyUserJson.storeId = request.storeId;\n\t\t\t\t\tdummyUserJson.timestamp = 0;\n\t\t\t\t\trequest.userJSON = dummyUserJson;\n\t\t\t\t\tsetSessionStorage(\"cache-current-user\", dummyUserJson);\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (typeof finish == \"function\"){\n\t\t\t\t\tfinish();\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t}\n\t\n\t\tfunction ajax(request, finish){\n\t\t\tvar xmlhttp, type, k;\n\t\n\t\t\txmlhttp = new XMLHttpRequest();\n\t\t\txmlhttp.open(request.method, request.url);\n\t\t\tif (request.contentType) {\n\t\t\t\txmlhttp.setRequestHeader(\"Content-type\", request.contentType);\n\t\t\t}\n\t\t\tif (request.timeout) {\n\t\t\t\txmlhttp.timeout = request.timeout;\n\t\t\t}\n\t\t\t\n\t\t\txmlhttp.onreadystatechange = function(){\n\t\t\t\t\n\t\t\t\tif (xmlhttp.readyState == 4) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif ((xmlhttp.status == 200) || (xmlhttp.status == 201) || (xmlhttp.status == 202)) {\n\t\t\t\t\t\t\trequest.status = 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trequest.status = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\ttype = xmlhttp.getResponseHeader('Content-type');\n\t\t\t\t\t\tif (type && (type.indexOf(\"json\") != -1)) {\n\t\t\t\t\t\t\t\trequest.value = JSON.parse(xmlhttp.responseText);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trequest.value = xmlhttp.responseText;\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\trequest.status = 0;\n\t\t\t\t\t\trequest.value = null;\n\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\tif (typeof finish == \"function\"){\n\t\t\t\t\t\tfinish();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\t\t\tif (request.headers){\n\t\t\t\tfor(k in request.headers){\n\t\t\t\t\txmlhttp.setRequestHeader(k, request.headers[k]);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif (request.data){\n\t\t\t\txmlhttp.send(JSON.stringify(request.data));\n\t\t\t} else {\n\t\t\t\txmlhttp.send();\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\t//INICIO - Gestion casos especiales\n\t\tfunction processPreRestAction(json, finish){\n\t\t\t\n\t\t\tvar pendingData = getPendingData(json.storeId);\n\t\t\t\n\t\t\tif ((json.action == \"user:login\")\n\t\t\t\t|| (json.action == \"user:register\")\n\t\t\t\t|| (json.action == \"user:logout\")\n\t\t\t\t|| (json.action == \"wishList:wishListByUser\")\n\t\t\t\t|| (json.action == \"wishList:wishListById\")) {\n\t\t\t\tif (isPersistCartCouchBaseEnabled && (json.action == \"user:login\")) {\n\t\t\t\t\tfinish();\n\t\t\t\t} else {\n\t\t\t\t\tpersistCartsToServer(pendingData, json, function(){\n\t\t\t\t\t\tfinish();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else if (json.action == \"user:currentUser\") {\t\t\t\t\t\t\t\n\t\t\t\tprocessCurrentUser(pendingData, json, function(){\n\t\t\t\t\tjson.sendRequest = false;\n\t\t\t\t\tjson.value = json.userJSON;\n\t\t\t\t\tfinish();\n\t\t\t\t});\n\t\t\t} else if (json.action == \"order:shoppingCart\"\n\t\t\t\t\t|| json.action == \"order:miniCart\") {\t\t\t\t\t\t\t\n\t\t\t\tprocessShoppingCart(pendingData, json, function(){\n\t\t\t\t\tjson.sendRequest = false;\n\t\t\t\t\tjson.value = json.shopCartJSON;\n\t\t\t\t\tfinish();\n\t\t\t\t});\n\t\t\t} else if (json.action == \"order:addToCart\") {\t\t\t\t\t\t\t\n\t\t\t\tproccessAddToCart(\"shopCart\", json, pendingData, function(){\n\t\t\t\t\tjson.sendRequest = false;\n\t\t\t\t\tfinish();\n\t\t\t\t});\n\t\t\t} else if (json.action == \"wishList:addToWishList\") {\n\t\t\t\tproccessAddToCart(\"wishCart\", json, pendingData, function(){\n\t\t\t\t\tjson.sendRequest = false;\n\t\t\t\t\tfinish();\n\t\t\t\t});\n\t\t\t} else if (json.action == \"catalog:productDetail\") {\n\t\t\t\t if (json.params && json.params.categoryId) {\n\t\t\t\t \tjson.params.categoryId = 0;\n\t\t\t\t }\n\t\t\t\t finish();\n\t\t\t}else {\n\t\t\t\tfinish();\n\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\n\t\t}\n\t\t\n\t\tfunction processPostRestAction(json, finish){\n\t\t\t\n\t\t\tvar callbacks = [];\n\t\t\t\n\t\t\tif ((json.updateUserJson)\n\t\t\t\t\t|| (json.action == \"user:register\")\t\t\t\t\n\t\t\t\t\t|| (json.action == \"user:logout\")\t\t\t\t\t\t\t\t\n\t\t\t\t\t|| (json.action == \"user:updateUserEmail\")\n\t\t\t\t\t|| (json.action == \"user:addUpdateAddress\")\n\t\t\t\t\t|| (json.action == \"wallet:deleteCard\")\n\t\t\t\t\t|| (json.action == \"wallet:saveWalletData\")\n\t\t\t\t\t|| (json.action == \"wallet:deleteWalletData\")\t\t\t\t\n\t\t\t\t\t|| (json.action == \"wishList:updateWishList\")\n\t\t\t\t\t|| (json.action == \"giftCard:addPhysicalGiftCardToShopCart\")\n\t\t\t\t\t|| (json.action == \"giftCard:addVirtualGiftCardToShopCart\")\n\t\t\t\t\t|| (json.action == \"user:deleteAddress\")\n\t\t\t\t\t|| (json.action == \"user:updateUserPassword\")){\t\t\t\t\n\t\t\t\tcallbacks.push( function(json, onFinish) {\n\t\t\t\t\t\tgetFromServer(\"userJSON\", json, function(){\n\t\t\t\t\t\t\tprocessUserJSON(json.userJSON, json.storeId);\n\t\t\t\t\t\t\tif(json.updateShopCart) {\n\t\t\t\t\t\t\t\tprocessShopCartJSON(json.userJSON.shopCart, json.storeId);\n\t\t\t\t\t\t\t\tjson.value = json.userJSON.shopCart;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tonFinish();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t} \n\t\t\t\n\t\t\tif (json.action == \"user:login\") {\n\t\t\t\tif (isPersistCartCouchBaseEnabled && json.value.identity) {\n\t\t\t\t\tcallbacks.push( function(json, onFinish) {\n\t\t\t\t\t\tgetCartFromCouchBase(json.value.identity.userId, json.storeId, function(couchBaseJson) {\n\t\t\t\t\t\t\tif (couchBaseJson && couchBaseJson.shopCart && couchBaseJson.wishCart) {\n\t\t\t\t\t\t\t\tvar pendingData = getPendingData(json.storeId);\n\t\t\t\t\t\t\t\tupdateItemsCart(pendingData, \"shopCart\", couchBaseJson.shopCart.items);\n\t\t\t\t\t\t\t\tupdateItemsCart(pendingData, \"wishCart\", couchBaseJson.wishCart.items);\n\t\t\t\t\t\t\t\tpersistCartsToServer(pendingData, json, function(){\n\t\t\t\t\t\t\t\t\tdeleteCartFromCouchBase(json.value.identity.userId, json.storeId, function(){\n\t\t\t\t\t\t\t\t\t\tgetFromServer(\"userJSON\", json, function(){\n\t\t\t\t\t\t\t\t\t\t\tprocessUserJSON(json.userJSON, json.storeId);\n\t\t\t\t\t\t\t\t\t\t\tif(json.updateShopCart) {\n\t\t\t\t\t\t\t\t\t\t\t\tprocessShopCartJSON(json.userJSON.shopCart, json.storeId);\n\t\t\t\t\t\t\t\t\t\t\t\tjson.value = json.userJSON.shopCart;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tonFinish();\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (json.status == 1) {\n\t\t\t\t\t\t\t\t\tjson.userJSON = json.value;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tprocessUserJSON(json.userJSON, json.storeId);\n\t\t\t\t\t\t\t\tif(json.updateShopCart) {\n\t\t\t\t\t\t\t\t\tprocessShopCartJSON(json.userJSON.shopCart, json.storeId);\n\t\t\t\t\t\t\t\t\tjson.value = json.userJSON.shopCart;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tonFinish();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tcallbacks.push( function(json, onFinish) {\n\t\t\t\t\t\tif (json.status == 1) {\n\t\t\t\t\t\t\tjson.userJSON = json.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tprocessUserJSON(json.userJSON, json.storeId);\n\t\t\t\t\t\tif(json.updateShopCart) {\n\t\t\t\t\t\t\tprocessShopCartJSON(json.userJSON.shopCart, json.storeId);\n\t\t\t\t\t\t\tjson.value = json.userJSON.shopCart;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonFinish();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif (json.updateShopCart && !json.updateUserJson){\n\t\t\t\tcallbacks.push( function(json, onFinish){\n\t\t\t\t\t//Actualizo el JSON desde el servidor\n\t\t\t\t\tgetFromServer(\"shopCartJSON\", json, function(){\n\t\t\t\t\t\tprocessShopCartJSON(json.shopCartJSON, json.storeId);\n\t\t\t\t\t\tjson.userJSON = getSessionStorage(\"cache-current-user\");\n\t\t\t\t\t\tjson.value = json.shopCartJSON;\n\t\t\t\t\t\tonFinish();\n\t\t\t\t\t}); \n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tif ((json.action == \"order:updateCart\")\n\t\t\t\t|| (json.action == \"order:deleteFromCart\")){\n\t\t\t\tcallbacks.push( function(json, onFinish) {\n\t\t\t\t\t//Se hace un current-user para traer lo que tengamos \n\t\t\t\t\t// en el carrito persistido.\n\t\t\t\t    var pendingData = getLocalStorage(\"cache-pending-data\");\n\t\t\t\t    var shopCartJSON = getLocalStorage(\"cache-shop-cart\");\t\n\t\t\t\t    //comprobamos que no hay ningun articulo sin pesistir. Si\n\t\t\t\t    // es asi, se persiste el carrito.\n\t\t\t\t\tif(pendingData!=null && (shopCartJSON != null && pendingData.timestamp != shopCartJSON.timestamp)) {\n\t\t\t\t\t\t\tshopCartJSON.timestamp = 1;\n\t\t\t\t\t\t\tprocessShoppingCart(pendingData, shopCartJSON, function(){\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t//Ahora que el carrito está persistido, nos traemos\n\t\t\t\t\t// el usuario con el carrito actualizado.\n\t\t\t\t\tgetFromServer(\"userJSON\", json, function(){\n\t\t\t\t\t\tprocessUserJSON(json.userJSON, json.storeId);\n\t\t\t\t\t\tvar shopCartJSON = json.userJSON.shopCart;\n\t\t\t\t\t\tvar pendingData = getLocalStorage(\"cache-pending-data\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tsetLocalStorage(\"cache-shop-cart\", shopCartJSON);\t\t\t\t\t\t\n\t\t\t\t\t\tif (pendingData) {\n\t\t\t\t\t\t\tpendingData.timestamp = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetLocalStorage(\"cache-pending-data\", pendingData);\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\tprocessShopCartJSON(shopCartJSON, json.storeId);\n\t\t\t\t\t\tonFinish();\n\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\tif ((json.action == \"order:addGiftpacking\")\n\t\t\t\t|| (json.action == \"order:getGiftTicket\")\n\t\t\t\t|| (json.action == \"order:deleteGiftPacking\")\n\t\t\t\t|| (json.action == \"order:cardsAdjustments\")\n\t\t\t\t|| (json.action == \"order:deleteCardsAdjustments\")\t\t\t\t\n\t\t\t\t|| (json.action == \"order:orderConfirmation\")\n\t\t\t\t|| (json.action == \"order:addPromoCode\")\n\t\t\t\t|| (json.action == \"giftCard:updatePhysicalGiftCardData\")\n\t\t\t\t|| (json.action == \"giftCard:updateVirtualGiftCardData\")\n\t\t\t\t|| (json.action == \"giftCard:addPhysicalGiftCardToShopCart\")\n\t\t\t\t|| (json.action == \"giftCard:addVirtualGiftCardToShopCart\")\n\t\t\t\t|| (json.action == \"wishList:addWishListToOrder\")\n\t\t\t\t|| (json.action == \"order:asyncRepay\")\n\t\t\t\t|| (json.action == \"order:checkoutShipping\")\n\t\t\t\t|| (json.action == \"order:deletePromoCode\")\n\t\t\t\t|| (json.action == \"order:paymentStatus\")\n\t\t\t\t|| (json.action == \"order:unboundPayment\")\n\t\t\t\t|| (json.action == \"wallet:orderPreview\")\n\t\t\t\t|| (json.action == \"user:login\")\n\t\t\t\t|| (json.action == \"user:register\")\t\t\t\t\n\t\t\t\t|| (json.action == \"user:logout\")){\n\t\t\t\tcallbacks.push( function(json, onFinish){\n\t\t\t\t\t//Solo actualizo el timestamp\n\t\t\t\t\tvar shopCartJSON = getLocalStorage(\"cache-shop-cart\");\n\t\t\t\t\tif (shopCartJSON){\n\t\t\t\t\t\tshopCartJSON.timestamp = 0;\n\t\t\t\t\t\tsetLocalStorage(\"cache-shop-cart\", shopCartJSON);\n\t\t\t\t\t}\n\t\t\t\t\tonFinish();\n\t\t\t\t});\n\t\t\t} \t\t\t\n\t\t\t\n\t\t\tprocessCallbacks(callbacks, json, finish);\n\t\t\t\n\t\t}\n\t\t\n\t\tfunction processCallbacks(callbacks, json, finish){\n\t\t\tif (callbacks.length > 0){\n\t\t\t\tvar callback = callbacks.shift();\n\t\t\t\tif (typeof callback === \"function\"){\n\t\t\t\t\tcallback(json, function(){\n\t\t\t\t\t\tprocessCallbacks(callbacks, json, finish)\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfinish();\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\tfunction persistCartsToServer(pendingData, json, finish){\n\t\t\tpersistCartToServer(\"shopCart\", pendingData, json, function (){\n\t\t\t\tpersistCartToServer(\"wishCart\", pendingData, json, function (){\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\tif (isPersistCartCouchBaseEnabled) {\n\t\t\t\t\t\tvar\tuserJSON = getSessionStorage(\"cache-current-user\");\n\t\t\t\t\t\tif (userJSON && userJSON.userType === \"R\") {\n\t\t\t\t\t\t\tdeleteCartFromCouchBase(userJSON.identity.userId, json.storeId, finish);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfinish();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfinish();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\t\n\t\t}\n\t\t\n\t\tfunction persistCartToServer(typeCart, pendingData, json, finish){\n\t\n\t\t\tvar cart = {\n\t\t\t\t\t\"cartItems\": []\n\t\t\t\t\t};\t\t\t\t\t\n\t\t\t\n\t\t\tfor (var i = 0; i< pendingData[typeCart].items.length; i++){\n\t\t\t\tvar item = {\n\t\t\t\t\t\"sku\": pendingData[typeCart].items[i].sku,\n\t\t\t\t\t\"quantity\": pendingData[typeCart].items[i].quantity,\n\t\t\t\t\t\"categoryId\": pendingData[typeCart].items[i].categoryId,\n\t\t\t\t\t\"categoryType\": pendingData[typeCart].items[i].categoryType,\n\t\t\t\t\t\"parentId\": pendingData[typeCart].items[i].parentId,\n\t\t\t\t\t\"productId\": pendingData[typeCart].items[i].productId,\n\t\t\t\t\t\"style\": pendingData[typeCart].items[i].style,\n\t\t\t\t\t\"color\": pendingData[typeCart].items[i].color\n\t\t\t\t};\n\t\t\t\tcart.cartItems.push(item);\n\t\t\t}\t\t\t\t\t\t\t\t\n\t\t\t//A�adimos los items actuales (si hay)\n\t\t\tif (((typeCart === \"shopCart\" && json.action === \"order:addToCart\") || (typeCart === \"wishCart\" && json.action === \"wishList:addToWishList\")) && json !=null && json.data!=null && json.data.cartItems!=null && json.data.cartItems.length>0){\n\t\t\t\t\n\t\t\t\tfor (var i = 0; i<json.data.cartItems.length; i++){\n\t\t\t\t\tcart.cartItems.push({\n\t\t\t\t\t\t\"sku\": json.data.cartItems[i].sku,\n\t\t\t\t\t\t\"quantity\": json.data.cartItems[i].quantity,\n\t\t\t\t\t\t\"categoryId\": json.data.cartItems[i].categoryId,\n\t\t\t\t\t\t\"categoryType\": json.data.cartItems[i].categoryType,\n\t\t\t\t\t\t\"parentId\": json.data.cartItems[i].parentId,\n\t\t\t\t\t\t\"productId\": json.data.cartItems[i].productId,\n\t\t\t\t\t\t\"style\": json.data.cartItems[i].style,\n\t\t\t\t\t\t\"color\": json.data.cartItems[i].color\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\t\t\n\t\t\t\n\t\t\tif (cart.cartItems.length>0){\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\n\t\t\t\tvar action = null;\n\t\t\t\t\n\t\t\t\t//Delete the pending data from the current cart localStorage\n\t\t\t\tpendingData[typeCart] = {\"items\":[]};\t\t\t\t\t\n\t\t\t\tsetLocalStorage(\"cache-pending-data\", pendingData);\n\t\t\t\t\n\t\t\t\tif (typeCart == \"wishCart\"){\n\t\t\t\t\taction = \"wishList:addToWishList\";\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (typeCart == \"shopCart\"){\n\t\t\t\t\taction = \"order:addToCart\";\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//Needs to user json\n\t\t\t\tjson.updateUserJson = true;\n\t\t\t\t\n\t\t\t\t//Persisto los datos de la cesta de la compra\t\t\n\t\t\t\tvar myData = {\n\t\t\t\t\t\t\"action\": action,\n\t\t\t\t\t\t\"params\": {\n\t\t\t\t\t\t\t\"storeId\": json.storeId,\n\t\t\t\t\t\t\t\"languageId\": json.languageId ? json.languageId : -1\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\"data\": cart\n\t\t\t\t\t};\n\t\t\t\t\n\t\t\t\tmyData.contentType = \"application/json\";\n\t\t\t\t\t\n\t\t\t\trest(myData, function(){\t\t\t\t\t\n\t\t\t\t\tfinish();\t\t\t\t\t\t\t    \t\t\t\t\t\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tfinish();\n\t\t\t}\n\t\t};\n\t\t\n\t\t\n\t\tfunction getFromServer(jsonName, json, finish){\n\t\t\t//Recuperamos el JSON del servidor\n\t\t\t\n\t\t\tvar action = null;\n\t\t\t\n\t\t\tif (jsonName === \"userJSON\"){\n\t\t\t\taction = \"user:currentUser\";\n\t\t\t} else if (jsonName === \"shopCartJSON\") {\n\t\t\t\taction = \"order:shoppingCart\";\n\t\t\t}\n\t\t\t\n\t\t\tvar myData = {\n\t\t\t\t\t\"action\": action,\n\t\t\t\t\t\"params\": {\n\t\t\t\t\t\t\"storeId\": json.storeId,\n\t\t\t\t\t\t\"languageId\": json.languageId,\n\t\t\t\t\t\t\"ts\": new Date().getTime()\n\t\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\n\t\t\tmyData.contentType = \"application/json\";\n\t\t\t\t\n\t\t\trest(myData, function(){\n\t\t\t\tif (myData.status == 1){\n\t\t\t\t\tjson[jsonName] = myData.value;\n\t\t\t\t\tjson[jsonName].storeId = json.storeId;\n\t\t\t\t\tjson[jsonName].timestamp = new Date().getTime();\n\t\t\t\t\tif (jsonName === \"userJSON\"){\n\t\t\t\t\t\tsetSessionStorage(\"cache-current-user\", json[jsonName]);\n\t\t\t\t\t} else if (jsonName === \"shopCartJSON\") {\n\t\t\t\t\t\tsetLocalStorage(\"cache-shop-cart\", json[jsonName]);\t\t\t\t\t\t\n\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tfinish();\n\t\t\t});\n\t\t}\n\t\t\n\t\tfunction persistCartToCouchBase(userId, pendingData, storeId, finish){\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\n\t\t\tvar action = \"cb:safeCart\";\n\t\t\t\n\t\t\t//Persisto los datos de la cesta de la compra\t\t\n\t\t\tvar myData = {\n\t\t\t\t\"action\": action,\n\t\t\t\t\"params\": {\n\t\t\t\t\t\"userId\": userId,\n\t\t\t\t\t\"storeId\": storeId\n\t\t\t\t},\n\t\t\t\t\"data\": pendingData,\n\t\t\t\t\"timeout\": safeCartServiceTimeout\n\t\t\t};\n\t\t\t\n\t\t\tmyData.contentType = \"application/json\";\n\t\t\t\t\n\t\t\trest(myData, function(){\n\t\t\t\tfinish();\n\t\t\t});\n\t\t};\n\t\t\n\t\tfunction getCartFromCouchBase(userId, storeId, finish){\n\t\t\t\n\t\t\tvar action = \"cb:getCart\";\n\t\t\t\n\t\t\tvar myData = {\n\t\t\t\t\"action\": action,\n\t\t\t\t\"params\": {\n\t\t\t\t\t\"userId\": userId,\n\t\t\t\t\t\"storeId\": storeId\n\t\t\t\t},\n\t\t\t\t\"timeout\": safeCartServiceTimeout\n\t\t\t};\n\t\t\t\n\t\t\tmyData.contentType = \"application/json\";\n\t\t\t\t\n\t\t\trest(myData, function(){\n\t\t\t\tfinish(myData.value);\n\t\t\t});\n\t\t};\n\t\t\n\t\tfunction deleteCartFromCouchBase(userId, storeId, finish){\n\t\t\t\n\t\t\tvar action = \"cb:deleteCart\";\n\t\t\t\n\t\t\tvar myData = {\n\t\t\t\t\"action\": action,\n\t\t\t\t\"params\": {\n\t\t\t\t\t\"userId\": userId,\n\t\t\t\t\t\"storeId\": storeId\n\t\t\t\t},\n\t\t\t\t\"timeout\": safeCartServiceTimeout\n\t\t\t};\n\t\t\t\n\t\t\tmyData.contentType = \"application/json\";\n\t\t\t\t\n\t\t\trest(myData, function(){\n\t\t\t\tfinish();\n\t\t\t});\n\t\t};\n\t\t\n\t\tfunction updateCouchBaseCart(pendingData, userJSON, typeCart, itemsAdded, finish){\n\t\t\tif (userJSON && userJSON.userType === \"R\") {\n\t\t\t\tgetCartFromCouchBase(userJSON.identity.userId, userJSON.storeId, function(couchBaseJson) {\n\t\t\t\t\tif (couchBaseJson && couchBaseJson[typeCart]) {\n\t\t\t\t\t\tupdateItemsCart(couchBaseJson, typeCart, itemsAdded);\n\t\t\t\t\t\tupdateItemsCartFromCouchBase(pendingData, typeCart, couchBaseJson[typeCart].items);\n\t\t\t\t\t\tupdateItemsCartFromCouchBase(userJSON, typeCart, couchBaseJson[typeCart].items);\n\t\t\t\t\t\tupdateTimestampForJSONs([userJSON, pendingData], new Date().getTime());\n\t\t\t\t\t\tstoreCacheJSONs(pendingData, userJSON);\n\t\t\t\t\t} \n\t\t\t\t\tpersistCartToCouchBase(userJSON.identity.userId, pendingData, userJSON.storeId, function() {\n\t\t\t\t\t\tfinish();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tfinish();\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction updateItemsCart(value, cartType, cartItems){\n\t\t\t\n\t\t\tvar found = false;\n\t\t\tif (cartItems!=null && cartItems.length>0 && value != null && value[cartType] != null && value[cartType].items != null){\n\t\t\t\t//Buscamos a ver si estaba a�adido en el array\n\t\t\t\tvar cart = value[cartType];\n\t\t\t\tfor (var i = 0; i< cartItems.length; i++){\n\t\t\t\t\tfor (var j = 0 ; j < cart.items.length; j++) {\n\t\t\t\t\t\tif (cartItems[i].sku == cart.items[j].sku){\n\t\t\t\t\t\t\tcart.items[j].quantity += cartItems[i].quantity;\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\tif (cart.items[j].quantity == 0){\n\t\t\t\t\t\t\t\t//Eliminamos el item del array\n\t\t\t\t\t\t\t\tcart.items.splice(j,1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!found){\n\t\t\t\t\t\t//A�adimos item al array\n\t\t\t\t\t\tvalue[cartType].items.push(cartItems[i]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfound = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvalue[cartType] = {\"items\" : []};\n\t\t\t}\t\t\t\n\t\t};\n\t\t\n\t\tfunction updateItemsCartFromCouchBase(value, cartType, cartItems){\n\t\t\t\n\t\t\tvar found = false;\n\t\t\tif (cartItems!=null && cartItems.length>0 && value != null && value[cartType] != null && value[cartType].items != null){\n\t\t\t\tvar cart = value[cartType];\n\t\t\t\tfor (var i = 0; i< cartItems.length; i++){\n\t\t\t\t\tfor (var j = 0 ; j < cart.items.length; j++) {\n\t\t\t\t\t\tif (cartItems[i].sku == cart.items[j].sku){\n\t\t\t\t\t\t\tcart.items[j].quantity = cartItems[i].quantity;\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!found){\n\t\t\t\t\t\tvalue[cartType].items.push(cartItems[i]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfound = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvalue[cartType] = {\"items\" : []};\n\t\t\t}\t\t\t\n\t\t};\n\t\t\n\t\tfunction updateTimestampForJSONs(jsonArray, timestamp){\t\t\t\n\t\t\t\n\t\t\tfor (var i = 0; i< jsonArray.length; i++){\n\t\t\t\tif (jsonArray[i]){\n\t\t\t\t\tjsonArray[i].timestamp = timestamp;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t\n\t\tfunction storeCacheJSONs(pendingData, userJSON, shopCartJSON){\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\tif (pendingData){\n\t\t\t\tsetLocalStorage(\"cache-pending-data\", pendingData);\n\t\t\t}\n\t\t\tif (userJSON){\n\t\t\t\tsetSessionStorage(\"cache-current-user\", userJSON);\n\t\t\t}\n\t\t\tif (shopCartJSON){\n\t\t\t\tsetLocalStorage(\"cache-shop-cart\", shopCartJSON);\n\t\t\t}\n\t\t};\n\t\t\n\t\tfunction proccessAddToCart(typeCart, json, pendingData, finish){\n\t\t\t\n\t\t\tvar\tuserJSON = getSessionStorage(\"cache-current-user\");\n\t\t\t\t\t\t\t\t\n\t\t\tjson.userJSON = userJSON;\n\t\t\t\n\t\t\tif (pendingData!=null && pendingData.storeId == json.storeId && userJSON!=null\n\t\t\t\t\t&& pendingData.timestamp == userJSON.timestamp) {\t\t\t\t\t\t\n\t\t\t\t//Es una operaci�n de a�adir a la cesta\n\t\t\t\t\tif (json.data!=null){\n\t\t\t\t\t\t\n\t\t\t\t\t\t//actualizamos JSON de usuario\n\t\t\t\t\t\tupdateItemsCart(userJSON, typeCart, json.data.cartItems);\n\t\t\t\t\t\t//actualizamos pending Data\n\t\t\t\t\t\tupdateItemsCart(pendingData, typeCart, json.data.cartItems);\n\t\t\t\t\n\t\t\t\t\t\tupdateTimestampForJSONs([userJSON, pendingData], new Date().getTime());\n\t\t\t\t\t\tif (userJSON) {\n\t\t\t\t\t\t\tuserJSON.storeId = json.storeId;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstoreCacheJSONs(pendingData, userJSON);\n\t\t\t\t\t\tif (isPersistCartCouchBaseEnabled) {\n\t\t\t\t\t\t\tupdateCouchBaseCart(pendingData, userJSON, typeCart, json.data.cartItems, finish);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfinish();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfinish();\n\t\t\t\t\t}\t\t\t\t\t\t\n\t\t\t} else {\n\t\t\t\tif ((pendingData!=null && pendingData.storeId == json.storeId && \n\t\t\t\t\t\tuserJSON!=null && pendingData.timestamp != userJSON.timestamp) || (userJSON == null)){\n\t\t\t\t\tpersistCartsToServer(pendingData, json, function() {\n\t\t\t\t\t\tupdateTimestampForJSONs([userJSON, pendingData], new Date().getTime());\n\t\t\t\t\t\tif (userJSON) {\n\t\t\t\t\t\t\tuserJSON.storeId = json.storeId;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstoreCacheJSONs(pendingData, userJSON);\n\t\t\t\t\t\tfinish();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction getLocalStorage(key){\n\t\t\ttry{\n\t\t\t\treturn JSON.parse(localStorage.getItem(key));\n\t\t\t} catch (e){\t\t\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction setLocalStorage(key, value){\n\t\t\ttry {\n\t\t\t\tlocalStorage.setItem(key, JSON.stringify(value));\t\t\t\t\t\t\n\t\t\t} catch (err) {\t\t\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction isLocalStorageSupported(){\n\t\t\ttry {\n\t\t\t\tlocalStorage.setItem('test', 'test');\n\t\t\t\tlocalStorage.removeItem('test');\n\t\t\t\treturn true;\t\t\t\t\t\t\n\t\t\t} catch (err) {\t\t\t\t\t\t\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction getSessionStorage(key){\n\t\t\ttry{\n\t\t\t\treturn JSON.parse(sessionStorage.getItem(key));\n\t\t\t} catch (e){\t\t\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction setSessionStorage(key, value){\n\t\t\ttry{\n\t\t\t\tsessionStorage.setItem(key, JSON.stringify(value));\n\t\t\t} catch (e){\t\t\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction getCookie(name) {\n\t\t\tvar cookies = document.cookie.split(\";\");\n\t\t\tvar i, key, value, index;\n\t\t\n\t\t\tfor (i = 0; i < cookies.length; i++) {\n\t\t\t\tindex = cookies[i].indexOf(\"=\");\n\t\t\t\tkey = cookies[i].substr(0, index).replace(/^\\s+|\\s+$/g, \"\");\n\t\t\t\tvalue = cookies[i].substr(index + 1);\n\t\t\t\tif (key == name) {\n\t\t\t\t\treturn decodeURIComponent(value);\n\t\t\t\t}\n\t\t\t}\n\t\t\n\t\t\treturn null;\n\t\t};\n\t\t\n\t\tfunction setCookie(name, data, expiresIn) {\n\t\t\tvar expires;\n\t\t\tif (expiresIn != undefined) {\n\t\t\t\tvar date = new Date();\n\t\t\t\tdate.setTime(date.getTime() + (expiresIn * 24 * 60 * 60 * 1000));\n\t\t\t\texpires = \"; expires=\" + date.toGMTString();\n\t\t\t}\n\t\t\tif (expires != undefined) {\n\t\t\t\tdocument.cookie = name + \"=\" + encodeURIComponent(data) + expires + \"; path=/\";\n\t\t\t} else {\n\t\t\t\tdocument.cookie = name + \"=\" + encodeURIComponent(data) + \"; path=/\";\n\t\t\t}\n\t\t};\n\t\t\n\t\tfunction getPendingData(storeId) {\n\t\t\tvar dummyPendingData = {\n\t\t\t\t\t\"timestamp\" : new Date().getTime(),\n\t\t\t\t\t\"storeId\": storeId,\n\t\t\t\t\t\"shopCart\": {\"items\": []},\n\t\t\t\t\t\"wishCart\": {\"items\": []}\n\t\t\t\t};\n\t\t\t\n\t\t\tvar pendingData = getLocalStorage(\"cache-pending-data\");\n\t\t\tif (null == pendingData || pendingData.storeId != storeId) {\n\t\t\t\tpendingData = dummyPendingData;\n\t\t\t}\n\t\t\t\n\t\t\treturn pendingData;\n\t\t}\n\t\t\n\t\tfunction getLocalCartJSON(storeId) {\n\t\t\tvar dummyCartJSON = {  \n\t\t\t\t\t   \"timestamp\":0\n\t\t\t\t\t};\n\t\t\t\n\t\t\tvar cartJSON = getLocalStorage(\"cache-shop-cart\");\n\t\t\tif (null == cartJSON || cartJSON.storeId != storeId) {\n\t\t\t\tcartJSON = dummyCartJSON;\n\t\t\t}\n\t\t\t\n\t\t\treturn cartJSON;\n\t\t}\n\t\t\n\t\tfunction getLocalUserJSON(storeId) {\n\t\t\tvar userJSON = getLocalStorage(\"cache-current-user\");\n\t\t\tif (null == userJSON || userJSON.storeId != storeId) {\n\t\t\t\tuserJSON = dummyUserJson;\n\t\t\t}\n\t\t\t\n\t\t\treturn userJSON;\n\t\t}\n\t\t\t\t\n\n\t\t\n\t\tfunction processShoppingCart(pendingData, json, finish){\n\t\t\t\n\t\t\tvar shopCartJSON = getLocalStorage(\"cache-shop-cart\");\n\t\t\t\n\t\t\tif (!shopCartJSON){\n\t\t\t\tshopCartJSON = {};\n\t\t\t}\n\t\t\t\n\t\t\tif (pendingData!=null && (shopCartJSON != null && pendingData.timestamp != shopCartJSON.timestamp)){\n\t\t\t\tpersistCartsToServer(pendingData, json, function() {\n\t\t\t\t\tjson.updateShopCart = true;\t\t\t\t\t\n\t\t\t\t\tfinish();\n\t\t\t\t});\n\t\t\t} else {\t\t\t\t\n\t\t\t\tif (shopCartJSON != null && ((new Date().getTime() - shopCartJSON.timestamp) < TS_CACHE) && (shopCartJSON.storeId == json.storeId)) {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\tjson.shopCartJSON = shopCartJSON;\n\t\t\t\t\tfinish();\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\tjson.updateShopCart = true;\n\t\t\t\t\tfinish();\n\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t}\t\t\t\n\t\t}\t\t\n\t\t\n\t\tfunction processCurrentUser(pendingData, json, finish){\t\n\t\t\t\n\t\t\tvar userJSON = getSessionStorage(\"cache-current-user\");\n\t\t\tif (!userJSON){\n\t\t\t\tuserJSON = {};\n\t\t\t}\n\t\t\t\n\t\t\tif (pendingData!=null && (userJSON != null && pendingData.timestamp != userJSON.timestamp)){\t\t\t\t\n\t\t\t\tpersistCartsToServer(pendingData, json, function() {\n \t\t\t\t\tjson.updateUserJson = true;\n\t\t\t\t\tfinish();\n\t\t\t\t});\n\t\t\t} else {\t\t\t\t\n\t\t\t\tif (userJSON != null && ((new Date().getTime() - userJSON.timestamp) < TS_CACHE) && (userJSON.storeId == json.storeId)){\t\t\t\t\t\t\t\n\t\t\t\t\tjson.userJSON = userJSON;\n\t\t\t\t\tfinish();\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\tjson.updateUserJson = true;\n\t\t\t\t\tfinish();\n\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t}\t\t\t\n\t\t}\n\t\t\n\t\tfunction processUserJSON(userJSON, storeId){\n\t\t\tpendingData = getPendingData(storeId);\n\t\t\tvar timestamp = new Date().getTime();\n\t\t\tif ((new Date().getTime() - pendingData.timestamp) < TS_CACHE){\n\t\t\t\ttimestamp = pendingData.timestamp;\n\t\t\t}\n\t\t\tupdateTimestampForJSONs([userJSON, pendingData], timestamp);\n\t\t\tif (userJSON) {\n\t\t\t\tuserJSON.storeId = storeId;\n\t\t\t}\n\t\t\tstoreCacheJSONs(pendingData, userJSON);\t\n\t\t};\n\t\t\n\t\t\n\t\tfunction processShopCartJSON(shopCartJSON, storeId){\n\t\t\tpendingData = getPendingData(storeId);\n\t\t\tvar userJSON = getSessionStorage(\"cache-current-user\");\n\t\t\tif (userJSON){\n\t\t\t\tuserJSON.shopCart = shopCartJSON;\t\t\t\t\n\t\t\t}\n\t\t\tvar timestamp = new Date().getTime();\n\t\t\tif ((new Date().getTime() - pendingData.timestamp) < TS_CACHE){\n\t\t\t\ttimestamp = pendingData.timestamp;\n\t\t\t}\n\t\t\tupdateTimestampForJSONs([shopCartJSON, pendingData, userJSON], timestamp);\n\t\t\tshopCartJSON.storeId = storeId;\n\t\t\tstoreCacheJSONs(pendingData, userJSON, shopCartJSON);\t\n\t\t};\n\t\t\n\t\t//FIN - Gestion casos especiales\n\t\t\n\t\tfunction storage(request, callback) {\n\t\t\tif (request.action == \"get\") {\n\t\t\t\ttry {\n\t\t\t\t\trequest.value = JSON.parse(localStorage.getItem(request.key));\n\t\t\t\t\trequest.status = 1;\n\t\t\t\t} catch (err) {\n\t\t\t\t\trequest.value = null;\n\t\t\t\t\trequest.status = 0;\n\t\t\t\t}\n\t\t\t} else if (request.action == \"set\") {\n\t\t\t\ttry {\n\t\t\t\t\tlocalStorage.setItem(request.key, JSON.stringify(request.value));\n\t\t\t\t\trequest.status = 1;\n\t\t\t\t} catch (err) {\n\t\t\t\t\trequest.status = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tcallback(request);\n\t\t}\n\t\n\t\t\tinditex.postMessage = function(data, callback) {\n\t\t\t\tonMessage(JSON.parse(data), callback);\n\t\t\t};\n\t\t\nfunction processPreRestAction(json, finish){\n\t\t\t\n\t\t\tvar pendingData = getPendingData(json.storeId);\n\t\t\t\n\t\t\tif (json.action == \"user:resetPassword\") {\n\t\t\t\t//lanzamos una petición de guestIdentity\n\t\t\t\t\n                var userJSON = getSessionStorage(\"cache-current-user\");\n                if (userJSON && (!userJSON.identity || !userJSON.identity.WCToken)){     \n                    var myData = {\n\t\t\t\t\t\t\"action\": \"user:loginGuest\",\n\t\t\t\t\t\t\"params\": {\n\t\t\t\t\t\t\t\"storeId\": json.storeId,\n\t\t\t\t\t\t\t\"languageId\": json.languageId ? json.languageId : -1\n\t\t\t\t\t\t\t}\n\t\t\t\t\t};\t\t\t\t\n                    myData.contentType = \"application/json\";                        \n                    rest(myData, function(){\t\t\t\t\t\n                        finish();\t\t\t\t\t\t\t    \t\t\t\t\t\n                    });                \n                } else {\n                    finish();\n                }\n                \n\t\t\t\t\n\t\t\t} else if ((json.action == \"user:login\")\n\t\t\t\t|| (json.action == \"user:register\")\n\t\t\t\t|| (json.action == \"user:logout\")\n\t\t\t\t|| (json.action == \"wishList:wishListByUser\")\n\t\t\t\t|| (json.action == \"wishList:wishListById\")) {\n\t\t\t\tpersistCartsToServer(pendingData, json, function(){\n\t\t\t\t\tfinish();\n\t\t\t\t});\n\t\t\t} else if (json.action == \"user:currentUser\") {\t\t\t\t\t\t\t\n\t\t\t\tprocessCurrentUser(pendingData, json, function(){\n\t\t\t\t\tjson.sendRequest = false;\n\t\t\t\t\tjson.value = json.userJSON;\n\t\t\t\t\tfinish();\n\t\t\t\t});\n\t\t\t} else if (json.action == \"order:shoppingCart\"\n\t\t\t\t\t|| json.action == \"order:miniCart\") {\t\t\t\t\t\t\t\n\t\t\t\tprocessShoppingCart(pendingData, json, function(){\n\t\t\t\t\tjson.sendRequest = false;\n\t\t\t\t\tjson.value = json.shopCartJSON;\n\t\t\t\t\tfinish();\n\t\t\t\t});\n\t\t\t} else if (json.action == \"order:addToCart\") {\t\t\t\t\t\t\t\n\t\t\t\tproccessAddToCart(\"shopCart\", json, pendingData, function(){\n\t\t\t\t\tjson.sendRequest = false;\n\t\t\t\t\tfinish();\n\t\t\t\t});\n\t\t\t} else if (json.action == \"wishList:addToWishList\") {\n\t\t\t\tproccessAddToCart(\"wishCart\", json, pendingData, function(){\n\t\t\t\t\tjson.sendRequest = false;\n\t\t\t\t\tfinish();\n\t\t\t\t});\n\t\t\t} else if (json.action == \"catalog:productDetail\") {\n\t\t\t\t if (json.params && json.params.categoryId) {\n\t\t\t\t \tjson.params.categoryId = 0;\n\t\t\t\t }\n\t\t\t\t finish();\n\t\t\t}else {\n\t\t\t\tfinish();\n\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\n\t\t}\nfunction processPostRestAction(json, finish){\n\t\t\t\n\tvar callbacks = [];\n\t\n\tif ((json.updateUserJson)\n\t\t\t|| (json.action == \"user:login\")\n\t\t\t|| (json.action == \"user:register\")\t\t\t\t\n\t\t\t|| (json.action == \"user:logout\")\t\t\t\t\t\t\t\t\n\t\t\t|| (json.action == \"user:updateUserEmail\")\n\t\t\t|| (json.action == \"user:addUpdateAddress\")\n\t\t\t|| (json.action == \"wallet:deleteCard\")\n\t\t\t|| (json.action == \"wallet:saveWalletData\")\n\t\t\t|| (json.action == \"wallet:deleteWalletData\")\t\t\t\t\n\t\t\t|| (json.action == \"wishList:updateWishList\")\n\t\t\t|| (json.action == \"giftCard:addPhysicalGiftCardToShopCart\")\n\t\t\t|| (json.action == \"giftCard:addVirtualGiftCardToShopCart\")\n\t\t\t|| (json.action == \"user:deleteAddress\")\n\t\t\t|| (json.action == \"user:updateUserPassword\")){\t\t\t\t\n\t\tcallbacks.push( function(json, onFinish) {\n\t\t\t\tgetFromServer(\"userJSON\", json, function(){\n\t\t\t\t\tprocessUserJSON(json.userJSON, json.storeId);\n\t\t\t\t\tonFinish();\n\t\t\t\t});\n\t\t\t});\n\t} \n\t\n\tif (json.updateShopCart){\n\t\tcallbacks.push( function(json, onFinish){\n\t\t\t//Actualizo el JSON desde el servidor\n\t\t\tgetFromServer(\"shopCartJSON\", json, function(){\n\t\t\t\tprocessShopCartJSON(json.shopCartJSON, json.storeId);\n\t\t\t\tjson.userJSON = getSessionStorage(\"cache-current-user\");\n\t\t\t\tjson.value = json.shopCartJSON;\n\t\t\t\tonFinish();\n\t\t\t});\t\n\t\t});\n\t}\n\t\n\tif ((json.action == \"order:updateCart\")\n\t\t|| (json.action == \"order:deleteFromCart\")){\n\t\tcallbacks.push( function(json, onFinish) {\n\t\t\tgetFromServer(\"userJSON\", json, function(){\n\t\t\t\tprocessUserJSON(json.userJSON, json.storeId);\n\t\t\t\tvar shopCartJSON = getLocalStorage(\"cache-shop-cart\");\n\t\t\t\tshopCartJSON.timestamp = 0;\n\t\t\t\tsetLocalStorage(\"cache-shop-cart\", shopCartJSON);\n\t\t\t\tvar pendingData = getLocalStorage(\"cache-pending-data\");\n\t\t\t\tpendingData.timestamp = 0;\n\t\t\t\tsetLocalStorage(\"cache-pending-data\", pendingData);\n\t\t\t\tonFinish();\n\t\t\t});\n\t\t});\n\t}\n\t\n\tif ((json.action == \"order:addGiftpacking\")\n\t\t|| (json.action == \"order:getGiftTicket\")\n\t\t|| (json.action == \"order:deleteGiftPacking\")\n\t\t|| (json.action == \"order:cardsAdjustments\")\n\t\t|| (json.action == \"order:deleteCardsAdjustments\")\t\t\t\t\n\t\t|| (json.action == \"order:orderConfirmation\")\n\t\t|| (json.action == \"order:addPromoCode\")\n\t\t|| (json.action == \"giftCard:updatePhysicalGiftCardData\")\n\t\t|| (json.action == \"giftCard:updateVirtualGiftCardData\")\n\t\t|| (json.action == \"giftCard:addPhysicalGiftCardToShopCart\")\n\t\t|| (json.action == \"giftCard:addVirtualGiftCardToShopCart\")\n\t\t|| (json.action == \"wishList:addWishListToOrder\")\n\t\t|| (json.action == \"order:asyncRepay\")\n\t\t|| (json.action == \"order:checkoutShipping\")\n\t\t|| (json.action == \"order:deletePromoCode\")\n\t\t|| (json.action == \"order:paymentStatus\")\n\t\t|| (json.action == \"order:unboundPayment\")\n\t\t|| (json.action == \"wallet:orderPreview\")\n\t\t|| (json.action == \"user:login\")\n\t\t|| (json.action == \"user:register\")\t\t\t\t\n\t\t|| (json.action == \"user:logout\")){\n\t\tcallbacks.push( function(json, onFinish){\n\t\t\t//Solo actualizo el timestamp\n\t\t\tvar shopCartJSON = getLocalStorage(\"cache-shop-cart\");\n\t\t\tif (shopCartJSON){\n\t\t\t\tshopCartJSON.timestamp = 0;\n\t\t\t\tsetLocalStorage(\"cache-shop-cart\", shopCartJSON);\n\t\t\t}\n\t\t\tonFinish();\n\t\t});\n\t} \t\t\t\n\t\n\tprocessCallbacks(callbacks, json, finish);\n\t\n}\nfunction getFromServer(jsonName, json, finish){\n                                               //Recuperamos el JSON del servidor\n                                               \n                                               var action = null;\n                                               \n                                               if (jsonName === \"userJSON\"){\n                                                               action = \"user:currentUser\";\n                                               } else if (jsonName === \"shopCartJSON\") {\n                                                               action = \"order:shoppingCart\";\n                                               }\n                                               \n                                               var myData = {\n                                                                              \"action\": action,\n                                                                              \"params\": {\n                                                                                              \"storeId\": json.storeId,\n                                                                                              \"languageId\": json.languageId,\n                                                                                               \"ts\": new Date().getTime()\n                                                                                              }\n                                                               };\n                                               \n                                               myData.contentType = \"application/json\";\n                                                               \n                                               rest(myData, function(){\n                                                               if (myData.status == 1){\n                                                                              json[jsonName] = myData.value;\n                                                                              json[jsonName].storeId = json.storeId;\n                                                                              json[jsonName].timestamp = new Date().getTime();\n                                                                              if (jsonName === \"userJSON\"){\n                                                                                              setSessionStorage(\"cache-current-user\", json[jsonName]);\n                                                                              } else if (jsonName === \"shopCartJSON\") {\n                                                                                              setLocalStorage(\"cache-shop-cart\", json[jsonName]);                                                                               \n                                                                              }                                                                             \n                                                               }\n                                                               finish();\n                                               });\n                               }\nfunction processUserJSON(userJSON, storeId){\n\tpendingData = getPendingData(storeId);\n\tvar timestamp = new Date().getTime();\n\tif ((new Date().getTime() - pendingData.timestamp) < TS_CACHE){\n\t\ttimestamp = pendingData.timestamp;\n\t}\n\tupdateTimestampForJSONs([userJSON, pendingData], timestamp);\n\tif (userJSON) {\n\t\tuserJSON.storeId = storeId;\n\t}\n\tstoreCacheJSONs(pendingData, userJSON);\t\n};\t})();\n\t\n</script>\n\t\n\t<script type=\"text/javascript\">\n\t\tinditex.initialize(null, false);\n\t</script>\n\t\n\n\n\n<!-- BEGIN Monitor -->\n<!--TagPageName=\"ItxWorldWidePage\"-->\n<!--itxStoreId=\"OyshoES\"-->\n<!--itxStoreLang=\"es\"-->\n<!--itxStoreType=\"VENTA\"-->\n<!-- END Monitor -->\n<script type=\"text/javascript\" id=\"\">_gaq.push([\"_addIgnoredOrganic\",\"oysho\"]);_gaq.push([\"_addIgnoredOrganic\",\"oysho.com\"]);_gaq.push([\"_addIgnoredOrganic\",\"www.oysho.com\"]);_gaq.push([\"_addIgnoredOrganic\",\"ohyso\"]);_gaq.push([\"_addIgnoredOrganic\",\"oisho\"]);_gaq.push([\"_addIgnoredOrganic\",\"oshio\"]);_gaq.push([\"_addIgnoredOrganic\",\"oshyo\"]);_gaq.push([\"_addIgnoredOrganic\",\"osyho\"]);_gaq.push([\"_addIgnoredOrganic\",\"ousho\"]);_gaq.push([\"_addIgnoredOrganic\",\"oycho\"]);_gaq.push([\"_addIgnoredOrganic\",\"oyosho\"]);\n_gaq.push([\"_addIgnoredOrganic\",\"oyscho\"]);_gaq.push([\"_addIgnoredOrganic\",\"oysh\"]);_gaq.push([\"_addIgnoredOrganic\",\"oyshio\"]);_gaq.push([\"_addIgnoredOrganic\",\"oyso\"]);_gaq.push([\"_addIgnoredOrganic\",\"\\u03bf\\u03c5\\u03c3\\u03b7\\u03bf\"]);_gaq.push([\"_addIgnoredOrganic\",\"\\u043e\\u0439\\u0448\\u0430\"]);_gaq.push([\"_addIgnoredOrganic\",\"\\u043e\\u0439\\u0448\\u043e\"]);_gaq.push([\"_addIgnoredOrganic\",\"\\u0449\\u043d\\u044b\\u0440\\u0449\"]);</script>\n\n\n<style type=\"text/css\">\n/* Alto del formulario de backsoon */\n#ItxBackSoonNotifyPage > div.inner_overlay {\n    padding-right: 10px;\n}\n\n/* Temporal */\n.col-b span p {\n    width: 100% !important;\n}\n  \n  \n/*Corte de texto de productos con nombre largo y Precios en la misma linea*/\ndiv.content div.grid_element.col4 div.element_info div.prod_name_grid span.name {\n    width: 100%;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow: hidden;\n} \t\n  \ndiv.footer div.categories .group h4 {\n    padding-right: 0px !important;\n}\n  \ndiv.content_wrapper div.content div.second_row div.like_products div.likeProductInnerContainer div.productLikeInfo p.likeProdName {\n    min-height: 24px;\n    width: 60%;\n}\n  \n@media only screen and (max-width: 768px) {\n\t#headerMenu > ul > li {\n\t\tpadding: 0 7px !important;\n\t}\n}\n  \n.auxTallas > a[class*='sC '] {\n    background-image: url(../images/cupc.png);\n}\n\n  \n#contactChat {\n    margin-bottom: 10px;\n    margin-top: 12px;\n    width: 65px!important;\n}\n  \n  \nhtml#ItxLookBookPage div.overlay {\n    height: unset !important;\n\toverflow: hidden;\n}\n\ndiv#see_more {\n    top: 47px;\n}\n  \n\n</style><script type=\"text/javascript\" id=\"\">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version=\"2.0\",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,\"script\",\"https://connect.facebook.net/en_US/fbevents.js\");fbq(\"init\",\"859211820843201\");</script><script type=\"text/javascript\" id=\"\">setTimeout(function(){fbq(\"track\",\"PageView\")},5E3);</script><style>\n  /*FIN FIX ECOMOYSH-4520 */\n/*scroll guia de compra*/\n#guide_content{\n\toverflow-y: auto !important;\n\theight: 630px;\n}\n</style>\n<script type=\"text/javascript\" id=\"\">ItxProductPageClass.prototype._getProdImgUrlsMain=function(){var b=this,a=b.iColorInfo.image,c=3,e=b.isBundleSpecial?b.iProductInfo.bundleProductSummaries[0].detail.colors[0].image.type:b.iProductInfo.detail.colors[0].image.type,d=null;a.style&&a.style[0]&&(d=a.style[0]);var f=Inditex.getProductImageUrls(a,1,c,null,d),g=Inditex.getProductImageUrls(a,2,c,null,d),a=Inditex.getProductImageUrls(a,6,c,null,d);b.iProdImgUrls[0]=inditex.xGetImagesArray(e,g,f,null,a[0])};\nItxProductPageClass.prototype._getProdImgUrlsZoom=function(){var b=this,a=b.isBundle?b.iProductInfo.image:b.iColorInfo.image,c=b.isBundleSpecial?b.iProductInfo.bundleProductSummaries[0].detail.colors[0].image.type:b.iProductInfo.detail.colors[0].image.type,e=Inditex.getProductImageUrls(a,1,1),d=Inditex.getProductImageUrls(a,2,1),a=Inditex.getProductImageUrls(a,6,1);b.iProdImgUrls[2]=inditex.xGetImagesArray(c,d,e,null,a[0])};\nItxNewProductPageClass.prototype._getProdImgUrlsMain=function(){var b=this,a=b.isBundle?inditex.iXProductInfo.bundleColors[0].image:b.iColorInfo.image,c=b.isBundle?inditex.iXProductInfo.bundleColors[0].image.type:b.iColorInfo.image.type,e=a.style&&a.style[0]?a.style[0]:null,d=Inditex.getProductImageUrls(a,1,2,null,e),f=Inditex.getProductImageUrls(a,2,2,null,e),a=Inditex.getProductImageUrls(a,6,2,null,e);b.iProdImgUrls[0]=inditex.xGetImagesArray(c,f,d,null,a[0])};\nItxNewProductPageClass.prototype._getProdImgUrlsZoom=function(){var b=this,a=b.isBundle?inditex.iXProductInfo.bundleColors[0].image:b.iColorInfo.image,c=b.isBundle?inditex.iXProductInfo.bundleColors[0].image.type:b.iColorInfo.image.type,e=Inditex.getProductImageUrls(a,1,1,null),d=Inditex.getProductImageUrls(a,2,1,null),a=Inditex.getProductImageUrls(a,6,1,null);b.iProdImgUrls[2]=inditex.xGetImagesArray(c,d,e,null,a[0])};\nItxRenderGridClass.prototype.getListImages=function(b,a,c,e,d,f){e=this;f=null;var g=2==d?3:4;null!=a.image&&null!=a.image.style&&0<a.image.style.length&&(f=a.image.style[0]);d=a.image.type;var h=Inditex.getProductImageUrls(c,1,g,null,f),k=Inditex.getProductImageUrls(c,2,g,null,f);c=Inditex.getProductImageUrls(c,6,g,null,f);e.swiperImagesUrls[b.toString()+\"_\"+a.id]=inditex.xGetImagesArray(d,k,h,null,c[0])};\ninditex.xGetImagesArray=function(b,a,c,e,d){var f=[];f.push(c[0]);1==inditex.xCheckImage(b,6)&&f.push(d);$.each(a,function(a,b){f.push(b)});null!=e&&1==inditex.xCheckImage(b,5)&&f.push(e[0]);return f};</script>\n<script type=\"text/javascript\" id=\"\">ItxGiftCardVirtualPageClass.prototype._init=function(){var a=this;if(-1002==inditex.iUserJSON.identity.userId){var b=[];b.push({action:\"user:loginGuest\",params:{storeId:inditex.iStoreId},data:{id:inditex.iStoreId}});inditex.execute({actions:b,onFinish:function(c,a){1==c&&(inditex.iUserJSON.identity=a.identity)}})}b=inditex.text(\"gift_card_blocked_message\");$(\".giftcard_page_right\").prepend('\\x3cp class\\x3d\"card_activ_msg\"\\x3e'+b+\"\\x3c/p\\x3e\");$.datetimepicker.setLocale(inditex.iLocale.split(\"_\")[0]);\nvar d=new Date,e=new Date(d.getTime()+36E5);$(\"#sendTime\").datetimepicker({datepicker:!1,format:\"H:i\"}).on(\"keypress\",function(){return!1});$(\"#sendDate\").datetimepicker({timepicker:!1,format:\"d/m/Y\",minDate:e,yearStart:d.getFullYear(),onSelectDate:function(c){$(\"#sendTime\").datetimepicker(\"reset\");var a=new Date(d.getTime()+72E5);c=c.setHours(0,0,0,0)==a.setHours(0,0,0,0);$(\"#sendTime\").datetimepicker(\"setOptions\",{minTime:c?e.getTime():1})}}).on(\"keypress\",function(){return!1});inditex.iXGiftCardMenu(\"#iUrlGiftCardVirtualPage\");\na._getProdImgUrls();a._drawMainImage();$('form[name\\x3d\"iVirtualGiftCardForm\"]').validationEngine({promptPosition:\"bottomLeft\",autoPositionUpdate:!0,showOneMessageByField:!0,scroll:!1,focusFirstField:!1});$(\"#iVirtualGiftCardForm #phoneCountryCode_0\").val(a.iStoreInfo.details.phoneCountryCode);a.rangePrice=a._getRangePrice();b=0;a.currentSku=void 0;0<a.rangePrice.length&&(b=a.rangePrice.length-1,a.currentSku=a.rangePrice[0]);$(\"#slider_horizontal\").slider({orientation:\"horizontal\",range:\"max\",max:b,\nmin:0,value:0,step:1,slide:function(c,b){a.currentSku=a.rangePrice[b.value];$(\"#slider_amount\").html(inditex.formatPrice(a.currentSku.price));setTimeout(function(){$(\"#slider_amount\").css(\"left\",a.xKnowLeftPosition())},25)},start:function(c,b){$(\"#slider_amount\").css(\"left\",a.xKnowLeftPosition())},stop:function(c,b){$(\"#slider_amount\").css(\"left\",a.xKnowLeftPosition())},change:function(c,a){},create:function(c,b){var d=0;a.currentSku&&(d=a.currentSku.price);$(\"#slider_amount\").css(\"left\",a.xKnowLeftPosition()).html(inditex.formatPrice(d))}}).draggable();\n$(\"#use_conditions\").bind(inditex.iXBindType,function(a){a.preventDefault();a=inditex.generateUrl(\"ItxStandardGiftCardConditionsPage\",{storeId:inditex.iStoreId,langId:inditex.iLangId,catalogId:inditex.iCatalogId},!0);window.open(a,\"condiciones\",\"width\\x3d600,height\\x3d600,scrollbars\\x3dyes\")});$(\"#buy_conditions\").bind(inditex.iXBindType,function(a){a.preventDefault();inditex.xShowShopGuide(8,!1)});$(\"#use_conditions\").bind(inditex.iXBindType,function(a){a.preventDefault();a=inditex.generateUrl(\"ItxStandardGiftCardConditionsPage\",\n{storeId:inditex.iStoreId,langId:inditex.iLangId,catalogId:inditex.iCatalogId},!0);window.open(a,\"condiciones\",\"width\\x3d600,height\\x3d600,scrollbars\\x3dyes\")});$(\"#addShopCard\").bind(inditex.iXBindType,function(c){c.preventDefault();a._submitForm()});$(\".share_content .share_elements span[rel\\x3demail]\").unbind().bind(inditex.iXBindType,function(a){a=inditex.generateUrl(\"ItxDetailSendToFriendPage\",{},!0);inditex.popupUrl(a,650,540,function(){new ItxDetailSendToFriendPageClass})})};</script><script type=\"text/javascript\" id=\"\">\"undefined\"===typeof ItxCategoryMixMatchPageClass&&(ItxCategoryMixMatchPageClass={});\"undefined\"===typeof ItxCategoryMixMatchPageClass.prototype&&(ItxCategoryMixMatchPageClass.prototype={});\nItxCategoryMixMatchPageClass.prototype._setSizeProductoInfo=function(a){var c=a.parent().attr(\"id\").split(\"_\").pop();$(\"#size_selector_name_\"+c).html(a.html());a.hasClass(\"disabled\")?($(\"#size_selector_name_\"+c+\" span\").addClass(\"disabled\"),$(\"#add_product_\"+c+\" a.button\").removeClass(\"active\")):($(\"#size_selector_name_\"+c+\" span\").removeClass(\"disabled\"),$(\"#add_product_\"+c+\" a.button\").addClass(\"active\"),2==$(\".add_button_single.active\").length&&$(\"li#add_bundle_button.button\").addClass(\"active\"),\n$(\"#size_selector_name_\"+c).removeClass(\"uncompleted\").removeClass(\"uncompleted-alert\"),$(\"#sizeSelector_\"+c).removeClass(\"uncompleted-alert\"),$(\"#alert_icon_\"+c).removeClass(\"uncompleted-alert\"));a.children(\"span\").hasClass(\"coming_soon\")||a.children(\"span\").hasClass(\"back_soon\")?($(\"#notify_legend_\"+c).show(),$(\"#notify_legend_\"+c).attr(\"data-sku\",a.children(\"span\").attr(\"id\"))):($(\"#notify_legend_\"+c).hide(),$(\"#notify_legend_\"+c).removeAttr(\"data-sku\"))};\nItxCategoryMixMatchPageClass.prototype._isTop=function(a){return 0<a.closest(\"div.productinfo_top\").length};ItxCategoryMixMatchPageClass.prototype._saveLastSize=function(a){this._isTop(a)?window.lastSizeTop=a[0].children[0].innerText:window.lastSizeBottom=a[0].children[0].innerText};ItxCategoryMixMatchPageClass.prototype._getLastSize=function(a){return this._isTop(a)?window.lastSizeTop:window.lastSizeBottom};\nItxCategoryMixMatchPageClass.prototype._setLastSize=function(a){var c=this,b=c._getLastSize(a);void 0!=b&&(a=c._isTop(a)?\"div.productinfo_top li.available span\":\"div.productinfo_bottom li.available span\",a=$(a).filter(function(){return $(this).text()===b}),0<a.length&&c._setSizeProductoInfo(a.parent()))};ItxCategoryMixMatchPageClass.prototype._bindingsProductInfo=function(a){var c=this;Inditex.xLoadCustomSelect(\"sizeSelector_\"+a.id,null,function(b){c._setSizeProductoInfo(b);c._saveLastSize(b)})};\nItxCategoryMixMatchPageClass.prototype.drawProductInfo=function(a,c){var b=this;c.empty();if(!a)return!1;var d=Inditex.getProductBean(a),d={product:{id:a.id,image:Inditex.getProductImageUrls(d.detail.colors[0].image,1,4),name:a.name,description:d.detail.description||\"\",price:Inditex.formatPrice(d.detail.colors[0].sizes[0].price),oldPrice:b._calculateStrikedPriceBundle(d)||\"\",reference:d.detail.displayReference,colors:b._drawColor(d),sizes:d.detail.colors[0].sizes,sizesAvailability:b.iVisibilityMap},\nlabel:{ref:Inditex.text(\"ref\"),info:Inditex.text(\"ItxProductPage.info\"),selectSize:Inditex.text(\"select_size\"),availability:Inditex.text(\"availability_link\"),add_single_button:Inditex.text(\"addToCart\"),sizeGuide:Inditex.text(\"ItxProductPage_sizeGuide\")}},d=inditex.xGetTemplate(\"mixMatchProductInfo\",d);c.append(d);b._drawSizeGuide(a);b._bindingsProductInfo(a);b._setLastSize(c)};\nItxCategoryMixMatchPageClass.prototype._bindSelectors=function(a){var c=this;$(document).on(\"mouseover\",\".add_button_single:not(.active)\",function(){var b=$(this).parent().attr(\"id\").split(\"_\").pop();$(\"#size_selector_name_\"+b).addClass(\"uncompleted\")});$(document).on(\"mouseleave\",\".add_button_single:not(.active)\",function(){var b=$(this).parent().attr(\"id\").split(\"_\").pop();$(\"#size_selector_name_\"+b).removeClass(\"uncompleted\")});$(document).on(\"click\",\".add_button_single:not(.active)\",function(){var b=\n$(this).parent().attr(\"id\").split(\"_\").pop();$(\"#size_selector_name_\"+b).removeClass(\"uncompleted\").addClass(\"uncompleted-alert\");$(\"#sizeSelector_\"+b).addClass(\"uncompleted-alert\");$(\"#alert_icon_\"+b).addClass(\"uncompleted-alert\");inditex.xOpenCustomSelect(\"sizeSelector_\"+b)});$(document).on(\"click\",\".add_button_single.active\",function(){var b=$(this).parent().attr(\"id\").split(\"_\").pop(),a=$(\"#size_selector_name_\"+b+\" span\").attr(\"id\"),b=_.findWhere(c.productList,{id:parseInt(b)}),e=Inditex.getProductBean(b),\na=_.findWhere(e.detail.colors[0].sizes,{sku:parseInt(a)});c._addToList(a,\"shopCart\",1,e);c._resetSizes(b.id)});$(document).on(\"click mouseover mouseleave\",\"#add_bundle_button:not(.active)\",function(b){$(\".add_button_single:not(.active)\").trigger(b.type)});$(document).on(\"click\",\"#add_bundle_button.active\",function(){var b=$(\".add_button_single.active\");2==b.length&&b.trigger(\"click\");b=$(this).parent().attr(\"id\").split(\"_\").pop();c._resetSizes(b)});$(document).on(\"click\",\".product_name a\",function(b){b.preventDefault();\nvar a=$(this).parent().attr(\"id\").split(\"_\")[1];b=Inditex.generateUrl(\"ItxAjaxProductPage\",{storeId:Inditex.iStoreId,langId:Inditex.iLangId,catalogId:Inditex.iCatalogId,categoryId:Inditex.iCategoryId,productId:a},!0);Inditex.popupUrl(b,695,478,function(){popUpInstance=new ItxProductPageClass(a,\"popupContent\",Inditex.iCategoryId)})});$(document).on(\"click\",\".product_image img\",function(b){b.preventDefault();var a=$(this).parent().attr(\"id\").split(\"_\")[2];b=Inditex.generateUrl(\"ItxAjaxProductPage\",\n{storeId:Inditex.iStoreId,langId:Inditex.iLangId,catalogId:Inditex.iCatalogId,categoryId:Inditex.iCategoryId,productId:a},!0);Inditex.popupUrl(b,695,478,function(){popUpInstance=new ItxProductPageClass(a,\"popupContent\",Inditex.iCategoryId)})});$(\".footer\").insertAfter($(\".body_wrapper\"))};</script><style>\n\t\n/*FIX_ECOMOYSH-4697_TAGNEW*/\nli.M_TAGNEW:after {\n\tcontent: \"NEW\";\n\tfont-size: 9px;\n\tline-height: 8px;\n\tdisplay: inline-block;\n\tvertical-align: middle;\n\tpadding: 4px;\n\tbackground: white;\n\tmargin-bottom: 1px !important;\n\theight: 6px;\n\ttext-decoration: none!important;\n\tmargin-left: 3px;\n\tcolor: #be8268!important;\n\tfont-weight: normal!important;\n\tletter-spacing: 1.6px;\n}\n</style>\n\n<script type=\"text/javascript\" id=\"\">inditex.xRestGetOrderList=function(a){a={action:\"order:orders\",params:{storeId:inditex.iStoreId,languageId:inditex.iLangId,howMany:a}};return inditex.xRestExecute([a]).done(function(a){return a[0].orders})};\nItxMyAccountOrdersPageClass.prototype._loadData=function(){var a=this;a.howMany=\"undefined\"===typeof a.howMany?7:a.howMany+7;console.log(\"howMany: \"+a.howMany);inditex.xRestGetOrderList(a.howMany).done(function(b){inditex.iXOrderListJSON={orders:b};b=Inditex.iXOrderListJSON.orders;var d=$(\"#displayOrders table.myaccount_address tbody\");d.empty();$.each(b,function(b,c){var e=$(\"\\x3ctr\\x3e\").append($(\"\\x3ctd\\x3e\").html(Inditex.xFormatDate(c.date))).append($(\"\\x3ctd\\x3e\").html(c.id)).append($(\"\\x3ctd\\x3e\").html(Inditex.xGetOrderStatusName(c.status,\nc.shipping.kind)).addClass(c.status)).append($(\"\\x3ctd\\x3e\").html(Inditex.formatPrice(c.totalOrder))).append($(\"\\x3ctd\\x3e\").addClass(\"MyAccount_Orders_buttons\")).attr(\"order\",c.id);d.append(e);a._addCancelOrder(b,c)});b.length==a.howMany&&(b=\"\\x3ca class\\x3d'button' style\\x3d'margin-left:0px; border: 1px solid #b8b8b8; background: #b8b8b8' href\\x3d'javascript:;' id\\x3d'viewMoreBtn'\\x3e\"+inditex.text(\"CHK_SHIP_SEEMORE_BTN\")+\"\\x3c/a\\x3e\",$(b).insertAfter(\"table.myaccount_address\"),$(\"#viewMoreBtn\").on(\"click\",\nfunction(){$(this).remove();a._loadData()}));a._bindings()}).Catch(function(a){inditex.xOpenErrorPopUp()})};</script>\n\n<script type=\"text/javascript\" id=\"\">ItxShopCartPageClass.prototype._getPriceRangeBundle=function(c){var e=this;c=_.map(c.bundleProductSummaries,function(a){return e.getPriceRange(a)});var d={maxOp:void 0,minOp:void 0,maxP:_.reduce(c,function(a,b){return a+b.maxP},0),minP:_.reduce(c,function(a,b){return a+b.minP},0)},f=_.find(c.minPAntiguo,function(a){return void 0!=a}),g=_.find(c.maxPAntiguo,function(a){return void 0!=a});void 0!=f&&(d.maxOp=_.reduce(c,function(a,b){return void 0!=a+b.maxOp?b.maxOp:b.maxP},0));void 0!=g&&(d.minOp=_.reduce(c,\nfunction(a,b){return void 0!=a+b.minOp?b.minOp:b.minP},0));return d};</script>\n</body>"}
