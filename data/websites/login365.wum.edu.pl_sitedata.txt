{"link":"https://login365.wum.edu.pl/","html":"<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n\n    <title>Logowanie do Office 365 - Outlook Login</title>\n\n    <link href=\"/Content/wspolne.css\" rel=\"stylesheet\">\n\n    <link href=\"/Content/layout.css\" rel=\"stylesheet\">\n    <script src=\"/bundles/jquery?v=FVs3ACwOLIVInrAl5sdzR2jrCDmVOWFbZMY6g6Q0ulE1\"></script>\n\n    \n</head>\n<body>    \n    <div class=\"container body-content\">\n        \n\n<div id=\"wraper\">\n    <div id=\"header\">\n        <a href=\"http://wum.edu.pl\"><div id=\"logo\"><img src=\"/img/logo_wum.png\" alt=\"Logo WUM\" width=\"120\"></div></a>\n        <h1>Warszawski Uniwersyet Medyczny</h1>\n        <h2>Logowanie do Office 365</h2>\n    </div>\n    <div id=\"tlo\" alt=\"tło\">\n        <a id=\"btnZaloguj\" href=\"/Home/RedirectToOutlook\"></a>\n    </div>\n    <div id=\"statusMessage\"></div>\n    <div id=\"stopka\">\n        <p><a target=\"_blank\" href=\"http://it.wum.edu.pl/\">Dział Informatyki WUM</a></p>        \n        <p><a class=\"link\" target=\"_blank\" href=\"/Home/RedirectToOutlook\">Alternatywna strona logowania</a></p>\n    </div>\n    \n</div>\n\n\n\n\n        \n        <footer>\n            <p></p>\n        </footer>\n    </div>\n\n    \n    \n    <script src=\"/Content/common-1.0.js\"></script>\n    \n    <script type=\"text/javascript\">\n        var signinWin;\n        var closedCounter;\n        //var signinUrl;\n        //var opener;\n\n        //$('#btnZaloguj').click(function () {\n        //    //var pos = screenCenterPos(800, 500);\n        //    //var pos = { x: 100, y: 100}\n        //    //signinWin = window.open(signinUrl, \"Zaloguj się\", \"width=780,height=510,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left=\" + pos.x + \",top=\" + pos.y);\n        //    signinWin = PopupCenter(\"/Home/RedirectToProvider\", \"Office365Login\", 480, 600);\n        //    //$(signinWin).bind(\"onpagehide\", function whenPopupClosed() {\n        //    //    CheckLoginStatus();\n        //    //});\n\n        //    //var focusCounter = 0;\n        //    //signinWin.focus();\n        //    //$(window).bind('onfocus', function whenPopupClosed() {\n        //    //    focusCounter++;\n        //    //    if (focusCounter > 2) {\n        //    //        CheckLoginStatus();\n        //    //    }\n        //    //});\n        //    closedCounter = 0;\n        //    setTimeout(CheckLoginStatus, 100);\n\n        //    return false;\n        //});\n        function CheckLoginStatus() {           \n\n            //var ready = true;\n\n            //if (signinWin.closed) {\n\n            //    closedCounter += 1;\n            //}\n\n            //if (!signinWin.closed) {\n            //    ready = false;\n            //}\n            //if (signinWin.closed && closedCounter <= 1) {\n            //    ready = false;\n            //}\n            //if (ready) {\n            //    var isAfterLogin = readCookie('after');\n            //    if (isAfterLogin != \"true\") {\n            //        ready = false;\n            //    }\n            //}\n            //if (!ready) {\n            //    setTimeout(CheckLoginStatus, 100);\n            //    return;\n            //}\n\n            var isAfterLogin = readCookie('after');\n            if (isAfterLogin != \"true\") {\n                setTimeout(CheckLoginStatus, 100);\n                return;\n            }\n\n            $('#statusMessage').text(\"Sprawdzanie wyniku logowania\");            \n            setTimeout(function checkTokenGet() {\n                $.get(\"/Home/HasValidToken\")\n                .done(function afterCheckToken(result) {\n                    afterCheckStatus(result)\n                })\n            .error(function myfunction() {\n                $('#statusMessage').text(\"Wystąpił błąd logowania. Spróbuj ponownie lub użyj alternatywnego linku.\");\n            });\n            }, 200);\n\n            //}\n            //else {\n            //    setTimeout(CheckLoginStatus, 500);\n            //}\n\n\n            //var isAfterLogin = readCookie('after');\n\n\n        }\n        function afterCheckStatus(result) {\n\n            var isLoggedIn = result == \"true\";\n            //if (signinWin.closed && isLoggedIn) {\n            if (isLoggedIn) {\n                //$('#UserInfo').text($.cookie(\"some_cookie\"));\n                $('#statusMessage').text(\"Przekierowywanie do Office 365\");\n                //window.parent.location.href = '/Home/RedirectToOutlook';\n                //signinWin.open('', '_self', '');\n                //signinWin.close();\n                //setTimeout(function () {\n                //    signinWin.open('', '_self', '');\n                //    signinWin.close();\n                //}, 100);\n                setTimeout(function () {\n                    eraseCookie('after');\n                    window.location.href = '/Home/RedirectToOutlook';\n                }, 200);\n            }\n            else {\n                $('#statusMessage').text(\"Nie zalogowano użytkownika. Można spróbować jeszcze raz lub użyć alternatywnego linku.\");\n            }\n            //}\n            //else if (!signinWin.closed) {\n            //    setTimeout(CheckLoginStatus, 500);\n            //}\n        }\n\n\n\n        function PopupCenter(url, title, w, h) {\n            var dualScreenLeft = window.screenLeft != undefined ? window.screenLeft : screen.left;\n            var dualScreenTop = window.screenTop != undefined ? window.screenTop : screen.top;\n\n            width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : screen.width;\n            height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : screen.height;\n\n            var left = ((width / 2) - (w / 2)) + dualScreenLeft;\n            var top = ((height / 2) - (h / 2)) + dualScreenTop;\n            var newWindow = window.open(url, title, 'toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0, width=' + w + ', height=' + h + ', top=' + top + ', left=' + left);\n            //newWindow.onpagehide = function() { EOG(); };\n\n            // Puts focus on the newWindow\n            if (window.focus) {\n                newWindow.focus();\n            }\n            return newWindow;\n        }\n\n        //function EOG() {\n        //    alert(\"aaa\");\n        //}\n\n    </script>\n\n\n\n\n\n</body>"}
