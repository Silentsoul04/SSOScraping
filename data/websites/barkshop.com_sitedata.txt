{"link":"barkshop.com","html":"<head><style type=\"text/css\">@charset \"UTF-8\";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>\n<script src=\"https://js-agent.newrelic.com/nr-1026.min.js\"></script><script type=\"text/javascript\" async=\"\" src=\"//www.googleadservices.com/pagead/conversion_async.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https://cdn.pbbl.co/r/1113.js\"></script><script async=\"\" src=\"https://s.pinimg.com/ct/core.js\"></script><script type=\"text/javascript\" async=\"\" src=\"//www.googleadservices.com/pagead/conversion_async.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https://www.googletagmanager.com/gtm.js?id=GTM-MVZ86D&amp;l=dataLayer\"></script><script type=\"text/javascript\" async=\"\" src=\"https://www.google-analytics.com/analytics.js\"></script><script src=\"https://connect.facebook.net/signals/plugins/identity.js?v=stable\" async=\"\"></script><script src=\"https://connect.facebook.net/signals/config/1141960305877924?v=stable\" async=\"\"></script><script src=\"https://connect.facebook.net/signals/config/779756138718673?v=stable\" async=\"\"></script><script type=\"text/javascript\" async=\"\" src=\"https://connect.facebook.net/en_US/fbevents.js\"></script><script async=\"\" charset=\"utf-8\" src=\"//v2.zopim.com/?31hwtwabcV8aIaGpPCG4YPfC8ycOymAn\" type=\"text/javascript\"></script><script type=\"text/javascript\" async=\"\" src=\"https://cdn.segment.com/analytics.js/v1/K6mYPeoKeM4QKAHyxe9CQoZhf3d8iWbe/analytics.min.js\"></script><script type=\"text/javascript\">window.NREUM||(NREUM={});NREUM.info={\"beacon\":\"bam.nr-data.net\",\"errorBeacon\":\"bam.nr-data.net\",\"licenseKey\":\"eb599a375b\",\"applicationID\":\"11516001\",\"transactionName\":\"dgtbEhQLXlRRQh5EVlIBRkkOC19d\",\"queueTime\":2,\"applicationTime\":43,\"agent\":\"\"}</script>\n<script type=\"text/javascript\">(window.NREUM||(NREUM={})).loader_config={xpid:\"Uw8PVVRTGwIBUVBUBwEG\"};window.NREUM||(NREUM={}),__nr_require=function(t,n,e){function r(e){if(!n[e]){var o=n[e]={exports:{}};t[e][0].call(o.exports,function(n){var o=t[e][1][n];return r(o||n)},o,o.exports)}return n[e].exports}if(\"function\"==typeof __nr_require)return __nr_require;for(var o=0;o<e.length;o++)r(e[o]);return r}({1:[function(t,n,e){function r(t){try{s.console&&console.log(t)}catch(n){}}var o,i=t(\"ee\"),a=t(15),s={};try{o=localStorage.getItem(\"__nr_flags\").split(\",\"),console&&\"function\"==typeof console.log&&(s.console=!0,o.indexOf(\"dev\")!==-1&&(s.dev=!0),o.indexOf(\"nr_dev\")!==-1&&(s.nrDev=!0))}catch(c){}s.nrDev&&i.on(\"internal-error\",function(t){r(t.stack)}),s.dev&&i.on(\"fn-err\",function(t,n,e){r(e.stack)}),s.dev&&(r(\"NR AGENT IN DEVELOPMENT MODE\"),r(\"flags: \"+a(s,function(t,n){return t}).join(\", \")))},{}],2:[function(t,n,e){function r(t,n,e,r,o){try{d?d-=1:i(\"err\",[o||new UncaughtException(t,n,e)])}catch(s){try{i(\"ierr\",[s,c.now(),!0])}catch(u){}}return\"function\"==typeof f&&f.apply(this,a(arguments))}function UncaughtException(t,n,e){this.message=t||\"Uncaught error with no additional information\",this.sourceURL=n,this.line=e}function o(t){i(\"err\",[t,c.now()])}var i=t(\"handle\"),a=t(16),s=t(\"ee\"),c=t(\"loader\"),f=window.onerror,u=!1,d=0;c.features.err=!0,t(1),window.onerror=r;try{throw new Error}catch(l){\"stack\"in l&&(t(8),t(7),\"addEventListener\"in window&&t(5),c.xhrWrappable&&t(9),u=!0)}s.on(\"fn-start\",function(t,n,e){u&&(d+=1)}),s.on(\"fn-err\",function(t,n,e){u&&(this.thrown=!0,o(e))}),s.on(\"fn-end\",function(){u&&!this.thrown&&d>0&&(d-=1)}),s.on(\"internal-error\",function(t){i(\"ierr\",[t,c.now(),!0])})},{}],3:[function(t,n,e){t(\"loader\").features.ins=!0},{}],4:[function(t,n,e){function r(t){}if(window.performance&&window.performance.timing&&window.performance.getEntriesByType){var o=t(\"ee\"),i=t(\"handle\"),a=t(8),s=t(7),c=\"learResourceTimings\",f=\"addEventListener\",u=\"resourcetimingbufferfull\",d=\"bstResource\",l=\"resource\",p=\"-start\",h=\"-end\",m=\"fn\"+p,w=\"fn\"+h,v=\"bstTimer\",y=\"pushState\",g=t(\"loader\");g.features.stn=!0,t(6);var b=NREUM.o.EV;o.on(m,function(t,n){var e=t[0];e instanceof b&&(this.bstStart=g.now())}),o.on(w,function(t,n){var e=t[0];e instanceof b&&i(\"bst\",[e,n,this.bstStart,g.now()])}),a.on(m,function(t,n,e){this.bstStart=g.now(),this.bstType=e}),a.on(w,function(t,n){i(v,[n,this.bstStart,g.now(),this.bstType])}),s.on(m,function(){this.bstStart=g.now()}),s.on(w,function(t,n){i(v,[n,this.bstStart,g.now(),\"requestAnimationFrame\"])}),o.on(y+p,function(t){this.time=g.now(),this.startPath=location.pathname+location.hash}),o.on(y+h,function(t){i(\"bstHist\",[location.pathname+location.hash,this.startPath,this.time])}),f in window.performance&&(window.performance[\"c\"+c]?window.performance[f](u,function(t){i(d,[window.performance.getEntriesByType(l)]),window.performance[\"c\"+c]()},!1):window.performance[f](\"webkit\"+u,function(t){i(d,[window.performance.getEntriesByType(l)]),window.performance[\"webkitC\"+c]()},!1)),document[f](\"scroll\",r,{passive:!0}),document[f](\"keypress\",r,!1),document[f](\"click\",r,!1)}},{}],5:[function(t,n,e){function r(t){for(var n=t;n&&!n.hasOwnProperty(u);)n=Object.getPrototypeOf(n);n&&o(n)}function o(t){s.inPlace(t,[u,d],\"-\",i)}function i(t,n){return t[1]}var a=t(\"ee\").get(\"events\"),s=t(18)(a,!0),c=t(\"gos\"),f=XMLHttpRequest,u=\"addEventListener\",d=\"removeEventListener\";n.exports=a,\"getPrototypeOf\"in Object?(r(document),r(window),r(f.prototype)):f.prototype.hasOwnProperty(u)&&(o(window),o(f.prototype)),a.on(u+\"-start\",function(t,n){var e=t[1],r=c(e,\"nr@wrapped\",function(){function t(){if(\"function\"==typeof e.handleEvent)return e.handleEvent.apply(e,arguments)}var n={object:t,\"function\":e}[typeof e];return n?s(n,\"fn-\",null,n.name||\"anonymous\"):e});this.wrapped=t[1]=r}),a.on(d+\"-start\",function(t){t[1]=this.wrapped||t[1]})},{}],6:[function(t,n,e){var r=t(\"ee\").get(\"history\"),o=t(18)(r);n.exports=r,o.inPlace(window.history,[\"pushState\",\"replaceState\"],\"-\")},{}],7:[function(t,n,e){var r=t(\"ee\").get(\"raf\"),o=t(18)(r),i=\"equestAnimationFrame\";n.exports=r,o.inPlace(window,[\"r\"+i,\"mozR\"+i,\"webkitR\"+i,\"msR\"+i],\"raf-\"),r.on(\"raf-start\",function(t){t[0]=o(t[0],\"fn-\")})},{}],8:[function(t,n,e){function r(t,n,e){t[0]=a(t[0],\"fn-\",null,e)}function o(t,n,e){this.method=e,this.timerDuration=\"number\"==typeof t[1]?t[1]:0,t[0]=a(t[0],\"fn-\",this,e)}var i=t(\"ee\").get(\"timer\"),a=t(18)(i),s=\"setTimeout\",c=\"setInterval\",f=\"clearTimeout\",u=\"-start\",d=\"-\";n.exports=i,a.inPlace(window,[s,\"setImmediate\"],s+d),a.inPlace(window,[c],c+d),a.inPlace(window,[f,\"clearImmediate\"],f+d),i.on(c+u,r),i.on(s+u,o)},{}],9:[function(t,n,e){function r(t,n){d.inPlace(n,[\"onreadystatechange\"],\"fn-\",s)}function o(){var t=this,n=u.context(t);t.readyState>3&&!n.resolved&&(n.resolved=!0,u.emit(\"xhr-resolved\",[],t)),d.inPlace(t,w,\"fn-\",s)}function i(t){v.push(t),h&&(g=-g,b.data=g)}function a(){for(var t=0;t<v.length;t++)r([],v[t]);v.length&&(v=[])}function s(t,n){return n}function c(t,n){for(var e in t)n[e]=t[e];return n}t(5);var f=t(\"ee\"),u=f.get(\"xhr\"),d=t(18)(u),l=NREUM.o,p=l.XHR,h=l.MO,m=\"readystatechange\",w=[\"onload\",\"onerror\",\"onabort\",\"onloadstart\",\"onloadend\",\"onprogress\",\"ontimeout\"],v=[];n.exports=u;var y=window.XMLHttpRequest=function(t){var n=new p(t);try{u.emit(\"new-xhr\",[n],n),n.addEventListener(m,o,!1)}catch(e){try{u.emit(\"internal-error\",[e])}catch(r){}}return n};if(c(p,y),y.prototype=p.prototype,d.inPlace(y.prototype,[\"open\",\"send\"],\"-xhr-\",s),u.on(\"send-xhr-start\",function(t,n){r(t,n),i(n)}),u.on(\"open-xhr-start\",r),h){var g=1,b=document.createTextNode(g);new h(a).observe(b,{characterData:!0})}else f.on(\"fn-end\",function(t){t[0]&&t[0].type===m||a()})},{}],10:[function(t,n,e){function r(t){var n=this.params,e=this.metrics;if(!this.ended){this.ended=!0;for(var r=0;r<d;r++)t.removeEventListener(u[r],this.listener,!1);if(!n.aborted){if(e.duration=a.now()-this.startTime,4===t.readyState){n.status=t.status;var i=o(t,this.lastSize);if(i&&(e.rxSize=i),this.sameOrigin){var c=t.getResponseHeader(\"X-NewRelic-App-Data\");c&&(n.cat=c.split(\", \").pop())}}else n.status=0;e.cbTime=this.cbTime,f.emit(\"xhr-done\",[t],t),s(\"xhr\",[n,e,this.startTime])}}}function o(t,n){var e=t.responseType;if(\"json\"===e&&null!==n)return n;var r=\"arraybuffer\"===e||\"blob\"===e||\"json\"===e?t.response:t.responseText;return h(r)}function i(t,n){var e=c(n),r=t.params;r.host=e.hostname+\":\"+e.port,r.pathname=e.pathname,t.sameOrigin=e.sameOrigin}var a=t(\"loader\");if(a.xhrWrappable){var s=t(\"handle\"),c=t(11),f=t(\"ee\"),u=[\"load\",\"error\",\"abort\",\"timeout\"],d=u.length,l=t(\"id\"),p=t(14),h=t(13),m=window.XMLHttpRequest;a.features.xhr=!0,t(9),f.on(\"new-xhr\",function(t){var n=this;n.totalCbs=0,n.called=0,n.cbTime=0,n.end=r,n.ended=!1,n.xhrGuids={},n.lastSize=null,p&&(p>34||p<10)||window.opera||t.addEventListener(\"progress\",function(t){n.lastSize=t.loaded},!1)}),f.on(\"open-xhr-start\",function(t){this.params={method:t[0]},i(this,t[1]),this.metrics={}}),f.on(\"open-xhr-end\",function(t,n){\"loader_config\"in NREUM&&\"xpid\"in NREUM.loader_config&&this.sameOrigin&&n.setRequestHeader(\"X-NewRelic-ID\",NREUM.loader_config.xpid)}),f.on(\"send-xhr-start\",function(t,n){var e=this.metrics,r=t[0],o=this;if(e&&r){var i=h(r);i&&(e.txSize=i)}this.startTime=a.now(),this.listener=function(t){try{\"abort\"===t.type&&(o.params.aborted=!0),(\"load\"!==t.type||o.called===o.totalCbs&&(o.onloadCalled||\"function\"!=typeof n.onload))&&o.end(n)}catch(e){try{f.emit(\"internal-error\",[e])}catch(r){}}};for(var s=0;s<d;s++)n.addEventListener(u[s],this.listener,!1)}),f.on(\"xhr-cb-time\",function(t,n,e){this.cbTime+=t,n?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&\"function\"==typeof e.onload||this.end(e)}),f.on(\"xhr-load-added\",function(t,n){var e=\"\"+l(t)+!!n;this.xhrGuids&&!this.xhrGuids[e]&&(this.xhrGuids[e]=!0,this.totalCbs+=1)}),f.on(\"xhr-load-removed\",function(t,n){var e=\"\"+l(t)+!!n;this.xhrGuids&&this.xhrGuids[e]&&(delete this.xhrGuids[e],this.totalCbs-=1)}),f.on(\"addEventListener-end\",function(t,n){n instanceof m&&\"load\"===t[0]&&f.emit(\"xhr-load-added\",[t[1],t[2]],n)}),f.on(\"removeEventListener-end\",function(t,n){n instanceof m&&\"load\"===t[0]&&f.emit(\"xhr-load-removed\",[t[1],t[2]],n)}),f.on(\"fn-start\",function(t,n,e){n instanceof m&&(\"onload\"===e&&(this.onload=!0),(\"load\"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=a.now()))}),f.on(\"fn-end\",function(t,n){this.xhrCbStart&&f.emit(\"xhr-cb-time\",[a.now()-this.xhrCbStart,this.onload,n],n)})}},{}],11:[function(t,n,e){n.exports=function(t){var n=document.createElement(\"a\"),e=window.location,r={};n.href=t,r.port=n.port;var o=n.href.split(\"://\");!r.port&&o[1]&&(r.port=o[1].split(\"/\")[0].split(\"@\").pop().split(\":\")[1]),r.port&&\"0\"!==r.port||(r.port=\"https\"===o[0]?\"443\":\"80\"),r.hostname=n.hostname||e.hostname,r.pathname=n.pathname,r.protocol=o[0],\"/\"!==r.pathname.charAt(0)&&(r.pathname=\"/\"+r.pathname);var i=!n.protocol||\":\"===n.protocol||n.protocol===e.protocol,a=n.hostname===document.domain&&n.port===e.port;return r.sameOrigin=i&&(!n.hostname||a),r}},{}],12:[function(t,n,e){function r(){}function o(t,n,e){return function(){return i(t,[f.now()].concat(s(arguments)),n?null:this,e),n?void 0:this}}var i=t(\"handle\"),a=t(15),s=t(16),c=t(\"ee\").get(\"tracer\"),f=t(\"loader\"),u=NREUM;\"undefined\"==typeof window.newrelic&&(newrelic=u);var d=[\"setPageViewName\",\"setCustomAttribute\",\"setErrorHandler\",\"finished\",\"addToTrace\",\"inlineHit\",\"addRelease\"],l=\"api-\",p=l+\"ixn-\";a(d,function(t,n){u[n]=o(l+n,!0,\"api\")}),u.addPageAction=o(l+\"addPageAction\",!0),u.setCurrentRouteName=o(l+\"routeName\",!0),n.exports=newrelic,u.interaction=function(){return(new r).get()};var h=r.prototype={createTracer:function(t,n){var e={},r=this,o=\"function\"==typeof n;return i(p+\"tracer\",[f.now(),t,e],r),function(){if(c.emit((o?\"\":\"no-\")+\"fn-start\",[f.now(),r,o],e),o)try{return n.apply(this,arguments)}finally{c.emit(\"fn-end\",[f.now()],e)}}}};a(\"setName,setAttribute,save,ignore,onEnd,getContext,end,get\".split(\",\"),function(t,n){h[n]=o(p+n)}),newrelic.noticeError=function(t){\"string\"==typeof t&&(t=new Error(t)),i(\"err\",[t,f.now()])}},{}],13:[function(t,n,e){n.exports=function(t){if(\"string\"==typeof t&&t.length)return t.length;if(\"object\"==typeof t){if(\"undefined\"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if(\"undefined\"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if(!(\"undefined\"!=typeof FormData&&t instanceof FormData))try{return JSON.stringify(t).length}catch(n){return}}}},{}],14:[function(t,n,e){var r=0,o=navigator.userAgent.match(/Firefox[\\/\\s](\\d+\\.\\d+)/);o&&(r=+o[1]),n.exports=r},{}],15:[function(t,n,e){function r(t,n){var e=[],r=\"\",i=0;for(r in t)o.call(t,r)&&(e[i]=n(r,t[r]),i+=1);return e}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],16:[function(t,n,e){function r(t,n,e){n||(n=0),\"undefined\"==typeof e&&(e=t?t.length:0);for(var r=-1,o=e-n||0,i=Array(o<0?0:o);++r<o;)i[r]=t[n+r];return i}n.exports=r},{}],17:[function(t,n,e){n.exports={exists:\"undefined\"!=typeof window.performance&&window.performance.timing&&\"undefined\"!=typeof window.performance.timing.navigationStart}},{}],18:[function(t,n,e){function r(t){return!(t&&t instanceof Function&&t.apply&&!t[a])}var o=t(\"ee\"),i=t(16),a=\"nr@original\",s=Object.prototype.hasOwnProperty,c=!1;n.exports=function(t,n){function e(t,n,e,o){function nrWrapper(){var r,a,s,c;try{a=this,r=i(arguments),s=\"function\"==typeof e?e(r,a):e||{}}catch(f){l([f,\"\",[r,a,o],s])}u(n+\"start\",[r,a,o],s);try{return c=t.apply(a,r)}catch(d){throw u(n+\"err\",[r,a,d],s),d}finally{u(n+\"end\",[r,a,c],s)}}return r(t)?t:(n||(n=\"\"),nrWrapper[a]=t,d(t,nrWrapper),nrWrapper)}function f(t,n,o,i){o||(o=\"\");var a,s,c,f=\"-\"===o.charAt(0);for(c=0;c<n.length;c++)s=n[c],a=t[s],r(a)||(t[s]=e(a,f?s+o:o,i,s))}function u(e,r,o){if(!c||n){var i=c;c=!0;try{t.emit(e,r,o,n)}catch(a){l([a,e,r,o])}c=i}}function d(t,n){if(Object.defineProperty&&Object.keys)try{var e=Object.keys(t);return e.forEach(function(e){Object.defineProperty(n,e,{get:function(){return t[e]},set:function(n){return t[e]=n,n}})}),n}catch(r){l([r])}for(var o in t)s.call(t,o)&&(n[o]=t[o]);return n}function l(n){try{t.emit(\"internal-error\",n)}catch(e){}}return t||(t=o),e.inPlace=f,e.flag=a,e}},{}],ee:[function(t,n,e){function r(){}function o(t){function n(t){return t&&t instanceof r?t:t?c(t,s,i):i()}function e(e,r,o,i){if(!l.aborted||i){t&&t(e,r,o);for(var a=n(o),s=h(e),c=s.length,f=0;f<c;f++)s[f].apply(a,r);var d=u[y[e]];return d&&d.push([g,e,r,a]),a}}function p(t,n){v[t]=h(t).concat(n)}function h(t){return v[t]||[]}function m(t){return d[t]=d[t]||o(e)}function w(t,n){f(t,function(t,e){n=n||\"feature\",y[e]=n,n in u||(u[n]=[])})}var v={},y={},g={on:p,emit:e,get:m,listeners:h,context:n,buffer:w,abort:a,aborted:!1};return g}function i(){return new r}function a(){(u.api||u.feature)&&(l.aborted=!0,u=l.backlog={})}var s=\"nr@context\",c=t(\"gos\"),f=t(15),u={},d={},l=n.exports=o();l.backlog=u},{}],gos:[function(t,n,e){function r(t,n,e){if(o.call(t,n))return t[n];var r=e();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return t[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(t,n,e){function r(t,n,e,r){o.buffer([t],r),o.emit(t,n,e)}var o=t(\"ee\").get(\"handle\");n.exports=r,r.ee=o},{}],id:[function(t,n,e){function r(t){var n=typeof t;return!t||\"object\"!==n&&\"function\"!==n?-1:t===window?0:a(t,i,function(){return o++})}var o=1,i=\"nr@id\",a=t(\"gos\");n.exports=r},{}],loader:[function(t,n,e){function r(){if(!x++){var t=b.info=NREUM.info,n=l.getElementsByTagName(\"script\")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&n))return u.abort();f(y,function(n,e){t[n]||(t[n]=e)}),c(\"mark\",[\"onload\",a()+b.offset],null,\"api\");var e=l.createElement(\"script\");e.src=\"https://\"+t.agent,n.parentNode.insertBefore(e,n)}}function o(){\"complete\"===l.readyState&&i()}function i(){c(\"mark\",[\"domContent\",a()+b.offset],null,\"api\")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(s=Math.max((new Date).getTime(),s))-b.offset}var s=(new Date).getTime(),c=t(\"handle\"),f=t(15),u=t(\"ee\"),d=window,l=d.document,p=\"addEventListener\",h=\"attachEvent\",m=d.XMLHttpRequest,w=m&&m.prototype;NREUM.o={ST:setTimeout,CT:clearTimeout,XHR:m,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var v=\"\"+location,y={beacon:\"bam.nr-data.net\",errorBeacon:\"bam.nr-data.net\",agent:\"js-agent.newrelic.com/nr-1026.min.js\"},g=m&&w&&w[p]&&!/CriOS/.test(navigator.userAgent),b=n.exports={offset:s,now:a,origin:v,features:{},xhrWrappable:g};t(12),l[p]?(l[p](\"DOMContentLoaded\",i,!1),d[p](\"load\",r,!1)):(l[h](\"onreadystatechange\",o),d[h](\"onload\",r)),c(\"mark\",[\"firstbyte\",s],null,\"api\");var x=0,E=t(17)},{}]},{},[\"loader\",2,10,4,3]);</script>\n<title>Shop Collections of Dog Toys, Beds, Collars &amp; More | BarkShop</title>\n\n  <meta content=\"BarkShop curates the best collections of dog toys, gear, beds, treats, and more! Browse the recommended dog goodies and make your pup smile.\" name=\"description\">\n\n<meta content=\"width=device-width, initial-scale=1.0, user-scalable=no\" name=\"viewport\">\n<meta content=\"1532250563653729\" property=\"fb:app_id\">\n<meta content=\"website\" property=\"og:type\">\n<meta content=\"BarkShop\" property=\"og:site_name\">\n<meta content=\"https://dv4pc7nwcrrvy.cloudfront.net/assets/logo-black-fa0b87a93956c021e74aede0efbe1b32.png\" property=\"og:image\">\n<meta content=\"USD\" property=\"product:price:currency\">\n<meta content=\"telephone=no\" name=\"format-detection\">\n<meta content=\"ca75e5311925aa881660d53eef05903b\" name=\"p:domain_verify\">\n<link rel=\"stylesheet\" media=\"all\" href=\"//dv4pc7nwcrrvy.cloudfront.net/assets/application-df860057529245f8f4c04dcb436e02a4.css\">\n<link rel=\"stylesheet\" media=\"screen\" href=\"//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css\">\n<link rel=\"apple-touch-icon\" sizes=\"57x57\" href=\"/apple-touch-icon-57x57.png\">\n<link rel=\"apple-touch-icon\" sizes=\"114x114\" href=\"/apple-touch-icon-114x114.png\">\n<link rel=\"apple-touch-icon\" sizes=\"72x72\" href=\"/apple-touch-icon-72x72.png\">\n<link rel=\"apple-touch-icon\" sizes=\"144x144\" href=\"/apple-touch-icon-144x144.png\">\n<link rel=\"apple-touch-icon\" sizes=\"60x60\" href=\"/apple-touch-icon-60x60.png\">\n<link rel=\"apple-touch-icon\" sizes=\"120x120\" href=\"/apple-touch-icon-120x120.png\">\n<link rel=\"apple-touch-icon\" sizes=\"76x76\" href=\"/apple-touch-icon-76x76.png\">\n<link rel=\"apple-touch-icon\" sizes=\"152x152\" href=\"/apple-touch-icon-152x152.png\">\n<link rel=\"apple-touch-icon\" sizes=\"180x180\" href=\"/apple-touch-icon-180x180.png\">\n<meta name=\"apple-mobile-web-app-title\" content=\"BarkShop\">\n<link rel=\"icon\" type=\"image/png\" href=\"/favicon-192x192.png\" sizes=\"192x192\">\n<link rel=\"icon\" type=\"image/png\" href=\"/favicon-160x160.png\" sizes=\"160x160\">\n<link rel=\"icon\" type=\"image/png\" href=\"/favicon-96x96.png\" sizes=\"96x96\">\n<link rel=\"icon\" type=\"image/png\" href=\"/favicon-16x16.png\" sizes=\"16x16\">\n<link rel=\"icon\" type=\"image/png\" href=\"/favicon-32x32.png\" sizes=\"32x32\">\n<meta name=\"msapplication-TileColor\" content=\"#36ade7\">\n<meta name=\"msapplication-TileImage\" content=\"/mstile-144x144.png\">\n<meta name=\"application-name\" content=\"BarkShop\">\n<meta name=\"csrf-param\" content=\"authenticity_token\">\n<meta name=\"csrf-token\" content=\"XahU6jkQa+n9ViI6ubB+m+oThklYciG20QcYaLXInNbguiJESx6EtJQr9zQ48Dwhz9jr2Shd09J1MTu3Cs/zUg==\">\n<script type=\"text/javascript\">\n    window.current_user = null;\n  window.test_wrangler = {\"cohort\":\"base\",\"experiment\":\"scouts-honor-rewards\",\"variant\":\"scouts-honor-rewards\"};\n</script>\n\n<script src=\"//cdn.optimizely.com/js/2797290298.js\"></script>\n<script type=\"text/javascript\">\n  window.optimizely = window.optimizely || {};\n</script>\n\n<!-- Hotjar Tracking Code for https://barkshop.com -->\n<script>\n    (function(h,o,t,j,a,r){\n        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};\n        h._hjSettings={hjid:253226,hjsv:5};\n        a=o.getElementsByTagName('head')[0];\n        r=o.createElement('script');r.async=1;\n        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;\n        a.appendChild(r);\n    })(window,document,'//static.hotjar.com/c/hotjar-','.js?sv=');\n</script><script async=\"\" src=\"//static.hotjar.com/c/hotjar-253226.js?sv=5\"></script>\n\n<script src=\"https://bounceexchange.com/tag/1168/i.js\" async=\"\"></script><script async=\"\" src=\"https://script.hotjar.com/modules-fa2b48a238bb646d8cc1b2e82176a64f.js\"></script><style type=\"text/css\">iframe#_hjRemoteVarsFrame {display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;}</style><style media=\"print\" class=\"jx_ui_StyleSheet\" __jx__id=\"___$_2\" type=\"text/css\">.zopim { display: none !important }</style><script src=\"https://api.bounceexchange.com/bounce/init1.js?tojQ=function&amp;cts=1492862819926&amp;tzo=300&amp;is_preview=false&amp;website_id=1168&amp;resolution=800x575&amp;referrer=&amp;is_google_pla=0&amp;calling_url=https%3A%2F%2Fwww.barkshop.com%2F&amp;visit_cookie=%7B%22lp%22%3A%22https%253A%252F%252Fwww.barkshop.com%252F%22%2C%22r%22%3A%22%22%7D&amp;cookie=%7B%22v%22%3A%7B%22hillary_in_cart%22%3Afalse%2C%22dognald_in_cart%22%3Afalse%2C%22ever_logged_in%22%3Afalse%7D%2C%22sid%22%3A1%7D&amp;vars[subtotal]=0&amp;vars[email_param]=&amp;vars[hillary_in_cart]=false&amp;vars[dognald_in_cart]=false&amp;vars[logged_in]=false&amp;vars[ever_logged_in]=false&amp;vars[items_in_cart]=0&amp;vars[cart_total]=0&amp;vsuc[hillary_in_cart]=true&amp;vsuc[dognald_in_cart]=true&amp;vdef[ever_logged_in]=false&amp;cookie_too_large=false&amp;bp=0\" type=\"text/javascript\"></script></head>\n\n<body><div class=\"zopim\" __jx__id=\"___$_74 ___$_74\" style=\"margin-top: 0px; margin-right: 0px; margin-bottom: 0px; padding: 0px; border: 0px; background: transparent; overflow: hidden; position: fixed; z-index: 16000002; width: 10px; height: 10px; bottom: 0px; left: 10px; display: none; visibility: hidden;\"><iframe frameborder=\"0\" src=\"about:blank\" style=\"background-color: transparent; vertical-align: text-bottom; position: relative; width: 100%; height: 100%; min-width: 100%; min-height: 100%; max-width: 100%; max-height: 100%; margin: 0px; overflow: hidden; display: block;\"></iframe></div><div class=\"zopim\" __jx__id=\"___$_4 ___$_4\" style=\"margin-top: 0px; margin-right: 0px; margin-bottom: 0px; padding: 0px; border: 0px; background: transparent; overflow: hidden; position: fixed; z-index: 16000001; visibility: hidden; bottom: 0px; left: 10px; border-top-left-radius: 5px; border-top-right-radius: 5px; display: none; width: 240px; height: 335px; box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 3px 2px;\"><iframe frameborder=\"0\" style=\"background-color: transparent; vertical-align: text-bottom; position: relative; width: 100%; height: 100%; min-width: 100%; min-height: 100%; max-width: 100%; max-height: 100%; margin: 0px; overflow: hidden; display: block;\" src=\"about:blank\"></iframe></div>\n<header bs-shrink=\"\" header-height=\"\" ng-class=\"{shrink: scrollHeight > 150 &amp;&amp; !isMobile}\" ng-controller=\"HeaderController\" class=\"ng-scope\">\n<div id=\"banner\">\n<div ng-class=\"{'wrap': !isMobile}\" class=\"wrap\">\n<p>\nFree U.S. shipping on orders\n$35+\nand free returns on all orders\n</p>\n<div class=\"links\" ng-hide=\"isMobile\">\n<a zopim-chat-toggle=\"\">\n<div class=\"fa fa-comment\"></div>\nChat\n</a>\n<a ng-click=\"login()\">\nLogin\n</a>\n<a class=\"cart-count\" ng-click=\"showCart()\">\n<span class=\"ng-binding\">0</span>\n</a>\n</div>\n</div>\n</div>\n<nav class=\"wrap\"><div id=\"hamburger\" ng-click=\"menu.toggle()\">\n<!-- ngIf: !menu.sidebarShowing --><i class=\"fa fa-bars ng-scope\" ng-if=\"!menu.sidebarShowing\"></i><!-- end ngIf: !menu.sidebarShowing -->\n<!-- ngIf: menu.sidebarShowing -->\n</div><a href=\"/\" id=\"logo\" target=\"_self\"><img alt=\"BarkShop\" src=\"//dv4pc7nwcrrvy.cloudfront.net/assets/logo-black-fa0b87a93956c021e74aede0efbe1b32.png\"></a><ul ng-hide=\"isMobile\"><!-- ngRepeat: link in menu.items --><span ng-repeat-start=\"link in menu.items\" class=\"ng-scope\"></span><li class=\"ng-scope\">\n<a ng-href=\"/gifts\" target=\"_self\" class=\"ng-binding\" href=\"/gifts\">Gifts</a>\n<!-- ngIf: link.pages.length > 0 --><ul ng-if=\"link.pages.length > 0\" class=\"ng-scope\">\n<!-- ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/gifts-for-dogs\" target=\"_self\" class=\"ng-binding\" href=\"/gifts-for-dogs\">Gifts for Dogs</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/gifts-dog-people\" target=\"_self\" class=\"ng-binding\" href=\"/gifts-dog-people\">Gifts for Dog People</a>\n</li><!-- end ngRepeat: sub in link.pages -->\n</ul><!-- end ngIf: link.pages.length > 0 -->\n</li>\n<span ng-repeat-end=\"\" class=\"ng-scope\"></span><!-- end ngRepeat: link in menu.items --><span ng-repeat-start=\"link in menu.items\" class=\"ng-scope\"></span><li class=\"ng-scope\">\n<a ng-href=\"/eat\" target=\"_self\" class=\"ng-binding\" href=\"/eat\">Eats</a>\n<!-- ngIf: link.pages.length > 0 --><ul ng-if=\"link.pages.length > 0\" class=\"ng-scope\">\n<!-- ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/treats\" target=\"_self\" class=\"ng-binding\" href=\"/treats\">Treats</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/chews\" target=\"_self\" class=\"ng-binding\" href=\"/chews\">Chews</a>\n</li><!-- end ngRepeat: sub in link.pages -->\n</ul><!-- end ngIf: link.pages.length > 0 -->\n</li>\n<span ng-repeat-end=\"\" class=\"ng-scope\"></span><!-- end ngRepeat: link in menu.items --><span ng-repeat-start=\"link in menu.items\" class=\"ng-scope\"></span><li class=\"ng-scope\">\n<a ng-href=\"/play\" target=\"_self\" class=\"ng-binding\" href=\"/play\">Play</a>\n<!-- ngIf: link.pages.length > 0 --><ul ng-if=\"link.pages.length > 0\" class=\"ng-scope\">\n<!-- ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/plush\" target=\"_self\" class=\"ng-binding\" href=\"/plush\">Plush</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/superchewer\" target=\"_self\" class=\"ng-binding\" href=\"/superchewer\">Super Chewer</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/fetch\" target=\"_self\" class=\"ng-binding\" href=\"/fetch\">Fetch</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/thinkers\" target=\"_self\" class=\"ng-binding\" href=\"/thinkers\">Thinkers</a>\n</li><!-- end ngRepeat: sub in link.pages -->\n</ul><!-- end ngIf: link.pages.length > 0 -->\n</li>\n<span ng-repeat-end=\"\" class=\"ng-scope\"></span><!-- end ngRepeat: link in menu.items --><span ng-repeat-start=\"link in menu.items\" class=\"ng-scope\"></span><li class=\"ng-scope\">\n<a ng-href=\"/wear\" target=\"_self\" class=\"ng-binding\" href=\"/wear\">Wear</a>\n<!-- ngIf: link.pages.length > 0 --><ul ng-if=\"link.pages.length > 0\" class=\"ng-scope\">\n<!-- ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/leashes\" target=\"_self\" class=\"ng-binding\" href=\"/leashes\">Leashes, Collars &amp; Harnesses</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/outerwear\" target=\"_self\" class=\"ng-binding\" href=\"/outerwear\">Outerwear</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/accessories\" target=\"_self\" class=\"ng-binding\" href=\"/accessories\">Accessories</a>\n</li><!-- end ngRepeat: sub in link.pages -->\n</ul><!-- end ngIf: link.pages.length > 0 -->\n</li>\n<span ng-repeat-end=\"\" class=\"ng-scope\"></span><!-- end ngRepeat: link in menu.items --><span ng-repeat-start=\"link in menu.items\" class=\"ng-scope\"></span><li class=\"ng-scope\">\n<a ng-href=\"/nest\" target=\"_self\" class=\"ng-binding\" href=\"/nest\">Nest</a>\n<!-- ngIf: link.pages.length > 0 --><ul ng-if=\"link.pages.length > 0\" class=\"ng-scope\">\n<!-- ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/sleep\" target=\"_self\" class=\"ng-binding\" href=\"/sleep\">Sleep</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/dine\" target=\"_self\" class=\"ng-binding\" href=\"/dine\">Dine</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/daily-essentials\" target=\"_self\" class=\"ng-binding\" href=\"/daily-essentials\">Daily Essentials</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/travel\" target=\"_self\" class=\"ng-binding\" href=\"/travel\">Travel</a>\n</li><!-- end ngRepeat: sub in link.pages -->\n</ul><!-- end ngIf: link.pages.length > 0 -->\n</li>\n<span ng-repeat-end=\"\" class=\"ng-scope\"></span><!-- end ngRepeat: link in menu.items --><span ng-repeat-start=\"link in menu.items\" class=\"ng-scope\"></span><li class=\"ng-scope\">\n<a ng-href=\"/humans\" target=\"_self\" class=\"ng-binding\" href=\"/humans\">Humans</a>\n<!-- ngIf: link.pages.length > 0 --><ul ng-if=\"link.pages.length > 0\" class=\"ng-scope\">\n<!-- ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/books\" target=\"_self\" class=\"ng-binding\" href=\"/books\">Books &amp; Stationery</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/human-accessories\" target=\"_self\" class=\"ng-binding\" href=\"/human-accessories\">Apparel &amp; Accessories</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/homegoods\" target=\"_self\" class=\"ng-binding\" href=\"/homegoods\">Homegoods</a>\n</li><!-- end ngRepeat: sub in link.pages -->\n</ul><!-- end ngIf: link.pages.length > 0 -->\n</li>\n<span ng-repeat-end=\"\" class=\"ng-scope\"></span><!-- end ngRepeat: link in menu.items --><span ng-repeat-start=\"link in menu.items\" class=\"ng-scope\"></span><li class=\"ng-scope\">\n<a ng-href=\"\" target=\"_self\" class=\"ng-binding\">Collections</a>\n<!-- ngIf: link.pages.length > 0 --><ul ng-if=\"link.pages.length > 0\" class=\"ng-scope\">\n<!-- ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/destroyers-club-collection\" target=\"_self\" class=\"ng-binding\" href=\"/destroyers-club-collection\">Destroyers Club</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/emojis\" target=\"_self\" class=\"ng-binding\" href=\"/emojis\">Emojis</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/bundles-boxes\" target=\"_self\" class=\"ng-binding\" href=\"/bundles-boxes\">Bundles &amp; Boxes</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/shop-the-box\" target=\"_self\" class=\"ng-binding\" href=\"/shop-the-box\">Shop the Box</a>\n</li><!-- end ngRepeat: sub in link.pages --><li class=\"triangle ng-scope\" ng-repeat=\"sub in link.pages\">\n<a ng-href=\"/made-by-bark-co\" target=\"_self\" class=\"ng-binding\" href=\"/made-by-bark-co\">Made by Bark &amp; Co.</a>\n</li><!-- end ngRepeat: sub in link.pages -->\n</ul><!-- end ngIf: link.pages.length > 0 -->\n</li>\n<span ng-repeat-end=\"\" class=\"ng-scope\"></span><!-- end ngRepeat: link in menu.items -->\n</ul><a class=\"black cart-count ng-hide\" ng-click=\"showCart()\" ng-hide=\"!isMobile\">\n<span class=\"ng-binding\">0</span>\n</a><i class=\"fa fa-search ng-hide\" ng-click=\"toggleSearch()\" ng-hide=\"!isMobile\"></i><div class=\"\" id=\"search\" ng-show=\"!isMobile\"><form class=\"search-form ng-pristine ng-valid\" ng-submit=\"submitSearch()\"><input ng-model=\"term\" placeholder=\"Search...\" class=\"ng-pristine ng-untouched ng-valid ng-empty\"><button class=\"fa fa-search\" type=\"submit\"></button>\n</form></div>\n</nav>\n<div class=\"ng-hide\" id=\"search\" ng-show=\"isMobile &amp;&amp; mobileSearch\"><form class=\"search-form ng-pristine ng-valid\" ng-submit=\"submitSearch()\"><input id=\"mobile-search-input\" ng-model=\"term\" placeholder=\"Search...\" class=\"ng-pristine ng-untouched ng-valid ng-empty\"></form></div>\n<div id=\"sidebar\" ng-style=\"{'left': menu.sidebarShowing ? 0 : inherit, 'height': windowDimensions.height - headerHeight}\" sidebar-menu=\"\" style=\"height: 471px;\">\n<ul>\n<!-- ngRepeat: link in menu.items --><li ng-class=\"{'has-children': link.pages.length > 0}\" ng-repeat=\"link in menu.items\" class=\"ng-scope has-children\">\n<a ng-click=\"menu.showSubMenu(link.slug)\" ng-href=\"#\" target=\"_self\" class=\"ng-binding\" href=\"#\">Gifts</a>\n<!-- ngIf: link.pages.length > 0 --><ul ng-if=\"link.pages.length > 0\" ng-style=\"{'left': (menu.activeSubMenu &amp;&amp; menu.activeSubMenu == link.slug) ? 0 : inherit, 'height': sidebarMenuHeight}\" class=\"ng-scope\" style=\"height: 0px;\">\n<li class=\"return\">\n<a ng-click=\"menu.hideSubMenu()\">\n<i class=\"fa fa-angle-left\"></i>\nBack: Home\n</a>\n</li>\n<!-- ngIf: link.slug --><li ng-if=\"link.slug\" class=\"ng-scope\">\n<a ng-href=\"/gifts\" target=\"_self\" class=\"ng-binding\" href=\"/gifts\">Gifts</a>\n</li><!-- end ngIf: link.slug -->\n<!-- ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/gifts-for-dogs\" target=\"_self\" class=\"ng-binding\" href=\"/gifts-for-dogs\">\n<i class=\"fa fa-caret-right\"></i>\nGifts for Dogs\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/gifts-dog-people\" target=\"_self\" class=\"ng-binding\" href=\"/gifts-dog-people\">\n<i class=\"fa fa-caret-right\"></i>\nGifts for Dog People\n</a>\n</li><!-- end ngRepeat: sub in link.pages -->\n</ul><!-- end ngIf: link.pages.length > 0 -->\n</li><!-- end ngRepeat: link in menu.items --><li ng-class=\"{'has-children': link.pages.length > 0}\" ng-repeat=\"link in menu.items\" class=\"ng-scope has-children\">\n<a ng-click=\"menu.showSubMenu(link.slug)\" ng-href=\"#\" target=\"_self\" class=\"ng-binding\" href=\"#\">Eats</a>\n<!-- ngIf: link.pages.length > 0 --><ul ng-if=\"link.pages.length > 0\" ng-style=\"{'left': (menu.activeSubMenu &amp;&amp; menu.activeSubMenu == link.slug) ? 0 : inherit, 'height': sidebarMenuHeight}\" class=\"ng-scope\" style=\"height: 0px;\">\n<li class=\"return\">\n<a ng-click=\"menu.hideSubMenu()\">\n<i class=\"fa fa-angle-left\"></i>\nBack: Home\n</a>\n</li>\n<!-- ngIf: link.slug --><li ng-if=\"link.slug\" class=\"ng-scope\">\n<a ng-href=\"/eat\" target=\"_self\" class=\"ng-binding\" href=\"/eat\">Eats</a>\n</li><!-- end ngIf: link.slug -->\n<!-- ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/treats\" target=\"_self\" class=\"ng-binding\" href=\"/treats\">\n<i class=\"fa fa-caret-right\"></i>\nTreats\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/chews\" target=\"_self\" class=\"ng-binding\" href=\"/chews\">\n<i class=\"fa fa-caret-right\"></i>\nChews\n</a>\n</li><!-- end ngRepeat: sub in link.pages -->\n</ul><!-- end ngIf: link.pages.length > 0 -->\n</li><!-- end ngRepeat: link in menu.items --><li ng-class=\"{'has-children': link.pages.length > 0}\" ng-repeat=\"link in menu.items\" class=\"ng-scope has-children\">\n<a ng-click=\"menu.showSubMenu(link.slug)\" ng-href=\"#\" target=\"_self\" class=\"ng-binding\" href=\"#\">Play</a>\n<!-- ngIf: link.pages.length > 0 --><ul ng-if=\"link.pages.length > 0\" ng-style=\"{'left': (menu.activeSubMenu &amp;&amp; menu.activeSubMenu == link.slug) ? 0 : inherit, 'height': sidebarMenuHeight}\" class=\"ng-scope\" style=\"height: 0px;\">\n<li class=\"return\">\n<a ng-click=\"menu.hideSubMenu()\">\n<i class=\"fa fa-angle-left\"></i>\nBack: Home\n</a>\n</li>\n<!-- ngIf: link.slug --><li ng-if=\"link.slug\" class=\"ng-scope\">\n<a ng-href=\"/play\" target=\"_self\" class=\"ng-binding\" href=\"/play\">Play</a>\n</li><!-- end ngIf: link.slug -->\n<!-- ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/plush\" target=\"_self\" class=\"ng-binding\" href=\"/plush\">\n<i class=\"fa fa-caret-right\"></i>\nPlush\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/superchewer\" target=\"_self\" class=\"ng-binding\" href=\"/superchewer\">\n<i class=\"fa fa-caret-right\"></i>\nSuper Chewer\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/fetch\" target=\"_self\" class=\"ng-binding\" href=\"/fetch\">\n<i class=\"fa fa-caret-right\"></i>\nFetch\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/thinkers\" target=\"_self\" class=\"ng-binding\" href=\"/thinkers\">\n<i class=\"fa fa-caret-right\"></i>\nThinkers\n</a>\n</li><!-- end ngRepeat: sub in link.pages -->\n</ul><!-- end ngIf: link.pages.length > 0 -->\n</li><!-- end ngRepeat: link in menu.items --><li ng-class=\"{'has-children': link.pages.length > 0}\" ng-repeat=\"link in menu.items\" class=\"ng-scope has-children\">\n<a ng-click=\"menu.showSubMenu(link.slug)\" ng-href=\"#\" target=\"_self\" class=\"ng-binding\" href=\"#\">Wear</a>\n<!-- ngIf: link.pages.length > 0 --><ul ng-if=\"link.pages.length > 0\" ng-style=\"{'left': (menu.activeSubMenu &amp;&amp; menu.activeSubMenu == link.slug) ? 0 : inherit, 'height': sidebarMenuHeight}\" class=\"ng-scope\" style=\"height: 0px;\">\n<li class=\"return\">\n<a ng-click=\"menu.hideSubMenu()\">\n<i class=\"fa fa-angle-left\"></i>\nBack: Home\n</a>\n</li>\n<!-- ngIf: link.slug --><li ng-if=\"link.slug\" class=\"ng-scope\">\n<a ng-href=\"/wear\" target=\"_self\" class=\"ng-binding\" href=\"/wear\">Wear</a>\n</li><!-- end ngIf: link.slug -->\n<!-- ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/leashes\" target=\"_self\" class=\"ng-binding\" href=\"/leashes\">\n<i class=\"fa fa-caret-right\"></i>\nLeashes, Collars &amp; Harnesses\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/outerwear\" target=\"_self\" class=\"ng-binding\" href=\"/outerwear\">\n<i class=\"fa fa-caret-right\"></i>\nOuterwear\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/accessories\" target=\"_self\" class=\"ng-binding\" href=\"/accessories\">\n<i class=\"fa fa-caret-right\"></i>\nAccessories\n</a>\n</li><!-- end ngRepeat: sub in link.pages -->\n</ul><!-- end ngIf: link.pages.length > 0 -->\n</li><!-- end ngRepeat: link in menu.items --><li ng-class=\"{'has-children': link.pages.length > 0}\" ng-repeat=\"link in menu.items\" class=\"ng-scope has-children\">\n<a ng-click=\"menu.showSubMenu(link.slug)\" ng-href=\"#\" target=\"_self\" class=\"ng-binding\" href=\"#\">Nest</a>\n<!-- ngIf: link.pages.length > 0 --><ul ng-if=\"link.pages.length > 0\" ng-style=\"{'left': (menu.activeSubMenu &amp;&amp; menu.activeSubMenu == link.slug) ? 0 : inherit, 'height': sidebarMenuHeight}\" class=\"ng-scope\" style=\"height: 0px;\">\n<li class=\"return\">\n<a ng-click=\"menu.hideSubMenu()\">\n<i class=\"fa fa-angle-left\"></i>\nBack: Home\n</a>\n</li>\n<!-- ngIf: link.slug --><li ng-if=\"link.slug\" class=\"ng-scope\">\n<a ng-href=\"/nest\" target=\"_self\" class=\"ng-binding\" href=\"/nest\">Nest</a>\n</li><!-- end ngIf: link.slug -->\n<!-- ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/sleep\" target=\"_self\" class=\"ng-binding\" href=\"/sleep\">\n<i class=\"fa fa-caret-right\"></i>\nSleep\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/dine\" target=\"_self\" class=\"ng-binding\" href=\"/dine\">\n<i class=\"fa fa-caret-right\"></i>\nDine\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/daily-essentials\" target=\"_self\" class=\"ng-binding\" href=\"/daily-essentials\">\n<i class=\"fa fa-caret-right\"></i>\nDaily Essentials\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/travel\" target=\"_self\" class=\"ng-binding\" href=\"/travel\">\n<i class=\"fa fa-caret-right\"></i>\nTravel\n</a>\n</li><!-- end ngRepeat: sub in link.pages -->\n</ul><!-- end ngIf: link.pages.length > 0 -->\n</li><!-- end ngRepeat: link in menu.items --><li ng-class=\"{'has-children': link.pages.length > 0}\" ng-repeat=\"link in menu.items\" class=\"ng-scope has-children\">\n<a ng-click=\"menu.showSubMenu(link.slug)\" ng-href=\"#\" target=\"_self\" class=\"ng-binding\" href=\"#\">Humans</a>\n<!-- ngIf: link.pages.length > 0 --><ul ng-if=\"link.pages.length > 0\" ng-style=\"{'left': (menu.activeSubMenu &amp;&amp; menu.activeSubMenu == link.slug) ? 0 : inherit, 'height': sidebarMenuHeight}\" class=\"ng-scope\" style=\"height: 0px;\">\n<li class=\"return\">\n<a ng-click=\"menu.hideSubMenu()\">\n<i class=\"fa fa-angle-left\"></i>\nBack: Home\n</a>\n</li>\n<!-- ngIf: link.slug --><li ng-if=\"link.slug\" class=\"ng-scope\">\n<a ng-href=\"/humans\" target=\"_self\" class=\"ng-binding\" href=\"/humans\">Humans</a>\n</li><!-- end ngIf: link.slug -->\n<!-- ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/books\" target=\"_self\" class=\"ng-binding\" href=\"/books\">\n<i class=\"fa fa-caret-right\"></i>\nBooks &amp; Stationery\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/human-accessories\" target=\"_self\" class=\"ng-binding\" href=\"/human-accessories\">\n<i class=\"fa fa-caret-right\"></i>\nApparel &amp; Accessories\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/homegoods\" target=\"_self\" class=\"ng-binding\" href=\"/homegoods\">\n<i class=\"fa fa-caret-right\"></i>\nHomegoods\n</a>\n</li><!-- end ngRepeat: sub in link.pages -->\n</ul><!-- end ngIf: link.pages.length > 0 -->\n</li><!-- end ngRepeat: link in menu.items --><li ng-class=\"{'has-children': link.pages.length > 0}\" ng-repeat=\"link in menu.items\" class=\"ng-scope has-children\">\n<a ng-click=\"menu.showSubMenu(link.slug)\" ng-href=\"#\" target=\"_self\" class=\"ng-binding\" href=\"#\">Collections</a>\n<!-- ngIf: link.pages.length > 0 --><ul ng-if=\"link.pages.length > 0\" ng-style=\"{'left': (menu.activeSubMenu &amp;&amp; menu.activeSubMenu == link.slug) ? 0 : inherit, 'height': sidebarMenuHeight}\" class=\"ng-scope\" style=\"height: 0px;\">\n<li class=\"return\">\n<a ng-click=\"menu.hideSubMenu()\">\n<i class=\"fa fa-angle-left\"></i>\nBack: Home\n</a>\n</li>\n<!-- ngIf: link.slug --><li ng-if=\"link.slug\" class=\"ng-scope\">\n<a ng-href=\"\" target=\"_self\" class=\"ng-binding\">Collections</a>\n</li><!-- end ngIf: link.slug -->\n<!-- ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/destroyers-club-collection\" target=\"_self\" class=\"ng-binding\" href=\"/destroyers-club-collection\">\n<i class=\"fa fa-caret-right\"></i>\nDestroyers Club\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/emojis\" target=\"_self\" class=\"ng-binding\" href=\"/emojis\">\n<i class=\"fa fa-caret-right\"></i>\nEmojis\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/bundles-boxes\" target=\"_self\" class=\"ng-binding\" href=\"/bundles-boxes\">\n<i class=\"fa fa-caret-right\"></i>\nBundles &amp; Boxes\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/shop-the-box\" target=\"_self\" class=\"ng-binding\" href=\"/shop-the-box\">\n<i class=\"fa fa-caret-right\"></i>\nShop the Box\n</a>\n</li><!-- end ngRepeat: sub in link.pages --><li ng-repeat=\"sub in link.pages\" class=\"ng-scope\">\n<a ng-href=\"/made-by-bark-co\" target=\"_self\" class=\"ng-binding\" href=\"/made-by-bark-co\">\n<i class=\"fa fa-caret-right\"></i>\nMade by Bark &amp; Co.\n</a>\n</li><!-- end ngRepeat: sub in link.pages -->\n</ul><!-- end ngIf: link.pages.length > 0 -->\n</li><!-- end ngRepeat: link in menu.items -->\n</ul><div id=\"mobile-fixed-menu\"><a ng-click=\"login()\">\nLogin\n</a><a zopim-chat-open=\"\">\nWanna Chat?\n</a>\n</div></div>\n</header>\n\n\n<div id=\"main\">\n\n<div id=\"home\" ng-controller=\"HomeController\" class=\"ng-scope\">\n      <div class=\"slick-wrapper\">\n        <div class=\"ng-isolate-scope slick-initialized slick-slider slick-dotted\" slick=\"\" invertable=\"\" settings=\"slickConfig\" ng-show=\"slickReady\" role=\"toolbar\" style=\"display: block;\"><button type=\"button\" data-role=\"none\" class=\"slick-prev slick-arrow\" aria-label=\"Previous\" role=\"button\" style=\"display: block;\">Previous</button>\n            <div aria-live=\"polite\" class=\"slick-list draggable\" style=\"height: 240px;\"><div class=\"slick-track\" role=\"listbox\" style=\"opacity: 1; width: 3140px;\"><article data-is-dark=\"false\" class=\"slick-slide slick-current slick-active\" data-slick-index=\"0\" aria-hidden=\"false\" tabindex=\"-1\" role=\"option\" aria-describedby=\"slick-slide00\" style=\"width: 785px; position: relative; left: 0px; top: 0px; z-index: 999; opacity: 1;\">\n              <a class=\"carousel-image ng-isolate-scope\" track-link=\"\" track-event=\"Homepage Click\" track-name=\"Eats\" track-feature=\"Hero Carousel\" target=\"_self\" ng-href=\"/eat\" ng-hide=\"isMobile\" href=\"/eat\" tabindex=\"0\">\n                <img class=\"\" src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/06dcfc98c7c00f23d772ce728e1fdda7eb45d920.png?1492694191\">\n              </a>\n              <a class=\"carousel-image ng-isolate-scope ng-hide\" track-link=\"\" track-event=\"Homepage Click\" track-name=\"Eats\" track-feature=\"Hero Carousel\" target=\"_self\" ng-href=\"/eat\" ng-hide=\"!isMobile\" href=\"/eat\" tabindex=\"0\">\n                <img class=\"\" src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/209f4818dd1cad74a74b84cb99e92de2c4f009fa.png?1492694191\">\n              </a>\n            </article><article data-is-dark=\"true\" class=\"slick-slide\" data-slick-index=\"1\" aria-hidden=\"true\" tabindex=\"-1\" role=\"option\" aria-describedby=\"slick-slide01\" style=\"width: 785px; position: relative; left: -785px; top: 0px; z-index: 998; opacity: 0;\">\n              <a class=\"carousel-image ng-isolate-scope\" track-link=\"\" track-event=\"Homepage Click\" track-name=\"Destroyers Club\" track-feature=\"Hero Carousel\" target=\"_self\" ng-href=\"/destroyers-club-collection\" ng-hide=\"isMobile\" href=\"/destroyers-club-collection\" tabindex=\"-1\">\n                <img class=\"\" src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/d53fe19936ab7d67d4eb24079bbd70d3c5a601e5.jpg?1491513863\">\n              </a>\n              <a class=\"carousel-image ng-isolate-scope ng-hide\" track-link=\"\" track-event=\"Homepage Click\" track-name=\"Destroyers Club\" track-feature=\"Hero Carousel\" target=\"_self\" ng-href=\"/destroyers-club-collection\" ng-hide=\"!isMobile\" href=\"/destroyers-club-collection\" tabindex=\"-1\">\n                <img class=\"\" src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/c946e6d4338d1aecd29294552ba9876125e29719.jpg?1491513863\">\n              </a>\n            </article><article data-is-dark=\"false\" class=\"slick-slide\" data-slick-index=\"2\" aria-hidden=\"true\" tabindex=\"-1\" role=\"option\" aria-describedby=\"slick-slide02\" style=\"width: 785px; position: relative; left: -1570px; top: 0px; z-index: 998; opacity: 0;\">\n              <a class=\"carousel-image ng-isolate-scope\" track-link=\"\" track-event=\"Homepage Click\" track-name=\"Shop the Box\" track-feature=\"Hero Carousel\" target=\"_self\" ng-href=\"/shop-the-box\" ng-hide=\"isMobile\" href=\"/shop-the-box\" tabindex=\"-1\">\n                <img class=\"\" src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/3e7ab784dffd4646b66d226be9f1d9fc99d31440.jpg?1491927768\">\n              </a>\n              <a class=\"carousel-image ng-isolate-scope ng-hide\" track-link=\"\" track-event=\"Homepage Click\" track-name=\"Shop the Box\" track-feature=\"Hero Carousel\" target=\"_self\" ng-href=\"/shop-the-box\" ng-hide=\"!isMobile\" href=\"/shop-the-box\" tabindex=\"-1\">\n                <img class=\"\" src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/09239e201af89c0ed0e8d4a87c13caab7011bc7d.jpg?1491927768\">\n              </a>\n            </article><article data-is-dark=\"false\" class=\"slick-slide\" data-slick-index=\"3\" aria-hidden=\"true\" tabindex=\"-1\" role=\"option\" aria-describedby=\"slick-slide03\" style=\"width: 785px; position: relative; left: -2355px; top: 0px; z-index: 998; opacity: 0;\">\n              <a class=\"carousel-image ng-isolate-scope\" track-link=\"\" track-event=\"Homepage Click\" track-name=\"Treat Sampler\" track-feature=\"Hero Carousel\" target=\"_self\" ng-href=\"/treat-sampler\" ng-hide=\"isMobile\" href=\"/treat-sampler\" tabindex=\"-1\">\n                <img class=\"\" src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/60af97625204a105a9285259800598f6629be57e.jpg?1484160980\">\n              </a>\n              <a class=\"carousel-image ng-isolate-scope ng-hide\" track-link=\"\" track-event=\"Homepage Click\" track-name=\"Treat Sampler\" track-feature=\"Hero Carousel\" target=\"_self\" ng-href=\"/treat-sampler\" ng-hide=\"!isMobile\" href=\"/treat-sampler\" tabindex=\"-1\">\n                <img class=\"\" src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/20d2afe7a62997e3b8928419c991998921228930.jpg?1484160980\">\n              </a>\n            </article></div></div>\n            \n            \n            \n        <button type=\"button\" data-role=\"none\" class=\"slick-next slick-arrow\" aria-label=\"Next\" role=\"button\" style=\"display: block;\">Next</button><ul class=\"slick-dots\" style=\"display: block;\" role=\"tablist\"><li class=\"slick-active\" aria-hidden=\"false\" role=\"presentation\" aria-selected=\"true\" aria-controls=\"navigation00\" id=\"slick-slide00\"><button type=\"button\" data-role=\"none\" role=\"button\" tabindex=\"0\">1</button></li><li aria-hidden=\"true\" role=\"presentation\" aria-selected=\"false\" aria-controls=\"navigation01\" id=\"slick-slide01\"><button type=\"button\" data-role=\"none\" role=\"button\" tabindex=\"0\">2</button></li><li aria-hidden=\"true\" role=\"presentation\" aria-selected=\"false\" aria-controls=\"navigation02\" id=\"slick-slide02\"><button type=\"button\" data-role=\"none\" role=\"button\" tabindex=\"0\">3</button></li><li aria-hidden=\"true\" role=\"presentation\" aria-selected=\"false\" aria-controls=\"navigation03\" id=\"slick-slide03\"><button type=\"button\" data-role=\"none\" role=\"button\" tabindex=\"0\">4</button></li></ul></div>\n      </div>\n    <section class=\"subfeatured-row wrap\">\n      <a class=\"subfeatured ng-isolate-scope\" track-link=\"\" track-event=\"Homepage Click\" track-name=\"Destroyer's Club Landing\" track-feature=\"Subfeature\" ng-href=\"/destroyers\" target=\"_self\" href=\"/destroyers\">\n        <img src=\"https://barkshop_production.s3.amazonaws.com/assets/destroyers-club-homepage-subfeatured.png\" alt=\"Destroyers club homepage subfeatured\">\n      </a>\n        <a class=\"subfeatured ng-isolate-scope\" track-link=\"\" track-event=\"Homepage Click\" track-name=\"Play\" track-feature=\"Subfeature\" ng-href=\"/play\" target=\"_self\" href=\"/play\">\n          <img src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/90e3ed7d76f6aaa9b2c2451700734ac5edfef116.png?1445271694\" alt=\"90e3ed7d76f6aaa9b2c2451700734ac5edfef116\">\n        </a>\n    </section>\n  <a class=\"scouts-honor wrap ng-isolate-scope\" href=\"/scouts-honor\" target=\"_blank\" track-link=\"\" track-event=\"Homepage Click\" track-name=\"Scouts Honor\">\n    <div>\n      <img src=\"//dv4pc7nwcrrvy.cloudfront.net/assets/scouts-honor/logo-94c7852fb80f410da5e0143e68ef7e45.png\" alt=\"Logo\">\n    </div><div>\n      <h4>Free U.S. Shipping on all orders over $35 + free returns.</h4>\n      <p>Bark &amp; Co’s promise, priority, and policy is that our products will make your dog happy – or we'll fix it!</p>\n    </div>\n  </a>\n  <section class=\"popular\" ng-show=\"!!popularProducts &amp;&amp; popularProducts.items.length > 0\">\n    <h4>Popular Products</h4>\n    <div class=\"wrap clearfix\">\n      <!-- ngRepeat: item in popularProducts.items | limitTo:6 --><span ng-repeat-start=\"item in popularProducts.items | limitTo:6\" class=\"ng-scope\"></span>\n      <!-- ngInclude: 'home/item.html' --><article ng-include=\"'home/item.html'\" class=\"ng-scope\"><div ng-class=\"{'sold-out' : item.quantity_available_all_variants <= 0}\" class=\"ng-scope\">\n  <a track-link=\"\" track-event=\"Homepage Click\" track-name=\"Feast for Your Beast&nbsp;Treat&nbsp;Sampler\" track-feature=\"Popular Product\" ng-href=\"/items/feast-sampler\" target=\"_self\" class=\"ng-isolate-scope\" href=\"/items/feast-sampler\">\n    <div bs-image=\"\" image-data=\"[{&quot;url&quot;:&quot;https://d1sgp4rxw9t8ft.cloudfront.net/items/a4d8d63f26641f93a82432f053317f3a0b36ea83.jpg?1479415239&quot;,&quot;is_dark&quot;:false}]\" alt-data=\"Feast for Your Beast&nbsp;Treat&nbsp;Sampler\"><img src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/a4d8d63f26641f93a82432f053317f3a0b36ea83.jpg?1479415239\" alt=\"Feast for Your Beast&nbsp;Treat&nbsp;Sampler\" class=\"ng-scope\"></div>\n    <div class=\"doodle\" bs-image=\"\" image-data=\"\"></div>\n    <h6 class=\"ng-binding\">Feast for Your Beast&nbsp;Treat&nbsp;Sampler</h6>\n    <!-- ngIf: item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0 --><span class=\"price ng-binding ng-scope\" ng-if=\"item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0\">$24.00</span><!-- end ngIf: item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0 -->\n    <!-- ngIf: item.quantity_available_all_variants <= 0 -->\n  </a>\n</div></article>\n      <!-- ngIf: $index == 0 --><article class=\"inline-doodle ng-scope\" ng-if=\"$index == 0\"><img src=\"//dv4pc7nwcrrvy.cloudfront.net/assets/inline-doodle-1-46c2bcdc57a8059ed0b25267a955f971.gif\"></article><!-- end ngIf: $index == 0 -->\n      <!-- ngIf: $index == 5 -->\n      <span ng-repeat-end=\"\" class=\"ng-scope\"></span><!-- end ngRepeat: item in popularProducts.items | limitTo:6 --><span ng-repeat-start=\"item in popularProducts.items | limitTo:6\" class=\"ng-scope\"></span>\n      <!-- ngInclude: 'home/item.html' --><article ng-include=\"'home/item.html'\" class=\"ng-scope\"><div ng-class=\"{'sold-out' : item.quantity_available_all_variants <= 0}\" class=\"ng-scope\">\n  <a track-link=\"\" track-event=\"Homepage Click\" track-name=\"Wild Alaskan Salmon Jerky\" track-feature=\"Popular Product\" ng-href=\"/items/wild-alaskan-salmon-jerky-treat\" target=\"_self\" class=\"ng-isolate-scope\" href=\"/items/wild-alaskan-salmon-jerky-treat\">\n    <div bs-image=\"\" image-data=\"[{&quot;url&quot;:&quot;https://d1sgp4rxw9t8ft.cloudfront.net/items/a25679bf0bcd922d7164fb3bcda77805d00341b6.jpg?1421186631&quot;,&quot;is_dark&quot;:false}]\" alt-data=\"Wild Alaskan Salmon Jerky\"><img src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/a25679bf0bcd922d7164fb3bcda77805d00341b6.jpg?1421186631\" alt=\"Wild Alaskan Salmon Jerky\" class=\"ng-scope\"></div>\n    <div class=\"doodle\" bs-image=\"\" image-data=\"\"></div>\n    <h6 class=\"ng-binding\">Wild Alaskan Salmon Jerky</h6>\n    <!-- ngIf: item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0 --><span class=\"price ng-binding ng-scope\" ng-if=\"item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0\">$11.00</span><!-- end ngIf: item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0 -->\n    <!-- ngIf: item.quantity_available_all_variants <= 0 -->\n  </a>\n</div></article>\n      <!-- ngIf: $index == 0 -->\n      <!-- ngIf: $index == 5 -->\n      <span ng-repeat-end=\"\" class=\"ng-scope\"></span><!-- end ngRepeat: item in popularProducts.items | limitTo:6 --><span ng-repeat-start=\"item in popularProducts.items | limitTo:6\" class=\"ng-scope\"></span>\n      <!-- ngInclude: 'home/item.html' --><article ng-include=\"'home/item.html'\" class=\"ng-scope\"><div ng-class=\"{'sold-out' : item.quantity_available_all_variants <= 0}\" class=\"ng-scope\">\n  <a track-link=\"\" track-event=\"Homepage Click\" track-name=\"Pug Apron\" track-feature=\"Popular Product\" ng-href=\"/items/pug-apron\" target=\"_self\" class=\"ng-isolate-scope\" href=\"/items/pug-apron\">\n    <div bs-image=\"\" image-data=\"[{&quot;url&quot;:&quot;https://d1sgp4rxw9t8ft.cloudfront.net/items/4b10594fb22399039ee9002beee07854dc00bffd.jpg?1488135326&quot;,&quot;is_dark&quot;:false}]\" alt-data=\"Pug Apron\"><img src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/4b10594fb22399039ee9002beee07854dc00bffd.jpg?1488135326\" alt=\"Pug Apron\" class=\"ng-scope\"></div>\n    <div class=\"doodle\" bs-image=\"\" image-data=\"\"></div>\n    <h6 class=\"ng-binding\">Pug Apron</h6>\n    <!-- ngIf: item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0 --><span class=\"price ng-binding ng-scope\" ng-if=\"item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0\">$44.00</span><!-- end ngIf: item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0 -->\n    <!-- ngIf: item.quantity_available_all_variants <= 0 -->\n  </a>\n</div></article>\n      <!-- ngIf: $index == 0 -->\n      <!-- ngIf: $index == 5 -->\n      <span ng-repeat-end=\"\" class=\"ng-scope\"></span><!-- end ngRepeat: item in popularProducts.items | limitTo:6 --><span ng-repeat-start=\"item in popularProducts.items | limitTo:6\" class=\"ng-scope\"></span>\n      <!-- ngInclude: 'home/item.html' --><article ng-include=\"'home/item.html'\" class=\"ng-scope\"><div ng-class=\"{'sold-out' : item.quantity_available_all_variants <= 0}\" class=\"ng-scope\">\n  <a track-link=\"\" track-event=\"Homepage Click\" track-name=\"Sheri Gray Deep Dish Cuddler\" track-feature=\"Popular Product\" ng-href=\"/items/sheri-gary-deep-dish-cuddler\" target=\"_self\" class=\"ng-isolate-scope\" href=\"/items/sheri-gary-deep-dish-cuddler\">\n    <div bs-image=\"\" image-data=\"[{&quot;url&quot;:&quot;https://d1sgp4rxw9t8ft.cloudfront.net/items/246b5be04fc530ff6e62bb2b5eba3784d79210a6.jpg?1480615609&quot;,&quot;is_dark&quot;:false}]\" alt-data=\"Sheri Gray Deep Dish Cuddler\"><img src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/246b5be04fc530ff6e62bb2b5eba3784d79210a6.jpg?1480615609\" alt=\"Sheri Gray Deep Dish Cuddler\" class=\"ng-scope\"></div>\n    <div class=\"doodle\" bs-image=\"\" image-data=\"\"></div>\n    <h6 class=\"ng-binding\">Sheri Gray Deep Dish Cuddler</h6>\n    <!-- ngIf: item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0 --><span class=\"price ng-binding ng-scope\" ng-if=\"item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0\">$45.00</span><!-- end ngIf: item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0 -->\n    <!-- ngIf: item.quantity_available_all_variants <= 0 -->\n  </a>\n</div></article>\n      <!-- ngIf: $index == 0 -->\n      <!-- ngIf: $index == 5 -->\n      <span ng-repeat-end=\"\" class=\"ng-scope\"></span><!-- end ngRepeat: item in popularProducts.items | limitTo:6 --><span ng-repeat-start=\"item in popularProducts.items | limitTo:6\" class=\"ng-scope\"></span>\n      <!-- ngInclude: 'home/item.html' --><article ng-include=\"'home/item.html'\" class=\"ng-scope\"><div ng-class=\"{'sold-out' : item.quantity_available_all_variants <= 0}\" class=\"ng-scope\">\n  <a track-link=\"\" track-event=\"Homepage Click\" track-name=\"Happy Barkday Gift Box\" track-feature=\"Popular Product\" ng-href=\"/items/happy-birthday-gift-box-medium-large\" target=\"_self\" class=\"ng-isolate-scope\" href=\"/items/happy-birthday-gift-box-medium-large\">\n    <div bs-image=\"\" image-data=\"[{&quot;url&quot;:&quot;https://d1sgp4rxw9t8ft.cloudfront.net/items/68269dfd75070e93430d7b6a8e0947c51fe91261.jpg?1461237892&quot;,&quot;is_dark&quot;:false}]\" alt-data=\"Happy Barkday Gift Box\"><img src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/68269dfd75070e93430d7b6a8e0947c51fe91261.jpg?1461237892\" alt=\"Happy Barkday Gift Box\" class=\"ng-scope\"></div>\n    <div class=\"doodle\" bs-image=\"\" image-data=\"\"></div>\n    <h6 class=\"ng-binding\">Happy Barkday Gift Box</h6>\n    <!-- ngIf: item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0 --><span class=\"price ng-binding ng-scope\" ng-if=\"item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0\">$50.00</span><!-- end ngIf: item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0 -->\n    <!-- ngIf: item.quantity_available_all_variants <= 0 -->\n  </a>\n</div></article>\n      <!-- ngIf: $index == 0 -->\n      <!-- ngIf: $index == 5 -->\n      <span ng-repeat-end=\"\" class=\"ng-scope\"></span><!-- end ngRepeat: item in popularProducts.items | limitTo:6 --><span ng-repeat-start=\"item in popularProducts.items | limitTo:6\" class=\"ng-scope\"></span>\n      <!-- ngInclude: 'home/item.html' --><article ng-include=\"'home/item.html'\" class=\"ng-scope\"><div ng-class=\"{'sold-out' : item.quantity_available_all_variants <= 0}\" class=\"ng-scope\">\n  <a track-link=\"\" track-event=\"Homepage Click\" track-name=\"Bacon Dental Chew\" track-feature=\"Popular Product\" ng-href=\"/items/dental-chew-bacon-flavor-regular\" target=\"_self\" class=\"ng-isolate-scope\" href=\"/items/dental-chew-bacon-flavor-regular\">\n    <div bs-image=\"\" image-data=\"[{&quot;url&quot;:&quot;https://d1sgp4rxw9t8ft.cloudfront.net/items/8bd98b5127840b5b1ada2b4dfcf943fb8b778c7a.jpg?1444147004&quot;,&quot;is_dark&quot;:false}]\" alt-data=\"Bacon Dental Chew\"><img src=\"https://d1sgp4rxw9t8ft.cloudfront.net/items/8bd98b5127840b5b1ada2b4dfcf943fb8b778c7a.jpg?1444147004\" alt=\"Bacon Dental Chew\" class=\"ng-scope\"></div>\n    <div class=\"doodle\" bs-image=\"\" image-data=\"\"></div>\n    <h6 class=\"ng-binding\">Bacon Dental Chew</h6>\n    <!-- ngIf: item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0 --><span class=\"price ng-binding ng-scope\" ng-if=\"item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0\">$11.00 - $13.00</span><!-- end ngIf: item.quantity_available_all_variants == undefined || item.quantity_available_all_variants > 0 -->\n    <!-- ngIf: item.quantity_available_all_variants <= 0 -->\n  </a>\n</div></article>\n      <!-- ngIf: $index == 0 -->\n      <!-- ngIf: $index == 5 --><article class=\"inline-doodle ng-scope\" ng-if=\"$index == 5\"><img src=\"//dv4pc7nwcrrvy.cloudfront.net/assets/inline-doodle-2-4ad68f3406580a92be04f43eefcc279a.gif\"></article><!-- end ngIf: $index == 5 -->\n      <span ng-repeat-end=\"\" class=\"ng-scope\"></span><!-- end ngRepeat: item in popularProducts.items | limitTo:6 -->\n    </div>\n  </section>\n  <section class=\"who-we-are wrap\">\n    <div>\n      <h6>Who we are</h6>\n      <h4><span>BarkShop</span> is built around two beliefs: all dogs are unique and all dogs deserve to be healthy and happy.</h4>\n      <p>As a part of Bark &amp; Co we are able to utilize years of collected product feedback and user testing to make sure that everything in the shop is safe for you and your pooch. Have a question for us or want to chat?</p>\n      <a class=\"bs-btn-large blue\" zopim-chat-open=\"\">Chat with us now!</a>\n    </div>\n  </section>\n</div>\n\n</div>\n<footer>\n<!-- ngIf: signupState --><span ng-if=\"signupState\" class=\"ng-scope\">\n<div class=\"newsletter-signup\">\n<div class=\"wrap\">\n<span ng-show=\"signupState === 'pending'\">\n<div class=\"cta-wrapper\">\n<h5>Sniff Our Butt</h5>\n<p>Sign up for our newsletter and receive updates on the latest products.</p>\n</div>\n<form name=\"newsletterForm\" ng-submit=\"signupNewsletter(email)\" novalidate=\"\" class=\"ng-pristine ng-valid-email ng-invalid ng-invalid-required ng-valid-pattern ng-valid-maxlength\">\n<fieldset class=\"left\">\n<input maxlength=\"100\" name=\"email\" ng-model-options=\"{updateOn: 'default blur'}\" ng-model=\"email\" ng-pattern=\"/^([^@\\s]+)@((?:[-a-z0-9]+\\.)+[a-z]{2,})$/i\" placeholder=\"woof@barkshop.com\" required=\"true\" type=\"email\" class=\"ng-pristine ng-untouched ng-empty ng-valid-email ng-invalid ng-invalid-required ng-valid-pattern ng-valid-maxlength\">\n<label for=\"email\" ng-hide=\"newsletterForm.email.$dirty &amp;&amp; newsletterForm.email.$invalid\">\nEmail Address\n</label>\n<div class=\"error-wrap ng-hide\" ng-show=\"newsletterForm.email.$dirty &amp;&amp; newsletterForm.email.$invalid\">\n<span class=\"error\" ng-show=\"newsletterForm.email.$error.required\">\nEmail Address Required\n</span>\n<span class=\"error ng-hide\" ng-show=\"newsletterForm.email.$error.email || newsletterForm.email.$error.pattern\">\nInvalid Email Address\n</span>\n</div>\n</fieldset>\n<fieldset class=\"right\">\n<button class=\"bs-btn-large blue\" ng-disabled=\"newsletterForm.$invalid\" type=\"submit\" disabled=\"disabled\">\nSubscribe\n</button>\n</fieldset>\n</form>\n</span>\n<span ng-show=\"signupState !== 'pending'\" class=\"ng-hide\">\n<div class=\"result-wrapper\">\n<h5>Sniff Our Butt</h5>\n<p ng-show=\"signupState === 'success'\" class=\"ng-hide\">\n<span class=\"emphasize\">\nYip-pee! You're all set.\n</span>\nYou should receive a welcome email shortly.\n</p>\n<p ng-show=\"signupState === 'error'\" class=\"ng-hide\">\n<a href=\"\" ng-click=\"signupState = 'pending'\">\nSomething went wrong, please try again.\n</a>\n</p>\n</div>\n</span>\n</div>\n</div>\n</span><!-- end ngIf: signupState -->\n<nav class=\"wrap\">\n<section>\n<h5>Categories</h5>\n<ul>\n<!-- ngRepeat: link in menu.items --><li ng-repeat=\"link in menu.items\" class=\"ng-scope\">\n<!-- ngIf: link.name != 'Collections' --><a ng-href=\"/gifts\" ng-if=\"link.name != 'Collections'\" target=\"_self\" class=\"ng-binding ng-scope\" href=\"/gifts\">Gifts</a><!-- end ngIf: link.name != 'Collections' -->\n</li><!-- end ngRepeat: link in menu.items --><li ng-repeat=\"link in menu.items\" class=\"ng-scope\">\n<!-- ngIf: link.name != 'Collections' --><a ng-href=\"/eat\" ng-if=\"link.name != 'Collections'\" target=\"_self\" class=\"ng-binding ng-scope\" href=\"/eat\">Eats</a><!-- end ngIf: link.name != 'Collections' -->\n</li><!-- end ngRepeat: link in menu.items --><li ng-repeat=\"link in menu.items\" class=\"ng-scope\">\n<!-- ngIf: link.name != 'Collections' --><a ng-href=\"/play\" ng-if=\"link.name != 'Collections'\" target=\"_self\" class=\"ng-binding ng-scope\" href=\"/play\">Play</a><!-- end ngIf: link.name != 'Collections' -->\n</li><!-- end ngRepeat: link in menu.items --><li ng-repeat=\"link in menu.items\" class=\"ng-scope\">\n<!-- ngIf: link.name != 'Collections' --><a ng-href=\"/wear\" ng-if=\"link.name != 'Collections'\" target=\"_self\" class=\"ng-binding ng-scope\" href=\"/wear\">Wear</a><!-- end ngIf: link.name != 'Collections' -->\n</li><!-- end ngRepeat: link in menu.items --><li ng-repeat=\"link in menu.items\" class=\"ng-scope\">\n<!-- ngIf: link.name != 'Collections' --><a ng-href=\"/nest\" ng-if=\"link.name != 'Collections'\" target=\"_self\" class=\"ng-binding ng-scope\" href=\"/nest\">Nest</a><!-- end ngIf: link.name != 'Collections' -->\n</li><!-- end ngRepeat: link in menu.items --><li ng-repeat=\"link in menu.items\" class=\"ng-scope\">\n<!-- ngIf: link.name != 'Collections' --><a ng-href=\"/humans\" ng-if=\"link.name != 'Collections'\" target=\"_self\" class=\"ng-binding ng-scope\" href=\"/humans\">Humans</a><!-- end ngIf: link.name != 'Collections' -->\n</li><!-- end ngRepeat: link in menu.items --><li ng-repeat=\"link in menu.items\" class=\"ng-scope\">\n<!-- ngIf: link.name != 'Collections' -->\n</li><!-- end ngRepeat: link in menu.items -->\n</ul>\n</section>\n<section class=\"social\">\n<h5>Sniff Our Butt</h5>\n<ul>\n<li>\n<a href=\"http://facebook.com/thebarkshop\" target=\"_blank\">\n<i class=\"fa fa-fw fa-facebook\"></i>\n<span>Facebook</span>\n</a>\n</li>\n<li>\n<a href=\"https://twitter.com/barkshop\" target=\"_blank\">\n<i class=\"fa fa-fw fa-twitter\"></i>\n<span>Twitter</span>\n</a>\n</li>\n<li>\n<a href=\"http://instagram.com/barkshop\" target=\"_blank\">\n<i class=\"fa fa-fw fa-instagram\"></i>\n<span>Instagram</span>\n</a>\n</li>\n<li>\n<a href=\"http://pinterest.com/barkshop\" target=\"_blank\">\n<i class=\"fa fa-fw fa-pinterest\"></i>\n<span>Pinterest</span>\n</a>\n</li>\n</ul>\n</section>\n<section class=\"about\">\n<h5>About Us</h5>\n<ul>\n<li>\n<a target=\"_self\" href=\"/scouts-honor\">Contact Us</a>\n</li>\n<li>\n<a target=\"_self\" href=\"/about\">Who Are We?</a>\n</li>\n<li>\n<a target=\"_self\" href=\"/returns\">Returns</a>\n</li>\n<li>\n<a target=\"_blank\" href=\"https://barkbox.zendesk.com/hc/en-us/categories/202193378-BarkShop\">FAQ</a>\n</li>\n<li>\n<a target=\"_blank\" href=\"http://bark.co/jobs\">Jobs</a>\n</li>\n<li>\n<a target=\"_self\" href=\"/privacy\">Privacy Policy</a>\n</li>\n<li>\n<a target=\"_self\" href=\"/terms\">Terms &amp; Conditions</a>\n</li>\n</ul>\n</section>\n<section>\n<h5>Bark &amp; Co Family</h5>\n<ul class=\"familia\">\n<li>\n<a target=\"_blank\" href=\"http://bark.co/\">Bark &amp; Co</a>\n</li>\n<li>\n<a target=\"_blank\" href=\"https://www.barkbox.com/\">BarkBox</a>\n</li>\n<li>\n<a target=\"_blank\" href=\"http://barkpost.com/\">BarkPost</a>\n</li>\n</ul>\n</section>\n</nav>\n<div class=\"logo\">\n<div class=\"wrap\">\n<a href=\"/\" target=\"_self\">\n<img src=\"//dv4pc7nwcrrvy.cloudfront.net/assets/logo-white-a841c5a6c2c94d2e8b23fc867aa38c9f.png\" alt=\"Logo white\">\n</a>\n</div>\n</div>\n</footer>\n\n<script>\n  window.free_shipping_minimum = 35\n  window.menu = [{\"name\":\"Gifts\",\"slug\":\"gifts\",\"path\":\"/gifts\",\"pages\":[{\"name\":\"Gifts for Dogs\",\"slug\":\"gifts-for-dogs\",\"path\":\"/gifts-for-dogs\"},{\"name\":\"Gifts for Dog People\",\"slug\":\"gifts-dog-people\",\"path\":\"/gifts-dog-people\"}]},{\"name\":\"Eats\",\"slug\":\"eat\",\"path\":\"/eat\",\"pages\":[{\"name\":\"Treats\",\"slug\":\"treats\",\"path\":\"/treats\"},{\"name\":\"Chews\",\"slug\":\"chews\",\"path\":\"/chews\"}]},{\"name\":\"Play\",\"slug\":\"play\",\"path\":\"/play\",\"pages\":[{\"name\":\"Plush\",\"slug\":\"plush\",\"path\":\"/plush\"},{\"name\":\"Super Chewer\",\"slug\":\"superchewer\",\"path\":\"/superchewer\"},{\"name\":\"Fetch\",\"slug\":\"fetch\",\"path\":\"/fetch\"},{\"name\":\"Thinkers\",\"slug\":\"thinkers\",\"path\":\"/thinkers\"}]},{\"name\":\"Wear\",\"slug\":\"wear\",\"path\":\"/wear\",\"pages\":[{\"name\":\"Leashes, Collars \\u0026 Harnesses\",\"slug\":\"leashes\",\"path\":\"/leashes\"},{\"name\":\"Outerwear\",\"slug\":\"outerwear\",\"path\":\"/outerwear\"},{\"name\":\"Accessories\",\"slug\":\"accessories\",\"path\":\"/accessories\"}]},{\"name\":\"Nest\",\"slug\":\"nest\",\"path\":\"/nest\",\"pages\":[{\"name\":\"Sleep\",\"slug\":\"sleep\",\"path\":\"/sleep\"},{\"name\":\"Dine\",\"slug\":\"dine\",\"path\":\"/dine\"},{\"name\":\"Daily Essentials\",\"slug\":\"daily-essentials\",\"path\":\"/daily-essentials\"},{\"name\":\"Travel\",\"slug\":\"travel\",\"path\":\"/travel\"}]},{\"name\":\"Humans\",\"slug\":\"humans\",\"path\":\"/humans\",\"pages\":[{\"name\":\"Books \\u0026 Stationery\",\"slug\":\"books\",\"path\":\"/books\"},{\"name\":\"Apparel \\u0026 Accessories\",\"slug\":\"human-accessories\",\"path\":\"/human-accessories\"},{\"name\":\"Homegoods\",\"slug\":\"homegoods\",\"path\":\"/homegoods\"}]},{\"name\":\"Collections\",\"slug\":\"collections\",\"pages\":[{\"name\":\"Destroyers Club\",\"slug\":\"destroyers-club-collection\",\"path\":\"/destroyers-club-collection\"},{\"name\":\"Emojis\",\"slug\":\"emojis\",\"path\":\"/emojis\"},{\"name\":\"Bundles \\u0026 Boxes\",\"slug\":\"bundles-boxes\",\"path\":\"/bundles-boxes\"},{\"name\":\"Shop the Box\",\"slug\":\"shop-the-box\",\"path\":\"/shop-the-box\"},{\"name\":\"Made by Bark \\u0026 Co.\",\"slug\":\"made-by-bark-co\",\"path\":\"/made-by-bark-co\"}]}];\n</script>\n<script src=\"//dv4pc7nwcrrvy.cloudfront.net/assets/application-7b6612427c0b5f6f61bfc8ab8099b00f.js\"></script>\n<script>\n  /**\n    LiveAddress API jQuery Plugin\n    by SmartyStreets - smartystreets.com\n    (c) 2012-2013 SmartyStreets\n    LICENSED UNDER THE GNU GENERAL PUBLIC LICENSE VERSION 3\n    (http://opensource.org/licenses/gpl-3.0.html)\n    Documentation:      http://smartystreets.com/kb/liveaddress-api/website-forms\n    Version:        (See variable below for version)\n    Minified:       (See documentation or GitHub repository for minified script file)\n    Latest stable version:  (See documentation)\n    Bleeding-edge release:  https://github.com/smartystreets/jquery.liveaddress\n    Feel free to contribute to this project on GitHub by\n    submitting pull requests and reporting issues.\n  **/\n\n  (function($, window, document) {\n    \"use strict\";   //  http://ejohn.org/blog/ecmascript-5-strict-mode-json-and-more/\n\n    /*\n      * PRIVATE MEMBERS\n    */\n\n    var instance;     // Contains public-facing functions and variables\n    var ui = new UI;    // Internal use only, for UI-related tasks\n    var version = \"2.6.0\";  // Version of this copy of the script\n\n    var defaults = {\n      candidates: 3,                              // Number of suggestions to show if ambiguous\n      autocomplete: 10,                           // Number of autocomplete suggestions; set to 0 or false to disable\n      requestUrl: \"https://api.smartystreets.com/street-address\",       // API endpoint\n      timeout: 5000,                              // How long to wait before the request times out (5000 = 5 seconds)\n      speed: \"medium\",                            // Animation speed\n      ambiguousMessage: \"Choose the correct address\",             // Message when address is ambiguous\n      invalidMessage: \"Address not verified\",                 // Message when address is invalid\n      fieldSelector: \"input[type=text], input:not([type]), textarea, select\", // Selector for possible address-related form elements\n      submitSelector: \"[type=submit], [type=image], [type=button]:last, button:last\"  // Selector to find a likely submit button or submit image (in a form)\n    };\n    var config = {};        // Configuration settings as set by the user or just the defaults\n    var forms = [];         // List of forms (which hold lists of addresses)\n    var defaultSelector = 'body'; // Default selector which should be over the whole page (must be compatible with the .find() function; not document)\n    var mappedAddressCount = 0;   // The number of currently-mapped addresses\n    var acceptableFields = [\"street\", \"street2\", \"secondary\", \"city\", \"state\", \"zipcode\", \"lastline\", \"addressee\", \"urbanization\", \"country\"]; // API input field names\n\n    /*\n      * ENTRY POINT\n    */\n    \n    $.LiveAddress = function(arg)\n    {\n      return $(defaultSelector).LiveAddress(arg);\n    };\n\n    $.fn.LiveAddress = function(arg)\n    {\n      if (instance)\n        return instance;\n\n      var matched = this, wasChained = matched.prevObject ? !!matched.prevObject.prevObject : false;\n\n      // Make sure the jQuery version is compatible\n      var vers = $.fn.jquery.split(\".\");\n      if (vers.length >= 2)\n      {\n        if (vers[0] < 1 || (vers[0] == 1 && vers[1] < 5))\n        {\n          console.log(\"jQuery version \"+$.fn.jquery+\" found, but LiveAddress requires jQuery version 1.5 or higher. Aborting.\");\n          return false;\n        }\n      }\n      else\n        return false;\n\n      if (arg.debug)\n        console.log(\"LiveAddress API jQuery Plugin version \"+version+\" (Debug mode)\");\n\n      // Mapping fields requires that the document be fully loaded in order to attach UI elements\n      if (document.readyState === \"complete\")\n        window.loaded = true;\n      else\n        $(window).load(function() { window.loaded = true; });\n\n      // Determine if user passed in an API key or a settings/config object\n      if (typeof arg === 'string')\n      {\n        // Use the default configuration\n        config = { key: arg, candidates: defaults.candidates };\n      }\n      else if (typeof arg === 'object')\n      {\n        // Persist the user's configuration\n        config = $.extend(config, arg);\n      }\n\n      // Enforce some defaults\n      config.candidates = config.candidates || defaults.candidates;\n      config.ui = typeof config.ui === 'undefined' ? true : config.ui;\n      config.autoMap = typeof config.autoMap === 'undefined' ? true : config.autoMap;\n      config.autoVerify = typeof config.autoVerify === 'undefined' ? true : config.autoVerify;\n      config.submitVerify = typeof config.submitVerify === 'undefined' ? true : config.submitVerify;\n      config.timeout = config.timeout || defaults.timeout;\n      config.ambiguousMessage = config.ambiguousMessage || defaults.ambiguousMessage;\n      config.invalidMessage = config.invalidMessage || defaults.invalidMessage;\n      config.fieldSelector = config.fieldSelector || defaults.fieldSelector;\n      config.submitSelector = config.submitSelector || defaults.submitSelector;\n      config.requestUrl = config.requestUrl || defaults.requestUrl;\n      config.autocomplete = typeof config.autocomplete === 'undefined' ? defaults.autocomplete : config.autocomplete;\n      config.cityFilter = typeof config.cityFilter === 'undefined' ? \"\" : config.cityFilter;\n      config.stateFilter = typeof config.stateFilter === 'undefined' ? \"\" : config.stateFilter;\n      config.cityStatePreference = typeof config.cityStatePreference === 'undefined' ? \"\" : config.cityStatePreference;\n      config.geolocate = typeof config.geolocate === 'undefined' ? true : config.geolocate;\n\n      config.candidates = config.candidates < 1 ? 0 : (config.candidates > 10 ? 10 : config.candidates);\n\n      if (typeof config.autocomplete === 'number')\n        config.autocomplete = config.autocomplete < 1 ? false : (config.autocomplete > 10 ? 10 : config.autocomplete);\n\n      /*\n        * EXPOSED (PUBLIC) FUNCTIONS\n      */\n      instance = {\n        events: EventHandlers,\n        on: function(eventType, userHandler)\n        {\n          if (!EventHandlers[eventType] || typeof userHandler !== 'function')\n            return false;\n\n          var previousHandler = EventHandlers[eventType];\n          EventHandlers[eventType] = function(event, data) {\n            userHandler(event, data, previousHandler);\n          };\n        },\n        mapFields: function(map)\n        {\n          var doMap = function(map)\n          {\n            if (map === \"auto\")\n              return ui.automap(matched);\n            else if (typeof map === 'object')\n              return ui.mapFields(map, matched);\n            else if (!map && typeof config.addresses === 'object')\n              return ui.mapFields(config.addresses, matched)\n            else if (config.autoMap)\n              return ui.automap(matched);\n            else\n              return false;\n          };\n          if ($.isReady)\n            doMap(map);\n          else\n            $(function() {\n              if (!wasChained)\n                matched = $(matched.selector);\n              doMap(map);\n            });\n        },\n        makeAddress: function(addressData)\n        {\n          if (typeof addressData !== \"object\")\n            return instance.getMappedAddressByID(addressData) || new Address({ street: addressData });\n          else\n            return new Address(addressData);\n        },\n        verify: function(input, callback)\n        {\n          var addr = instance.makeAddress(input);     // Below means, force re-verify even if accepted/unchanged.\n          trigger(\"VerificationInvoked\", { address: addr, verifyAccepted: true, invoke: callback });\n        },\n        getMappedAddresses: function()\n        {\n          var addr = [];\n          for (var i = 0; i < forms.length; i++)\n            for (var j = 0; j < forms[i].addresses.length; j++)\n              addr.push(forms[i].addresses[j]);\n          return addr;\n        },\n        getMappedAddressByID: function(id)\n        {\n          for (var i = 0; i < forms.length; i++)\n            for (var j = 0; j < forms[i].addresses.length; j++)\n              if (forms[i].addresses[j].id() == id)\n                return forms[i].addresses[j];\n        },\n        setKey: function(htmlkey)\n        {\n          config.key = htmlkey;\n        },\n        setCityFilter: function(cities)\n        {\n          config.cityFilter = cities;\n        },\n        setStateFilter: function(states)\n        {\n          config.stateFilter = states;\n        },\n        setCityStatePreference: function(pref)\n        {\n          config.cityStatePreference = pref;\n        },\n        activate: function(addressID)\n        {\n          var addr = instance.getMappedAddressByID(addressID);\n          if (addr)\n            addr.active = true;\n        },\n        deactivate: function(addressID)\n        {\n          if (!addressID)\n            return ui.clean();\n          var addr = instance.getMappedAddressByID(addressID);\n          if (addr)\n            addr.active = false;\n        },\n        autoVerify: function(setting)\n        {\n          if (typeof setting === 'undefined')\n            return config.autoVerify;\n          else if (setting === \"disable\" || setting === \"off\" || !setting)\n            config.autoVerify = false;\n          else\n            config.autoVerify = true;\n        },\n        version: version\n      };\n\n      \n      // Bind each handler to an event\n      for (var prop in EventHandlers)\n        bind(prop);\n\n      // Map the fields\n      instance.mapFields();\n\n      return instance;\n    };\n\n\n\n    /*\n      * PRIVATE FUNCTIONS / OBJECTS\n    */\n\n\n\n    /*\n      The UI object auto-maps the fields and controls\n      interaction with the user during the address\n      verification process.\n    */\n    function UI()\n    {\n      var submitHandler;        // Function which is later bound to handle form submits\n      var mapMeta = {\n        formDataProperty: \"smarty-form\",  // Indicates whether we've stored the form already\n        identifiers: {\n          streets: {        // both street1 and street2, separated later.\n            names: [      // Names are hidden from the user; \"name\" and \"id\" attributes\n              'street',\n              'address',    // This (\"address\") is a dangerous inclusion; but we have a strong set of exclusions below to prevent false positives.\n              'address1',   // If there are automapping issues (specifically if it is too greedy when mapping fields) it will be because\n              'address2',   // of these arrays for the \"streets\" fields, namely the \"address\" entry right around here, or potentially others.\n              'addr1',\n              'addr2',\n              'address-1',\n              'address-2',\n              'address_1',\n              'address_2',\n              'line',\n              'primary'\n            ],\n            labels: [     // Labels are visible to the user (labels and placeholder texts)\n              'street',\n              'address',    // hazardous (e.g. \"Email address\") -- but we deal with that later\n              'line ',\n              ' line'\n            ]\n          },\n          secondary: {\n            names: [\n              'suite',\n              'apartment',\n              'primary',\n              //'box',    // This false-positives fields like \"searchBox\" ...\n              'pmb',\n              //'unit',   // I hesitate to allow this, since \"Units\" (as in quantity) might be common...\n              'secondary'\n            ],\n            labels: [\n              'suite',\n              'apartment',\n              'apt:',\n              'apt.',\n              'ste:',\n              'ste.',\n              'unit:',\n              'unit.',\n              'unit ',\n              'box',\n              'pmb'\n            ]\n          },\n          city: {\n            names: [\n              'city',\n              'town',\n              'village',\n              'cityname',\n              'city-name',\n              'city_name',\n              'cities'\n            ],\n            labels: [\n              'city',\n              'town',\n              'city name'\n            ]\n          },\n          state: {\n            names: [\n              'state',\n              'province',\n              'region',\n              'section',\n              'territory'\n            ],\n            labels: [\n              'state',\n              'province',\n              'region',\n              'section',\n              'territory'\n            ]\n          },\n          zipcode: {\n            names: [\n              'zip',\n              'zipcode',\n              'zip-code',\n              'zip_code',\n              'postal_code',\n              'postal-code',\n              'postalcode',\n              'postcode',\n              'post-code',\n              'post_code',\n              'postal',\n              'zcode'\n            ],\n            labels: [\n              'zip',\n              'zip code',\n              'postal code',\n              'postcode',\n              'locality'\n            ]\n          },\n          lastline: {\n            names: [\n              'lastline',\n              'last-line',\n              'citystatezip',\n              'city-state-zip',\n              'city_state_zip'\n            ],\n            labels: [\n              'last line',\n              'city/state/zip',\n              'city / state / zip',\n              'city - state - zip',\n              'city-state-zip',\n              'city, state, zip'\n            ]\n          },\n          country: {        // We only use country to see if we should submit to the API\n            names: [\n              'country',\n              'nation',\n              'sovereignty'\n            ],\n            labels: [\n              'country',\n              'nation',\n              'sovereignty'\n            ]\n          }\n        },  // We'll iterate through these (above) to make a basic map of fields, then refine:\n        street1exacts: {    // List of case-insensitive EXACT matches for street1 field\n          names: [\n            'address',\n            'street',\n            'address1',\n            'streetaddress',\n            'street-address',\n            'street_address',\n            'streetaddr',\n            'street-addr',\n            'street_addr',\n            'str',\n            'str1',\n            'street1',\n            'addr'\n          ]\n        },\n        street2: {      // Terms which would identify a \"street2\" field\n          names: [\n            'address2',\n            'address_2',\n            'address-2',\n            'street2',\n            'addr2',\n            'addr_2',\n            'line2',\n            'str2',\n            'second',\n            'two'\n          ],\n          labels: [\n            ' 2',\n            'second ',\n            'two'\n          ]\n        },\n        exclude: {      // Terms we look for to exclude an element from the mapped set to prevent false positives\n          names: [    // The intent is to keep non-address elements from being mapped accidently.\n            'email',\n            'e-mail',\n            'e_mail',\n            'firstname',\n            'first-name',\n            'first_name',\n            'lastname',\n            'last-name',\n            'last_name',\n            'fname',\n            'lname',\n            'name',     // Sometimes problematic (\"state_name\" ...) -- also see same label value below\n            'eml',\n            'type',\n            'township',\n            'zip4',\n            'plus4',\n            'method',\n            'location',\n            'store',\n            'save',\n            'keep',\n            'phn',\n            'phone',\n            'cardholder', // I hesitate to exclude \"card\" because of common names like: \"card_city\" or something...\n            'security',\n            'comp',\n            'firm',\n            'org',\n            'addressee',\n            'addresses',\n            'group',\n            'gate',\n            'fax',\n            'cvc',\n            'cvv',\n            'file',\n            'search',\n            'list'      // AmeriCommerce cart uses this as an \"Address Book\" dropdown to choose an entire address...\n          ],\n          labels: [\n            'email',\n            'e-mail',\n            'e mail',\n            ' type',\n            'save ',\n            'keep',\n            'name',\n            'method',\n            'phone',\n            'organization',\n            'company',\n            'addressee',\n            'township',\n            'firm',\n            'group',\n            'gate',\n            'cardholder',\n            'cvc',\n            'cvv',\n            'search',\n            'file',\n            ' list',\n            'fax',\n            'book'\n          ]\n        }\n      };\n\n      var autocompleteResponse;   // The latest response from the autocomplete server\n      var autocplCounter = 0;     // A counter so that only the most recent JSONP request is used\n      var autocplRequests = [];   // The array that holds autocomplete requests in order\n      var loaderWidth = 24, loaderHeight = 8;   // TODO: Update these if the image changes\n      var uiCss = \"<style>\"\n        + \".smarty-dots { display: none; position: absolute; z-index: 999; width: \"+loaderWidth+\"px; height: \"+loaderHeight+\"px; background-image: url('data:image/gif;base64,R0lGODlhGAAIAOMAALSytOTi5MTCxPTy9Ly6vPz6/Ozq7MzKzLS2tOTm5PT29Ly+vPz+/MzOzP///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJBgAOACwAAAAAGAAIAAAEUtA5NZi8jNrr2FBScQAAYVyKQC6gZBDkUTRkXUhLDSwhojc+XcAx0JEGjoRxCRgWjcjAkqZr5WoIiSJIaohIiATqimglg4KWwrDBDNiczgDpiAAAIfkECQYAFwAsAAAAABgACACEVFZUtLK05OLkxMbE9PL0jI6MvL68bG5s7Ors1NbU/Pr8ZGJkvLq8zM7MXFpctLa05ObkzMrM9Pb0nJqcxMLE7O7s/P78////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABWDgZVWQcp2nJREWmhLSKRWOcySoRAWBEZ8IBi+imAAcxwXhZODxDCfFwxloLI6A7OBCoPKWEG/giqxRuOLKRSA2lpVM6kM2dTZmyBuK0Aw8fhcQdQMxIwImLiMSLYkVPyEAIfkECQYAFwAsAAAAABgACACEBAIEpKak1NbU7O7svL68VFZU/Pr8JCIktLK05OLkzMrMDA4M9Pb0vLq87Ors9PL0xMLEZGZk/P78tLa05ObkzM7MFBIU////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABWLgJVGCcZ2n9DASmq7nUwDAQaAPhCAEgzqNncIQodEWgxNht7tdDBMmorIw0gKXh3T3uCSYgV3VitUiwrskZTspGpFKsJMRRVdkNBuKseT5Tg4TUQo+BgkCfygSDCwuIgN/IQAh+QQJBgAXACwAAAAAGAAIAIRUVlS0srTk4uR8enz08vTExsRsbmzs6uyMjoz8+vzU1tRkYmS8urzMzsxcWly0trTk5uR8fnz09vTMyszs7uycmpz8/vz///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFYOBlUVBynad1QBaaEtIpIY5jKOgxAM5w5IxAYJKo8HgLwmnnAAAGsodQ2FgcnYUL5Nh0QLTTqbXryB6cXcBPEBYaybEL0wm9SNqFWfOWY0Z+JxBSAXkiFAImLiolLoZxIQAh+QQJBgAQACwAAAAAGAAIAIQEAgS0srTc2tz08vTMyszk5uT8+vw0MjS8ury0trTk4uT09vTMzszs6uz8/vw0NjT///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFWiAELYMjno4gmCfkDItoEEGANKfwAMAjnA1EjWBg1I4G14HHO5gMiWOAEZUqIAIm86eQeo/XrBbA/RqlMceS6RxVa4xZLVHI7QCHn6hQRbAWDSwoKoIiLzEQIQAh+QQJBgAXACwAAAAAGAAIAIRUVlS0srTk4uR8enz08vTExsRsbmzs6uyMjoz8+vzU1tRkYmS8urzMzsxcWly0trTk5uR8fnz09vTMyszs7uycmpz8/vz///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFY+B1SYQlntYBmeeVQJSZTEHAHCcUOUCEiwqDw4GQNGrIhGgA4DkGIsIC0ARUHsia4AKpOiGXghewyGq5YwCu4Gw6jlnJ0gu9SKvWRKH2AIt0TQN+F0FNRSISMS0XKSuLCQKKIQAh+QQJBgAXACwAAAAAGAAIAIQEAgSkpqTU1tTs7uy8vrxUVlT8+vwkIiS0srTk4uTMyswMDgz09vS8urzs6uz08vTEwsRkZmT8/vy0trTk5uTMzswUEhT///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFZOB1MY8knhJpnpchUKahIEjjnAxEE8xJHABA4VGhGQ0ighFBEA0swWBkYgxMEpfHkva4BKLBxRaBHdACCHT3C14U0VbkRWlsXgYLcERGJQxOD3Q8PkBCfyMDKygMDIoiDAIJJiEAIfkECQYAFwAsAAAAABgACACEVFZUtLK05OLkxMbE9PL0jI6MvL68bG5s7Ors1NbU/Pr8ZGJkvLq8zM7MXFpctLa05ObkzMrM9Pb0nJqcxMLE7O7s/P78////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABWPgdUmEJZ4WaZ6XAlWmEgUBg5wSRRvSmRwOR0HSoBkVIoMxYBARFgBHdPJYBgSXijVAuAykUsBii5VsK96oelFc9i5K40MkgYInigHtAcHFH28XP1EFXSMwLBcWFRIrJwoCiCEAOw=='); }\"\n        + \".smarty-ui { position: absolute; z-index: 99999; text-shadow: none; text-align: left; text-decoration: none; }\"\n        + \".smarty-popup { border: 3px solid #4C4C4C; padding: 0; background: #F6F6F6; box-shadow: 0px 10px 35px rgba(0, 0, 0, .8); }\"\n        + \".smarty-popup-header { background: #DDD; height: 12px; text-transform: uppercase; font: bold 12px/1em 'Arial Black', sans-serif; padding: 12px; }\"\n        + \".smarty-popup-ambiguous-header { color: #333; }\"\n        + \".smarty-popup-invalid-header { color: #CC0000; }\"\n        + \".smarty-popup-close { color: #CC0000 !important; text-decoration: none !important; position: absolute; right: 15px; top: 10px; display: block; padding: 4px 6px; text-transform: uppercase; }\"\n        + \".smarty-popup-close:hover { color: #FFF !important; background: #CC0000; }\"\n        + \".smarty-choice-list .smarty-choice { background: #FFF; padding: 10px 15px; color: #1A1A1A; }\"\n        + \".smarty-choice { display: block; font: 300 14px/1.5em sans-serif; text-decoration: none !important; border-top: 1px solid #CCC; }\"\n        + \".smarty-choice-list .smarty-choice:hover { color: #EEE !important; background: #333; text-decoration: none !important; }\"\n        + \".smarty-choice-alt { border-top: 1px solid #4C4C4C; background: #F6F6F6 !important; box-shadow: inset 0 4px 15px -5px rgba(0, 0, 0, .45); }\"\n        + \".smarty-choice-alt .smarty-choice-abort, .smarty-choice-override { padding: 6px 15px; color: #B3B3B3 !important; font-size: 12px; text-decoration: none !important; }\"\n        + \".smarty-choice-alt .smarty-choice:first-child { border-top: 0; }\"\n        + \".smarty-choice-abort:hover { color: #333 !important; }\"\n        + \".smarty-choice-override:hover { color: #CC0000 !important; }\"\n        + \".smarty-tag { position: absolute; display: block; overflow: hidden; font: 15px/1.2em sans-serif; text-decoration: none !important; width: 20px; height: 18px; border-radius: 25px; transition: all .25s; -moz-transition: all .25s; -webkit-transition: all .25s; -o-transition: all .25s; }\"\n        + \".smarty-tag:hover { width: 70px; text-decoration: none !important; color: #999; }\"\n        + \".smarty-tag:hover .smarty-tag-text { color: #000 !important; }\"\n        + \".smarty-tag-grayed { border: 1px solid #B4B4B4 !important; color: #999 !important; background: #DDD !important; box-shadow: inset 0 9px 15px #FFF; }\"\n        + \".smarty-tag-green { border: 1px solid #407513 !important; color: #407513 !important; background: #A6D187 !important; box-shadow: inset 0 9px 15px #E3F6D5; }\"\n        + \".smarty-tag-grayed:hover { border-color: #333 !important; }\"\n        + \".smarty-tag-check { padding-left: 4px; text-decoration: none !important; }\"\n        + \".smarty-tag-text { font-size: 12px !important; position: absolute; top: 0; left: 16px; width: 50px !important; text-align: center !important; }\"\n        + \".smarty-autocomplete { border: 1px solid #777; background: white; overflow: hidden; white-space: nowrap; box-shadow: 1px 1px 3px #555; }\"\n        + \".smarty-suggestion { display: block; color: #444; text-decoration: none !important; font-size: 12px; padding: 1px 5px; }\"\n        + \".smarty-active-suggestion { background: #EEE; color: #000; border: none; outline: none; }\"\n        + \".smarty-no-suggestions { padding: 1px 5px; font-size: 12px; color: #AAA; font-style: italic; }\"\n        + \"</style>\";\n\n\n      this.postMappingOperations = function()\n      {\n        // Injects materials into the DOM, binds to form submit events, etc... very important.\n\n        if (config.ui)\n        {\n          // Prepend CSS to head tag to allow cascading and give their style rules priority\n          $('head').prepend(uiCss);\n\n          // For each address on the page, inject the loader and \"address verified\" markup after the last element\n          var addresses = instance.getMappedAddresses();\n          for (var i = 0; i < addresses.length; i++)\n          {\n            var id = addresses[i].id();\n            $('body').append('<div class=\"smarty-ui\"><div title=\"Loading...\" class=\"smarty-dots smarty-addr-'+id+'\"></div></div>');\n            var offset = uiTagOffset(addresses[i].corners(true));\n            $('body').append('<div class=\"smarty-ui\" style=\"top: '+offset.top+'px; left: '+offset.left+'px;\"><a href=\"javascript:\" class=\"smarty-tag smarty-tag-grayed smarty-addr-'+id+'\" title=\"Address not verified. Click to verify.\" data-addressid=\"'+id+'\"><span class=\"smarty-tag-check\">&#10003;</span><span class=\"smarty-tag-text\">Verify</span></a></div>');\n            \n            // Move the UI elements around when browser window is resized\n            $(window).resize({ addr: addresses[i] }, function(e)\n            {\n              var addr = e.data.addr;\n              var offset = uiTagOffset(addr.corners(true)); // Position of lil' tag\n              $('.smarty-tag.smarty-addr-'+addr.id())\n                .parent('.smarty-ui')\n                .css('top', offset.top+'px')\n                .css('left', offset.left+'px');\n\n              var addrOffset = addr.corners();        // Position of any popup windows\n              $('.smarty-popup.smarty-addr-'+addr.id())\n                .parent('.smarty-ui')\n                .css('top', addrOffset.top+'px')\n                .css('left', addrOffset.left+'px');\n\n              if (config.autocomplete)            // Position of autocomplete boxes\n              {\n                var containerUi = $('.smarty-autocomplete.smarty-addr-'+addr.id()).closest('.smarty-ui');\n                var domFields = addr.getDomFields();\n                if (domFields['street'])\n                {\n                  containerUi.css({\n                    \"left\": $(domFields['street']).offset().left + \"px\",\n                    \"top\": ($(domFields['street']).offset().top + $(domFields['street']).outerHeight(false)) + \"px\"\n                  });\n                }\n              }\n            });\n\n            // Disable for addresses defaulting to a foreign/non-US value\n            if (!addresses[i].isDomestic())\n            {\n              var uiTag = $('.smarty-ui .smarty-tag.smarty-addr-'+id)\n              if (uiTag.is(':visible'))\n                uiTag.hide();\n              addresses[i].accept({ address: addresses[i] }, false);\n            }\n          }\n\n          $('body').delegate('.smarty-tag-grayed', 'click', function(e)\n          {\n            // \"Verify\" clicked -- manually invoke verification\n            var addrId = $(this).data('addressid');\n            instance.verify(addrId);\n          });\n\n          $('body').delegate('.smarty-undo', 'click', function(e)\n          {\n            // \"Undo\" clicked -- replace field values with previous input\n            var addrId = $(this).parent().data('addressid');\n            var addr = instance.getMappedAddressByID(addrId);\n            addr.undo(true);\n            // If fields are re-mapped after an address was verified, it loses its \"accepted\" status even if no values were changed.\n            // Thus, in some rare occasions, the undo link and the \"verified!\" text may not disappear when the user clicks \"Undo\",\n            // The undo functionality still works in those cases, but with no visible changes, the address doesn't fire \"AddressChanged\"...\n          });\n\n\n\n          // Prepare autocomplete UI\n          if (config.autocomplete && config.key)\n          {\n            // For every mapped address, wire up autocomplete\n            for (var i = 0; i < forms.length; i++)\n            {\n              var f = forms[i];\n\n              for (var j = 0; j < f.addresses.length; j++)\n              {\n                var addr = f.addresses[j];\n                var domFields = addr.getDomFields();\n\n                if (domFields['street'])\n                {\n                  var strField = $(domFields['street']);\n                  var containerUi = $('<div class=\"smarty-ui\"></div>');\n                  var autoUi = $('<div class=\"smarty-autocomplete\"></div>');\n\n                  autoUi.addClass('smarty-addr-' + addr.id());\n                  containerUi.data(\"addrID\", addr.id())\n                  containerUi.append(autoUi);\n                  \n                  containerUi.css({\n                    \"position\": \"absolute\",\n                    \"left\": strField.offset().left + \"px\",\n                    \"top\": (strField.offset().top + strField.outerHeight(false)) + \"px\"\n                  });\n\n                  containerUi.hide().appendTo(\"body\");\n\n                  containerUi.delegate(\".smarty-suggestion\", \"click\", { addr: addr, containerUi: containerUi }, function(event) {\n                    var sugg = autocompleteResponse.suggestions[$(this).data('suggIndex')];\n                    useAutocompleteSuggestion(event.data.addr, sugg, event.data.containerUi);\n                  });\n\n                  containerUi.delegate(\".smarty-suggestion\", \"mouseover\", function() {\n                    $('.smarty-active-suggestion').removeClass('smarty-active-suggestion');\n                    $(this).addClass('smarty-active-suggestion');\n                  });\n\n                  containerUi.delegate(\".smarty-active-suggestion\", \"mouseleave\", function() {\n                    $(this).removeClass('smarty-active-suggestion');\n                  });\n\n\n                  strField.attr(\"autocomplete\", \"off\"); // Tell Firefox to keep quiet\n\n                  strField.blur({ containerUi: containerUi }, function(event) {\n                    setTimeout( (function(event) { return function() { if (event.data) event.data.containerUi.hide(); }; })(event), 300); // This line is proudly IE9-compatible\n                  });\n\n                  strField.keydown({ containerUi: containerUi, addr: addr }, function(event) {\n                    var suggContainer = $('.smarty-autocomplete', event.data.containerUi);\n                    var currentChoice = $('.smarty-active-suggestion:visible', suggContainer).first();\n                    var choiceSelectionIsNew = false;\n\n                    if (event.keyCode == 9)     // Tab key\n                    {\n                      if (currentChoice.length > 0)\n                      {\n                        var domFields = event.data.addr.getDomFields();\n                        if (domFields['zipcode'])\n                          $(domFields['zipcode']).focus();\n                        else\n                          $(domFields['street']).blur();\n                        useAutocompleteSuggestion(event.data.addr, autocompleteResponse.suggestions[currentChoice.data(\"suggIndex\")], event.data.containerUi);\n                        return addr.isFreeform() ? true : suppress(event);\n                      }\n                      else\n                        event.data.containerUi.hide();\n                      return;\n                    }\n                    else if (event.keyCode == 40) // Down arrow\n                    {\n                      if (!currentChoice.hasClass('smarty-suggestion'))\n                      {\n                        currentChoice = $('.smarty-suggestion', suggContainer).first().mouseover();\n                        choiceSelectionIsNew = true;\n                      }\n\n                      if (!choiceSelectionIsNew)\n                      {\n                        if (currentChoice.next('.smarty-addr-'+event.data.addr.id()+' .smarty-suggestion').length > 0)\n                          currentChoice.next('.smarty-suggestion').mouseover();\n                        else\n                          currentChoice.removeClass('smarty-active-suggestion');\n                      }\n\n                      moveCursorToEnd(this);\n                      return;\n                    }\n                    else if (event.keyCode == 38) // Up arrow\n                    {\n                      if (!currentChoice.hasClass('smarty-suggestion'))\n                      {\n                        currentChoice = $('.smarty-suggestion', suggContainer).last().mouseover();\n                        choiceSelectionIsNew = true;\n                      }\n\n                      if (!choiceSelectionIsNew)\n                      {\n                        if (currentChoice.prev('.smarty-addr-'+event.data.addr.id()+' .smarty-suggestion').length > 0)\n                          currentChoice.prev('.smarty-suggestion').mouseover();\n                        else\n                          currentChoice.removeClass('smarty-active-suggestion');\n                      }\n\n                      moveCursorToEnd(this);\n                      return;\n                    }\n                  });\n\n                  // Flip the on switch!\n                  strField.keyup({ form: f, addr: addr, streetField: strField, containerUi: containerUi }, doAutocomplete);\n                }\n              }\n\n              $(document).keyup(function(event) {\n                if (event.keyCode == 27)  // Esc key\n                  $('.smarty-autocomplete').closest('.smarty-ui').hide();\n              });\n            }\n\n            // Try .5 and 1.5 seconds after the DOM loads to re-position UI elements; hack for Firefox.\n            setTimeout(function() { $(window).resize(); }, 500);\n            setTimeout(function() { $(window).resize(); }, 1500);\n          }\n        }\n        \n        if (config.submitVerify)\n        {\n          // Bind to form submits through form submit and submit button click events\n          for (var i = 0; i < forms.length; i++)\n          {\n            var f = forms[i];\n    \n            submitHandler = function(e)\n            {\n              // Don't invoke verification if it's already processing or autocomplete is open and the user was pressing Enter to use a suggestion\n              if ((e.data.form && e.data.form.processing) || $('.smarty-active-suggestion:visible').length > 0)\n                return suppress(e);\n\n              /*\n                IMPORTANT!\n                Prior to version 2.4.8, the plugin would call syncWithDom() at submit-time\n                in case programmatic changes were made to the address input fields, including\n                browser auto-fills. The sync function would detect those changes and force\n                a re-verification to not let invalid addresses through. Unfortunately, this\n                frequently caused infinite loops (runaway lookups), ultimately preventing\n                form submission, which is unacceptable. As a safety measure to protect our\n                customer's subscriptions, we've removed syncWithDom(). The website owner is\n                responsible for making sure that any changes to address field values raise the\n                \"change\" event on that element. Example: $('#city').val('New City').change();\n              */\n    \n              if (!e.data.form.allActiveAddressesAccepted())\n              {\n                // We could verify all the addresses at once, but that can overwhelm the user.\n                // An API request is usually quick, so let's do one at a time: it's much cleaner.\n                var unaccepted = e.data.form.activeAddressesNotAccepted();\n                if (unaccepted.length > 0)\n                  trigger(\"VerificationInvoked\", { address: unaccepted[0], invoke: e.data.invoke, invokeFn: e.data.invokeFn });\n                return suppress(e);\n              }\n            };\n    \n            // Performs the tricky operation of uprooting existing event handlers that we have references to\n            // (either by jQuery's data cache or HTML attributes) planting ours, then laying theirs on top\n            var bindSubmitHandler = function(domElement, eventName)\n            {\n              if (!domElement || !eventName)\n                return;\n    \n              var oldHandlers = [], eventsRef = $._data(domElement, 'events');\n    \n              // If there are previously-bound-event-handlers (from jQuery), get those.\n              if (eventsRef && eventsRef[eventName] && eventsRef[eventName].length > 0)\n              {\n                // Get a reference to the old handlers previously bound by jQuery\n                oldHandlers = $.extend(true, [], eventsRef[eventName]);\n              }\n    \n              // Unbind them...\n              $(domElement).unbind(eventName);\n    \n              // ... then bind ours first ...\n              $(domElement)[eventName]({ form: f, invoke: domElement, invokeFn: eventName }, submitHandler);\n    \n              // ... then bind theirs last:\n              // First bind their onclick=\"...\" or onsubmit=\"...\" handles...\n              if (typeof domElement['on'+eventName] === 'function')\n              {\n                var temp = domElement['on'+eventName];\n                domElement['on'+eventName] = null;\n                $(domElement)[eventName](temp);\n              }\n    \n              // ... then finish up with their old jQuery handles.\n              for (var j = 0; j < oldHandlers.length; j++)\n                $(domElement)[eventName](oldHandlers[j].data, oldHandlers[j].handler);\n            };\n    \n            // Take any existing handlers (bound via jQuery) and re-bind them for AFTER our handler(s).\n            var formSubmitElements = $(config.submitSelector, f.dom);\n    \n            // Form submit() events are apparently invoked by CLICKING the submit button (even jQuery does this at its core for binding)\n            // (but jQuery, when raising a form submit event with .submit() will NOT necessarily click the submit button)\n            formSubmitElements.each(function(idx) {\n              bindSubmitHandler(this, 'click'); // These get fired first\n            });\n    \n            // These fire after button clicks, so these need to be bound AFTER binding to the submit button click events\n            bindSubmitHandler(f.dom, 'submit');\n          }\n        }\n\n        trigger(\"MapInitialized\");\n      };\n\n      function doAutocomplete(event)\n      {\n        var addr = event.data.addr;\n        var streetField = event.data.streetField;\n        var input = $.trim(event.data.streetField.val());\n        var containerUi = event.data.containerUi;\n        var suggContainer = $('.smarty-autocomplete', containerUi);\n\n        if (!input)\n        {\n          addr.lastStreetInput = input;\n          suggContainer.empty();\n          containerUi.hide();\n        }\n\n        if (event.keyCode == 13)  // Enter/return\n        {\n          if ($('.smarty-active-suggestion:visible').length > 0)\n            useAutocompleteSuggestion(addr, autocompleteResponse.suggestions[$('.smarty-active-suggestion:visible').first().data('suggIndex')], containerUi);\n          containerUi.hide();\n          streetField.blur();\n          return suppress(event);\n        }\n\n        if (event.keyCode == 40)  // Down arrow\n        {\n          moveCursorToEnd(streetField[0]);\n          return;\n        }\n\n        if (event.keyCode == 38)  // Up arrow\n        {\n          moveCursorToEnd(streetField[0]);\n          return;\n        }\n\n        if (!input || input == addr.lastStreetInput || !addr.isDomestic())\n          return;\n\n        addr.lastStreetInput = input; // Used so that autocomplete only fires on real changes (i.e. not just whitespace)\n\n        trigger('AutocompleteInvoked', {\n          containerUi: containerUi,\n          suggContainer: suggContainer,\n          streetField: streetField,\n          input: input,\n          addr: addr\n        });\n      }\n\n      this.requestAutocomplete = function(event, data)\n      {\n        if (data.input && data.addr.isDomestic() && autocompleteResponse)\n          data.containerUi.show();\n\n        var autocplrequest = {\n          callback: function(counter, json)\n          {\n            autocompleteResponse = json;\n            data.suggContainer.empty();\n\n            if (!json.suggestions || json.suggestions.length == 0)\n            {\n              data.suggContainer.html('<div class=\"smarty-no-suggestions\">No suggestions</div>');\n              return;\n            }\n\n            for (var j = 0; j < json.suggestions.length; j++)\n            {\n              var link = $('<a href=\"javascript:\" class=\"smarty-suggestion\">' + json.suggestions[j].text.replace(/<|>/g, \"\") + '</a>');\n              link.data(\"suggIndex\", j);\n              data.suggContainer.append(link);\n            }\n\n            data.suggContainer.css({\n              \"width\": Math.max(data.streetField.outerWidth(false), 250) + \"px\"\n            });\n\n            data.containerUi.show();\n\n            // Delete all older callbacks so they don't get executed later because of latency\n            autocplRequests.splice(0, counter);\n          },\n          number: autocplCounter++\n        };\n\n        autocplRequests[autocplrequest.number] = autocplrequest;\n\n        $.getJSON(\"https://autocomplete-api.smartystreets.com/suggest?callback=?\", {\n          \"auth-id\": config.key,\n          prefix: data.input,\n          city_filter: config.cityFilter,\n          state_filter: config.stateFilter,\n          prefer: config.cityStatePreference,\n          suggestions: config.autocomplete,\n          geolocate: config.geolocate\n        }, function(json)\n        {\n          trigger(\"AutocompleteReceived\", $.extend(data, {\n            json: json,\n            autocplrequest: autocplrequest\n          }));\n        });\n      };\n\n      this.showAutocomplete = function(event, data)\n      {\n        if (autocplRequests[data.autocplrequest.number])\n          autocplRequests[data.autocplrequest.number].callback(data.autocplrequest.number, data.json);\n      };\n\n      function useAutocompleteSuggestion(addr, suggestion, containerUi)\n      {\n        var domfields = addr.getDomFields();\n        containerUi.hide();   // It's important that the suggestions are hidden before AddressChanged event fires\n\n        if (addr.isFreeform())\n          $(domfields['street']).val(suggestion.text).change();\n        else\n        {\n          if(domfields['zipcode'])\n            $(domfields['zipcode']).val(\"\").change();\n          if (domfields['street'])\n            $(domfields['street']).val(suggestion.street_line).change();\n          // State filled in before city so autoverify is not invoked without finishing using the suggestion\n          if (domfields['state'])\n          {\n            if(domfields['state'].options) // Checks for dropdown\n            {\n              for(var i = 0; i < domfields['state'].options.length; i++)\n              {\n                // Checks for abbreviation match and maps full state name to abbreviation\n                if(domfields['state'].options[i].text.toUpperCase() === suggestion.state || allStatesByName[domfields['state'].options[i].text.toUpperCase()] === suggestion.state)\n                {\n                  $(domfields['state'])[0].selectedIndex = i;\n                  $(domfields['state']).change();\n                  break;\n                }\n              }\n            }\n            else\n              $(domfields['state']).val(suggestion.state).change();\n          }\n          if (domfields['city'])\n            $(domfields['city']).val(suggestion.city).change();\n          if (domfields['lastline'])\n            $(domfields['lastline']).val(suggestion.city + \" \" + suggestion.state).change();\n        }\n        trigger(\"AutocompleteUsed\", {address: addr, suggestion: suggestion});\n      }\n\n      // Computes where the little checkmark tag of the UI goes, relative to the boundaries of the last field\n      function uiTagOffset(corners)\n      {\n        return {\n          top: corners.top + corners.height / 2 - 10,\n          left: corners.right - 6\n        };\n      }\n\n      // This function is used to find and properly map elements to their field type\n      function filterDomElement(domElement, names, labels)\n      {\n        /*\n          Where we look to find a match, in this order:\n          name, id, <label> tags, placeholder, title\n          Our searches first conduct fairly liberal \"contains\" searches:\n          if the attribute even contains the name or label, we map it.\n          The names and labels we choose to find are very particular.\n         */\n\n        var name = lowercase(domElement.name);\n        var id = lowercase(domElement.id);\n        var selectorSafeID = id.replace(/[\\[|\\]|\\(|\\)|\\:|\\'|\\\"|\\=|\\||\\#|\\.|\\!|\\||\\@|\\^|\\&|\\*]/g, '\\\\\\\\$&');\n        var placeholder = lowercase(domElement.placeholder);\n        var title = lowercase(domElement.title);\n\n        // First look through name and id attributes of the element, the most common\n        for (var i = 0; i < names.length; i++)\n          if (name.indexOf(names[i]) > -1 || id.indexOf(names[i]) > -1)\n            return true;\n\n        // If we can't find it in name or id, look at labels associated to the element.\n        // Webkit automatically associates labels with form elements for us. But for other\n        // browsers, we have to find them manually, which this next block does.\n        if (!('labels' in domElement))\n        {\n          var lbl = $('label[for=\"' + selectorSafeID + '\"]')[0] || $(domElement).parents('label')[0];\n          domElement.labels = !lbl ? [] : [lbl];\n        }\n\n        // Iterate through the <label> tags now to search for a match.\n        for (var i = 0; i < domElement.labels.length; i++)\n        {\n          // This inner loop compares each label value with what we're looking for\n          for (var j = 0; j < labels.length; j++)\n            if ($(domElement.labels[i]).text().toLowerCase().indexOf(labels[j]) > -1)\n              return true;\n        }\n\n        // Still not found? Then look in \"placeholder\" or \"title\"...\n        for (var i = 0; i < labels.length; i++)\n        if (placeholder.indexOf(labels[i]) > -1 || title.indexOf(labels[i]) > -1)\n          return true;\n\n        // Got all the way to here? Probably not a match then.\n        return false;\n      };\n\n      // User aborted the verification process (X click or esc keyup)\n      function userAborted(uiPopup, e)\n      {\n        // Even though there may be more than one bound, and this disables the others,\n        // this is for simplicity: and I figure, it won't happen too often.\n        // (Otherwise \"Completed\" events are raised by pressing Esc even if nothing is happening)\n        $(document).unbind('keyup');\n        $(uiPopup).slideUp(defaults.speed, function() { $(this).parent('.smarty-ui').remove(); });\n        trigger(\"Completed\", e.data);\n      }\n\n      // When we're done with a \"pop-up\" where the user chooses what to do,\n      // we need to remove all other events bound on that whole \"pop-up\"\n      // so that it doesn't interfere with any future \"pop-ups\".\n      function undelegateAllClicks(selectors)\n      {\n        for (var selector in selectors)\n          $('body').undelegate(selectors[selector], 'click');\n      }\n\n      // Utility function\n      function moveCursorToEnd(el)  // Courtesy of http://css-tricks.com/snippets/javascript/move-cursor-to-end-of-input/\n      {\n        if (typeof el.selectionStart == \"number\")\n          el.selectionStart = el.selectionEnd = el.value.length;\n        else if (typeof el.createTextRange != \"undefined\")\n        {\n          el.focus();\n          var range = el.createTextRange();\n          range.collapse(false);\n          range.select();\n        }\n      }\n\n\n      // If anything was previously mapped, this resets it all for a new mapping.\n      this.clean = function()\n      {\n        if (forms.length == 0)\n          return;\n\n        if (config.debug)\n          console.log(\"Cleaning up old form map data and bindings...\");\n\n        // Spare none alive!\n\n        for (var i = 0; i < forms.length; i++)\n        {\n          $(forms[i].dom).data(mapMeta.formDataProperty, '');\n\n          // Clean up each form's DOM by resetting the address fields to the way they were\n          for (var j = 0; j < forms[i].addresses.length; j++)\n          {\n            var doms = forms[i].addresses[j].getDomFields();\n            for (var prop in doms)\n            {\n              if (config.debug)\n                $(doms[prop]).css('background', 'none').attr('placeholder', '');\n              $(doms[prop]).unbind('change');\n            }\n            if (doms['street'])\n              $(doms['street']).unbind('keyup').unbind('keydown').unbind('blur');\n          }\n\n          // Unbind our form submit and submit-button click handlers\n          $.each(forms, function(idx) { $(this.dom).unbind('submit', submitHandler); });\n          $(config.submitSelector, forms[i].dom).each(function(idx) { $(this).unbind('click', submitHandler); });\n        }\n\n        $('.smarty-ui').undelegate('.smarty-suggestion', 'click').undelegate('.smarty-suggestion', 'mouseover').undelegate('.smarty-suggestion', 'mouseleave').remove();\n        $('body').undelegate('.smarty-undo', 'click');\n        $('body').undelegate('.smarty-tag-grayed', 'click');\n        $(window).unbind('resize');\n        $(document).unbind('keyup');\n\n        forms = [];\n        mappedAddressCount = 0;\n\n        if (config.debug)\n          console.log(\"Done cleaning up; ready for new mapping.\");\n      };\n\n      function disableBrowserAutofill(dom) {\n        //Does not disable autofill if config.autocomplete is disabled\n        if(config.autocomplete > 0) {\n          for (var i = 0; i < dom.getElementsByTagName(\"input\").length; i++) {\n            dom.getElementsByTagName(\"input\")[i].autocomplete = \"smartystreets\";\n          }\n        }\n      }\n\n      function addDefaultToStateDropdown(dom) {\n        if (dom.getElementsByTagName(\"option\").length > 0) {\n          if (arrayContains(stateNames, dom.getElementsByTagName(\"option\")[0].text.toUpperCase()) ||\n            arrayContains(stateAbbreviations, dom.getElementsByTagName(\"option\")[0].text.toUpperCase())) {\n            var option = document.createElement(\"OPTION\");\n            option.innerText = \"State\";\n            option.selected = true;\n            $(dom.getElementsByTagName(\"select\")[0]).prepend(option);\n            $(dom).change();\n          }\n        }\n      }\n\n      // ** AUTOMAPPING ** //\n      this.automap = function(context)\n      {\n        if (config.debug)\n          console.log(\"Automapping fields...\");\n\n        this.clean();\n\n        //$('form').add($('iframe').contents().find('form')).each(function(idx)   // Include forms in iframes, but they must be hosted on same domain (and iframe must have already loaded)\n        $('form').each(function(idx)   // For each form ...\n        {\n          var form = new Form(this);\n          var potential = {};\n\n          // Look for each type of field in this form\n          for (var fieldName in mapMeta.identifiers)\n          {\n            var names = mapMeta.identifiers[fieldName].names;\n            var labels = mapMeta.identifiers[fieldName].labels;\n\n            // Find matching form elements and store them away\n            potential[fieldName] = $(config.fieldSelector, this)\n              .filter(function()\n              {\n                // This potential address input element must be within the user's set of selected elements\n                return $(context).has(this).length > 0; // (Using has() is compatible with as low as jQuery 1.4)\n              })\n              .filter(':visible')   // No \"hidden\" input fields allowed\n              .filter(function()\n              {\n                var name = lowercase(this.name), id = lowercase(this.id);\n\n                // \"Street address line 1\" is a special case because \"address\" is an ambiguous\n                // term, so we pre-screen this field by looking for exact matches.\n                if (fieldName == \"streets\")\n                {\n                  for (var i = 0; i < mapMeta.street1exacts.names.length; i++)\n                    if (name == mapMeta.street1exacts.names[i] || id == mapMeta.street1exacts.names[i])\n                      return true;\n                }\n\n                // Now perform the main filtering.\n                // If this is TRUE, then this form element is probably a match for this field type.\n                var filterResult = filterDomElement(this, names, labels);\n\n                if (fieldName == \"streets\")\n                {\n                  // Looking for \"address\" is a very liberal search, so we need to see if it contains another\n                  // field name, too... this helps us find freeform addresses (SLAP).\n                  var otherFields = [\"secondary\", \"city\", \"state\", \"zipcode\", \"country\", \"lastline\"];\n                  for (var i = 0; i < otherFields.length; i ++)\n                  {\n                    // If any of these filters turns up true, then it's\n                    // probably neither a \"street\" field, nor a SLAP address.\n                    if (filterDomElement(this, mapMeta.identifiers[otherFields[i]].names,\n                        mapMeta.identifiers[otherFields[i]].labels))\n                      return false;\n                  }\n                }\n\n                return filterResult;\n              })\n              .not(function()\n              {\n                // The filter above can be a bit liberal at times, so we need to filter out\n                // results that are actually false positives (fields that aren't part of the address)\n                // Returning true from this function excludes the element from the result set.\n                var name = lowercase(this.name), id = lowercase(this.id);\n                if (name == \"name\" || id == \"name\") // Exclude fields like \"First Name\", et al.\n                  return true;\n                return filterDomElement(this, mapMeta.exclude.names, mapMeta.exclude.labels);\n              })\n              .toArray();\n          }\n\n          // Now prepare to differentiate between street1 and street2.\n          potential.street = [], potential.street2 = [];\n\n          // If the ratio of 'street' fields to the number of addresses in the form\n          // (estimated by number of city or zip fields) is about the same, it's all street1.\n          if (potential.streets.length <= potential.city.length * 1.5\n            || potential.streets.length <= potential.zipcode.length * 1.5)\n          {\n            potential.street = potential.streets;\n          }\n          else\n          {\n            // Otherwise, differentiate between the two\n            for (var i = 0; i < potential.streets.length; i++)\n            {\n              // Try to map it to a street2 field first. If it fails, it's street1.\n              // The second condition is for naming schemes like \"street[]\" or \"address[]\", where the names\n              // are the same: the second one is usually street2.\n              var current = potential.streets[i];\n              if (filterDomElement(current, mapMeta.street2.names, mapMeta.street2.labels)\n                || (i > 0 && current.name == potential.streets[i-1].name))\n              {\n                // Mapped it to street2\n                potential.street2.push(current);\n              }\n              else  // Could not map to street2, so put it in street1\n                potential.street.push(current);\n            }\n          }\n\n          delete potential.streets; // No longer needed; we've moved them into street/street2.\n\n          if (config.debug)\n            console.log(\"For form \" + idx + \", the initial scan found these fields:\", potential);\n\n\n\n          // Now organize the mapped fields into addresses\n\n          // The number of addresses will be the number of street1 fields,\n          // and in case we support it in the future, maybe street2, or\n          // in case a mapping went a little awry.\n          var addressCount = Math.max(potential.street.length, potential.street2.length);\n\n          if (config.debug && addressCount == 0)\n            console.log(\"No addresses were found in form \" + idx + \".\");\n\n          for (var i = 0; i < addressCount; i++)\n          {\n            var addrObj = {};\n            for (var field in potential)\n            {\n              var current = potential[field][i];\n              if (current)\n                addrObj[field] = current;\n            }\n\n            // Don't map the address if there's not enough fields for a complete address\n            var hasCityAndStateOrZip = addrObj.zipcode || (addrObj.state && addrObj.city);\n            var hasCityOrStateOrZip = addrObj.city || addrObj.state || addrObj.zipcode;\n            if ((!addrObj.street && hasCityAndStateOrZip) || (addrObj.street && !hasCityAndStateOrZip && hasCityOrStateOrZip))\n            {\n              if (config.debug)\n                console.log(\"Form \" + idx + \" contains some address input elements that could not be resolved to a complete address.\");\n              continue;\n            }\n\n            form.addresses.push(new Address(addrObj, form, \"auto\" + (++mappedAddressCount)));\n          }\n\n          // Save the form we just finished mapping\n          disableBrowserAutofill(form.dom);\n          addDefaultToStateDropdown(form.dom);\n          forms.push(form);\n\n          if (config.debug)\n            console.log(\"Form \" + idx + \" is finished:\", form);\n        });\n\n        if (config.debug)\n          console.log(\"Automapping complete.\");\n        \n        trigger(\"FieldsMapped\");\n      };\n\n\n      // ** MANUAL MAPPING ** //\n      this.mapFields = function(map, context)\n      {\n        // \"map\" should be an array of objects mapping field types\n        // to a field by selector, all supplied by the user.\n        // \"context\" should be the set of elements in which fields will be mapped\n        // Context can be acquired like: $('#something').not('#something-else').LiveAddress( ... ); ...\n\n        if (config.debug)\n          console.log(\"Manually mapping fields given this data:\", map);\n        \n        this.clean();\n        var formsFound = [];\n        map = map instanceof Array ? map : [map];\n\n        for (var addrIdx in map)\n        {\n          var address = map[addrIdx];\n\n          if (!address.street)\n            continue;\n\n          // Convert selectors into actual DOM references\n          for (var fieldType in address)\n          {\n            if (fieldType != \"id\")\n            {\n              if (!arrayContains(acceptableFields, fieldType))\n              { // Make sure the field name is allowed\n                if (config.debug)\n                  console.log(\"NOTICE: Field named \" + fieldType + \" is not allowed. Skipping...\");\n                delete address[fieldType];\n                continue;\n              }\n              var matched = $(address[fieldType], context);\n              if (matched.length == 0)\n              { // Don't try to map an element that couldn't be matched or found at all\n                if (config.debug)\n                  console.log(\"NOTICE: No matches found for selector \" + address[fieldType] + \". Skipping...\");\n                delete address[fieldType];\n                continue;\n              }\n              else if (matched.parents('form').length == 0)\n              { // We should only map elements inside a <form> tag; otherwise we can't bind to submit handlers later\n                if (config.debug)\n                  console.log(\"NOTICE: Element with selector \\\"\" + address[fieldType] + \"\\\" is not inside a <form> tag. Skipping...\");\n                delete address[fieldType];\n                continue;\n              }\n              else\n                address[fieldType] = matched[0];\n            }\n          }\n\n          if (!((address.street) && (((address.city) && (address.state)) || (address.zipcode) || (address.lastline)\n             || (!address.street2 && !address.city && !address.state && !address.zipcode && !address.lastline))))\n          {\n            if (config.debug)\n              console.log(\"NOTICE: Address map (index \"+addrIdx+\") was not mapped to a complete street address. Skipping...\");\n            continue;\n          }\n\n          // Acquire the form based on the street address field (the required field)\n          var formDom = $(address.street).parents('form')[0];\n          var form = new Form(formDom);\n          \n          // Persist a reference to the form if it wasn't acquired before\n          if (!$(formDom).data(mapMeta.formDataProperty))\n          {\n            // Mark the form as mapped then add it to our list\n            $(formDom).data(mapMeta.formDataProperty, 1);\n            disableBrowserAutofill(form.dom);\n            addDefaultToStateDropdown(form.dom);\n            formsFound.push(form);\n          }\n          else\n          {\n            // Find the form in our list since we already put it there\n            for (var i = 0; i < formsFound.length; i++)\n            {\n              if (formsFound[i].dom == formDom)\n              {\n                form = formsFound[i];\n                break;\n              }\n            }\n          }\n\n          // Add this address to the form\n          mappedAddressCount ++;\n          form.addresses.push(new Address(address, form, address.id));\n\n          if (config.debug)\n            console.log(\"Finished mapping address with ID: \"+form.addresses[form.addresses.length-1].id());\n        }\n\n        forms = formsFound;\n        trigger(\"FieldsMapped\");\n      };\n\n\n      this.disableFields = function(address)\n      {\n        // Given an address, disables the input fields for the address, also the submit button\n        if (!config.ui)\n          return;\n\n        var fields = address.getDomFields();\n        for (var field in fields)\n          $(fields[field]).prop ? $(fields[field]).prop('disabled', true) :  $(fields[field]).attr('disabled', 'disabled');\n\n        // Disable submit buttons\n        if (address.form && address.form.dom)\n        {\n          var buttons = $(config.submitSelector, address.form.dom);\n          buttons.prop ? buttons.prop('disabled', true) :  buttons.attr('disabled', 'disabled');\n        }\n      };\n\n      this.enableFields = function(address)\n      {\n        // Given an address, re-enables the input fields for the address\n        if (!config.ui)\n          return;\n\n        var fields = address.getDomFields();\n        for (var field in fields)\n          $(fields[field]).prop ? $(fields[field]).prop('disabled', false) : $(fields[field]).removeAttr('disabled');\n\n        // Enable submit buttons\n        if (address.form && address.form.dom)\n        {\n          var buttons = $(config.submitSelector, address.form.dom);\n          buttons.prop ? buttons.prop('disabled', false) : buttons.removeAttr('disabled');\n        }\n      };\n\n      this.showLoader = function(addr)\n      {\n        if (!config.ui || !addr.hasDomFields())\n          return;\n\n        // Get position information now instead of earlier in case elements shifted since page load\n        var lastFieldCorners = addr.corners(true);\n        var loaderUI = $('.smarty-dots.smarty-addr-'+addr.id()).parent();\n\n        loaderUI.css(\"top\", (lastFieldCorners.top + lastFieldCorners.height / 2 - loaderHeight / 2) + \"px\")\n              .css(\"left\", (lastFieldCorners.right - loaderWidth - 10) + \"px\");\n        $('.smarty-dots', loaderUI).show();\n      };\n\n      this.hideLoader = function(addr)\n      {\n        if (config.ui)\n          $('.smarty-dots.smarty-addr-'+addr.id()).hide();\n      };\n\n      this.markAsValid = function(addr)\n      {\n        if (!config.ui || !addr)\n          return;\n        \n        var domTag = $('.smarty-tag.smarty-tag-grayed.smarty-addr-'+addr.id());\n        domTag.removeClass('smarty-tag-grayed').addClass('smarty-tag-green').attr(\"title\", \"Address verified! Click to undo.\");\n        $('.smarty-tag-text', domTag).text('Verified').hover(function () {\n          $(this).text('Undo');\n        }, function() {\n          $(this).text('Verified');\n        }).addClass('smarty-undo');\n      };\n\n      this.unmarkAsValid = function(addr)\n      {\n        var validSelector = '.smarty-tag.smarty-addr-'+addr.id();\n        if (!config.ui || !addr || $(validSelector).length == 0)\n          return;\n        \n        var domTag = $('.smarty-tag.smarty-tag-green.smarty-addr-'+addr.id());\n        domTag.removeClass('smarty-tag-green').addClass('smarty-tag-grayed').attr(\"title\", \"Address not verified. Click to verify.\");\n        $('.smarty-tag-text', domTag).text('Verify').unbind('mouseenter mouseleave').removeClass('smarty-undo');\n      };\n\n      this.showAmbiguous = function(data)\n      {\n        if (!config.ui || !data.address.hasDomFields())\n          return;\n\n        var addr = data.address;\n        var response = data.response;\n        var corners = addr.corners();\n        corners.width = Math.max(corners.width, 300);   // minimum width\n        corners.height = Math.max(corners.height, response.length * 63 + 119);  // minimum height\n\n        var html = '<div class=\"smarty-ui\" style=\"top: '+corners.top+'px; left: '+corners.left+'px; width: '+corners.width+'px; height: '+corners.height+'px;\">'\n          + '<div class=\"smarty-popup smarty-addr-'+addr.id()+'\" style=\"width: '+(corners.width - 6)+'px; height: '+(corners.height - 3)+'px;\">'\n          + '<div class=\"smarty-popup-header smarty-popup-ambiguous-header\">'+config.ambiguousMessage+'<a href=\"javascript:\" class=\"smarty-popup-close smarty-abort\" title=\"Cancel\">x</a></div>'\n          + '<div class=\"smarty-choice-list\">';\n\n        for (var i = 0; i < response.raw.length; i++)\n        {\n          var line1 = response.raw[i].delivery_line_1, city = response.raw[i].components.city_name,\n            st = response.raw[i].components.state_abbreviation,\n            zip = response.raw[i].components.zipcode + \"-\" + response.raw[i].components.plus4_code;\n          html += '<a href=\"javascript:\" class=\"smarty-choice\" data-index=\"'+i+'\">'+line1+'<br>'+city+', '+st+' '+zip+'</a>';\n        }\n\n        html += '</div><div class=\"smarty-choice-alt\">';\n        html += '<a href=\"javascript:\" class=\"smarty-choice smarty-choice-abort smarty-abort\">Click here to change your address</a>';\n        html += '<a href=\"javascript:\" class=\"smarty-choice smarty-choice-override\">Click here to certify the address is correct<br>('+addr.toString()+')</a>';\n        html += '</div></div></div>';\n        $(html).hide().appendTo('body').show(defaults.speed);\n\n        // Scroll to it if needed\n        if ($(document).scrollTop() > corners.top - 100\n          || $(document).scrollTop() < corners.top - $(window).height() + 100)\n        {\n          $('html, body').stop().animate({\n            scrollTop: $('.smarty-popup.smarty-addr-'+addr.id()).offset().top - 100\n          }, 500);\n        }\n\n        data.selectors = {\n          goodAddr: '.smarty-popup.smarty-addr-'+addr.id()+' .smarty-choice-list .smarty-choice',\n          useOriginal: '.smarty-popup.smarty-addr-'+addr.id()+' .smarty-choice-override',\n          abort: '.smarty-popup.smarty-addr-'+addr.id()+' .smarty-abort'\n        };\n\n        // User chose a candidate address\n        $('body').delegate(data.selectors.goodAddr, 'click', data, function(e)\n        {\n          $('.smarty-popup.smarty-addr-'+addr.id()).slideUp(defaults.speed, function()\n          {\n            $(this).parent('.smarty-ui').remove();\n            $(this).remove();\n          });\n\n          undelegateAllClicks(e.data.selectors);\n          delete e.data.selectors;\n\n          trigger(\"UsedSuggestedAddress\", {\n            address: e.data.address,\n            response: e.data.response,\n            invoke: e.data.invoke,\n            invokeFn: e.data.invokeFn,\n            chosenCandidate: response.raw[$(this).data('index')]\n          });\n        });\n\n        // User wants to revert to what they typed (forced accept)\n        $('body').delegate(data.selectors.useOriginal, 'click', data, function(e)\n        {\n          $(this).parents('.smarty-popup').slideUp(defaults.speed, function()\n          {\n            $(this).parent('.smarty-ui').remove();\n            $(this).remove();\n          });\n\n          undelegateAllClicks(e.data.selectors);\n          delete e.data.selectors;\n          trigger(\"OriginalInputSelected\", e.data);\n        });\n\n        // User presses Esc key\n        $(document).keyup(data, function(e)\n        {\n          if (e.keyCode == 27) //Esc\n          {\n            undelegateAllClicks(e.data.selectors);\n            delete e.data.selectors;\n            userAborted($('.smarty-popup.smarty-addr-'+e.data.address.id()), e);\n            suppress(e);\n          }\n        });\n\n        // User clicks \"x\" in corner or chooses to try a different address (same effect as Esc key)\n        $('body').delegate(data.selectors.abort, 'click', data, function(e)\n        {\n          undelegateAllClicks(e.data.selectors);\n          delete e.data.selectors;\n          userAborted($(this).parents('.smarty-popup'), e);\n        });\n      };\n\n\n      this.showInvalid = function(data)\n      {\n        if (!config.ui || !data.address.hasDomFields())\n          return;\n\n        var addr = data.address;\n        var response = data.response;\n        var corners = addr.corners();\n        corners.width = Math.max(corners.width, 300);   // minimum width\n        corners.height = Math.max(corners.height, 180); // minimum height\n\n        var html = '<div class=\"smarty-ui\" style=\"top: '+corners.top+'px; left: '+corners.left+'px; width: '+corners.width+'px; height: '+corners.height+'px;\">'\n          + '<div class=\"smarty-popup smarty-addr-'+addr.id()+'\" style=\"width: '+(corners.width - 6)+'px; height: '+(corners.height - 3)+'px;\">'\n          + '<div class=\"smarty-popup-header smarty-popup-invalid-header\">'+config.invalidMessage+'<a href=\"javascript:\" class=\"smarty-popup-close smarty-abort\" title=\"Cancel\">x</a></div>'\n          + '<div class=\"smarty-choice-list\"><a href=\"javascript:\" class=\"smarty-choice smarty-choice-abort smarty-abort\">Click here to change your address</a></div>'\n          + '<div class=\"smarty-choice-alt\"><a href=\"javascript:\" class=\"smarty-choice smarty-choice-override\">Click here to certify the address is correct<br>('+addr.toString()+')</a></div>'\n          + '</div></div>';\n\n        $(html).hide().appendTo('body').show(defaults.speed);\n\n        data.selectors = {\n          useOriginal: '.smarty-popup.smarty-addr-'+addr.id()+' .smarty-choice-override ',\n          abort: '.smarty-popup.smarty-addr-'+addr.id()+' .smarty-abort'\n        }\n\n        // Scroll to it if necessary\n        if ($(document).scrollTop() > corners.top - 100\n          || $(document).scrollTop() < corners.top - $(window).height() + 100)\n        {\n          $('html, body').stop().animate({\n            scrollTop: $('.smarty-popup.smarty-addr-'+addr.id()).offset().top - 100\n          }, 500);\n        }\n\n        // User rejects original input and agrees to double-check it\n        $('body').delegate(data.selectors.abort, 'click', data, function(e)\n        {\n          userAborted('.smarty-popup.smarty-addr-'+e.data.address.id(), e);\n          delete e.data.selectors;\n          trigger(\"InvalidAddressRejected\", e.data);\n        });\n\n        // User certifies that what they typed is correct\n        $('body').delegate(data.selectors.useOriginal, 'click', data, function(e)\n        {\n          userAborted('.smarty-popup.smarty-addr-'+e.data.address.id(), e);\n          delete e.data.selectors;\n          trigger(\"OriginalInputSelected\", e.data);\n        });\n\n        // User presses esc key\n        $(document).keyup(data, function(e)\n        {\n          if (e.keyCode == 27) //Esc\n          {\n            $(data.selectors.abort).click();\n            undelegateAllClicks(e.data.selectors);\n            userAborted('.smarty-popup.smarty-addr-'+e.data.address.id(), e);\n          }\n        });\n      };\n\n      this.isDropdown = function(dom)\n      {\n        return dom && ((dom.tagName || dom.nodeName || \"\").toUpperCase() == \"SELECT\");\n      };\n    }\n\n    var allStatesByName = {\n      \"ALABAMA\":\"AL\",\"ALASKA\":\"AK\",\"AMERICAN SAMOA\":\"AS\",\"ARIZONA\":\"AZ\",\"ARKANSAS\":\"AR\",\"CALIFORNIA\":\"CA\",\"COLORADO\":\"CO\",\"CONNECTICUT\":\"CT\",\"DELAWARE\":\"DE\",\"DISTRICT OF COLUMBIA\":\"DC\",\"FEDERATED STATES OF MICRONESIA\":\"FM\",\"FLORIDA\":\"FL\",\"GEORGIA\":\"GA\",\"GUAM\":\"GU\",\"HAWAII\":\"HI\",\"IDAHO\":\"ID\",\"ILLINOIS\":\"IL\",\"INDIANA\":\"IN\",\"IOWA\":\"IA\",\"KANSAS\":\"KS\",\"KENTUCKY\":\"KY\",\"LOUISIANA\":\"LA\",\"MAINE\":\"ME\",\"MARSHALL ISLANDS\":\"MH\",\"MARYLAND\":\"MD\",\"MASSACHUSETTS\":\"MA\",\"MICHIGAN\":\"MI\",\"MINNESOTA\":\"MN\",\"MISSISSIPPI\":\"MS\",\"MISSOURI\":\"MO\",\"MONTANA\":\"MT\",\"NEBRASKA\":\"NE\",\"NEVADA\":\"NV\",\"NEW HAMPSHIRE\":\"NH\",\"NEW JERSEY\":\"NJ\",\"NEW MEXICO\":\"NM\",\"NEW YORK\":\"NY\",\"NORTH CAROLINA\":\"NC\",\"NORTH DAKOTA\":\"ND\",\"NORTHERN MARIANA ISLANDS\":\"MP\",\"OHIO\":\"OH\",\"OKLAHOMA\":\"OK\",\"OREGON\":\"OR\",\"PALAU\":\"PW\",\"PENNSYLVANIA\":\"PA\",\"PUERTO RICO\":\"PR\",\"RHODE ISLAND\":\"RI\",\"SOUTH CAROLINA\":\"SC\",\"SOUTH DAKOTA\":\"SD\",\"TENNESSEE\":\"TN\",\"TEXAS\":\"TX\",\"UTAH\":\"UT\",\"VERMONT\":\"VT\",\"VIRGIN ISLANDS\":\"VI\",\"VIRGINIA\":\"VA\",\"WASHINGTON\":\"WA\",\"WEST VIRGINIA\":\"WV\",\"WISCONSIN\":\"WI\",\"WYOMING\":\"WY\",\n      \"ARMED FORCES EUROPE, THE MIDDLE EAST, AND CANADA\":\"AE\",\"ARMED FORCES CANADA\":\"AE\",\"ARMED FORCES THE MIDDLE EAST\":\"AE\",\"ARMED FORCES EUROPE\":\"AE\",\"ARMED FORCES PACIFIC\":\"AP\",\"ARMED FORCES AMERICAS (EXCEPT CANADA)\":\"AA\",\"ARMED FORCES AMERICAS\":\"AA\"\n    };\n    // this listing of stateNames has West Virginia before Virginia and the Virgin Islands (most specific to least specific)\n    var stateNames = [\"ALABAMA\",\"ALASKA\",\"AMERICAN SAMOA\",\"ARIZONA\",\"ARKANSAS\",\"CALIFORNIA\",\"COLORADO\",\"CONNECTICUT\",\"DELAWARE\",\"DISTRICT OF COLUMBIA\",\"FEDERATED STATES OF MICRONESIA\",\"FLORIDA\",\"GEORGIA\",\"GUAM\",\"HAWAII\",\"IDAHO\",\"ILLINOIS\",\"INDIANA\",\"IOWA\",\"KANSAS\",\"KENTUCKY\",\"LOUISIANA\",\"MAINE\",\"MARSHALL ISLANDS\",\"MARYLAND\",\"MASSACHUSETTS\",\"MICHIGAN\",\"MINNESOTA\",\"MISSISSIPPI\",\"MISSOURI\",\"MONTANA\",\"NEBRASKA\",\"NEVADA\",\"NEW HAMPSHIRE\",\"NEW JERSEY\",\"NEW MEXICO\",\"NEW YORK\",\"NORTH CAROLINA\",\"NORTH DAKOTA\",\"NORTHERN MARIANA ISLANDS\",\"OHIO\",\"OKLAHOMA\",\"OREGON\",\"PALAU\",\"PENNSYLVANIA\",\"PUERTO RICO\",\"RHODE ISLAND\",\"SOUTH CAROLINA\",\"SOUTH DAKOTA\",\"TENNESSEE\",\"TEXAS\",\"UTAH\",\"VERMONT\",\"WEST VIRGINIA\",\"VIRGINIA\",\"VIRGIN ISLANDS\",\"WASHINGTON\",\"WISCONSIN\",\"WYOMING\",\"ARMED FORCES EUROPE, THE MIDDLE EAST, AND CANADA\",\"ARMED FORCES CANADA\",\"ARMED FORCES THE MIDDLE EAST\",\"ARMED FORCES EUROPE\",\"ARMED FORCES PACIFIC\",\"ARMED FORCES AMERICAS (EXCEPT CANADA)\",\"ARMED FORCES AMERICAS\"];\n    var stateAbbreviations = [\"AL\",\"AK\",\"AS\",\"AZ\",\"AR\",\"CA\",\"CO\",\"CT\",\"DE\",\"DC\",\"FM\",\"FL\",\"GA\",\"GU\",\"HI\",\"ID\",\"IL\",\"IN\",\"IA\",\"KS\",\"KY\",\"LA\",\"ME\",\"MH\",\"MD\",\"MA\",\"MI\",\"MN\",\"MS\",\"MO\",\"MT\",\"NE\",\"NV\",\"NH\",\"NJ\",\"NM\",\"NY\",\"NC\",\"ND\",\"MP\",\"OH\",\"OK\",\"OR\",\"PW\",\"PA\",\"PR\",\"RI\",\"SC\",\"SD\",\"TN\",\"TX\",\"UT\",\"VT\",\"VI\",\"VA\",\"WA\",\"WV\",\"WI\",\"WY\",\"AE\",\"AP\",\"AA\"];\n\n    /*\n      Represents an option in a state dropdown menu. We look for any clues in the value or text\n      as to what state the option might represent so that when a verified result comes back we\n      can update the dropdown accordingly. Also allows us to submit the correct value to the server.\n      In many cases the value is a key that is only meaningful to the server-side code.\n    */\n    function StateDropdownOption(option)\n    {\n      var self = this; // Pointer to self so that internal functions can reference its parent\n\n      this.standard = function() {\n\n        for (var x in stateNames) {\n          var name = stateNames[x];\n\n          // look in the option.text for the full state name...\n          var text = option.text.toUpperCase();\n          if (text.indexOf(name) > -1)\n            return allStatesByName[name];\n\n          // look in the option.value for the full state name...\n          var value = option.value.toUpperCase();\n          if (value.indexOf(name) > -1)\n            return allStatesByName[name];\n        }\n\n        for (var x in stateAbbreviations) {\n          var abbreviation = stateAbbreviations[x];\n\n          // look in the option.text for a state abbreviation...\n          var words = option.text.split(/[ ,]+/);\n          for (var y in words) {\n            var word = words[y].toUpperCase();\n            if (abbreviation === word)\n              return abbreviation;\n          }\n\n          // look in the option.value for a state abbreviation...\n          var words = option.value.split(/[ ,]+/);\n          for (var y in words) {\n            var word = words[y].toUpperCase();\n            if (abbreviation === word)\n              return abbreviation;\n          }\n        }\n\n        return '';\n      }\n\n      this.value = function() {\n        return option.value ? option.value : option.text;\n      }\n    }\n\n    /*\n      Represents an address inputted by the user, whether it has been verified yet or not.\n      formObj must be a Form OBJECT, not a <form> tag... and the addressID is optional.\n    */\n    function Address(domMap, formObj, addressID)\n    {\n      // PRIVATE MEMBERS //\n\n      var self = this;              // Pointer to self so that internal functions can reference its parent\n      var fields;                 // Data values and references to DOM elements\n      var id;                   // An ID by which to classify this address on the DOM\n      var statesOptions = {};           // Stores the actual state dropdown option values that correspond to the option names\n      var totalStatesOptions = 0;         // Total number of options in the state dropdown\n\n      var state = \"accepted\";           // Can be: \"accepted\" or \"changed\"\n      // Example of a field:  street: { value: \"123 main\", dom: DOMElement, undo: \"123 mai\"}\n      // Some of the above fields will only be mapped manually, not automatically.\n      \n      // Private method that actually changes the address. The keepState parameter is\n      // used by the results of verification after an address is chosen; (or an \"undo\"\n      // on a freeform address), otherwise an infinite loop of requests is executed\n      // because the address keeps changing! (Set \"suppressAutoVerify\" to true when coming from the \"Undo\" link)  \n      var doSet = function(key, value, updateDomElement, keepState, sourceEvent, suppressAutoVerify)\n      {\n        if (!arrayContains(acceptableFields, key))  // Skip \"id\" and other unacceptable fields\n          return false;\n\n        if (!fields[key])\n          fields[key] = {};\n\n        value = value.replace(/<|>/g, \"\");  // prevents script injection attacks (< and > aren't in addresses, anyway)\n\n        var differentVal = fields[key].value != value;\n\n        fields[key].undo = fields[key].value || \"\";\n        fields[key].value = value;\n\n        if (updateDomElement && fields[key].dom) {\n\n          // figure out which state dropdown option should be selected, if any...\n          if (key === 'state' && totalStatesOptions > 0 && value in statesOptions) {\n            value = statesOptions[value].value();\n          }\n\n          $(fields[key].dom).val(value);\n        }\n\n        var eventMeta = {\n          sourceEvent: sourceEvent, // may be undefined\n          field: key,\n          address: self,\n          value: value,\n          suppressAutoVerification: suppressAutoVerify || false\n        };\n\n        if (differentVal && !keepState)\n        {\n          ui.unmarkAsValid(self);\n          var uiTag = config.ui ? $('.smarty-ui .smarty-tag.smarty-addr-'+id) : undefined;\n          if (self.isDomestic())\n          {\n            if (uiTag && !uiTag.is(':visible'))\n              uiTag.show(); // Show checkmark tag if address is in US\n            self.unaccept();\n            trigger(\"AddressChanged\", eventMeta);\n          }\n          else\n          {\n            if (uiTag && uiTag.is(':visible'))\n              uiTag.hide(); // Hide checkmark tag if address is non-US\n            self.accept({ address: self }, false);\n          }\n        }\n\n        return true;\n      };\n\n      // PUBLIC MEMBERS //\n\n      this.form = formObj;  // Reference to the parent form object (NOT THE DOM ELEMENT)\n      this.verifyCount = 0; // Number of times this address was submitted for verification\n      this.lastField;     // The last field found (last to appear in the DOM) during mapping, or the order given\n      this.active = true;   // If true, verify the address. If false, pass-thru entirely.\n      this.lastStreetInput = \"\";  // Used by autocomplete to detect changes\n\n      // Constructor-esque functionality (save the fields in this address object)\n      this.load = function(domMap, addressID)\n      {\n        fields = {};\n        id = addressID ? addressID.replace(/[^a-z0-9_\\-]/ig, '') : randomInt(1, 99999);   // Strips non-selector-friendly characters\n\n        if (typeof domMap === 'object') // can be an actual map to DOM elements or just field/value data\n        {\n          // Find the last field likely to appear on the DOM (used for UI attachments)\n          this.lastField = domMap.lastline || domMap.zipcode || domMap.state || domMap.city || domMap.street;\n\n          var isEmpty = true; // Whether the address has data in it (pre-populated) -- first assume it is empty.\n\n          for (var prop in domMap)\n          {\n            if (!arrayContains(acceptableFields, prop)) // Skip \"id\" and any other unacceptable field\n              continue;\n\n            var elem, val, elemArray, isData;\n            try\n            {\n              elem = $(domMap[prop]);\n              elemArray = elem.toArray();\n              isData = elemArray ? elemArray.length == 0 : false;\n            }\n            catch (e) { isData = true; }\n\n            if (isData) // Didn't match an HTML element, so treat it as an address string (\"street1\" data) instead\n              val = domMap[prop] || \"\";\n            else\n              val = elem.val() || \"\";\n\n            // Here we analyze the state dropdown so we can update it with verified address results later.\n            if (prop === \"state\" && elemArray[0] != undefined && elemArray[0].length != undefined) { // Is there a better way to detect a state dropdown from here?\n              $('option', elem).each(function(i){\n                var option = new StateDropdownOption(this);\n                var standardized = option.standard();\n                statesOptions[standardized] = option;\n                totalStatesOptions++;\n              });\n            }\n\n            fields[prop] = {};\n            fields[prop].value = val;\n            fields[prop].undo = val;\n            isEmpty = isEmpty ? val.length == 0 || ui.isDropdown(domMap[prop]) : false;  // dropdowns could have an initial value, yet the address may be \"empty\" (<option value=\"None\" selected>(Select state)</option>) ...\n\n            if (!isData)\n            {\n              if (config.debug)\n              {\n                elem.css('background', '#FFFFCC');\n                elem.attr('placeholder', prop + \":\" + id);\n              }\n              fields[prop].dom = domMap[prop];\n            }\n\n\n            // This has to be passed in at bind-time; they cannot be obtained at run-time\n            var data = {\n              address: this,\n              field: prop,\n              value: val\n            };\n            \n            // Bind the DOM element to needed events, passing in the data above\n            // NOTE: When the user types a street, city, and state, then hits Enter without leaving\n            // the state field, this change() event fires before the form is submitted, and if autoVerify is\n            // on, the verification will not invoke form submit, because it didn't come from a form submit.\n            // This is known behavior and is actually proper functioning in this uncommon edge case.\n            !isData && $(domMap[prop]).change(data, function(e)\n            {\n              e.data.address.set(e.data.field, e.target.value, false, false, e, false);\n            });\n          }\n\n          if (!isEmpty)\n            state = \"changed\";\n        }\n      };\n\n      // Run the \"constructor\" to load up the address\n      this.load(domMap, addressID);\n\n\n      this.set = function(key, value, updateDomElement, keepState, sourceEvent, suppressAutoVerify)\n      {\n        if (typeof key === 'string' && arguments.length >= 2)\n          return doSet(key, value, updateDomElement, keepState, sourceEvent, suppressAutoVerify);\n        else if (typeof key === 'object')\n        {\n          var successful = true;\n          for (var prop in key)\n            successful = doSet(prop, key[prop], updateDomElement, keepState, sourceEvent, suppressAutoVerify) ? successful : false;\n          return successful;\n        }\n      };\n\n      this.replaceWith = function(resp, updateDomElement, e)\n      {\n        // Given the response from an API request associated with this address,\n        // replace the values in the address... and if updateDomElement is true,\n        // then change the values in the fields on the page accordingly.\n        \n        if (typeof resp === 'array' && resp.length > 0)\n          resp = resp[0];\n\n        if (self.isFreeform())\n        {\n          var singleLineAddr = (resp.addressee ? resp.addressee + \" \" : \"\") +\n            (resp.delivery_line_1 ? resp.delivery_line_1 + \" \" : \"\") +\n            (resp.delivery_line_2 ? resp.delivery_line_2 + \" \" : \"\") +\n            (resp.components.urbanization ? resp.components.urbanization + \" \" : \"\") +\n            (resp.last_line ? resp.last_line : \"\");\n\n          self.set(\"street\", singleLineAddr, updateDomElement, true, e, false);\n        }\n        else\n        {\n          if (resp.addressee)\n            self.set(\"addressee\", resp.addressee, updateDomElement, true, e, false);\n          if (resp.delivery_line_1)\n            self.set(\"street\", resp.delivery_line_1, updateDomElement, true, e, false);\n          if (resp.last_line && fields[\"lastline\"])\n            self.set(\"lastline\", resp.last_line, updateDomElement, true, e, false);\n          self.set(\"street2\", resp.delivery_line_2 || \"\", updateDomElement, true, e, false);  // Rarely used; must otherwise be blank.\n          self.set(\"secondary\", \"\", updateDomElement, true, e, false);  // Not used in standardized addresses\n          if (resp.components.urbanization)\n            self.set(\"urbanization\", resp.components.urbanization, updateDomElement, true, e, false);\n          if (resp.components.city_name)\n            self.set(\"city\", resp.components.city_name, updateDomElement, true, e, false);\n          if (resp.components.state_abbreviation)\n            self.set(\"state\", resp.components.state_abbreviation, updateDomElement, true, e, false);\n          if (resp.components.zipcode && resp.components.plus4_code)\n            self.set(\"zipcode\", resp.components.zipcode + \"-\" + resp.components.plus4_code, updateDomElement, true, e, false);\n        }\n      };\n\n      this.corners = function(lastField)\n      {\n        var corners = {};\n\n        if (!lastField)\n        {\n          for (var prop in fields)\n          {\n            if (!fields[prop].dom || !$(fields[prop].dom).is(':visible'))\n              continue;\n\n            var dom = fields[prop].dom;\n            var offset = $(dom).offset();\n            offset.right = offset.left + $(dom).outerWidth(false);\n            offset.bottom = offset.top + $(dom).outerHeight(false);\n\n            corners.top = !corners.top ? offset.top : Math.min(corners.top, offset.top);\n            corners.left = !corners.left ? offset.left : Math.min(corners.left, offset.left);\n            corners.right = !corners.right ? offset.right : Math.max(corners.right, offset.right);\n            corners.bottom = !corners.bottom ? offset.bottom : Math.max(corners.bottom, offset.bottom);\n          }\n        }\n        else\n        {\n          var jqDom = $(self.lastField);\n          corners = jqDom.offset();\n          corners.right = corners.left + jqDom.outerWidth(false);\n          corners.bottom = corners.top + jqDom.outerHeight(false);\n        }\n\n        corners.width = corners.right - corners.left;\n        corners.height = corners.bottom - corners.top;\n\n        return corners;\n      };\n\n      this.verify = function(invoke, invokeFn)\n      {\n        // Invoke contains the element to \"click\" on once we're all done, or is a user-defined callback function (may also be undefined)\n        if (!invoke && !self.enoughInput())\n        {\n          if (config.debug)\n            console.log(\"NOTICE: The address does not have enough input to verify. Since no callback is specified, there is nothing to do.\");\n          return trigger(\"Completed\", { address: self, invoke: invoke, invokeFn: invokeFn, response: new Response([]) });\n        }\n\n        if (!self.enoughInput())\n          return trigger(\"AddressWasInvalid\", { address: self, response: new Response([]), invoke: invoke, invokeFn: invokeFn });\n\n        ui.disableFields(self);\n        self.verifyCount ++;\n        var addrData = self.toRequest();\n        var credentials = config.token ? \"auth-id=\"+encodeURIComponent(config.key)+\"&auth-token=\"+encodeURIComponent(config.token) : \"auth-token=\"+encodeURIComponent(config.key);\n\n        $.ajax(\n        {\n          url: config.requestUrl+\"?\"+credentials+\"&plugin=\"+encodeURIComponent(instance.version)+(config.debug ? \"_debug\" : \"\")+\"&callback=?\",\n          dataType: \"jsonp\",\n          data: addrData,\n          timeout: config.timeout\n        })\n        .done(function(response, statusText, xhr)\n        {\n          trigger(\"ResponseReceived\", { address: self, response: new Response(response), invoke: invoke, invokeFn: invokeFn });\n        })\n        .fail(function(xhr, statusText)\n        {\n          trigger(\"RequestTimedOut\", { address: self, status: statusText, invoke: invoke, invokeFn: invokeFn });\n          self.verifyCount --;      // Address verification didn't actually work, so don't count it\n        });\n\n        // Remember, the above callbacks happen later and this function is\n        // executed immediately afterward, probably before a response is received.\n        trigger(\"RequestSubmitted\", { address: self });\n      };\n\n      this.enoughInput = function()\n      {\n        var stateText;\n\n        // Checks for state dropdown\n        if(fields.state)\n        {\n          stateText = fields.state.value;\n          if(fields.state.dom !== undefined && fields.state.dom.length !== undefined)\n          {\n            if(fields.state.dom.selectedIndex < 1)\n              stateText = \"\";\n            else\n              stateText = fields.state.dom.options[fields.state.dom.selectedIndex].text;\n          }\n        }\n        return (fields.street && fields.street.value)\n          && (\n            (\n              (fields.city && fields.city.value)\n              && (fields.state && stateText.length > 0)\n            )\n            || (fields.zipcode && fields.zipcode.value)\n            || (fields.lastline && fields.lastline.value)\n            || (!fields.street2 && !fields.city && !fields.state && !fields.zipcode && !fields.lastline) // Allow freeform addresses (only a street field)\n             );\n      };\n\n      this.toRequest = function()\n      {\n        var obj = {};\n        if(fields.hasOwnProperty(\"lastline\") && fields.hasOwnProperty(\"city\") && fields.hasOwnProperty(\"state\") && fields.hasOwnProperty(\"zipcode\")) {\n              delete fields.city;\n              delete fields.state;\n              delete fields.zipcode\n            }\n        for (var key in fields)\n        {\n          var keyval = {};\n          if(key === \"state\" && fields[key].dom.length > 0)\n            keyval[key] = fields[key].dom[fields[key].dom.selectedIndex].text;\n          else \n            keyval[key] = fields[key].value.replace(/\\r|\\n/g, \" \"); // Line breaks to spaces\n          $.extend(obj, keyval);\n        }\n        return $.extend(obj, {candidates: config.candidates});\n      };\n\n      this.toString = function()\n      {\n        if(fields.state){\n          var stateText = fields.state.value;\n\n          // Sets state to text from dropdown, opposed to the value\n          console.log('fields.state:')\n          console.log(fields.state)\n          console.log('fields.state.dom:')\n          console.log(fields.state.dom)\n          if(fields.state.dom.length > 0)\n          {\n            stateText = fields.state.dom[fields.state.dom.selectedIndex].text;\n          }\n        }\n        return (fields.street ? fields.street.value + \" \" : \"\")\n          + (fields.street2 ? fields.street2.value + \" \" : \"\")\n          + (fields.secondary ? fields.secondary.value + \" \" : \"\")\n          + (fields.city ? fields.city.value + \" \" : \"\")\n          + (fields.state ? stateText + \" \" : \"\")\n          + (fields.zipcode ? fields.zipcode.value : \"\");\n      }\n\n      this.abort = function(event, keepAccept)\n      {\n        keepAccept = typeof keepAccept === 'undefined' ? false : keepAccept;\n        if (!keepAccept)\n          self.unaccept();\n        delete self.form.processing;\n        return suppress(event);\n      }\n\n      // Based on the properties in \"fields,\" determines if this is a single-line address\n      this.isFreeform = function()\n      {\n        return fields.street && !fields.street2 && !fields.secondary\n            && !fields.addressee && !fields.city && !fields.state\n            && !fields.zipcode && !fields.urbanization && !fields.lastline;\n      }\n      \n      this.get = function(key)\n      {\n        return fields[key] ? fields[key].value : null\n      };\n\n      this.undo = function(updateDomElement)\n      {\n        updateDomElement = typeof updateDomElement === 'undefined' ? true : updateDomElement;\n        for (var key in fields)\n          this.set(key, fields[key].undo, updateDomElement, false, undefined, true);\n      };\n\n      this.accept = function(data, showValid)\n      {\n        showValid = typeof showValid === 'undefined' ? true : showValid;\n        state = \"accepted\";\n        ui.enableFields(self);\n        if (showValid)  // If user chooses original input or the request timed out, the address wasn't \"verified\"\n          ui.markAsValid(self);\n        trigger(\"AddressAccepted\", data);\n      };\n\n      this.unaccept = function()\n      {\n        state = \"changed\";\n        ui.unmarkAsValid(self);\n        return self;\n      };\n\n      this.getUndoValue = function(key)\n      {\n        return fields[key].undo;\n      };\n\n      this.status = function()\n      {\n        return state;\n      };\n\n      this.getDomFields = function()\n      {\n        // Gets just the DOM elements for each field\n        var obj = {};\n        for (var prop in fields)\n        {\n          var ext = {};\n          ext[prop] = fields[prop].dom;\n          $.extend(obj, ext);\n        }\n        return obj;\n      };\n\n      this.hasDomFields = function()\n      {\n        for (var prop in fields)\n          if (fields[prop].dom)\n            return true;\n      }\n\n      this.isDomestic = function()\n      {\n        if (!fields.country)\n          return true;\n        var countryValue = fields.country.value.toUpperCase().replace(/\\.|\\s|\\(|\\)|\\\\|\\/|-/g, \"\");\n        var usa = [\"\", \"0\", \"1\", \"COUNTRY\", \"NONE\", \"US\", \"USA\", \"USOFA\", \"USOFAMERICA\", \"AMERICAN\", // 1 is AmeriCommerce\n              \"UNITEDSTATES\", \"UNITEDSTATESAMERICA\",  \"UNITEDSTATESOFAMERICA\", \"AMERICA\",\n              \"840\", \"223\", \"AMERICAUNITEDSTATES\", \"AMERICAUS\", \"AMERICAUSA\"];  // 840 is ISO: 3166; and 223 is some shopping carts\n        return arrayContains(usa, countryValue) || fields.country.value == \"-1\";\n      }\n\n      this.autocompleteVisible = function()\n      {\n        return config.ui && config.autocomplete && $('.smarty-autocomplete.smarty-addr-'+self.id()).is(':visible');\n      }\n\n      this.id = function()\n      {\n        return id;\n      };\n    }\n\n\n    /*\n      Represents a <form> tag which contains mapped fields.\n    */\n    function Form(domElement)\n    {\n      this.addresses = [];\n      this.dom = domElement;\n\n      this.activeAddressesNotAccepted = function()\n      {\n        var addrs = [];\n        for (var i = 0; i < this.addresses.length; i++)\n        {\n          var addr = this.addresses[i];\n          if (addr.status() != \"accepted\" && addr.active)\n            addrs.push(addr);\n        }\n        return addrs;\n      };\n\n      this.allActiveAddressesAccepted = function()\n      {\n        return this.activeAddressesNotAccepted().length == 0;\n      };\n    }\n\n\n    /*\n      Wraps output from the API in an easier-to-handle way\n    */\n\n    function Response(json)\n    {\n      // PRIVATE MEMBERS //\n\n      var checkBounds = function(idx)\n      {\n        // Ensures that an index is within the number of candidates\n        if (idx >= json.length || idx < 0)\n        {\n          if (json.length == 0)\n            throw new Error(\"Candidate index is out of bounds (no candidates returned; requested \" + idx + \")\");\n          else\n            throw new Error(\"Candidate index is out of bounds (\" + json.length + \" candidates; indicies 0 through \" + (json.length - 1) + \" available; requested \" + idx + \")\");\n        }\n      };\n      \n      var maybeDefault = function(idx)\n      {\n        // Assigns index to 0, the default value, if no value is passed in\n        return typeof idx === 'undefined' ? 0 : idx;\n      };\n\n\n      // PUBLIC-FACING MEMBERS //\n\n      this.raw = json;\n      this.length = json.length;\n\n      this.isValid = function()\n      {\n        return this.length == 1;\n      };\n\n      this.isInvalid = function()\n      {\n        return this.length == 0;\n      };\n\n      this.isAmbiguous = function()\n      {\n        return this.length > 1;\n      };\n\n      // These next functions are not comprehensive, but helpful for common tasks.\n\n      this.isMissingSecondary = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].analysis.dpv_footnotes.indexOf(\"N1\") > -1\n            || this.raw[idx].analysis.dpv_footnotes.indexOf(\"R1\") > -1\n            || (this.raw[idx].analysis.footnotes && this.raw[idx].analysis.footnotes.indexOf(\"H#\") > -1);\n      };\n\n      this.isBadSecondary = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].analysis.footnotes && this.raw[idx].analysis.footnotes.indexOf(\"S#\") > -1;\n      }\n\n      this.componentChanged = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].analysis.footnotes && this.raw[idx].analysis.footnotes.indexOf(\"L#\") > -1;\n      }\n\n      this.betterAddressExists = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].analysis.footnotes && this.raw[idx].analysis.footnotes.indexOf(\"P#\") > -1;\n      }\n\n      this.isExactMatch = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].analysis.footnotes && this.raw[idx].analysis.dpv_footnotes == \"AABB\";\n      }\n\n      this.isUniqueZipCode = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].analysis.dpv_footnotes.indexOf(\"U1\") > -1\n            || (this.raw[idx].analysis.footnotes && this.raw[idx].analysis.footnotes.indexOf(\"Q#\") > -1);\n      }\n\n      this.fixedAbbreviations = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].analysis.footnotes && this.raw[idx].analysis.footnotes.indexOf(\"N#\") > -1;\n      }\n\n      this.fixedZipCode = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].analysis.footnotes && this.raw[idx].analysis.footnotes.indexOf(\"A#\") > -1;\n      }\n\n      this.fixedSpelling = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].analysis.footnotes.indexOf(\"B#\") > -1\n          || (this.raw[idx].analysis.footnotes && this.raw[idx].analysis.footnotes.indexOf(\"M#\") > -1);\n      }\n\n      this.isBuildingDefault = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].metadata.building_default_indicator;\n      }\n\n      this.isMilitary = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].analysis.dpv_footnotes.indexOf(\"F1\") > -1;\n      }\n\n      this.hasExtraSecondary = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].analysis.dpv_footnotes.indexOf(\"CC\") > -1;\n      }\n\n      this.isLacsLink = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].analysis.lacslink_code == \"A\";\n      }\n\n      this.isCommercial = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].metadata.rdi == \"Commercial\";\n      }\n\n      this.isResidential = function(idx)\n      {\n        idx = maybeDefault(idx); checkBounds(idx);\n        return this.raw[idx].metadata.rdi == \"Residential\";\n      }\n    }\n    \n\n    /*\n     *  EVENT HANDLER \"SHTUFF\"\n     */\n\n\n    /*\n      Called every time a LiveAddress event is raised.\n      This allows us to maintain the binding even if the\n      callback function is changed later.\n      \"event\" is the actual event object, and\n      \"data\" is anything extra to pass to the event handler.\n    */\n    function HandleEvent(event, data)\n    {\n      var handler = EventHandlers[event.type];\n      if (handler)\n        handler(event, data);\n    }\n\n    // Submits a form by calling `click` on a button element or `submit` on a form element\n    var submitForm = function(invokeOn, invokeFunction)\n    {\n      if (invokeOn && typeof invokeOn !== 'function' && invokeFunction)\n        if (invokeFunction == \"click\")\n          $(invokeOn).trigger('click'); // Very particular: we MUST fire the native 'click' event!\n        else if (invokeFunction == \"submit\")\n          $(invokeOn).submit(); // For submit(), we have to use jQuery's, so that all its submit handlers fire.\n    };\n\n    var EventHandlers = {\n      FieldsMapped: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"FieldsMapped\", \"(Fields mapped to their respective addresses)\", event, data);\n\n        // We wait until the window is all loaded in case some elements are still loading\n        window.loaded ? ui.postMappingOperations() : $(window).load(ui.postMappingOperations);\n      },\n\n      MapInitialized: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"MapInitialized\", \"(Mapped fields have been wired up to the window\"+(config.ui ? \", document, and UI\" : \" and document\")+\")\", event, data);\n      },\n\n      AutocompleteInvoked: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"AutocompleteInvoked\", \"(A request is about to be sent to the autocomplete service)\", event, data);\n        ui.requestAutocomplete(event, data);\n      },\n\n      AutocompleteReceived: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"AutocompleteReceived\", \"(A response has just been received from the autocomplete service)\", event, data);\n        ui.showAutocomplete(event, data);\n      },\n\n      AutocompleteUsed: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"AutocompleteUsed\", \"(A suggested address was used from the autocomplete service)\", event, data);\n      },\n\n      AddressChanged: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"AddressChanged\", \"(Address changed)\", event, data);\n        \n        // If autoVerify is on, AND there's enough input in the address,\n        // AND it hasn't been verified automatically before -OR- it's a freeform address,\n        // AND autoVerification isn't suppressed (from an Undo click, even on a freeform address)\n        // AND it has a DOM element (it's not just a programmatic Address object)\n        // AND the address is \"active\" for verification\n        // AND the autocomplete suggestions aren't visible\n        // AND the form, if any, isn't already chewing on an address...\n        // THEN verification has been invoked.\n        if (config.autoVerify && data.address.enoughInput()\n          && (data.address.verifyCount == 0 || data.address.isFreeform())\n          && !data.suppressAutoVerification\n          && data.address.hasDomFields()\n          && data.address.active\n          && !data.address.autocompleteVisible()\n          && (data.address.form && !data.address.form.processing))\n          trigger(\"VerificationInvoked\", { address: data.address });\n      },\n\n      VerificationInvoked: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"VerificationInvoked\", \"(Address verification invoked)\", event, data);\n        \n        // Abort now if an address in the same form is already being processed\n        if (!data.address || (data.address && data.address.form && data.address.form.processing))\n        {\n          if (config.debug)\n            console.log(\"NOTICE: VerificationInvoked event handling aborted. Address is missing or an address in the same form is already processing.\");\n          return;\n        }\n        else if (data.address.status() == \"accepted\" && !data.verifyAccepted)\n        {\n          if (config.debug)\n            console.log(\"NOTICE: VerificationInvoked raised on an accepted or un-changed address. Nothing to do.\");\n          return trigger(\"Completed\", data);\n        }\n        else if (data.address.form)\n          data.address.form.processing = true;\n\n        data.address.verify(data.invoke, data.invokeFn);\n      },\n\n      RequestSubmitted: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"RequestSubmitted\", \"(Request submitted to server)\", event, data);\n        \n        ui.showLoader(data.address);\n      },\n\n      ResponseReceived: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"ResponseReceived\", \"(Response received from server, but has not been inspected)\", event, data);\n\n        ui.hideLoader(data.address);\n        \n        if (typeof data.invoke === \"function\")\n          data.invoke(data.response); // User-defined callback function; we're all done here.\n        else\n        {\n          if (data.response.isInvalid())\n            trigger(\"AddressWasInvalid\", data);\n          else if (data.response.isValid())\n            trigger(\"AddressWasValid\", data);\n          else\n            trigger(\"AddressWasAmbiguous\", data);\n        }\n      },\n\n      RequestTimedOut: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"RequestTimedOut\", \"(Request timed out)\", event, data);\n\n        if (data.address.form)\n          delete data.address.form.processing;  // Tell the potentially duplicate event handlers that we're done.\n\n        // If this was a form submit, don't let a network failure hold them back; just accept it and move on\n        if (data.invoke)\n          data.address.accept(data, false);\n\n        ui.enableFields(data.address);\n        ui.hideLoader(data.address);\n      },\n\n      AddressWasValid: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"AddressWasValid\", \"(Response indicates input address was valid)\", event, data);\n\n        var addr = data.address;\n        var resp = data.response;\n\n        data.response.chosen = resp.raw[0];\n        addr.replaceWith(resp.raw[0], true, event);\n        addr.accept(data);\n      },\n\n      AddressWasAmbiguous: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"AddressWasAmbiguous\", \"(Response indiciates input address was ambiguous)\", event, data);\n\n        ui.showAmbiguous(data);\n      },\n\n      AddressWasInvalid: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"AddressWasInvalid\", \"(Response indicates input address was invalid)\", event, data);\n\n        ui.showInvalid(data);\n      },\n\n      OriginalInputSelected: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"OriginalInputSelected\", \"(User chose to use original input)\", event, data);\n\n        data.address.accept(data, false);\n      },\n\n      UsedSuggestedAddress: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"UsedSuggestedAddress\", \"(User chose to a suggested address)\", event, data);\n\n        data.response.chosen = data.chosenCandidate;\n        data.address.replaceWith(data.chosenCandidate, true, event);\n        data.address.accept(data);\n      },\n\n      InvalidAddressRejected: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"InvalidAddressRejected\", \"(User chose to correct an invalid address)\", event, data);\n        \n        if (data.address.form)\n          delete data.address.form.processing;  // We're done with this address and ready for the next, potentially\n\n        trigger(\"Completed\", data);\n      },\n\n      AddressAccepted: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"AddressAccepted\", \"(Address marked accepted)\", event, data);\n\n        if (!data)\n          data = {};\n\n        if (data.address && data.address.form)\n          delete data.address.form.processing;  // We're done with this address and ready for the next, potentially\n        \n        // If this was the result of a form submit, re-submit the form (whether by clicking the button or raising form submit event)\n        if (data.invoke && data.invokeFn)\n          submitForm(data.invoke, data.invokeFn);\n\n        trigger(\"Completed\", data);\n      },\n\n      Completed: function(event, data)\n      {\n        if (config.debug)\n          console.log(\"EVENT:\", \"Completed\", \"(All done)\", event, data);\n\n        if (data.address)\n        {\n          ui.enableFields(data.address);\n          if (data.address.form)\n            delete data.address.form.processing;  // We're done with this address and ready for the next, potentially\n        }\n      }\n    };\n\n\n    /*\n     *  MISCELLANEOUS\n     */\n\n    function arrayContains(array, subject)\n    {\n      // See if an array contains a particular value\n      for (var i in array)\n        if (array[i] === subject) return true;\n      return false;\n    }\n\n    function randomInt(min, max)\n    {\n      // Generate a random integer between min and max\n      return Math.floor(Math.random() * (max - min + 1)) + min;\n    }\n\n    function lowercase(string)\n    {\n      // Return an empty string if not defined, or a lowercase string with '[]' stripped.\n      return string ? string.toLowerCase().replace('[]', '') : '';\n    }\n\n    function trigger(eventType, metadata)\n    {\n      // Raise an event (in our case, a custom event)\n      $(document).triggerHandler(eventType, metadata);\n    }\n\n    function bind(eventType)\n    {\n      // Bind a custom handler to an event\n      $(document).bind(eventType, HandleEvent);\n    }\n\n    function suppress(event)\n    {\n      // Used to prevent form submits, and stop other events if needed\n      if (!event) return false;\n      if (event.preventDefault) event.preventDefault();\n      if (event.stopPropagation) event.stopPropagation();\n      if (event.stopImmediatePropagation) event.stopImmediatePropagation();\n      event.cancelBubble = true;\n      return false;\n    }\n\n  })(jQuery, window, document);\n</script>\n\n<script type=\"text/javascript\">\n  (function(d) {   \n    var e = d.createElement('script');   \n    e.src = d.location.protocol + '//bounceexchange.com/tag/1168/i.js';    \n    e.async = true;    \n    d.getElementsByTagName(\"head\")[0].appendChild(e);    \n  }(document));\n</script>\n\n<script type=\"text/javascript\">\n  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error(\"Segment snippet included twice.\");else{analytics.invoked=!0;analytics.methods=[\"trackSubmit\",\"trackClick\",\"trackLink\",\"trackForm\",\"pageview\",\"identify\",\"reset\",\"group\",\"track\",\"ready\",\"alias\",\"page\",\"once\",\"off\",\"on\"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement(\"script\");e.type=\"text/javascript\";e.async=!0;e.src=(\"https:\"===document.location.protocol?\"https://\":\"http://\")+\"cdn.segment.com/analytics.js/v1/\"+t+\"/analytics.min.js\";var n=document.getElementsByTagName(\"script\")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION=\"3.1.0\";\n    analytics.load(\"K6mYPeoKeM4QKAHyxe9CQoZhf3d8iWbe\");\n    analytics.page({\n      cohort:     window.test_wrangler.cohort,\n      experiment: window.test_wrangler.experiment,\n      variant:    window.test_wrangler.variant\n    });\n  }}();\n</script>\n\n\n<!--Start of Zopim Live Chat Script-->\n<script type=\"text/javascript\">\nwindow.$zopim||(function(d,s){var z=$zopim=function(c){z._.push(c)},$=z.s=\nd.createElement(s),e=d.getElementsByTagName(s)[0];z.set=function(o){z.set.\n_.push(o)};z._=[];z.set._=[];$.async=!0;$.setAttribute(\"charset\",\"utf-8\");\n$.src=\"//v2.zopim.com/?31hwtwabcV8aIaGpPCG4YPfC8ycOymAn\";z.t=+new Date;$.\ntype=\"text/javascript\";e.parentNode.insertBefore($,e)})(document,\"script\");\n\n$zopim( function() {\n  $zopim.livechat.hideAll();\n  $zopim.livechat.departments.filter('BarkShop');\n  $zopim.livechat.departments.setVisitorDepartment('BarkShop');\n  $zopim.livechat.setDisableSound(true);\n\n  function check(status) {\n    var dep = $zopim.livechat.departments.getDepartment('BarkShop');\n\n    if ((typeof dep === \"undefined\") || (dep.status === status)) {\n      return;\n    } else if (dep.status === 'offline') {\n      $zopim.livechat.setStatus('offline');\n      if (!$zopim.livechat.isChatting()){\n        $zopim.livechat.hideAll();\n      }\n    } else if (dep.status === 'online') {\n      $zopim.livechat.setStatus('online');\n      if ($zopim.livechat.isChatting() && $.cookie('zopimOpen') == 'true' ){\n        $zopim.livechat.window.show();\n      } else {\n        $zopim.livechat.window.hide();\n      }\n    }\n\n    $zopim.livechat.window.setPosition('br');\n\n    if ($.cookie(\"zopimOpen\") == \"true\" && window.location.pathname !== \"/checkout\") {\n      $zopim.livechat.window.show();\n    }\n  }\n\n  $zopim.livechat.window.onShow(\n    function(){\n      $.cookie('zopimOpen', 'true', { path: '/' });\n    }\n  );\n\n  $zopim.livechat.window.onHide(\n    function(){\n      $.cookie('zopimOpen', 'false', { path: '/' });\n    }\n  );\n\n  $zopim.livechat.setOnChatStart(function(){\n    if (window.current_user) {\n      $zopim.livechat.setEmail(window.current_user.email);\n    }\n  });\n\n  $zopim.livechat.setOnConnected(check);\n  $zopim.livechat.setOnStatus(check);\n});\n</script>\n<!--End of Zopim Live Chat Script-->\n\n\n\n<iframe name=\"_hjRemoteVarsFrame\" title=\"_hjRemoteVarsFrame\" id=\"_hjRemoteVarsFrame\" src=\"https://vars.hotjar.com/rcj-99d43ead6bdf30da8ed5ffcb4f17100c.html\" style=\"display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;\"></iframe><div id=\"ads\"></div><script type=\"text/javascript\" id=\"\">(function(){var a=window._fbq||(window._fbq=[]);if(!a.loaded){var b=document.createElement(\"script\");b.async=!0;b.src=\"//connect.facebook.net/en_US/fbds.js\";var c=document.getElementsByTagName(\"script\")[0];c.parentNode.insertBefore(b,c);a.loaded=!0}a.push([\"addPixelId\",\"779756138718673\"])})();window._fbq=window._fbq||[];window._fbq.push([\"track\",\"PixelInitialized\",{}]);</script>\n<noscript>&lt;img height=\"1\" width=\"1\" alt=\"\" style=\"display:none\" src=\"https://www.facebook.com/tr?id=779756138718673&amp;amp;ev=PixelInitialized\"&gt;</noscript><div style=\"display: none; visibility: hidden;\"><script>document.write('\\x3cscript src\\x3d\"//load.sumome.com/\" data-sumo-site-id\\x3d\"dfcdc34865ca91124e8f4e8a37ba8c8a3aa070e870a2fa55eed0d8739e10a047\" async\\x3d\"async\"\\x3e\\x3c/script\\x3e');</script><script src=\"//load.sumome.com/\" data-sumo-site-id=\"dfcdc34865ca91124e8f4e8a37ba8c8a3aa070e870a2fa55eed0d8739e10a047\" async=\"async\"></script></div><script type=\"text/javascript\" id=\"\">!function(b){if(!window.pintrk){window.pintrk=function(){window.pintrk.queue.push(Array.prototype.slice.call(arguments))};var a=window.pintrk;a.queue=[];a.version=\"3.0\";a=document.createElement(\"script\");a.async=!0;a.src=b;b=document.getElementsByTagName(\"script\")[0];b.parentNode.insertBefore(a,b)}}(\"https://s.pinimg.com/ct/core.js\");pintrk(\"load\",\"2621302233509\");pintrk(\"page\",{page_name:\"My Page\",page_category:\"My Page Category\"});</script>\n<noscript>\n&lt;img height=\"1\" width=\"1\" style=\"display:none;\" alt=\"\" src=\"https://ct.pinterest.com/v3/?tid=2621302233509&amp;amp;noscript=1\"&gt;\n</noscript><script type=\"text/javascript\" id=\"\">window._pp=window._pp||[];_pp.siteUId=google_tag_manager[\"GTM-MVZ86D\"].macro('gtm1');_pp.siteId=1113;_pp.email=google_tag_manager[\"GTM-MVZ86D\"].macro('gtm2');_pp.endUrl=\"\";_pp.orderValue=google_tag_manager[\"GTM-MVZ86D\"].macro('gtm3');_pp.orderId=google_tag_manager[\"GTM-MVZ86D\"].macro('gtm4');_pp.tags=\"\";(function(){var a=document.createElement(\"script\");a.type=\"text/javascript\";a.async=!0;a.src=(\"https:\"==document.location.protocol?\"https:\":\"http:\")+\"//cdn.pbbl.co/r/\"+_pp.siteId+\".js\";var b=document.getElementsByTagName(\"script\")[0];b.parentNode.insertBefore(a,b)})();</script><script type=\"text/javascript\" id=\"\">var pathnameVal=window.location.pathname,ecomm_prodid=\"\",ecomm_pagetype=\"\",ecomm_totalvalue=0;jQuery(document).on(\"click\",'.cart-count[ng-click\\x3d\"showCart()\"]',function(){var a={ecomm_prodid:\"\",ecomm_pagetype:cart,ecomm_totalvalue:0};dataLayer.push({event:\"dyn_rmkt\",google_tag_params:a})});\nif(-1!=pathnameVal.indexOf(\"/items/\")){var productId=selectedItem.sku,price=jQuery('.overlay[ng-show\\x3d\"inventoryReady\"] .price.ng-binding').text().replace(/[^0-9.]/g,\"\");\"\"==price&&(price=0);ecomm_prodid=productId;ecomm_pagetype=\"product\";ecomm_totalvalue=parseFloat(price)}else ecomm_pagetype=\"/\"==pathnameVal?\"home\":0<jQuery(\".item-list\").length?\"category\":\"other\";var google_tag_params={ecomm_prodid:ecomm_prodid,ecomm_pagetype:ecomm_pagetype,ecomm_totalvalue:parseFloat(ecomm_totalvalue)};\ndataLayer.push({event:\"dyn_rmkt\",google_tag_params:google_tag_params});</script><iframe id=\"sumome-jquery-iframe\" style=\"display: none;\"></iframe></body>"}
