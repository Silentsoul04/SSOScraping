{"link":"http://operaciones.outsourcing.com.co:8013/webchatlogin.php","html":"<head><script type=\"text/javascript\">\n\n//\tGlobally used functions\n\nfunction sound(surl)\n{\n\tdocument.getElementById(\"NewMessageBeepHolder\").innerHTML = \"<embed src=\\\"\"+surl+\"\\\" hidden=\\\"true\\\" autostart=\\\"true\\\" loop=\\\"false\\\" />\";\n}\n\n//\tResize pop-up according to browser used, and by possible extending length\nfunction resizeWindow(ffPixelWidth, crPixelWidth, iePixelWidth, ffPixelLength, crPixelLength, iePixelLength, extendLength)\n{\n\tif (/Firefox[\\/\\s](\\d+\\.\\d+)/.test(navigator.userAgent))\n\t\twindow.resizeTo(ffPixelWidth, ffPixelLength + extendLength);\t//\tFirefox\n\telse if(navigator.userAgent.indexOf(\"Chrome\") != -1)\n\t\twindow.resizeTo(crPixelWidth, crPixelLength + extendLength);\t//\tChrome\n\telse if(navigator.appName == \"Microsoft Internet Explorer\")\n\t{\n\t\textendLength -= extendLength/14;\n\t\twindow.resizeTo(iePixelWidth, iePixelLength + extendLength);\t//\tIE\n\t}\n\telse \n\t\twindow.resizeTo(iePixelWidth, iePixelLength + extendLength);\t//\tResize others as of IE\n}\n\n//\tCheck for valid email address\nfunction isValidEmailAddress(str)\n{  \n\tvar at=\"@\";\n\tvar dot=\".\";\n\tvar lat=str.indexOf(at);\n\tvar lstr=str.length;\n\tvar ldot=str.indexOf(dot);\n\n\tif (str.indexOf(at)==-1)\n\t{\n\t\treturn false;\n\t}\n\n\tif (str.indexOf(at)==-1 || str.indexOf(at)==0 || str.indexOf(at)==lstr)\n\t{\n\t\treturn false;\n\t}\n\n\tif (str.indexOf(dot)==-1 || str.indexOf(dot)==0 || str.indexOf(dot)==(lstr-1))\n\t{\n\t\treturn false;\n\t}\n\n\tif (str.indexOf(at,(lat+1))!=-1)\n\t{\n\t\treturn false;\n\t} \n\n\tif (str.substring(lat-1,lat)==dot || str.substring(lat+1,lat+2)==dot)\n\t{\n\t\treturn false;\n\t}\n\n\tif (str.indexOf(dot,(lat+2))==-1)\n\t{\n\t\treturn false;\n\t}\n\n\tif (str.indexOf(\" \")!=-1)\n\t{\n\t\treturn false;\n\t}\n\n\treturn true;\t\t\t\n}\n\n//\tCheck for valid phone number\nfunction isValidPhoneNumber(str)\n{\n\t\tvar validCharacters = \"0123456789\";\n\n\t\tfor (i = 0; i < str.length; i++) \n\t\t{ \n\t\t\tif (validCharacters.indexOf(str.charAt(i)) == -1) \n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n}\n\n</script>\n\n\n\n\n\t\n\t\t<meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\">\n\t\t<title>Avaya Web Chat</title>\n\t\t<link rel=\"stylesheet\" type=\"text/css\" href=\"css/style.css\">\n\t\t<link rel=\"stylesheet\" type=\"text/css\" href=\"css/calendar.css\">\n\t\t<link rel=\"stylesheet\" type=\"text/css\" href=\"css/time.css\">\n\t</head>\n\n\t<!--\tThe 'onbeforeunload' event, though not in HTML standard, is used here because the standard 'onunload' event does not fire reliably in Chrome or Firefox\t-->\n\t<body onload=\"Javascript:onLoginLoadDo()\" style=\"margin:0px;\" onbeforeunload=\"closeAgentWin()\">\n\n<span id=\"NewMessageBeepHolder\" width=\"1\" height=\"1\"></span> \n<script src=\"library/jquery-1.2.2.pack.js\"></script>\n<script type=\"text/javascript\">\n\t\t\t\t\t\t\t\n\t\tvar jqSajax = {\n\t\tdebug_mode : false,request_type : \"POST\",\n\t\ttarget_id : '',failure_redirect : \"\",\n\t\tfriendly_url : false,requests: new Array(),data_return:\"\",\n\n\t\tdebug:function(text) {if (this.debug_mode)alert(text);},\t\n\t\tcancel: function() {for (var i = 0; i < this.requests.length; i++)this.requests[i].abort();},\n\t\t\n\t\tserialize:function(inp){\n\t\t\tvar getType=function(inp){var type=typeof inp,match;if(type=='object'&&!inp){return'null'}if(type==\"object\"){if(!inp.constructor){return'object'}var cons=inp.constructor.toString();if(match=cons.match(/(\\w+)\\(/)){cons=match[1].toLowerCase()}var types=[\"boolean\",\"number\",\"string\",\"array\"];for(key in types){if(cons==types[key]){type=types[key];break}}}return type};var type=getType(inp);var val;switch(type){case\"undefined\":val=\"N\";break;case\"boolean\":val=\"b:\"+(inp?\"1\":\"0\");break;case\"number\":val=(Math.round(inp)==inp?\"i\":\"d\")+\":\"+inp;break;case\"string\":val=\"s:\"+inp.length+\":\\\"\"+inp+\"\\\"\";break;case\"array\":val=\"a\";case\"object\":if(type==\"object\"){var objname=inp.constructor.toString().match(/(\\w+)\\(\\)/);if(objname==undefined){return}objname[1]=this.serialize(objname[1]);val=\"O\"+objname[1].substring(1,objname[1].length-1)}var count=0;var vals=\"\";var okey;for(key in inp){okey=(key.match(/^[0-9]+$/)?parseInt(key):key);vals+=this.serialize(okey)+this.serialize(inp[key]);count++}val+=\":\"+count+\":{\"+vals+\"}\";break}if(type!=\"object\"&&type!=\"array\")val+=\";\";return val;\n\t\t},\n\t\tunserialize:function(inp){\n\t\t\terror=0;if(inp==\"\"||inp.length<2){errormsg=\"\";return}var val,kret,vret,cval;var type=inp.charAt(0);var cont=inp.substring(2);var size=0,divpos=0,endcont=0,rest=\"\",next=\"\";switch(type){case\"N\":if(inp.charAt(1)!=\";\"){errormsg=\"\"}rest=cont;break;case\"b\":if(!/[01];/.test(cont.substring(0,2))){errormsg=\"\"}val=(cont.charAt(0)==\"1\");rest=cont.substring(2);break;case\"s\":val=\"\";divpos=cont.indexOf(\":\");if(divpos==-1){errormsg=\"\";break}size=parseInt(cont.substring(0,divpos));if(size==0){if(cont.length-divpos<4){errormsg=\"\";break}rest=cont.substring(divpos+4);break}if((cont.length-divpos-size)<4){errormsg=\"\";break}if(cont.substring(divpos+2+size,divpos+4+size)!=\"\\\";\"){errormsg=\"\"}val=cont.substring(divpos+2,divpos+2+size);rest=cont.substring(divpos+4+size);break;case\"i\":case\"d\":var dotfound=0;for(var i=0;i<cont.length;i++){cval=cont.charAt(i);if(isNaN(parseInt(cval))&&!(type==\"d\"&&cval==\".\"&&!dotfound++)){endcont=i;break}}if(!endcont||cont.charAt(endcont)!=\";\"){errormsg=\"\"}val=cont.substring(0,endcont);val=(type==\"i\"?parseInt(val):parseFloat(val));rest=cont.substring(endcont+1);break;case\"a\":if(cont.length<4){errormsg=\"\";return}divpos=cont.indexOf(\":\",1);if(divpos==-1){errormsg=\"\";return}size=parseInt(cont.substring(1*divpos,0));cont=cont.substring(divpos+2);val=new Array();if(cont.length<1){errormsg=\"\";return}for(var i=0;i+1<size*2;i+=2){kret=this.unserialize(cont,1);if(error||kret[0]==undefined||kret[1]==\"\"){errormsg=\"\";return}vret=this.unserialize(kret[1],1);if(error){errormsg=\"\";return}val[kret[0]]=vret[0];cont=vret[1]}if(cont.charAt(0)!=\"}\"){errormsg=\"\";return}rest=cont.substring(1);break;case\"O\":divpos=cont.indexOf(\":\");if(divpos==-1){errormsg=\"\";return}size=parseInt(cont.substring(0,divpos));var objname=cont.substring(divpos+2,divpos+2+size);if(cont.substring(divpos+2+size,divpos+4+size)!=\"\\\":\"){errormsg=\"\";return}var objprops=this.unserialize(\"a:\"+cont.substring(divpos+4+size),1);if(error){errormsg=\"\";return}rest=objprops[1];var objout=\"function \"+objname+\"(){\";for(key in objprops[0]){objout+=\"this['\"+key+\"']=objprops[0]['\"+key+\"'];\"}objout+=\"}val=new \"+objname+\"();\";eval(objout);break;default:errormsg=\"\"}return(arguments.length==1?val:[val,rest]);\n\t\t},\n\t\tfhasilc:function(text){this.debug(\"the data return is: \" + text);var txt = text.replace(/^\\s*|\\s*$/g,\"\");\n\t\t\tif(txt.substring(2,5)=='var')return this.unserialize(eval(txt.substring(2)));\n\t\t},\n\t\tfhasil:function(text){\n\t\t\tjqSajax.debug(\"PHP method/function Result is: \\n\"+text);\n\t\t\tjqSajax.data_return=eval(text);\t\t},\n\t\t\t\tx_SendMessage:function(){this.do_call(\"SendMessage\",this.x_SendMessage.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_SendMessage:function(){this.do_call(\"SendMessage\",this.x_page_SendMessage.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_GetHistory:function(){this.do_call(\"GetHistory\",this.x_GetHistory.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_GetHistory:function(){this.do_call(\"GetHistory\",this.x_page_GetHistory.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_UpdateAliveTime:function(){this.do_call(\"UpdateAliveTime\",this.x_UpdateAliveTime.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_UpdateAliveTime:function(){this.do_call(\"UpdateAliveTime\",this.x_page_UpdateAliveTime.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_GetAnonymousSessionKey:function(){this.do_call(\"GetAnonymousSessionKey\",this.x_GetAnonymousSessionKey.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_GetAnonymousSessionKey:function(){this.do_call(\"GetAnonymousSessionKey\",this.x_page_GetAnonymousSessionKey.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_GetAnonymousCustomerID:function(){this.do_call(\"GetAnonymousCustomerID\",this.x_GetAnonymousCustomerID.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_GetAnonymousCustomerID:function(){this.do_call(\"GetAnonymousCustomerID\",this.x_page_GetAnonymousCustomerID.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_GetAndUpdateAnonymousCustomerID:function(){this.do_call(\"GetAndUpdateAnonymousCustomerID\",this.x_GetAndUpdateAnonymousCustomerID.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_GetAndUpdateAnonymousCustomerID:function(){this.do_call(\"GetAndUpdateAnonymousCustomerID\",this.x_page_GetAndUpdateAnonymousCustomerID.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_SetupTextChat:function(){this.do_call(\"SetupTextChat\",this.x_SetupTextChat.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_SetupTextChat:function(){this.do_call(\"SetupTextChat\",this.x_page_SetupTextChat.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_CloseTextChat:function(){this.do_call(\"CloseTextChat\",this.x_CloseTextChat.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_CloseTextChat:function(){this.do_call(\"CloseTextChat\",this.x_page_CloseTextChat.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_RequestCallBackNow:function(){this.do_call(\"RequestCallBackNow\",this.x_RequestCallBackNow.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_RequestCallBackNow:function(){this.do_call(\"RequestCallBackNow\",this.x_page_RequestCallBackNow.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_RequestCallBackLater:function(){this.do_call(\"RequestCallBackLater\",this.x_RequestCallBackLater.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_RequestCallBackLater:function(){this.do_call(\"RequestCallBackLater\",this.x_page_RequestCallBackLater.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_RequestCallBackNowCustomerCheck:function(){this.do_call(\"RequestCallBackNowCustomerCheck\",this.x_RequestCallBackNowCustomerCheck.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_RequestCallBackNowCustomerCheck:function(){this.do_call(\"RequestCallBackNowCustomerCheck\",this.x_page_RequestCallBackNowCustomerCheck.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_RequestCallBackLaterCustomerCheck:function(){this.do_call(\"RequestCallBackLaterCustomerCheck\",this.x_RequestCallBackLaterCustomerCheck.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_RequestCallBackLaterCustomerCheck:function(){this.do_call(\"RequestCallBackLaterCustomerCheck\",this.x_page_RequestCallBackLaterCustomerCheck.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_RemoveContactFromQueue:function(){this.do_call(\"RemoveContactFromQueue\",this.x_RemoveContactFromQueue.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_RemoveContactFromQueue:function(){this.do_call(\"RemoveContactFromQueue\",this.x_page_RemoveContactFromQueue.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_IsSkillsetInUse:function(){this.do_call(\"IsSkillsetInUse\",this.x_IsSkillsetInUse.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_IsSkillsetInUse:function(){this.do_call(\"IsSkillsetInUse\",this.x_page_IsSkillsetInUse.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_GetCustomerIDByEmail:function(){this.do_call(\"GetCustomerIDByEmail\",this.x_GetCustomerIDByEmail.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_GetCustomerIDByEmail:function(){this.do_call(\"GetCustomerIDByEmail\",this.x_page_GetCustomerIDByEmail.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_RegisterNewCustomer:function(){this.do_call(\"RegisterNewCustomer\",this.x_RegisterNewCustomer.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_RegisterNewCustomer:function(){this.do_call(\"RegisterNewCustomer\",this.x_page_RegisterNewCustomer.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_LoginNewCustomer:function(){this.do_call(\"LoginNewCustomer\",this.x_LoginNewCustomer.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_LoginNewCustomer:function(){this.do_call(\"LoginNewCustomer\",this.x_page_LoginNewCustomer.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_GetCustomerByPhoneNumber:function(){this.do_call(\"GetCustomerByPhoneNumber\",this.x_GetCustomerByPhoneNumber.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_GetCustomerByPhoneNumber:function(){this.do_call(\"GetCustomerByPhoneNumber\",this.x_page_GetCustomerByPhoneNumber.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_AddPhoneNumber:function(){this.do_call(\"AddPhoneNumber\",this.x_AddPhoneNumber.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_AddPhoneNumber:function(){this.do_call(\"AddPhoneNumber\",this.x_page_AddPhoneNumber.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_AddEmailAddress:function(){this.do_call(\"AddEmailAddress\",this.x_AddEmailAddress.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_AddEmailAddress:function(){this.do_call(\"AddEmailAddress\",this.x_page_AddEmailAddress.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_GetCustomerUserNameByID:function(){this.do_call(\"GetCustomerUserNameByID\",this.x_GetCustomerUserNameByID.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_GetCustomerUserNameByID:function(){this.do_call(\"GetCustomerUserNameByID\",this.x_page_GetCustomerUserNameByID.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_UpdateEmailAddress:function(){this.do_call(\"UpdateEmailAddress\",this.x_UpdateEmailAddress.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_UpdateEmailAddress:function(){this.do_call(\"UpdateEmailAddress\",this.x_page_UpdateEmailAddress.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_RequestChatHistory:function(){this.do_call(\"RequestChatHistory\",this.x_RequestChatHistory.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_RequestChatHistory:function(){this.do_call(\"RequestChatHistory\",this.x_page_RequestChatHistory.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_ReadSkillsetByName:function(){this.do_call(\"ReadSkillsetByName\",this.x_ReadSkillsetByName.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_ReadSkillsetByName:function(){this.do_call(\"ReadSkillsetByName\",this.x_page_ReadSkillsetByName.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_GetOnHoldComfortMessages:function(){this.do_call(\"GetOnHoldComfortMessages\",this.x_GetOnHoldComfortMessages.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_GetOnHoldComfortMessages:function(){this.do_call(\"GetOnHoldComfortMessages\",this.x_page_GetOnHoldComfortMessages.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_GetWebOnHoldURLs:function(){this.do_call(\"GetWebOnHoldURLs\",this.x_GetWebOnHoldURLs.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_GetWebOnHoldURLs:function(){this.do_call(\"GetWebOnHoldURLs\",this.x_page_GetWebOnHoldURLs.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\tx_SendEmail:function(){this.do_call(\"SendEmail\",this.x_SendEmail.arguments,\"\");return jqSajax.data_return},\n\t\t\t\tx_page_SendEmail:function(){this.do_call(\"SendEmail\",this.x_page_SendEmail.arguments,\"page\");return jqSajax.data_return},\n\t\t\t\n\t\tdo_call:function(func_name, args, obj) {\n\t\t\tvar i,post_data,target_id,uri;\t\n\t\t\tthis.debug(\"in jqSajax.do_call()...\\nRequest Type: \" + this.request_type + \"\\nTarget Id: \" + this.target_id);\n\t\t\ttarget_id = this.target_id;\n\t\t\tif (typeof(this.request_type) == \"undefined\" || this.request_type == \"\")this.request_type = \"GET\";\n\t\t\turi = \"/webchatlogin.php\";\n\t\t\tif (this.request_type == \"GET\") {\n\t\t\t\tif (uri.indexOf(\"?\") == -1 && this.friendly_url==false)uri += \"?rs=\" + escape(func_name);\n\t\t\t\telse uri += \"&rs=\" + escape(func_name);\n\t\t\t\turi += \"&rst=\" + escape(target_id);\n\t\t\t\turi += \"&rsrnd=\" + new Date().getTime();\n\t\t\t\turi += \"&rsobj=\" + obj;\n\t\t\t\tfor (i = 0; i < args.length; i++)uri += \"&rsargs[]=\" + escape(args[i]);\n\t\t\t\tpost_data = null;\n\t\t\t}\n\t\t\telse if (this.request_type == \"POST\") {\n\t\t\t\tpost_data = \"rs=\" + escape(func_name);\n\t\t\t\tpost_data += \"&rst=\" + escape(this.target_id);\n\t\t\t\tpost_data += \"&rsrnd=\" + new Date().getTime();\n\t\t\t\tpost_data += \"&rsobj=\" + obj;\n\t\t\t\tfor (i = 0; i < args.length; i++)post_data = post_data + \"&rsargs[]=\" + escape(args[i]);\t\t\t\t\n\t\t\t}\n\t\t\telse this.debug(\"Illegal request type: \" + this.request_type);\n\t\t\t\n\t\t\tthis.debug(\"Do requested page with JQUERY ajax...\");\n\t\t\tthis.debug(\"URI: \"+uri);\n\t\t\tthis.debug(\"Post Data: \"+post_data);\n\t\t\t$.ajax({\n\t\t\t\tasync:false,\n\t\t\t\ttype: this.request_type,\n\t\t\t\turl\t: uri,\n\t\t\t\tdata: post_data,\n\t\t\t\tdataType:\"json\",\n\t\t\t\tsuccess:this.fhasil\n\t\t\t});\t\t\t\n\t\t}\t\n\t\t};\n\n\t\t</script><!-- \n\n  Avaya Aura Contact Center Multimedia \n  Copyright � 2010 - 2012 Avaya Inc. All Rights Reserved \n\n-->\n\n<table id=\"winDisplayAgent\" class=\"popover_window_chat\" style=\"display:none;\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n\t<tbody><tr>\n\t\t<td>        \n\t\t\t<table id=\"\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" class=\"top_gradient\">  \n\t\t\t\t<tbody><tr height=\"70\">\n\t\t\t\t\t<td width=\"81\" style=\"padding-top:25px;padding-left:50px;\" align=\"right\" valign=\"top\"><img src=\"img/smallLogo.png\" style=\"border-radius :50px;\"></td>\n\t\t\t\t\t<td width=\"349\" style=\"padding-top:25px;padding-left:15px;\" align=\"left\" valign=\"top\"><img src=\"img/chat.png\"></td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"2\" valign=\"top\" style=\"padding-left:50px;padding-right:50px;\">\n\n\t\t\t\t\t\t<!-- No Agents Available-->\n\n\t\t\t\t\t\t<table id=\"webchat_no_agents\" class=\"input_fields\" style=\"display:none;\" valign=\"top\" width=\"100%\" border=\"0\">\n\t\t\t\t\t\t\t<tbody><tr>\n\t\t\t\t\t\t\t\t<td align=\"center\" style=\"padding-bottom:20px;\" class=\"red_font\">No hay agentes disponibles para responder en este momento.</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</tbody></table>\n\n\t\t\t\t\t\t<!-- End No Agents Available-->\n\n\t\t\t\t\t\t<!-- Max Concurrent Chats Per Customer -->\n\n\t\t\t\t\t\t<table id=\"webchat_max_concurrent_per_customer\" class=\"input_fields\" style=\"display:none;\" valign=\"top\" width=\"100%\" border=\"0\">\n\t\t\t\t\t\t\t<tbody><tr>\n\t\t\t\t\t\t\t\t<td align=\"center\" style=\"padding-bottom:20px;\" class=\"red_font\">You have reached a maximum of concurrent chat sessions.</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</tbody></table>\n\n\t\t\t\t\t\t<!-- End Max Concurrent Chats Per Customer -->\n\n\t\t\t\t\t\t<!-- Max Concurrent Chats Per Skillset -->\n\n\t\t\t\t\t\t<table id=\"webchat_max_concurrent_per_skillset\" class=\"input_fields\" style=\"display:none;\" valign=\"top\" width=\"100%\" border=\"0\">\n\t\t\t\t\t\t\t<tbody><tr>\n\t\t\t\t\t\t\t\t<td align=\"center\" style=\"padding-bottom:20px;\" class=\"red_font\">There are currently no agents available to answer your chat.</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</tbody></table>\n\n\t\t\t\t\t\t<!-- End Max Concurrent Chats Per Skillset -->\n\n\t\t\t\t\t\t<!-- WebChat Area -->\n\n\t\t\t\t\t\t<table id=\"webchat_chat_area\" style=\"display:none;\" valign=\"top\" border=\"0\" width=\"100%\">\n\t\t\t\t\t\t\t<tbody><tr>\n\t\t\t\t\t\t\t\t<td>\n\n\t\t\t\t\t\t\t\t\t<!-- History Table -->\n\n\t\t\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t\t\t<tbody><tr>\n\t\t\t\t\t\t\t\t\t\t\t<td colspan=\"2\" align=\"center\" valign=\"top\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div align=\"left\" id=\"history\" name=\"history\" class=\"webchat_history\"></div>\n\t\t\t\t\t\t\t\t\t\t\t</td> \n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</tbody></table>\n\n\t\t\t\t\t\t\t\t\t<!-- End History Table -->\n\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr> \n\n\t\t\t\t\t\t\t<!-- Call Me Section -->\n\n\t\t\t\t\t\t\t<tr height=\"40\">\n\t\t\t\t\t\t\t\t<td align=\"right\" class=\"call_me\">\n\t\t\t\t\t\t\t\t\t                                    <table align=\"right\">\n                                    \t<tbody><tr align=\"right\">\n                                        \t<td align=\"right\" style=\"font-family:Cambria, 'Hoefler Text', 'Liberation Serif', Times, 'Times New Roman', serif; font-size:10px;\">Salir del Chat</td>\n                                            <td align=\"right\"><input type=\"image\" align=\"right\" src=\"img/close.png\" height=\"20\" width=\"20\" border=\"0\" title=\"Conclude and close chat window.\" id=\"closeButton\" onclick=\"transferEncuesta();\">\n\t\t\t\t\t\t\t\t\t</td>\n                                        </tr>\n                                    </tbody></table>\n\t\t\t\t\t\t\t\t\t\n                                </td>\n\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t<!-- End Call Me Section -->\n\n\t\t\t\t\t\t\t<!-- WebChat Text Area -->\n\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<table class=\"text_area_division\">\n\t\t\t\t\t\t\t\t\t\t<tbody><tr>\n\t\t\t\t\t\t\t\t\t\t\t<td>\n\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- Input table -->\n\n\t\t\t\t\t\t\t\t\t\t\t\t<table border=\"0\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tbody><tr height=\"100%\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td style=\"padding-top:15px;padding-bottom:15px;padding-left:15px;padding-right:5px;\" align=\"left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<textarea class=\"webchat_text_field\" name=\"comments\" id=\"comments\" onkeypress=\"return checkEnter(this,event)\" onclick=\"RemovePlaceHolder()\" ;=\"\"></textarea></td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td style=\"padding-right:5px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"submit\" id=\"enterButton\" class=\"wc_submit\" value=\"Enviar Mensaje\" disabled=\"\" onclick=\"processText();\"></td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t</tbody></table>\n\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- End Input table -->\n\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</tbody></table>\t\t \n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>  \n\n\t\t\t\t\t\t\t<!-- End WebChat Text Area -->\n\n\t\t\t\t\t\t</tbody></table>\t\t  \n\n\t\t\t\t\t\t<!-- End WebChat Area -->\n\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<!-- Agent Typing -->\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"2\" style=\"padding-left:50px;padding-right:50px;\" class=\"call_me\" id=\"AgentStatus\" name=\"AgentStatus\" height=\"18\" width=\"100%\"></td>\n\t\t\t\t</tr>\n\t\t\t\n\t\t\t\t<!-- End Agent Typing -->\n\n\t\t\t\t<!-- Footer -->\n\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"2\" class=\"bottom_gradient\" height=\"50\" width=\"100%\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span id=\"status\" class=\"webchat_connection_status\"><b><font class=\"status_color\">Estado: </font>No Conectado</b></span>\n\t\t\t\t\t\t\t<span class=\"powered_by\">Producido Por Outsourcing S.A.</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\n\t\t\t\t<!-- End Footer --> \n\n\t\t\t</tbody></table>\n\n\t\t</td>\n\t\t<td width=\"100%\" id=\"webchat_advertisement\" style=\"display:none;\">\n\n\t\t\t<!-- Advertisement Area -->\n\n\t\t\t<table cellspacing=\"0\" cellpadding=\"0\" border=\"0\" width=\"100%\" height=\"100%\" class=\"top_gradient\">  \n\t\t\t\t<tbody><tr height=\"70\">\n\t\t\t\t\t<td></td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td valign=\"top\" style=\"padding-left:20px;padding-right:20px;\">\n\t\t\t\t\t\t<table id=\"\" valign=\"top\" class=\"input_fields\" height=\"100%\" width=\"100%\" border=\"0\">\n\t\t\t\t\t\t\t<tbody><tr>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<iframe src=\"\" id=\"web_on_hold_url\" name=\"web_on_hold_url\" width=\"560\" height=\"320\" frameborder=\"0\"></iframe>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</tbody></table>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td colspan=\"2\" class=\"bottom_gradient\" height=\"50\" width=\"100%\"></td>\t\t\n\t\t\t\t</tr>\n\t\t\t</tbody></table>\n\n\t\t\t<!-- End Advertisement Area -->\n\n\t\t</td>\n\t</tr>\n</tbody></table>\n\n<script type=\"text/javascript\"> \n\nvar txt;\nvar thisHistory;\nvar temp;\nvar LastReadTime = 0;\nvar AgentAccepted = false ;\nvar subSection;\nvar CustomTextLine = \"[Customer] \";\nvar heartbeatTime = 0;\nvar session_key = \"\";\nvar contact_id = 0\nvar username = \"\";\nvar window_height;\nvar StopListening = false;\nvar EmailAddress = \"\";\nvar customerID;\nvar chatSubject;\nvar customField_1_name;\nvar customField_1_value;\nvar chatQuery;\nvar UserTyping = false;\nvar CustomerQuestionHandler_DoOnce = true;\nvar UseBeep = true;\nvar WebOnHoldTagGroup = \"\";\nvar WebOnHoldList = [];\nvar WebOnHoldDuration = \"\";\nvar WebOnHoldCurrentLink = 0;\nvar WebOnHoldTimerCounter = 999;\nvar NS4 = (document.layers) ? true : false;\nvar isPagePushed = false;\nvar nombreCompletoVar = \"\";\nvar habeasdata =\"\";\n//var habeas = \"\";\n\n\nfunction closeChatWin()\n{\nwindow.close();\t\n} \n\nfunction transferEncuesta()\n{\t\t\n\n\twindow.location = \"/pop-ups/webchat_offer/encuestaEasy.php?comodin1=\"+nombreCompletoVar+\"&comodin2=\"+EmailAddress+\"&comodin3=\"+chatSubject+\"&comodin4=\"+customField_1_name+\"&comodin5=\"+\n\tcustomField_1_value+\"&comodin6=\"+contact_id+\"&comodin7=\"+session_key+\"&comodin8=\"+customerID+\"&comodin9=\"+CustomTextLine+\"&comodin10=\"+username+\"&comodin11=\"+habeasdata;\t\n}\n\nfunction CallMeNow()\n{\n\t//\tEnsure chat is connected\n\tvar str = document.getElementById('status').innerHTML;\n\n\tif(str.match(\"Conectado\"))\n\t{\n\t\tvar temp = document.getElementById('comments').value;\n\t\tdocument.getElementById('comments').value = \"The Customer wishes you to call them on \" + document.getElementById('CallMeNumber').value + \".\";\n\t\tprocessText();\n\t\tdocument.getElementById('comments').value = temp;\n\t}\n}\n\nfunction RemovePlaceHolder()\n{\n\tvar str = document.getElementById('comments').value;\n\n\tif(str.match(\"Por Favor Ingrese su Comentario Aqui...\"))\n\t{\n\t\tdocument.getElementById('comments').value = \"\";\n\t}\n}\n\nfunction MuteBeep()\n{\n\tif(UseBeep == true)\n\t{\n\t\tdocument.getElementById('speakerIcon').src = \"img/speaker_off.gif\";\n\t\tdocument.getElementById('speakerIcon').title = \"Unmute.\";\n\t\tUseBeep = false;\n\t}\n\telse\n\t{\n\t\tdocument.getElementById('speakerIcon').src = \"img/speaker_on.gif\";\n\t\tdocument.getElementById('speakerIcon').title = \"Silecion.\";\n\t\tUseBeep = true;\n\t}\n}\n\nfunction checkEnter(Object, event)\n{ \t\n\tUserTyping = true;\n\tvar str = document.getElementById('status').innerHTML;\n\t\n\tif(!str.match(\"No Conectado\"))\n\t{\n\t\t//\tIf the enter key was pressed, send the message\n\t\tvar code = 0;\n\n\t\tif (NS4)\n\t\t{\n\t\t\tcode = event.which;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcode = event.keyCode;\n\t\t}\n\t\t\n\t\tif(code==13)\n\t\t{\n\t\t\tsetTimeout('processText()', 250);\n\t\t}\n\n\t\treturn (Object.value.length <= 1000);\n\t}\n}\n\n\nfunction closeAgentWin() \n{ \n\tdocument.getElementById('winDisplayAgent').style.display = \"none\";\n\n\tif(AgentAccepted == false)\n\t{ \n\t\t//\tRemove the contact from the queue\n\t\tvar temp = jqSajax.x_RemoveContactFromQueue(session_key, contact_id, \"User Ended Chat Before Agent Accepted Call\", \"\");\n\t}\n\telse\n\t{\n\t\tif(EmailAddress != \"\")\n\t\t{\n\t\t\tif(isValidEmailAddress(EmailAddress))\n\t\t\t{\n\t\t\t\t//\tAuto email chat history to customer\n\t\t\t\tjqSajax.x_RequestChatHistory(contact_id,EmailAddress,session_key,\"\");\n\t\t\t}\n\t\t}\n\t}\n\t\n\tif(contact_id > 0)\n\t{\n\t\tjqSajax.x_SendMessage(session_key, contact_id, CustomTextLine + \"Session Disconnected\", \"\", \"Session_Disconnected_by_Customer\", \"\");\n\t\tvar CustomerRealUserName = jqSajax.x_GetCustomerUserNameByID(session_key, customerID, \"\");\n\t\tjqSajax.x_CloseTextChat(CustomerRealUserName, contact_id, session_key, \"\");\n\t}\n\n\tStopListening = true;\n}\n\nfunction showAgentWin(Selected_Username, skillsetID, this_customer_id, this_session_key, this_email_address, this_phone_number, this_WebCommsSubject, this_CustomField_1_Name, this_CustomField_1_Value, this_WebCommsQuery, this_WebOnHoldTag,habeas) \n{\n\t\n\tEmailAddress = this_email_address;\n\tcustomerID = this_customer_id;\n\tchatSubject = this_WebCommsSubject;\n\tcustomField_1_name = this_CustomField_1_Name;\n\tcustomField_1_value = this_CustomField_1_Value;\n\tchatQuery = this_WebCommsQuery;\n\tWebOnHoldTagGroup = this_WebOnHoldTag;\n\tnombreCompletoVar = Selected_Username;\n\thabeasdata =habeas;\n\t\n\tif(document.getElementById('CallMeNumber') != null)\n\t{\n\t\tdocument.getElementById('CallMeNumber').value = this_phone_number;\n\t}\n\n\tif(Selected_Username != \"\")\n\t{\n\t\t//\tUpdate name tag with user typed selected username if entered\n\t\tCustomTextLine = \"[\"+Selected_Username+\"] \";\n\t}\n\n\t//\tUse existing session key if supplied\n\tsession_key = this_session_key;\n\n\t//\tCheck if we have a valid web on hold tag then get string.\n\tif(WebOnHoldTagGroup != \"\")\n\t{\n\t\tvar result = jqSajax.x_GetWebOnHoldURLs(session_key, WebOnHoldTagGroup, \"\");\n\t\tvar temp = result.URL.replace(/\\\"/gi, \"\");\n\t\tWebOnHoldList = temp.split(\" \");\n\t\tWebOnHoldDuration = result.Duration;\n\t}\n\telse\n\t{\n\t\t//\tUse default\n\t\tWebOnHoldList.push(\"adverts/advert_1.html\");\n\t\tWebOnHoldList.push(\"adverts/advert_2.html\");\n\t\tWebOnHoldList.push(\"adverts/advert_3.html\");\n\t\tWebOnHoldList.push(\"adverts/advert_4.html\");\n\t\tWebOnHoldList.push(\"adverts/advert_5.html\");\n\t\tWebOnHoldList.push(\"adverts/advert_6.html\");\n\t\tWebOnHoldDuration = \"5\";\n\t}\n\n\t//\tPut the application to sleep for 1 second so the loading screen can be read.\n\tsetTimeout(\"showAgentContinued(\"+skillsetID+\")\",1000);\n}\n\nfunction postErrorAndClose(errorCondition)\n{\n\t//\tEstablishing a text chat session has failed: display appropriate window format and message\n\tdocument.getElementById('webchatLogin').style.display = \"none\";\t\n\tdocument.getElementById('winDisplayAgent').style.display = \"\";\n\tdocument.getElementById(errorCondition).style.display = \"\";\n\tdocument.getElementById('webchat_advertisement').style.display = \"none\";\t\n\tdocument.getElementById('webchat_chat_area').style.display = \"none\";\t\n\n\t//\tResize window for confirmation message, and according to browser used\n\tresizeWindow(438, 438, 438, 241, 235, 206, 0);\n\n\t//\tClose chat window after delay\n\tsetTimeout(\"closeChatWin()\", 3000);\n}\n\nfunction showAgentContinued(skillsetID)\n{\n\t//\tEmpty all fields & disable until connected\n\tdocument.getElementById('comments').value = \"\";\n\n\t//\tDisplay enter question here prompt\n\tdocument.getElementById('comments').value = \"Por Favor Ingrese su Comentario Aqui...\";\n\tdocument.getElementById('comments').disabled = false;\n\n\tif(document.getElementById('CallMeNumber') != null)\n\t{\n\t\tdocument.getElementById('CallMeNumber').disabled = true;\n\t}\n\n\t//\tRequest text chat\n\tif(customerID != \"-1\")\n\t{\n\t\tcontact_id = jqSajax.x_SetupTextChat(session_key, customerID, skillsetID, chatSubject, chatQuery, customField_1_name, customField_1_value, \"\");\n\t}\n\n\tif(contact_id != \"-1\")\n\t{\n\t\t//\tCheck if a text chat session has failed due to max concurrent sessions\n\t\tif(contact_id == \"-2\")\n\t\t{\n\t\t\t//\tEstablishing a text chat session has failed: display message and close\n\t\t\tpostErrorAndClose('webchat_max_concurrent_per_customer');\n\t\t} \n\t\telse if(contact_id == \"-3\")\n\t\t{\n\t\t\t//\tEstablishing a text chat session has failed: display message and close\n\t\t\tpostErrorAndClose('webchat_max_concurrent_per_skillset');\n\t\t} \n\t\telse\n\t\t{\n\t\t\t//\tWe have connected to the server and processed a contact correctly\n\t\t\t//\tNow start polling for connected event\t\n\t\t\t//\tAnd hide login page / please wait page\n\t\t\tdocument.getElementById('webchatLogin').style.display = \"none\";\t\n\t\t\t//\tShow chat window\n\t\t\tdocument.getElementById('winDisplayAgent').style.display = \"\";\n\t\t\tdocument.getElementById('webchat_chat_area').style.display = \"\";\n\t\t\tdocument.getElementById('webchat_advertisement').style.display = \"\";\t\n\n\t\t\t//\tResize for adverts\n\t\t\tif(document.title == \"Avaya Web Chat\")\n\t\t\t{\n\t\t\t\tresizeWindow(1045, 1045, 1045, 510, 503, 473, 0);\n\t\t\t}\n\n\t\t\tRefresh();\n\t\t}\n\t}\n\telse\n\t{\n\t\t//\tSkillset not in use: display message and close\n\t\tpostErrorAndClose('webchat_no_agents');\n\t}\n}\n\nfunction processText()\n{\n\t//\tEnsure chat is connected\n\tvar str = document.getElementById('status').innerHTML;\n\n\tif(str.match(\"Conectado\"))\n\t{\n\t\tCustomerQuestionHandler_DoOnce = false;\n\t\tTextAreaComments = document.getElementById('comments');\n\t\tTextAreaComments.value = replaceWithHTMLEntities(TextAreaComments.value);\n\t\tTextAreaHistory  = document.getElementById('history');\n\t\t\n\t\tif(TextAreaComments.value != \"\")\n\t\t{\n\t\t\t//\tSend message\n\t\t\ttemp = jqSajax.x_SendMessage(session_key, contact_id, CustomTextLine + TextAreaComments.value, \"\", \"Chat_Message_from_Customer\", \"\");\n\t\t\tTextAreaHistory.scrollTop = TextAreaHistory.scrollHeight;\n\t\t\tTextAreaComments.value=\"\"\n\t\t\tTextAreaComments.focus();\n\t\t\t\n\t\t\t//\tRefresh\n\t\t\tQuickRefresh();\n\t\t}\n\t}\n}\n\nfunction QuickRefresh()\n{\n\t//\tFunction should not be used on its own, only works as expected in conjunction with the Refresh() function, or agent will think the customer will have timed out\n\tthisHistory = jqSajax.x_GetHistory(session_key, contact_id, LastReadTime, \"\");\n\n\tif(thisHistory.text != \"\")\n\t{\n\t\ttemp = thisHistory.text;\n\t\tLastReadTime = thisHistory.time;\n\t\t\n\t\tif(AgentAccepted  == false)\n\t\t{\n\t\t\tdocument.getElementById('history').innerHTML= \"\";\n\t\t\tAgentAccepted = true;\n\t\t}\n\t}\n\telse\n\t{\n\t\ttemp=\"\";\n\t}\n\n\tif(temp != \"\")\n\t{\n\t\ttextareaObj = document.getElementById('history');\n\t\ttxt =  textareaObj.innerHTML;\n\n\t\ttxt = txt + temp;\n\n\t\ttextareaObj.innerHTML = txt;\n\t\ttextareaObj.scrollTop = textareaObj.scrollHeight;\n\t}\n\t\n\tif(thisHistory.PlayBeep == \"true\")\n\t{\n\t\tif(UseBeep == true)\n\t\t{\n\t\t\tsound('audio/click.wav');\n\t\t}\n\t}\n\t\n\t//\tCheck agent status both for heartbeat and typing and update user\n\tif (heartbeatTime > 90)\n\t\tdocument.getElementById('AgentStatus').innerHTML = \"Connection to agent unsure; agent may be disconnected...\";\n\telse if (thisHistory.AgentTyping == \"true\")\n\t\tdocument.getElementById('AgentStatus').innerHTML = \"Agente Escribiendo un Mensaje...\";\n\telse\n\t\tdocument.getElementById('AgentStatus').innerHTML = \"\";\n\n\tif(thisHistory.PageFromAgent != \"\")\n\t{\n\t\tif(false)\n\t\t{\n\t\t\t//\tSet isPagePushed 'true'\n\t\t\tisPagePushed = true;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\t//\tOpen agent pushed page in advertisement area of chat pop-up:\n\t\t\t\tdocument.getElementById('web_on_hold_url').src = thisHistory.PageFromAgent;\n\n\t\t\t\t//\tOpen agent pushed page in parent window:\n\t\t\t\t//Window.opener.location.href =  thisHistory.PageFromAgent;\n\n\t\t\t\t//\tOpen agent pushed page in new browser:\n\t\t\t\tmywindow = window.open(thisHistory.PageFromAgent, \"Pushed_Page\", \"location=1, status=1, scrollbars=1, width=800, height=600\");\n\t\t\t}\n\t\t\tcatch(err)\n\t\t\t{\n\t\t\t\t//\tDo nothing, don't display a page, just catch the error\n\t\t\t}\n\t\t}\n\t}\n\n\tUserTyping = false;\n}\n\nfunction doHeartBeat()\n{\n\theartbeatTime = jqSajax.x_UpdateAliveTime(session_key, contact_id, UserTyping, \"\");\n\n\tif(heartbeatTime > 0)\n\t{\t \n\t\t//\tWe have connected to an agent: Update status\n\t\tdocument.getElementById('status').innerHTML = \"<b><font class='status_color'>Estado: </font>Conectado</b>\";\n\t\tdocument.getElementById('enterButton').disabled = false;\n\n\t\tif(document.getElementById('CallMeNumber') != null)\n\t\t{\n\t\t\tdocument.getElementById('CallMeNumber').disabled = false;\n\t\t}\n\n\t\t//\tEnable comments area if disabled\n\t\tdocument.getElementById('comments').disabled = false;\n\t\t//\tRemove question place holder if its still there.\n\t\tvar str = document.getElementById('comments').value;\n\t\t\n\t\tif(str.match(\"Por Favor Ingrese su Comentario Aqui...\"))\n\t\t{\n\t\t\tdocument.getElementById('comments').value = \"\";\n\t\t\tCustomerQuestionHandler_DoOnce = false;\n\t\t}\n\t\t\n\t\t//\tOr if its empty\n\t\tif(str == \"\")\n\t\t{\n\t\t\tCustomerQuestionHandler_DoOnce = false;\n\t\t}\n\t}\n\telse if((heartbeatTime < 0) && (AgentAccepted  == false))\n\t{\n\t\tdocument.getElementById('status').innerHTML = \"<b><font class='status_color'>Estado: </font>No Conectado</b>\";\n\n\t\tif(document.getElementById('CallMeNumber') != null)\n\t\t{\n\t\t\tdocument.getElementById('CallMeNumber').disabled = true;\n\t\t}\n\n\t\t//\tGet comfort messages\n\t\tvar ComfortMessage = jqSajax.x_GetOnHoldComfortMessages(contact_id, session_key, \"\");\n\t\tdocument.getElementById('history').innerHTML = ComfortMessage;\n\t}\n\telse\n\t{\n\t\tdocument.getElementById('status').innerHTML = \"<b><font class='status_color'>Estado: </font>No Conectado</b>\";\n\t\tdocument.getElementById('comments').disabled = true;\t\t\n\t\tdocument.getElementById('enterButton').disabled = true;\n\n\t\t/*----------*/\n\t\t\n\t\tif(document.getElementById('CallMeNumber') != null)\n\t\t{\n\t\t\tdocument.getElementById('CallMeNumber').disabled = true;\n\t\t}\n\t\ttransferEncuesta();\n\t}\n}\n\nfunction Refresh()\n{\n\t//\tDon't refresh while user is typing because of an issue with firefox where typed keys can get lost\n\tif(UserTyping == false)\n\t{\n\t\t//\tDo once, if the customer has typed a question, then auto send to the agent on second poll interval\n\t\tvar str = document.getElementById('status').innerHTML;\n\n\t\tif(CustomerQuestionHandler_DoOnce == true)\n\t\t{\n\t\t\tif(!str.match(\"No Conectado\"))\n\t\t\t{\n\t\t\t\tstr = document.getElementById('comments').value;\n\t\t\t\t\n\t\t\t\tif(!str.match(\"Por Favor Ingrese su Comentario Aqui...\"))\n\t\t\t\t{\n\t\t\t\t\t//\tWe now know that, the user is not typing, the chat is connected and has polled once already in the connected state, and the entered text is not the place holder value\n\t\t\t\t\t//\tSs, send question\n\t\t\t\t\tprocessText();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tCustomerQuestionHandler_DoOnce = false;\n\t\t\t}\n\t\t}\n\n\t\tif(contact_id != 0)\n\t\t{\t\n\t\t\t//\t Update alive time and reflect connection staus based on result\n\t\t\tdoHeartBeat();\n\n\t\t\t//\tRefresh histroy\n\t\t\tQuickRefresh();\n\t\t}\n\t}\n\telse\n\t{\n\t\t//\tBecause of a bug with firefox, remove the heartbeat. However, this means the client cannot update the agent that they are typing\n\t\tif (!(/Firefox[\\/\\s](\\d+\\.\\d+)/.test(navigator.userAgent)))\n\t\t{\n\t\t\t//\tUpdate alive time and reflect connection staus based on result\n\t\t\tdoHeartBeat();\n\t\t}\n\t}\n\n\tif(contact_id != 0)\n\t{\n\t\tif(StopListening == false)    \n\t\t{\n\t\t\tUserTyping = false;\n\t\t\tsetTimeout(\"Refresh()\",5000);\n\t\t}\n\t}\n\n\tif (isPagePushed == false)\n\t{\n\t\t//\tUpdate advert if needs be \n\t\tWebOnHoldTimerCounter = WebOnHoldTimerCounter +  (5000/ 1000);\n\n\t\tif(WebOnHoldDuration <= WebOnHoldTimerCounter)\n\t\t{\n\t\t\tWebOnHoldTimerCounter = 0;\n\n\t\t\tif(WebOnHoldList.length == WebOnHoldCurrentLink)\n\t\t\t{\n\t\t\t\tWebOnHoldCurrentLink = 0; \n\t\t\t}\n\n\t\t\tdocument.getElementById('web_on_hold_url').src = WebOnHoldList[WebOnHoldCurrentLink];\n\t\t\tWebOnHoldCurrentLink = WebOnHoldCurrentLink+1;\n\t\t}\n\t}\n}\n\n</script>\n\n\n\t\t<table id=\"webchatLogin\" class=\"popover_window\" width=\"430\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\n\t\t\t<tbody><tr>\n\t\t\t\t<td width=\"100%\">\n\t\t\t\t\t<table id=\"\" class=\"top_gradient\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">  \n\n\t\t\t\t\t\t<!--\tHeader & Logo\t-->\t\n\n\t\t\t\t\t\t<tbody><tr height=\"70\">\n\t\t\t\t\t\t\t<td width=\"81\" style=\"padding-top:25px;padding-left:50px;\" align=\"right\" valign=\"top\"><img alt=\"\" src=\"img/smallLogo.png\" style=\"border-radius :50px;\"></td>\n\t\t\t\t\t\t\t<td width=\"349\" style=\"padding-top:25px;padding-left:15px;\" align=\"left\" valign=\"top\"><img alt=\"\" src=\"img/chat.png\"></td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<!--\tEnd Header & Logo\t-->\t\n\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\" valign=\"top\">\n\n\t\t\t\t\t\t\t\t<!-- Input Fields -->\n\n\t\t\t\t\t\t\t\t<table id=\"\" class=\"webchat_text_chat\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" width=\"100%\">  \n\t\t\t\t\t\t\t\t\t<tbody><tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<table id=\"webchat_user_input\" class=\"input_fields\" width=\"100%\" valign=\"top\" style=\"display:block;\" border=\"0\" cellspacing=\"3\" cellpadding=\"0\">\n\t\t\t\t\t\t\t\t\t\t\t<tbody><tr align=\"left\">\n\t\t\t\t\t\t\t\t\t\t\t\t<td width=\"110\">Nombre Completo:</td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td><font size=\"3\" color=\"red\">*</font></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td><input type=\"field\" maxlength=\"50\" id=\"username\" size=\"30\"></td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr align=\"left\">\n\t\t\t\t\t\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td id=\"name_error\"></td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr align=\"left\">\n\t\t\t\t\t\t\t\t\t\t\t\t<td width=\"110\">Telefono:</td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td><font size=\"3\" color=\"red\">*</font></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td><input type=\"field\" maxlength=\"50\" id=\"phone\" size=\"30\"></td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr align=\"left\">\n\t\t\t\t\t\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td id=\"phone_error\"></td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr align=\"left\">\n\t\t\t\t\t\t\t\t\t\t\t\t<td width=\"110\">Correo Electronico:</td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td><font size=\"3\" color=\"red\">*</font></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td><input type=\"field\" maxlength=\"50\" id=\"email\" size=\"30\"></td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr align=\"left\">\n\t\t\t\t\t\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td id=\"email_error\"></td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr align=\"left\">\n\t\t\t\t\t\t\t\t\t\t\t\t<td width=\"110\">Asunto:</td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td><font size=\"3\" color=\"red\">*</font></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td><input type=\"field\" maxlength=\"50\" id=\"subject\" size=\"30\"></td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr align=\"left\">\n\t\t\t\t\t\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td id=\"subject_error\"></td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td width=\"110\">Celular:</td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td><font size=\"3\" color=\"red\">*</font></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td><input type=\"field\" maxlength=\"50\" id=\"reference\" size=\"30\"></td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr align=\"left\">\n\t\t\t\t\t\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td id=\"reference_error\"></td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr align=\"left\">\n\t\t\t\t\t\t\t\t\t\t\t\t<td width=\"110\" style=\"text-align: justify;\">¿Autoriza el uso de sus datos personales para manejo exclusivo de EASY en cumplimiento de la ley de protección de datos? </td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td><font size=\"3\" color=\"red\">*</font></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<select style=\"width:242px;\" id=\"habeas\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"1\">SI</option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"2\">NO</option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr align=\"left\" style=\"display:none\">\n\t\t\t\t\t\t\t\t\t\t\t\t<td width=\"110\">Departamento:</td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td><font size=\"3\" color=\"red\">*</font></td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<select style=\"width:205px;\" id=\"skillset\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"WC_Easy_Chat\">Easy</option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t</tbody></table>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</tbody></table>\n\n\t\t\t\t\t\t\t\t<!-- End Input Fields -->\n\n\t\t\t\t\t\t\t\t<!-- Please Wait / Error Message Table -->\n\n\t\t\t\t\t\t\t\t<table id=\"webchat_please_wait\" valign=\"top\" class=\"input_fields\" style=\"display:none;\" width=\"100%\" border=\"0\">\n\t\t\t\t\t\t\t\t\t<tbody><tr>\n\t\t\t\t\t\t\t\t\t\t<td id=\"PleaseWait\" height=\"152\" width=\"438\" valign=\"middle\" align=\"center\">... Por Favor Espera ...</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</tbody></table> \n\n\t\t\t\t\t\t\t\t<!-- End Please Wait / Error Message Table -->\n\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td align=\"center\" style=\"padding:20px;\" colspan=\"2\"> \n\t\t\t\t\t\t\t\t<input type=\"submit\" class=\"wc_submit\" value=\"Ingresar\" onclick=\"javascript:processChatRequest(),insertarVisita();\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</tbody></table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\n\t\t\t\t<!-- Footer -->\n\n\t\t\t\t<td colspan=\"2\" class=\"bottom_gradient\" height=\"50\" width=\"100%\">\n\t\t\t\t\t<div>\n\t\t\t\t\t<span id=\"status\" class=\"webchat_connection_status\"><b><font class=\"status_color\">Estado: </font>No Conectado</b></span>\n\t\t\t\t\t<span class=\"powered_by\">Producido Por Outsourcing S.A.</span>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\n\t\t\t\t<!-- End Footer -->\n\n\t\t\t</tr>\n\t\t</tbody></table>\n\n<script type=\"text/javascript\"> \n\nvar elementID;\n\nfunction onLoginLoadDo()\n{\n\t\n\t/*var myip=131.193.34.202\t\n\tif(myip=\"181.49.219.162\"){\n\t\t\n\t\twindow.location=\"http://www.easy.com.co/g/catalogo-tu-espacio-ideal/?gclid=CPK-4NLIkNICFVIGhgodi54H4w\";\n\t}*/\n\t//\tOn window load resize\n\t//de alto tenia antes 415 lo deje en 540\n\tresizeWindow(438, 438, 438, 540, 433, 397, 0);\n\n\t//\tSet focus to name field\n\t//document.getElementById('name').focus();\n}\n\nfunction replaceWithHTMLEntities(str)\n{\n\t//\tReplace certain 'vulnerable' characters with their html entities\n\tstr = str.replace(\"<\", \"&#60;\");\n\tstr = str.replace(\">\", \"&#62;\");\n\tstr = str.replace(\"$\", \"&#36;\");\n\tstr = str.replace(\"[\", \"&#91;\");\n\tstr = str.replace(\"[\", \"&#93;\");\n\treturn str; \n}\n\nfunction processChatRequest()\n{\n\tvar error = false;\n\telementID = 0;\n\n\t//\tGet input\n\tvar username = replaceWithHTMLEntities(document.getElementById('username').value);\n\tvar email = replaceWithHTMLEntities(document.getElementById('email').value);\n\tvar phone = replaceWithHTMLEntities(document.getElementById('phone').value);\n\tvar skillset = replaceWithHTMLEntities(document.getElementById('skillset').value);\n\tvar subject = replaceWithHTMLEntities(document.getElementById('subject').value);\n\tvar reference = replaceWithHTMLEntities(document.getElementById('reference').value);\n\tvar habeas = replaceWithHTMLEntities(document.getElementById('habeas').value);\n\t\n\n\t//\tOther potentially useable input objects\n\tvar AddressLine1 = \"\";\n\tvar AddressLine2 = \"\";\n\tvar AddressLine3 = \"\";\n\tvar AddressLine4 = \"\";\n\tvar AddressLine5 = \"\";\n\tvar AddressCountry = \"\";\n\tvar AddressLineZipcode = \"\";\n\tvar FirstName = \"\";\n\tvar LastName = \"\";\n\tvar Title = \"\";\n\tvar CustomField_1_Name = \"\";\n\tvar CustomField_1_Value = \"\";\n\t//\n\n\t//\tRetrieve platform and browser information to pass to agent\n\tvar WebCommsQuery = \"PLATFORM: [\" + navigator.platform + \"]; BROWSER: [\" + navigator.appName + \"]; HEADER: [\" + navigator.userAgent + \"]\";\n\n\t//\tAssign username to first name for creating user in database\n\tFirstName = username;\n\n\tdocument.getElementById('email_error').innerHTML = \"\";\n\tdocument.getElementById('phone_error').innerHTML = \"\";\n\tdocument.getElementById('name_error').innerHTML = \"\";\n\tdocument.getElementById('email_error').innerHTML = \"\";\n\tdocument.getElementById('reference_error').innerHTML = \"\";\n\tdocument.getElementById('subject_error').innerHTML = \"\";\n\t//document.getElementById('habeas_error').innerHTML = \"\";\n\t\n\t\n\t\n  \n\tif(username == \"\")\n\t{\n\t\tdocument.getElementById('name_error').innerHTML = \"<font color='red'>Por Favor Ingrese su Nombre Completo</font>\";\n\t\terror = true;\n\t\textendLength += 14;\n\t\telementID = document.getElementById('username');\n\t}\n\t\n\tif(phone == \"\")\n\t{\n\t\tdocument.getElementById('phone_error').innerHTML = \"<font color='red'>Ingrese Por Favor un Numero Telefonico.</font>\";\n\t\terror = true;\n\t\tif (elementID == 0)\n\t\telementID = document.getElementById('phone');\n\t}\n\t\n\t\n\tif(email == \"\")\n\t{\n\t\tdocument.getElementById('email_error').innerHTML = \"<font color='red'>Por Favor Ingrese un Correo Electronico.</font>\";\n\t\terror = true;\n\t\tif (elementID == 0)\n\t\telementID = document.getElementById('email');\n\t}\n\t\n\t//\tValidate given email address\n\tif(email != \"\")\n\t{\n\t\tif(!isValidEmailAddress(email))\n\t\t{\n\t\t\tdocument.getElementById('email_error').innerHTML = \"<font color='red'>Por favor Ingrese un Correo Valido.</font>\";\n\t\t\terror = true;\n\t\t\telementID = document.getElementById('email');\n\t\t}\n\t}\n\n\t//\tValidate given phone number\n\tif(phone != \"\")\n\t{\n\t\tif(!isValidPhoneNumber(phone))\n\t\t{\n\t\t\tdocument.getElementById('phone_error').innerHTML = \"<font color='red'>Ingrese un Numero de Telefono Valido</font>\";\n\t\t\terror = true;\n\t\t\tif (elementID == 0)\n\t\t\t\telementID = document.getElementById('phone');\n\t\t}\n\t}\n\t\n\tif(reference == \"\")\n\t{\n\t\tdocument.getElementById('reference_error').innerHTML = \"<font color='red'>Ingrese un numero Telefonico</font>\";\n\t\terror = true;\n\t\tif (elementID == 0)\n\t\telementID = document.getElementById('reference');\n\t}\n\n\tif(subject == \"\")\n\t{\n\t\tdocument.getElementById('subject_error').innerHTML = \"<font color='red'>Por Favor Ingrese el Asunto de Su Solicitud</font>\";\n\t\terror = true;\n\t\tif (elementID == 0)\n\t\telementID = document.getElementById('subject');\n\t}\n\t\n\n\t// Check for error\n\tif(error)\n\t{\n\t\t//\tSet element focus\n\t\telementID.focus();\n\n\t\treturn;\n\t}\n\n\t//\tAppend reference number to subject\n\tif (!reference == \"\")\n\t\tsubject += \" [\" + reference + \"]\";\n\n\t//\tHide user input panel\n\tdocument.getElementById('webchat_user_input').style.display = \"none\";\n\n\t//\tShow loading panel while we do all the web service calls and it can take a few seconds to complete\n\tdocument.getElementById('webchat_please_wait').style.display = \"block\";\n\n\t//\tMaintain window size (according to browser used) while wait message is displayed and the chat request is processed\n\tresizeWindow(438, 438, 438, 415, 408, 381, 0);\n\n\t//\tGet session key\n\tvar result = jqSajax.x_GetAnonymousSessionKey(\"\");\n\tSessionKey = result.SessionKey;\n\n\tif(SessionKey == null)\n\t{\n\t\t//\tDisplay error - usual cause is the chat cannot connect to the CCMM server - check config for server name\n\t\tdocument.getElementById('PleaseWait').innerHTML = \"Error: Unable to connect to the contact centre.<br \\>Reason: Unable to register with Server.\";\n\t\treturn;\n\t}\n  \n\t//\tGet Customer ID\n\tvar CustomerID = jqSajax.x_GetAndUpdateAnonymousCustomerID(SessionKey, result.AnonymousID, email, phone, FirstName, LastName, Title, AddressLine1, AddressLine2, AddressLine3, AddressLine4, AddressLine5, AddressCountry, AddressLineZipcode, \"\",habeas);\n\n\tif(CustomerID == -1)\n\t{\n\t\t//\tTry to remove phone number (known bug)\n\t\tCustomerID = jqSajax.x_GetAndUpdateAnonymousCustomerID(SessionKey, result.AnonymousID, email, \"\", FirstName, LastName, Title, AddressLine1, AddressLine2, AddressLine3, AddressLine4, AddressLine5, AddressCountry, AddressLineZipcode, \"\",habeas);\n\n\t\tif(CustomerID == -1)\n\t\t{\n\t\t\t//\tCan happen when ImpersonateCustomer is disabled\n\t\t\tdocument.getElementById('PleaseWait').innerHTML = \"Error: Unable to connect to the contact centre.<br \\>Reason: Unable to register customer.\";\n\t\t\treturn;\n\t\t}\n\t}\n\n\t//\tGet Skillset ID from Skillset Name\n\tvar result = jqSajax.x_ReadSkillsetByName(SessionKey, skillset, \"\");\n\tvar SkillsetID = result.id;\n\tvar WebOnHoldTag = result.webTag;\n\n\tif(SkillsetID == null)\n\t{\n\t\t//\tCan happen when an invalid skillset name is used\n\t\tdocument.getElementById('PleaseWait').innerHTML = \"Error: Unable to connect to the contact centre.<br \\>Reason: Unable to register with department.\";\n\t\treturn;\n\t}\n\t\n\n\t//\tRequest text chat\n\tshowAgentWin(username, SkillsetID, CustomerID, SessionKey, email, phone, subject, CustomField_1_Name, CustomField_1_Value, WebCommsQuery, WebOnHoldTag,habeas);\n\n\treturn;\n}\nfunction insertarVisita()\n{\n\tvar result = jqSajax.x_GetAnonymousSessionKey(\"\");\n\tSessionKey = result.SessionKey;\n\t\n\t $.ajax({\n                \n                url:'insertarVisita.php',\n\t\ttype:  'post',\n\t\tdata:  {SessionKey}\n\t});\n}\n\n</script>\n\n\t\n</body>"}
