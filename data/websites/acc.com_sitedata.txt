{"link":"acc.com","html":"<!-- Content Copyright  --><!-- Page generated 2017-04-22 10:16:57 by CommonSpot Build 8.0.2.221 (2013-04-16 14:15:45) --><!-- JavaScript & DHTML Code Copyright &copy; 1998-2013, PaperThin, Inc. All Rights Reserved. --><head> <title>Association of Corporate Counsel (ACC) - The In-house Counsel Bar Association</title> <meta name=\"Description\" id=\"Description\" content=\"The in-house bar association for professional corporate counsel who practice in legal departments globally. ACC, a membership organization, provides resources, news, educational programs and events (CLE), a job search database, and law advocacy sources.\">\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n<meta name=\"Keywords\" id=\"Keywords\" content=\"ACC, ACCA, Association of Corporate Counsel, Compliance, Docket, In-House Practice, Litigation, Practical Law, Small Law Department, attorney-client, bar, business ethics, business law, company lawyers, continuing law education, corporate attorney, corporate counsel, corporate law department, corporate legal, corporate legal department, education credits, general counsel, house counsel, in house counsel, in-house bar association, in-house counsel, in-house counsel jobs, in-house counsel position, in-house counsel salaries, in-house lawyer, in-house legal, in-house legal department, inside counsel, law association, law jobs, lawsuit, lawyers, legal department, legal forms, legal jobs, legal management, legal staff, sample legal forms, sample policy, staff counsel\">\n<meta name=\"Generator\" id=\"Generator\" content=\"CommonSpot Content Server Build 8.0.2.221\">\n<meta name=\"fulldate\" content=\"04/19/2017\"><meta name=\"NumDateRange\" content=\"20170419\"><meta name=\"searchsource\" content=\"ACC Web Pages\"><meta name=\"title\" id=\"title\" content=\"Association of Corporate Counsel (ACC) - The In-house Counsel Bar Association - Association of Corporate Counsel (ACC)\"> \n<link type=\"text/css\" href=\"/style/acc_2014.css\" rel=\"stylesheet\"> <script src=\"https://connect.facebook.net/signals/config/1403102386366748?v=stable\" async=\"\"></script><script async=\"\" src=\"https://connect.facebook.net/en_US/fbevents.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https://www.google-analytics.com/analytics.js\"></script><script src=\"https://dnn506yrbagrg.cloudfront.net/pages/scripts/0021/5597.js?414686\" async=\"\" type=\"text/javascript\"></script><script id=\"hs-analytics\" src=\"//js.hs-analytics.net/analytics/1492870800000/88951.js\"></script><script async=\"\" type=\"text/javascript\" src=\"https://servedbyadbutler.com/app.js\"></script><script async=\"\" src=\"//www.googletagmanager.com/gtm.js?id=GTM-NDN974\"></script><script type=\"text/javascript\">\n<!--\n\tvar gMenuControlID = 0;\n\tvar menus_included = 0;\n\tvar jsDlgLoader = '/loader.cfm';\n\tvar jsSiteID = 1;\n\tvar jsSubSiteID = 1;\n\tvar js_gvPageID = 1350;\n\tvar jsPageID = 1350;\n\tvar jsPageSetID = 0;\n\tvar jsPageType = 0;\n\tvar jsControlsWithRenderHandlers = \",36,36,36,36,1330,2253,2253,2253,2701,2701,36163,59199,66032,155500,159125,159125,168985,1279716,1279716,1279716,1279716,1279716,1279716,1281687,1281687,1281687,1281687,1281687,1306055,1306055,1337359,1348517,1348517,1348889,1350755,1351958,1370364,1370364,1370364,1370364,1379351,1379417,1386295,1395212,1412102,1451264,\";\n\tvar jsDefaultRenderHandlerProps = \",155500_1,159125_1,159125_1,1351958_1,1351958_1,1370364_1,1370364_1,1386295_1,1386295_1,1395212_1,1395212_1,\";\n\tvar jsAuthorizedControls = \",1,2,3,4,6,7,8,9,10,11,16,18,20,21,22,23,25,26,27,28,29,30,31,34,36,37,38,39,40,41,42,43,44,45,46,47,50,51,52,53,54,1330,1936,2253,2701,35682,35695,35705,36163,36309,36315,36692,36705,36844,37185,37656,38432,38450,45046,58375,59173,59181,59199,63781,65702,65916,66032,74545,74573,74934,86674,94025,119892,129555,155500,159125,160008,163705,165331,168983,168985,385198,396860,725091,764580,764675,816279,819058,819749,819756,820295,937945,937997,938002,1278641,1279716,1281687,1306055,1337359,1348517,1348889,1350755,1351877,1351958,1355111,1370364,1376254,1379351,1379415,1379417,1386274,1386295,1395212,1412102,1419983,1431677,1437470,1451257,1451264,1451273,\";\n\tvar jsCustomRenderHandlerPairs = \"\";\n\tvar jsStandardRenderHandlers = \"\";\n\tvar jsSiteSecurityCreateControls = 0;\n\tvar jsShowRejectForApprover = 1;\n\n// -->\n</script><script type=\"text/javascript\" src=\"/commonspot/javascript/browser-all.js\"></script> \n\t\n\t\n\t\t\t<script src=\"/jwplayer7/jwplayer.js\"></script><style type=\"text/css\">.jw-reset{color:inherit;background-color:transparent;padding:0;margin:0;float:none;font-family:Arial,Helvetica,sans-serif;font-size:1em;line-height:1em;list-style:none;text-align:left;text-transform:none;vertical-align:baseline;border:0;direction:ltr;font-variant:inherit;font-stretch:inherit;-webkit-tap-highlight-color:rgba(255,255,255,0)}@font-face{font-family:'jw-icons';src:url(data:application/font-woff;base64,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) format('woff'),url(data:application/octet-stream;base64,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) format('truetype');font-weight:normal;font-style:normal}.jw-icon-inline,.jw-icon-tooltip,.jw-icon-display,.jw-controlbar .jw-menu .jw-option:before{font-family:'jw-icons';-webkit-font-smoothing:antialiased;font-style:normal;font-weight:normal;text-transform:none;background-color:transparent;font-variant:normal;-webkit-font-feature-settings:\"liga\";-ms-font-feature-settings:\"liga\" 1;-o-font-feature-settings:\"liga\";font-feature-settings:\"liga\";-moz-osx-font-smoothing:grayscale}.jw-icon-audio-tracks:before{content:\"\\e600\"}.jw-icon-buffer:before{content:\"\\e601\"}.jw-icon-cast:before{content:\"\\e603\"}.jw-icon-cast.jw-off:before{content:\"\\e602\"}.jw-icon-cc:before{content:\"\\e605\"}.jw-icon-cue:before{content:\"\\e606\"}.jw-icon-menu-bullet:before{content:\"\\e606\"}.jw-icon-error:before{content:\"\\e607\"}.jw-icon-fullscreen:before{content:\"\\e608\"}.jw-icon-fullscreen.jw-off:before{content:\"\\e613\"}.jw-icon-hd:before{content:\"\\e60a\"}.jw-watermark:before,.jw-rightclick-logo:before{content:\"\\e60b\"}.jw-icon-next:before{content:\"\\e60c\"}.jw-icon-pause:before{content:\"\\e60d\"}.jw-icon-play:before{content:\"\\e60e\"}.jw-icon-prev:before{content:\"\\e60f\"}.jw-icon-replay:before{content:\"\\e610\"}.jw-icon-volume:before{content:\"\\e612\"}.jw-icon-volume.jw-off:before{content:\"\\e611\"}.jw-icon-more:before{content:\"\\e614\"}.jw-icon-close:before{content:\"\\e615\"}.jw-icon-playlist:before{content:\"\\e616\"}.jwplayer{width:100%;font-size:16px;position:relative;display:block;min-height:0;overflow:hidden;box-sizing:border-box;font-family:Arial,Helvetica,sans-serif;background-color:#000;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.jwplayer *{box-sizing:inherit}.jwplayer.jw-flag-aspect-mode{height:auto !important}.jwplayer.jw-flag-aspect-mode .jw-aspect{display:block}.jwplayer .jw-aspect{display:none}.jwplayer:focus,.jwplayer .jw-swf{outline:none}.jwplayer:hover .jw-display-icon-container{background-color:#333;background:#333;background-size:#333}.jw-media,.jw-preview,.jw-overlays,.jw-controls{position:absolute;width:100%;height:100%;top:0;left:0;bottom:0;right:0}.jw-media{overflow:hidden;cursor:pointer}.jw-overlays{cursor:auto}.jw-media.jw-media-show{visibility:visible;opacity:1}.jw-media video{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;height:100%;margin:auto;background:transparent}.jw-media video::-webkit-media-controls-start-playback-button{display:none}.jw-controls.jw-controls-disabled{display:none}.jw-controls .jw-controls-right{position:absolute;top:0;right:0}.jw-text{height:1em;font-family:Arial,Helvetica,sans-serif;font-size:.75em;font-style:normal;font-weight:normal;color:white;text-align:center;font-variant:normal;font-stretch:normal}.jw-plugin{position:absolute;bottom:2.5em}.jw-plugin .jw-banner{max-width:100%;opacity:0;cursor:pointer;position:absolute;margin:auto auto 0 auto;left:0;right:0;bottom:0;display:block}.jw-cast-screen{width:100%;height:100%}.jw-instream{position:absolute;top:0;right:0;bottom:0;left:0;display:none}.jw-icon-playback:before{content:\"\\e60e\"}.jw-tab-focus:focus{outline:solid 2px #0b7ef4}.jw-preview,.jw-captions,.jw-title,.jw-overlays,.jw-controls{pointer-events:none}.jw-overlays>div,.jw-media,.jw-controlbar,.jw-dock,.jw-logo,.jw-skip,.jw-display-icon-container{pointer-events:all}.jw-click{position:absolute;width:100%;height:100%}.jw-preview{position:absolute;display:none;opacity:1;visibility:visible;width:100%;height:100%;background:#000 no-repeat 50% 50%}.jwplayer .jw-preview,.jw-error .jw-preview,.jw-stretch-uniform .jw-preview{background-size:contain}.jw-stretch-none .jw-preview{background-size:auto auto}.jw-stretch-fill .jw-preview{background-size:cover}.jw-stretch-exactfit .jw-preview{background-size:100% 100%}.jw-display-icon-container{position:relative;top:50%;display:table;height:3.5em;width:3.5em;margin:-1.75em auto 0;cursor:pointer}.jw-display-icon-container .jw-icon-display{position:relative;display:table-cell;text-align:center;vertical-align:middle !important;background-position:50% 50%;background-repeat:no-repeat;font-size:2em}.jw-flag-audio-player .jw-display-icon-container,.jw-flag-dragging .jw-display-icon-container{display:none}.jw-icon{font-family:'jw-icons';-webkit-font-smoothing:antialiased;font-style:normal;font-weight:normal;text-transform:none;background-color:transparent;font-variant:normal;-webkit-font-feature-settings:\"liga\";-ms-font-feature-settings:\"liga\" 1;-o-font-feature-settings:\"liga\";font-feature-settings:\"liga\";-moz-osx-font-smoothing:grayscale}.jw-controlbar{display:table;position:absolute;right:0;left:0;bottom:0;height:2em;padding:0 .25em}.jw-controlbar .jw-hidden{display:none}.jw-controlbar.jw-drawer-expanded .jw-controlbar-left-group,.jw-controlbar.jw-drawer-expanded .jw-controlbar-center-group{opacity:0}.jw-background-color{background-color:#414040}.jw-group{display:table-cell}.jw-controlbar-center-group{width:100%;padding:0 .25em}.jw-controlbar-center-group .jw-slider-time,.jw-controlbar-center-group .jw-text-alt{padding:0}.jw-controlbar-center-group .jw-text-alt{display:none}.jw-controlbar-left-group,.jw-controlbar-right-group{white-space:nowrap}.jw-knob:hover,.jw-icon-inline:hover,.jw-icon-tooltip:hover,.jw-icon-display:hover,.jw-option:before:hover{color:#eee}.jw-icon-inline,.jw-icon-tooltip,.jw-slider-horizontal,.jw-text-elapsed,.jw-text-duration{display:inline-block;height:2em;position:relative;line-height:2em;vertical-align:middle;cursor:pointer}.jw-icon-inline,.jw-icon-tooltip{min-width:1.25em;text-align:center}.jw-icon-playback{min-width:2.25em}.jw-icon-volume{min-width:1.75em;text-align:left}.jw-time-tip{line-height:1em;pointer-events:none}.jw-icon-inline:after,.jw-icon-tooltip:after{width:100%;height:100%;font-size:1em}.jw-icon-cast{display:none}.jw-slider-volume.jw-slider-horizontal,.jw-icon-inline.jw-icon-volume{display:none}.jw-dock{margin:.75em;display:block;opacity:1;clear:right}.jw-dock:after{content:'';clear:both;display:block}.jw-dock-button{cursor:pointer;float:right;position:relative;width:2.5em;height:2.5em;margin:.5em}.jw-dock-button .jw-arrow{display:none;position:absolute;bottom:-0.2em;width:.5em;height:.2em;left:50%;margin-left:-0.25em}.jw-dock-button .jw-overlay{display:none;position:absolute;top:2.5em;right:0;margin-top:.25em;padding:.5em;white-space:nowrap}.jw-dock-button:hover .jw-overlay,.jw-dock-button:hover .jw-arrow{display:block}.jw-dock-image{width:100%;height:100%;background-position:50% 50%;background-repeat:no-repeat;opacity:.75}.jw-title{display:none;position:absolute;top:0;width:100%;font-size:.875em;height:8em;background:-webkit-linear-gradient(top, #000 0, #000 18%, rgba(0,0,0,0) 100%);background:linear-gradient(to bottom, #000 0, #000 18%, rgba(0,0,0,0) 100%)}.jw-title-primary,.jw-title-secondary{padding:.75em 1.5em;min-height:2.5em;width:75%;color:white;white-space:nowrap;text-overflow:ellipsis;overflow-x:hidden}.jw-title-primary{font-weight:bold}.jw-title-secondary{margin-top:-0.5em}.jw-slider-container{display:inline-block;height:1em;position:relative;-ms-touch-action:none;touch-action:none}.jw-rail,.jw-buffer,.jw-progress{position:absolute;cursor:pointer}.jw-progress{background-color:#fff}.jw-rail{background-color:#aaa}.jw-buffer{background-color:#202020}.jw-cue,.jw-knob{position:absolute;cursor:pointer}.jw-cue{background-color:#fff;width:.1em;height:.4em}.jw-knob{background-color:#aaa;width:.4em;height:.4em}.jw-slider-horizontal{width:4em;height:1em}.jw-slider-horizontal.jw-slider-volume{margin-right:5px}.jw-slider-horizontal .jw-rail,.jw-slider-horizontal .jw-buffer,.jw-slider-horizontal .jw-progress{width:100%;height:.4em}.jw-slider-horizontal .jw-progress,.jw-slider-horizontal .jw-buffer{width:0}.jw-slider-horizontal .jw-rail,.jw-slider-horizontal .jw-progress,.jw-slider-horizontal .jw-slider-container{width:100%}.jw-slider-horizontal .jw-knob{left:0;margin-left:-0.325em}.jw-slider-vertical{width:.75em;height:4em;bottom:0;position:absolute;padding:1em}.jw-slider-vertical .jw-rail,.jw-slider-vertical .jw-buffer,.jw-slider-vertical .jw-progress{bottom:0;height:100%}.jw-slider-vertical .jw-progress,.jw-slider-vertical .jw-buffer{height:0}.jw-slider-vertical .jw-slider-container,.jw-slider-vertical .jw-rail,.jw-slider-vertical .jw-progress{bottom:0;width:.75em;height:100%;left:0;right:0;margin:0 auto}.jw-slider-vertical .jw-slider-container{height:4em;position:relative}.jw-slider-vertical .jw-knob{bottom:0;left:0;right:0;margin:0 auto}.jw-slider-time{right:0;left:0;width:100%}.jw-tooltip-time{position:absolute}.jw-slider-volume .jw-buffer{display:none}.jw-captions{position:absolute;display:none;margin:0 auto;width:100%;left:0;bottom:3em;right:0;max-width:90%;text-align:center}.jw-captions.jw-captions-enabled{display:block}.jw-captions-window{display:none;padding:.25em;border-radius:.25em}.jw-captions-window.jw-captions-window-active{display:inline-block}.jw-captions-text{display:inline-block;color:white;background-color:black;word-wrap:break-word;white-space:pre-line;font-style:normal;font-weight:normal;text-align:center;text-decoration:none;line-height:1.3em;padding:.1em .8em}.jw-rightclick{display:none;position:absolute;white-space:nowrap}.jw-rightclick.jw-open{display:block}.jw-rightclick ul{list-style:none;font-weight:bold;border-radius:.15em;margin:0;border:1px solid #444;padding-left:0}.jw-rightclick .jw-rightclick-logo{font-size:2em;color:#ff0147;vertical-align:middle;padding-right:.3em;margin-right:.3em;border-right:1px solid #444}.jw-rightclick li{background-color:#000;border-bottom:1px solid #444;margin:0}.jw-rightclick a{color:#fff;text-decoration:none;padding:1em;display:block;font-size:.6875em}.jw-rightclick li:last-child{border-bottom:none}.jw-rightclick li:hover{background-color:#1a1a1a;cursor:pointer}.jw-rightclick .jw-featured{background-color:#252525;vertical-align:middle}.jw-rightclick .jw-featured a{color:#777}.jw-logo{float:right;padding:.75em;cursor:pointer;pointer-events:all}.jw-logo .jw-flag-audio-player{display:none}.jw-watermark{position:absolute;top:50%;left:0;right:0;bottom:0;text-align:center;font-size:14em;color:#eee;opacity:.33;pointer-events:none}.jw-icon-tooltip.jw-open .jw-overlay{opacity:1;visibility:visible}.jw-icon-tooltip.jw-hidden{display:none}.jw-overlay-horizontal{display:none}.jw-icon-tooltip.jw-open-drawer:before{display:none}.jw-icon-tooltip.jw-open-drawer .jw-overlay-horizontal{opacity:1;display:inline-block;vertical-align:top}.jw-overlay:before{position:absolute;top:0;bottom:0;left:-50%;width:100%;background-color:rgba(0,0,0,0);content:\" \"}.jw-slider-time .jw-overlay:before{height:1em;top:auto}.jw-time-tip,.jw-volume-tip,.jw-menu{position:relative;left:-50%;border:solid 1px #000;margin:0}.jw-volume-tip{width:100%;height:100%;display:block}.jw-time-tip{text-align:center;font-family:inherit;color:#aaa;bottom:1em;border:solid 4px #000}.jw-time-tip .jw-text{line-height:1em}.jw-controlbar .jw-overlay{margin:0;position:absolute;bottom:2em;left:50%;opacity:0;visibility:hidden}.jw-controlbar .jw-overlay .jw-contents{position:relative}.jw-controlbar .jw-option{position:relative;white-space:nowrap;cursor:pointer;list-style:none;height:1.5em;font-family:inherit;line-height:1.5em;color:#aaa;padding:0 .5em;font-size:.8em}.jw-controlbar .jw-option:hover,.jw-controlbar .jw-option:before:hover{color:#eee}.jw-controlbar .jw-option:before{padding-right:.125em}.jw-playlist-container ::-webkit-scrollbar-track{background-color:#333;border-radius:10px}.jw-playlist-container ::-webkit-scrollbar{width:5px;border:10px solid black;border-bottom:0;border-top:0}.jw-playlist-container ::-webkit-scrollbar-thumb{background-color:white;border-radius:5px}.jw-tooltip-title{border-bottom:1px solid #444;text-align:left;padding-left:.7em}.jw-playlist{max-height:11em;min-height:4.5em;overflow-x:hidden;overflow-y:scroll;width:calc(100% - 4px)}.jw-playlist .jw-option{height:3em;margin-right:5px;color:white;padding-left:1em;font-size:.8em}.jw-playlist .jw-label,.jw-playlist .jw-name{display:inline-block;line-height:3em;text-align:left;overflow:hidden;white-space:nowrap}.jw-playlist .jw-label{width:1em}.jw-playlist .jw-name{width:11em}.jw-skip{cursor:default;position:absolute;float:right;display:inline-block;right:.75em;bottom:3em}.jw-skip.jw-skippable{cursor:pointer}.jw-skip.jw-hidden{visibility:hidden}.jw-skip .jw-skip-icon{display:none;margin-left:-0.75em}.jw-skip .jw-skip-icon:before{content:\"\\e60c\"}.jw-skip .jw-text,.jw-skip .jw-skip-icon{color:#aaa;vertical-align:middle;line-height:1.5em;font-size:.7em}.jw-skip.jw-skippable:hover{cursor:pointer}.jw-skip.jw-skippable:hover .jw-text,.jw-skip.jw-skippable:hover .jw-skip-icon{color:#eee}.jw-skip.jw-skippable .jw-skip-icon{display:inline;margin:0}.jwplayer.jw-state-playing.jw-flag-casting .jw-display-icon-container,.jwplayer.jw-state-paused.jw-flag-casting .jw-display-icon-container{display:table}.jwplayer.jw-flag-casting .jw-display-icon-container{border-radius:0;top:8em;padding:2em 5em;border:1px solid white}.jwplayer.jw-flag-casting .jw-display-icon-container .jw-icon{font-size:3em}.jwplayer.jw-flag-casting.jw-state-complete .jw-preview{display:none}.jw-cast{position:absolute;width:100%;height:100%;background-repeat:no-repeat;background-size:auto;background-position:50% 50%}.jw-cast-label{position:absolute;left:10px;right:10px;bottom:50%;margin-bottom:100px;text-align:center}.jw-cast-name{color:#ccc}.jw-state-idle .jw-preview{display:block}.jw-state-idle .jw-icon-display:before{content:\"\\e60e\"}.jw-state-idle .jw-controlbar{display:none}.jw-state-idle .jw-captions{display:none}.jw-state-idle .jw-title{display:block}.jwplayer.jw-state-playing .jw-display-icon-container{display:none}.jwplayer.jw-state-playing .jw-display-icon-container .jw-icon-display:before{content:\"\\e60d\"}.jwplayer.jw-state-playing .jw-icon-playback:before{content:\"\\e60d\"}.jwplayer.jw-state-paused .jw-display-icon-container{display:none}.jwplayer.jw-state-paused .jw-display-icon-container .jw-icon-display:before{content:\"\\e60e\"}.jwplayer.jw-state-paused .jw-icon-playback:before{content:\"\\e60e\"}.jwplayer.jw-state-buffering .jw-display-icon-container .jw-icon-display{-webkit-animation:spin 2s linear infinite;animation:spin 2s linear infinite}.jwplayer.jw-state-buffering .jw-display-icon-container .jw-icon-display:before{content:\"\\e601\"}@-webkit-keyframes spin{100%{-webkit-transform:rotate(360deg)}}@keyframes spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.jwplayer.jw-state-buffering .jw-display-icon-container .jw-text{display:none}.jwplayer.jw-state-buffering .jw-icon-playback:before{content:\"\\e60d\"}.jwplayer.jw-state-complete .jw-preview{display:block}.jwplayer.jw-state-complete .jw-display-icon-container .jw-icon-display:before{content:\"\\e610\"}.jwplayer.jw-state-complete .jw-display-icon-container .jw-text{display:none}.jwplayer.jw-state-complete .jw-icon-playback:before{content:\"\\e60e\"}.jwplayer.jw-state-complete .jw-captions{display:none}body .jw-error .jw-title,.jwplayer.jw-state-error .jw-title{display:block}body .jw-error .jw-title .jw-title-primary,.jwplayer.jw-state-error .jw-title .jw-title-primary{white-space:normal}body .jw-error .jw-preview,.jwplayer.jw-state-error .jw-preview{display:block}body .jw-error .jw-controlbar,.jwplayer.jw-state-error .jw-controlbar{display:none}body .jw-error .jw-captions,.jwplayer.jw-state-error .jw-captions{display:none}body .jw-error:hover .jw-display-icon-container,.jwplayer.jw-state-error:hover .jw-display-icon-container{cursor:default;color:#fff;background:#000}body .jw-error .jw-icon-display,.jwplayer.jw-state-error .jw-icon-display{cursor:default;font-family:'jw-icons';-webkit-font-smoothing:antialiased;font-style:normal;font-weight:normal;text-transform:none;background-color:transparent;font-variant:normal;-webkit-font-feature-settings:\"liga\";-ms-font-feature-settings:\"liga\" 1;-o-font-feature-settings:\"liga\";font-feature-settings:\"liga\";-moz-osx-font-smoothing:grayscale}body .jw-error .jw-icon-display:before,.jwplayer.jw-state-error .jw-icon-display:before{content:\"\\e607\"}body .jw-error .jw-icon-display:hover,.jwplayer.jw-state-error .jw-icon-display:hover{color:#fff}body .jw-error{font-size:16px;background-color:#000;color:#eee;width:100%;height:100%;display:table;opacity:1;position:relative}body .jw-error .jw-icon-container{position:absolute;width:100%;height:100%;top:0;left:0;bottom:0;right:0}.jwplayer.jw-flag-cast-available .jw-controlbar{display:table}.jwplayer.jw-flag-cast-available .jw-icon-cast{display:inline-block}.jwplayer.jw-flag-skin-loading .jw-captions,.jwplayer.jw-flag-skin-loading .jw-controls,.jwplayer.jw-flag-skin-loading .jw-title{display:none}.jwplayer.jw-flag-fullscreen{width:100% !important;height:100% !important;top:0;right:0;bottom:0;left:0;z-index:1000;margin:0;position:fixed}.jwplayer.jw-flag-fullscreen.jw-flag-user-inactive{cursor:none;-webkit-cursor-visibility:auto-hide}.jwplayer.jw-flag-live .jw-controlbar .jw-text-elapsed,.jwplayer.jw-flag-live .jw-controlbar .jw-text-duration,.jwplayer.jw-flag-live .jw-controlbar .jw-slider-time{display:none}.jwplayer.jw-flag-live .jw-controlbar .jw-text-alt{display:inline}.jw-flag-user-inactive.jw-state-playing .jw-controlbar,.jw-flag-user-inactive.jw-state-playing .jw-dock{display:none}.jw-flag-user-inactive.jw-state-playing .jw-logo.jw-hide{display:none}.jw-flag-user-inactive.jw-state-playing .jw-plugin,.jw-flag-user-inactive.jw-state-playing .jw-captions{bottom:.5em}.jwplayer.jw-flag-media-audio .jw-controlbar{display:table}.jw-flag-media-audio .jw-preview{display:block}.jwplayer.jw-flag-ads .jw-preview,.jwplayer.jw-flag-ads .jw-dock{display:none}.jwplayer.jw-flag-ads .jw-controlbar .jw-icon-inline,.jwplayer.jw-flag-ads .jw-controlbar .jw-icon-tooltip,.jwplayer.jw-flag-ads .jw-controlbar .jw-text,.jwplayer.jw-flag-ads .jw-controlbar .jw-slider-horizontal{display:none}.jwplayer.jw-flag-ads .jw-controlbar .jw-icon-playback,.jwplayer.jw-flag-ads .jw-controlbar .jw-icon-volume,.jwplayer.jw-flag-ads .jw-controlbar .jw-slider-volume,.jwplayer.jw-flag-ads .jw-controlbar .jw-icon-fullscreen{display:inline-block}.jwplayer.jw-flag-ads .jw-controlbar .jw-text-alt{display:inline}.jwplayer.jw-flag-ads .jw-controlbar .jw-slider-volume.jw-slider-horizontal,.jwplayer.jw-flag-ads .jw-controlbar .jw-icon-inline.jw-icon-volume{display:inline-block}.jwplayer.jw-flag-ads .jw-controlbar .jw-icon-tooltip.jw-icon-volume{display:none}.jwplayer.jw-flag-ads .jw-logo{display:none}.jwplayer.jw-flag-ads-hide-controls .jw-controls{display:none !important}.jwplayer.jw-flag-ads.jw-flag-touch .jw-controlbar{display:table}.jwplayer.jw-flag-overlay-open .jw-title{display:none}.jwplayer.jw-flag-overlay-open .jw-controls-right .jw-logo{display:none}.jwplayer.jw-flag-rightclick-open{overflow:visible}.jwplayer.jw-flag-rightclick-open .jw-rightclick{z-index:16777215}.jw-flag-controls-disabled .jw-controls{visibility:hidden}.jw-flag-controls-disabled .jw-logo{visibility:visible}.jw-flag-controls-disabled .jw-media{cursor:auto}body .jwplayer.jw-flag-flash-blocked .jw-title{display:block}body .jwplayer.jw-flag-flash-blocked .jw-controls,body .jwplayer.jw-flag-flash-blocked .jw-overlays,body .jwplayer.jw-flag-flash-blocked .jw-preview{display:none}.jw-flag-touch .jw-controlbar,.jw-flag-touch .jw-skip,.jw-flag-touch .jw-plugin{font-size:1.5em}.jw-flag-touch .jw-captions{bottom:4.25em}.jw-flag-touch .jw-icon-tooltip.jw-open-drawer:before{display:inline}.jw-flag-touch .jw-icon-tooltip.jw-open-drawer:before{content:\"\\e615\"}.jw-flag-touch .jw-display-icon-container{pointer-events:none}.jw-flag-touch.jw-state-paused .jw-display-icon-container{display:table}.jw-flag-touch.jw-state-paused.jw-flag-dragging .jw-display-icon-container{display:none}.jw-flag-compact-player .jw-icon-playlist,.jw-flag-compact-player .jw-icon-next,.jw-flag-compact-player .jw-icon-prev,.jw-flag-compact-player .jw-text-elapsed,.jw-flag-compact-player .jw-text-duration{display:none}.jw-flag-audio-player{background-color:transparent}.jw-flag-audio-player .jw-media{visibility:hidden}.jw-flag-audio-player .jw-media object{width:1px;height:1px}.jw-flag-audio-player .jw-controlbar{display:table;bottom:0;margin:0;width:100%;min-width:100%;opacity:1}.jw-flag-audio-player .jw-controlbar .jw-icon-fullscreen{display:none}.jw-flag-audio-player .jw-controlbar .jw-icon-tooltip{display:none}.jw-flag-audio-player .jw-controlbar .jw-slider-volume.jw-slider-horizontal,.jw-flag-audio-player .jw-controlbar .jw-icon-inline.jw-icon-volume{display:inline-block}.jw-flag-audio-player .jw-controlbar .jw-icon-tooltip.jw-icon-volume{display:none}.jwplayer.jw-flag-audio-player .jw-controlbar{display:table;left:0}.jwplayer.jw-flag-audio-player .jw-controlbar{height:auto}.jwplayer.jw-flag-audio-player .jw-preview{display:none}.jwplayer.jw-flag-audio-player .jw-display-icon-container{display:none}.jw-skin-seven .jw-background-color{background:#000}.jw-skin-seven .jw-controlbar{border-top:#333 1px solid;height:2.5em}.jw-skin-seven .jw-group{vertical-align:middle}.jw-skin-seven .jw-playlist{background-color:rgba(0,0,0,0.5)}.jw-skin-seven .jw-playlist-container{left:-43%;background-color:rgba(0,0,0,0.5)}.jw-skin-seven .jw-playlist-container .jw-option{border-bottom:1px solid #444}.jw-skin-seven .jw-playlist-container .jw-option:hover,.jw-skin-seven .jw-playlist-container .jw-option.jw-active-option{background-color:black}.jw-skin-seven .jw-playlist-container .jw-option:hover .jw-label{color:#ff0046}.jw-skin-seven .jw-playlist-container .jw-icon-playlist{margin-left:0}.jw-skin-seven .jw-playlist-container .jw-label .jw-icon-play{color:#ff0046}.jw-skin-seven .jw-playlist-container .jw-label .jw-icon-play:before{padding-left:0}.jw-skin-seven .jw-tooltip-title{background-color:#000;color:#fff}.jw-skin-seven .jw-text{color:#fff}.jw-skin-seven .jw-button-color{color:#fff}.jw-skin-seven .jw-button-color:hover{color:#ff0046}.jw-skin-seven .jw-toggle{color:#ff0046}.jw-skin-seven .jw-toggle.jw-off{color:#fff}.jw-skin-seven .jw-controlbar .jw-icon:before,.jw-skin-seven .jw-text-elapsed,.jw-skin-seven .jw-text-duration{padding:0 .7em}.jw-skin-seven .jw-controlbar .jw-icon-prev:before{padding-right:.25em}.jw-skin-seven .jw-controlbar .jw-icon-playlist:before{padding:0 .45em}.jw-skin-seven .jw-controlbar .jw-icon-next:before{padding-left:.25em}.jw-skin-seven .jw-icon-prev,.jw-skin-seven .jw-icon-next{font-size:.7em}.jw-skin-seven .jw-icon-prev:before{border-left:1px solid #666}.jw-skin-seven .jw-icon-next:before{border-right:1px solid #666}.jw-skin-seven .jw-icon-display{color:#fff}.jw-skin-seven .jw-icon-display:before{padding-left:0}.jw-skin-seven .jw-display-icon-container{border-radius:50%;border:1px solid #333}.jw-skin-seven .jw-rail{background-color:#384154;box-shadow:none}.jw-skin-seven .jw-buffer{background-color:#666f82}.jw-skin-seven .jw-progress{background:#ff0046}.jw-skin-seven .jw-knob{width:.6em;height:.6em;background-color:#fff;box-shadow:0 0 0 1px #000;border-radius:1em}.jw-skin-seven .jw-slider-horizontal .jw-slider-container{height:.95em}.jw-skin-seven .jw-slider-horizontal .jw-rail,.jw-skin-seven .jw-slider-horizontal .jw-buffer,.jw-skin-seven .jw-slider-horizontal .jw-progress{height:.2em;border-radius:0}.jw-skin-seven .jw-slider-horizontal .jw-knob{top:-0.2em}.jw-skin-seven .jw-slider-horizontal .jw-cue{top:-0.05em;width:.3em;height:.3em;background-color:#fff;border-radius:50%}.jw-skin-seven .jw-slider-vertical .jw-rail,.jw-skin-seven .jw-slider-vertical .jw-buffer,.jw-skin-seven .jw-slider-vertical .jw-progress{width:.2em}.jw-skin-seven .jw-volume-tip{width:100%;left:-45%;padding-bottom:.7em}.jw-skin-seven .jw-text-duration{color:#666f82}.jw-skin-seven .jw-controlbar-right-group .jw-icon-tooltip:before,.jw-skin-seven .jw-controlbar-right-group .jw-icon-inline:before{border-left:1px solid #666}.jw-skin-seven .jw-controlbar-right-group .jw-icon-inline:first-child:before{border:none}.jw-skin-seven .jw-dock .jw-dock-button{border-radius:50%;border:1px solid #333}.jw-skin-seven .jw-dock .jw-overlay{border-radius:2.5em}.jw-skin-seven .jw-icon-tooltip .jw-active-option{background-color:#ff0046;color:#fff}.jw-skin-seven .jw-icon-volume{min-width:2.6em}.jw-skin-seven .jw-time-tip,.jw-skin-seven .jw-menu,.jw-skin-seven .jw-volume-tip,.jw-skin-seven .jw-skip{border:1px solid #333}.jw-skin-seven .jw-time-tip{padding:.2em;bottom:1.3em}.jw-skin-seven .jw-menu,.jw-skin-seven .jw-volume-tip{bottom:.24em}.jw-skin-seven .jw-skip{padding:.4em;border-radius:1.75em}.jw-skin-seven .jw-skip .jw-text,.jw-skin-seven .jw-skip .jw-icon-inline{color:#fff;line-height:1.75em}.jw-skin-seven .jw-skip.jw-skippable:hover .jw-text,.jw-skin-seven .jw-skip.jw-skippable:hover .jw-icon-inline{color:#ff0046}.jw-skin-seven.jw-flag-touch .jw-controlbar .jw-icon:before,.jw-skin-seven.jw-flag-touch .jw-text-elapsed,.jw-skin-seven.jw-flag-touch .jw-text-duration{padding:0 .35em}.jw-skin-seven.jw-flag-touch .jw-controlbar .jw-icon-prev:before{padding:0 .125em 0 .7em}.jw-skin-seven.jw-flag-touch .jw-controlbar .jw-icon-next:before{padding:0 .7em 0 .125em}.jw-skin-seven.jw-flag-touch .jw-controlbar .jw-icon-playlist:before{padding:0 .225em}</style>\n            <script>jwplayer.key=\"7qv7h2nZnAH3HJiTCkyQiZ+B2wKQo5g6DBx3MQ==\";</script>\t\n\n\n\n\n\t\n\t<script src=\"/j/jquery-1.7.1.min.js\"></script>\n\t<script src=\"/j/acc_2014.js\"></script>\n\t<link href=\"/style/body.css\" rel=\"stylesheet\" media=\"screen, projection\" type=\"text/css\">\t\n\t<link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css\">\n\n\n  \t<link rel=\"stylesheet\" href=\"/style/jquery-ui.css\">  \n\n    <script src=\"/j/jquery.expander.js\" type=\"text/javascript\"></script>\n    <script type=\"text/javascript\" src=\"/j/jquery.youtubeplaylist.js\"></script>\n\t<script src=\"/j/jquery-ui.js\"></script>\t\n\t<script src=\"/j/jquery.ui.touch-punch.min.js\"></script>\n\n    \n    \n    <script type=\"text/javascript\">\n        jQuery.noConflict();\n    \n        jQuery(document).ready(function($) { \n                \n            // ghost text code\n                $('.ghost-text').each(function(){\n                \n                    var thisElement = $(this);\n                    var defaultVal = thisElement.val();\n                    \n                    thisElement.focus(function(){\n                        if( thisElement.val() == defaultVal ) {\n                            thisElement.val('').removeClass('ghost-text');\n                        }\n                    });\n                    \n                    thisElement.blur(function(){\n                        if( thisElement.val() == '' ) {\n                            thisElement.val(defaultVal).addClass('ghost-text');\n                        }\n                    });\n                });\n    \n        });   \n    </script>\n\n\n\n\t\n\t<meta http-equiv=\"PRAGMA\" content=\"NO-CACHE\">\n\t<meta http-equiv=\"CACHE-CONTROL\" content=\"NO-CACHE\">\n\t<meta http-equiv=\"Expires\" content=\"-1\">\n\t<link rel=\"shortcut icon\" type=\"image/ico\" href=\"/favicon.ico\">\n\n\t<link href=\"/style/print.css\" rel=\"stylesheet\" media=\"print\" type=\"text/css\">\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"/style/lightwindow.css\">\n\n\t\n\t<script type=\"text/javascript\" src=\"/j/swfobject.js\"></script>\n\t\n\t\n\t\t<!--[if IE 6]>\n\t\t\t<link rel=\"stylesheet\" type=\"text/css\" href=\"/style/ie6.css\" />\n\t\t<![endif]-->\n\t\t<!--[if IE 7]>\n\t\t\t<link rel=\"stylesheet\" type=\"text/css\" href=\"/style/ie7.css\" />\n\t\t<![endif]-->\n\t\t<!--[if IE 8]>\n\t\t\t<link rel=\"stylesheet\" type=\"text/css\" href=\"/style/ie8.css\" />\n\t\t<![endif]-->\n\n\n\t\n\n\n<link rel=\"P3Pv1\" href=\"http://author.acc.com/w3c/p3p.xml\"> \n\n\t\n<script type=\"text/javascript\" src=\"/j/userid_tracking.js\"></script>\n\n<link rel=\"stylesheet\" href=\"/commonspot/commonspot.css\" type=\"text/css\" id=\"cs_maincss\"> <script id=\"cs_util_js\" type=\"text/javascript\" src=\"/commonspot/javascript/util.js\">/*\r\n * bring browser up to speed somewhat\r\n * NOTE: THESE PROTOTYPE METHODS ARE DUPLICATED IN util.js AND nondashboard-utils.js\r\n * \t\tKEEP THEM IDENTICAL\r\n */\r\nif(!String.prototype.trim)\r\n{\r\n\tString.prototype.trim = function()\r\n\t{\r\n\t\tvar start = -1;\r\n\t\tvar end = this.length;\r\n\t\twhile(this.charCodeAt(--end) < 33);\r\n\t\twhile(this.charCodeAt(++start) < 33);\r\n\t\treturn this.slice(start, end + 1);\r\n\t};\r\n}\r\nif(!String.prototype.toBoolean)\r\n{\r\n\tString.prototype.toBoolean = function()\r\n\t{\r\n\t\tswitch(this.valueOf())\r\n\t\t{\r\n\t\t\tcase \"1\":\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"0\": case \"\": case \"no\": case \"false\":\r\n\t\t\tcase \"No\": case \"False\": case \"NO\": case \"FALSE\":\r\n\t\t\t\treturn false;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t};\r\n}\r\nif(!Array.prototype.indexOf)\r\n{\r\n\tArray.prototype.indexOf = function(value, fromIndex)\r\n\t{\r\n\t\tvar len = this.length;\r\n\t\tif(fromIndex == null)\r\n\t\t\tfromIndex = 0;\r\n\t\telse if(fromIndex < 0)\r\n\t\t\tfromIndex = Math.max(0, len + fromIndex);\r\n\t\tfor(var i = fromIndex; i < len; i++)\r\n\t\t{\r\n\t\t\tif(this[i] === value)\r\n\t\t\t\treturn i;\r\n\t\t}\r\n\t\treturn -1;\r\n\t};\r\n}\r\nvar EventCache=function() \r\n{\r\n\tvar listEvents=[];\r\n\treturn{\r\n\t\tlistEvents: listEvents,\r\n\t\tadd: function(node,sEventName,fHandler,bCapture)\r\n\t\t{\r\n\t\t\tlistEvents.push(arguments);\r\n\t\t},\r\n\t\t\r\n\t\tflush: function()\r\n\t\t{\r\n\t\t\tvar i, item;\r\n\t\t\tfor(i=listEvents.length-1;i>=0;i=i-1) \r\n\t\t\t{\t\r\n\t\t\t\titem=listEvents[i];\r\n\t\t\t\tif(!item) \r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tif(item[0].removeEventListener) \r\n\t\t\t\t\titem[0].removeEventListener(item[1],item[2],item[3]);\r\n\t\t\t\tvar logical_type='';\r\n\t\t\t\tif(item[1].substring(0,2)!=\"on\") \r\n\t\t\t\t{\r\n\t\t\t\t\tlogical_type=item[1];\r\n\t\t\t\t\titem[1]=\"on\"+item[1];\r\n\t\t\t\t}\r\n\t\t\t\telse \r\n\t\t\t\t\tlogical_type=item[1].substring(2,event_name_without_on.length);\r\n\t\t\t\tif(typeof item[0].__eventHandlers!='undefined'&&typeof item[0].__eventHandlers[logical_type]!='undefined') \r\n\t\t\t\t\titem[0].__eventHandlers[logical_type]=null;\r\n\t\t\t\tif(item[0].detachEvent) \r\n\t\t\t\t\titem[0].detachEvent(item[1],item[2]);\r\n\t\t\t\titem[0][item[1]]=null;\r\n\t\t\t};\r\n\t\t\tlistEvents=null;\r\n\t\t}\r\n\t}\r\n}();\r\n\r\nfunction flashMsg(msg, width)\r\n{\r\n\tvar FLASH_MSG_ID = 'cs_flashMsg'; // id of html object that shows the msg\r\n\tif(!width)\r\n\t\tvar width = 200;\r\n\tvar div = document.createElement('div');\r\n\tdiv.id = FLASH_MSG_ID;\r\n\tdiv.style.width = width + 'px';\r\n\tdiv.style.marginLeft = (-width / 2) + 'px'; // minus half the width, to center on pg\r\n\tdiv.className = 'cs_flashMsg';\r\n\tdiv.innerHTML = msg;\r\n\tdiv.onclick = close; // let user close it; probably not needed, but safe\r\n\tdocument.body.appendChild(div);\r\n\tsetTimeout(close, 2000); // kill msg after a while in case page isn't going to reload\r\n\t\r\n\tfunction close()\r\n\t{\r\n\t\tvar div = document.getElementById(FLASH_MSG_ID);\r\n\t\tif(div)\r\n\t\t\tdiv.parentNode.removeChild(div);\r\n\t}\r\n}\r\n\r\n/* start functions used by lightbox */\r\nfunction OnMouseDown(e)\r\n{\r\n\t// IE is retarded and doesn't pass the event object\r\n\tif (e == null) \r\n\t\te = window.event; \r\n   if(typeof e.stopPropagation!='undefined')\r\n      e.stopPropagation();\r\n   else\r\n      e.cancelBubble=true;\t\t\r\n\t// IE uses srcElement, others use target\r\n\tvar target = e.target != null ? e.target : e.srcElement;\r\n\tif (_debug)\r\n\t\t_debug.innerHTML = target.className == 'drag' \r\n\t\t? 'draggable element clicked' \r\n\t\t: 'NON-draggable element clicked';\r\n\ttarget = getDraggableTarget(target);\r\n\t// for IE, left click == 1\r\n\t// for Firefox, left click == 0\r\n\tif ((e.button == 1 && window.event != null || \r\n\t\te.button == 0) && target)\r\n\t{\r\n\t\t// grab the mouse position\r\n\t\t_startX = e.clientX;\r\n\t\t_startY = e.clientY;\r\n\t\t\r\n\t\t// grab the clicked element's position\r\n\t\t_offsetX = ExtractNumber(target.style.left);\r\n\t\t_offsetY = ExtractNumber(target.style.top);\r\n\t\t\r\n\t\t// bring the clicked element to the front while it is being dragged\r\n\t\t_oldZIndex = target.style.zIndex;\r\n\t\ttarget.style.zIndex = 10000;\r\n\t\t\r\n\t\t// we need to access the element in OnMouseMove\r\n\t\t_dragElement = target;\r\n\r\n\t\t// tell our code to start moving the element with the mouse\r\n\t\tdocument.onmousemove = OnMouseMove;\r\n\t\t\r\n\t\t// cancel out any text selections\r\n\t\tdocument.body.focus();\r\n\t\t\r\n\t\t// prevent text selection in IE\r\n\t\tdocument.onselectstart = function () { return false; };\r\n\t\t// prevent IE from trying to drag an image\r\n\t\ttarget.ondragstart = function() { return false; };\r\n\t\t\r\n\t\t// prevent text selection (except IE)\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nfunction OnMouseUp(e)\r\n{\r\n\tif (_dragElement != null)\r\n\t{\r\n\t\t_dragElement.style.zIndex = _oldZIndex;\r\n\r\n\t\t// we're done with these events until the next OnMouseDown\r\n\t\tdocument.onmousemove = null;\r\n\t\tdocument.onselectstart = null;\r\n\t\t_dragElement.ondragstart = null;\r\n\r\n\t\t// this is how we know we're not dragging\r\n\t\t_dragElement = null;\r\n\t\tif (_debug)\r\n\t\t\t_debug.innerHTML = 'mouse up';\r\n\t}\r\n}\r\n\r\nfunction OnMouseMove(e)\r\n{\r\n\tif (e == null) \r\n\t\tvar e = window.event; \r\n   if(typeof e.stopPropagation!='undefined')\r\n      e.stopPropagation();\r\n   else\r\n      e.cancelBubble=true;\t\t\t\t\r\n\r\n\t// this is the actual \"drag code\"\r\n\t_dragElement.style.left = (_offsetX + e.clientX - _startX) + 'px';\r\n\t_dragElement.style.top = (_offsetY + e.clientY - _startY) + 'px';\r\n\tif (_debug)\r\n\t\t_debug.innerHTML = '(' + _dragElement.style.left + ', ' + _dragElement.style.top + ')';\t\r\n}\r\n\r\nfunction ExtractNumber(value)\r\n{\r\n\tvar n = parseInt(value);\r\n\t\r\n\treturn n == null || isNaN(n) ? 0 : n;\r\n}\r\n\r\nfunction getDraggableTarget(obj)\r\n{\r\n\tif (obj.className.indexOf('drag') >= 0)\r\n\t\treturn obj;\r\n\tif (obj.offsetParent)\r\n\t{\t\r\n\t\twhile(obj=obj.offsetParent)\r\n\t\t{\r\n\t\t\tif (obj.className.indexOf('drag') >= 0)\r\n\t\t\t\treturn obj;\t\t\t\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n}\r\n/* END functions used by lightbox */\r\n\r\n// this function is duplicated in browser-all.js and util.js; if you change one, change the other!\r\nfunction BrowserCheck()\r\n{\r\n\tvar b = navigator.appName.toString();\r\n\tvar b_ver;\r\n\tvar up = navigator.platform.toString();\r\n\tvar ua = navigator.userAgent.toString().toLowerCase();\r\n\tvar re_opera = /Opera.([0-9\\.]*)/i;\r\n\tvar re_msie = /MSIE.([0-9\\.]*)/i;\r\n\tvar re_gecko = /gecko/i;\r\n\t// mozilla/5.0 (macintosh; u; intel mac os x 10_6_7; en-us) applewebkit/533.20.25 (khtml, like gecko) version/5.0.4 safari/533.20.27\r\n\tvar re_safari = /safari\\/([\\d\\.]*)/i;\r\n\tvar re_mozilla = /firefox\\/([\\d\\.]*)/i;\r\n\tvar re_chrome = /chrome\\/([\\d\\.]*)/i;\r\n\tvar ie_documentMode = 0;\r\n\tvar browserType = {};\r\n\tbrowserType.mozilla = browserType.ie = browserType.opera = r = false;\r\n\tbrowserType.version = (ua.match(/.+(?:rv|it|ra|ie|me)[\\/: ]([\\d.]+)/) || [])[1];\r\n\tbrowserType.chrome = /chrome/.test(ua);\r\n\tbrowserType.safari = /webkit/.test(ua) && !/chrome/.test(ua);\r\n\tbrowserType.opera = /opera/.test(ua);\r\n\tbrowserType.ie = /msie/.test(ua) && !/opera/.test(ua);\r\n\tbrowserType.mozilla = /mozilla/.test(ua) && !/(compatible|webkit)/.test(ua);\r\n\tbrowserType.ie_documentMode = 0;\r\n\t\r\n\tif (ua.match(re_opera))\r\n\t{\r\n\t    r = ua.match(re_opera);\r\n\t    browserType.version = parseFloat(r[1]);\r\n\t}\r\n\telse if (ua.match(re_msie))\r\n\t{\r\n\t    r = ua.match(re_msie);\r\n\t    browserType.version = parseFloat(r[1]);\r\n\t    ie_documentMode = browserType.version;\r\n\t    if (browserType.version <= 7)\r\n\t    {\r\n\t        re_ver = /trident\\/([\\d\\.]*)/i;\r\n\t        r = ua.match(re_ver);\r\n\t        // in IE compat mode, trident=4.0 (IE8), =5.0 (IE9), =6.0 (IE10) etc, i.e, version=trident+4.\r\n\t        if (r && parseFloat(r[1]) >= 4)\r\n\t        {\r\n\t            browserType.version = parseFloat(r[1]) + 4;\r\n\t            ie_documentMode = document.documentMode;\r\n\t        }\r\n\t    }\r\n\t}\r\n\telse if (browserType.safari && !browserType.chrome)\r\n\t{\r\n\t    re_ver = /version\\/([\\d\\.]*)/i;\r\n\t    if (ua.match(re_ver))\r\n\t    {\r\n\t        r = ua.match(re_ver);\r\n\t        browserType.version = parseFloat(r[1]);\r\n\t    }\r\n\t}\r\n\telse if (browserType.chrome)\r\n\t{\r\n\t    b_ver = ua.match(re_chrome);\r\n\t    r = b_ver[1].split('.');\r\n\t    browserType.version = parseFloat(r[0]);\r\n\t}\r\n\telse if (ua.match(re_gecko))\r\n\t{\r\n\t    var re_gecko_version = /rv:\\s*([0-9\\.]+)/i;\r\n\t    r = ua.match(re_gecko_version);\r\n\t    browserType.version = parseFloat(r[1]);\r\n\t    if (ua.match(re_mozilla))\r\n\t    {\r\n\t        r = ua.match(re_mozilla);\r\n\t        browserType.version = parseFloat(r[1]);\r\n\t    }\r\n\t}\r\n\telse if (ua.match(re_mozilla))\r\n\t{\r\n\t    r = ua.match(re_mozilla);\r\n\t    browserType.version = parseFloat(r[1]);\r\n\t}\r\n\tbrowserType.windows = browserType.mac = browserType.linux = false;\r\n\tbrowserType.Platform = ua.match(/windows/i) ? \"windows\" : (ua.match(/linux/i) ? \"linux\" : (ua.match(/mac/i) ? \"mac\" : ua.match(/unix/i) ? \"unix\" : \"unknown\"));\r\n\tthis[browserType.Platform] = true;\r\n\tbrowserType.v = browserType.version;\r\n\tbrowserType.valid = browserType.ie && browserType.v >= 6 || browserType.mozilla && browserType.v >= 1.4 || browserType.safari && browserType.v >= 5 || browserType.chrome && browserType.v >= 12;\r\n\tbrowserType.okToAuthor = (browserType.ie && browserType.v >= 8 && ie_documentMode >= 7) || browserType.mozilla && browserType.v >= 3.6 || browserType.safari && browserType.v >= 5 || browserType.chrome && browserType.v >= 12;\r\n\tbrowserType.ie_documentMode = ie_documentMode;\r\n\treturn browserType;\r\n};\r\n\r\n// make sure we have our namespace\r\n// must be called AFTER code to relocate if not in dashboard, if that's used\r\nvar commonspot = window.commonspot || parent.commonspot || {};\r\n\r\n/**\r\n * commonspot.util: utility package\r\n */\r\nif(typeof commonspot.util == 'undefined')\r\n{\r\n\tcommonspot.util = {};\r\n\t\r\n\tcommonspot.util.browser = BrowserCheck();\t\r\n\r\n\tcommonspot.util.checkDashboard = function()\r\n\t{\r\n\t\treturn (typeof(commonspot.lview) != 'undefined');\r\n\t}\r\n\t\r\n\t/**\r\n\t * Encode string properly for html charactor\r\n\t * @return string\r\n\t */\r\n\tcommonspot.util.encodeString = function(str)\r\n\t{\t\r\n\t\tvar regExp = /&amp;#39;|&amp;amp;|&amp;nbsp;|&lt;br \\/&gt;&lt;br \\/&gt;/;\r\n\t\t  \t\r\n\t\tif (str && str.search(regExp) != -1)\t\t\r\n\t\t{ \r\n\t\t\tstr = str.replace(/&amp;amp;/, '&amp;');\r\n\t\t\tstr = str.replace(/&amp;#39;/, '&#39;');  \r\n\t\t\tstr = str.replace(/&amp;nbsp;/, '&nbsp;'); \r\n\t\t\tstr = str.replace(/&lt;br \\/&gt;&lt;br \\/&gt;/, ' '); \t\t\r\n\t\t}  \t\r\n\t\t\t \r\n\t\treturn str;\r\n\t};\r\n\t\t\r\n\t/**\r\n\t * Escape special XML characters with the equivalent entities\r\n\t * @return string\r\n\t */\r\n\tcommonspot.util.encodeXmlEntities = function(str)\r\n\t{\r\n\t\tif(str && str.search(/[&<>\"]/) != -1)\r\n\t\t{\r\n\t\t\tstr = str.replace(/&/g, '&amp;');\r\n\t\t\tstr = str.replace(/</g, '&lt;');\r\n\t\t\tstr = str.replace(/>/g, '&gt;');\r\n\t\t\tstr = str.replace(/\"/g, '&quot;');\r\n\t\t}\r\n\t\t// dmerrill 3/12/09: don't know why we do this, not xml spec\r\n\t\treturn encodeURIComponent(str);\r\n\t};\r\n\t\t\r\n\t/**\r\n\t * format a std commonspot date (yyyy-mm-dd hh:mm:ss) for display as a date only\r\n\t * default format is yyyy-mm-dd\r\n\t * if USFormat is true, returns it as mm/dd/yyyy\r\n\t */\r\n\tcommonspot.util.formatCSDate = function(csDateStr, USFormat)\r\n\t{\r\n\t   if(!csDateStr)\r\n\t      return;\r\n\t\tif(USFormat)\r\n\t\t{\r\n\t\t\tvar aDateParts = csDateStr.split(/[- :]/);\r\n\t\t\tif(aDateParts.length < 3)\r\n\t\t\t\tthrow(\"[formatCSDate(USFormat)] invalid date: \" + csDateStr);\r\n\t\t\treturn aDateParts[1] + \"/\" + aDateParts[2] + \"/\" + aDateParts[0];\r\n\t\t}\r\n\t\treturn csDateStr.substr(0, 10);\r\n\t};\r\n\t\r\n\t/**\r\n\t * for ea passed field in passed object, creates a new field w orig fld value converted to std date format\r\n\t * @param row (object): object to process\r\n\t * \t\tit's assumed to contain each of the fields in dateFieldsList, ea w date data\r\n\t * @param dateFieldsList (string): comma-delimited list of fields to process\r\n\t * @param fieldNameSuffix (string): appended to end of processed fld name to create name of formated fld\r\n\t * \tif not passed, '_display' is used\r\n\t * \tto overwrite orig fld w formatted version, pass ''\r\n\t */\r\n\tcommonspot.util.formatCSDateFields = function(obj, dateFieldsList, fieldNameSuffix)\r\n\t{\r\n\t\tif(!fieldNameSuffix)\r\n\t\t\tfieldNameSuffix = '_display';\r\n\t\tvar aDateFlds = dateFieldsList.split(',');\r\n\t\tfor(var i = 0; i < aDateFlds.length; i++)\r\n\t\t\tobj[aDateFlds[i] + fieldNameSuffix] = commonspot.util.formatCSDate(obj[aDateFlds[i]]);\r\n\t};\r\n\t\r\n\t\r\n\t/*\r\n\t * @return object: returns an object with values from url hash, interpreted as query string format\r\n\t */\r\n\tcommonspot.util.getHashArgs = function()\r\n\t{\r\n\t\tvar argStr = document.location.hash.replace(/^#+/, ''); // strip all leading #\r\n\t\tif (!argStr.toQueryParams)\r\n\t\t\treturn null;\r\n\t\tvar args = argStr.toQueryParams();\r\n\t\targs.qstring = window.location.search;\r\n\t\tif (args.mode)\r\n\t\t\targs.mode = args.mode.toLowerCase();\r\n\t\treturn args;\r\n\t};\r\n\t\r\n\tcommonspot.util.getObjFieldLCase = function(obj, name)\r\n\t{\r\n\t\tif (name)\r\n\t\t\treturn obj[name.toLowerCase()];\r\n\t\telse\r\n\t\t\treturn null;\r\n\t};\r\n\r\n\t// return true if any item in permissionNeededList is in permissionList\r\n\tcommonspot.util.hasAnyPermission = function(permissionNeededList, permissionList)\r\n\t{\r\n\t\tif( (!permissionNeededList) || (!permissionList) )\r\n\t\t\treturn false;\t\t\t\r\n\t\t\t\r\n\t\taPermsNeeded = permissionNeededList.toLowerCase().split(',');\r\n\t\taPermsYouHave = permissionList.toLowerCase().split(',');\r\n\t\t\r\n\t\tfor(var i = 0; i < aPermsNeeded.length; i++)\r\n\t\t{\r\n\t\t\tif(aPermsYouHave.indexOf(aPermsNeeded[i]) != -1) \r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\t\t\r\n\t\r\n\t/*\r\n\t * returns true if passed array or object has members\r\n\t */\r\n\tcommonspot.util.hasMembers = function(obj)\r\n\t{\r\n\t\tfor(var f in obj)\r\n\t\t{\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\tif(obj.hasOwnProperty(f))\r\n\t\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcatch(e)\r\n\t\t\t{\r\n\t\t\t\treturn false;\t\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Return boolean (true/false) as per the permission.\r\n\t */\t\r\n\tcommonspot.util.hasPermission = function(permission, permissionList)\r\n\t{\r\n\t\tif( ! permissionList )\r\n\t\t\treturn false;\t\t\t\r\n\t\t\t\r\n\t\tpermissionList = ',' + permissionList.toLowerCase() + ',';\r\n\t\treturn (permissionList.indexOf(',' + permission.toLowerCase() + ',') != -1)\r\n\t};\r\n\r\n\t/*\r\n\t * adds members of src to dest, returning dest\r\n\t * overwrites existing members if overwrite is true\r\n\t * ignores prototype members of either src or dest\r\n\t * \tmeans it won't copy from src prototype, and it will overwrite dest prototype members\r\n\t */\r\n\tcommonspot.util.merge = function(dest, src, overwrite, lcaseDestField)\r\n\t{\r\n\t\tvar destFld;\r\n\t\tfor(var fld in src)\r\n\t\t{\r\n\t\t\tdestFld = lcaseDestField ? fld.toLowerCase() : fld;\r\n\t\t   if(src.hasOwnProperty(fld) && (overwrite || (!dest.hasOwnProperty(destFld)) || dest[destFld] === null))\r\n\t\t      dest[destFld] = src[fld];\r\n\t\t}\r\n\t\treturn dest;\r\n\t};\r\n\t\r\n\t/*\r\n\t * pads passed value to a minimum of len chars; no effect if it's already that long or more\r\n\t */\r\n\tcommonspot.util.pad = function (val, len)\r\n\t{\r\n\t\tval = String(val);\r\n\t\tlen = len || 2;\r\n\t\twhile (val.length < len) val = \"0\" + val;\r\n\t\treturn val;\r\n\t};\r\n\t\t\r\n\t/**\r\n\t * commonspot.util.plural\r\n\t * returns a string with passed count, a space, and count-appropriate form of noun\r\n\t * @see \\cs\\devdocs\\javascript-function-docs.js\r\n\t */\r\n\tcommonspot.util.plural = function(count, noun, specialPlural, specialZero)\r\n\t{\r\n\t\tswitch(count)\r\n\t\t{\r\n\t\t\tcase 0:\r\n\t\t\t\treturn count + \" \" + (specialZero || specialPlural || (noun + \"s\"));\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1:\r\n\t\t\t\treturn count + \" \" + noun;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\treturn count + \" \" + (specialPlural || (noun + \"s\"));\r\n\t\t}\r\n\t};\r\n\t\t\r\n\tcommonspot.util.setOptions = function(dest, src)\r\n\t{\r\n\t\tfor(var fld in src)\r\n\t\t\tdest[fld] = src[fld];\r\n\t};\r\n\t\t\t\t\t\t\t\r\n\t\r\n\t/*\r\n\t * converts a date, or a string parsable as one, to commonspot's std yyyy-mm-dd hh:mm:ss format\r\n\t * rtns commonspot.err.INVALID_DATE_TOKEN if not a valid date\r\n\t */\r\n\tcommonspot.util.toCSDateFormat = function(date)\r\n\t{\r\n\t\tdate = new Date(date); // applies Date.parse if necessary\r\n\t\tif(isNaN(date))\r\n\t\t\treturn commonspot.err.INVALID_DATE_TOKEN;\r\n\t\treturn\tdate.getFullYear() + \"-\" +\r\n\t\t\t\t\tcommonspot.util.pad((date.getMonth() + 1)) + \"-\" +\r\n\t\t\t\t\tcommonspot.util.pad(date.getDay()) + \" \" +\r\n\t\t\t\t\tcommonspot.util.pad(date.getHours()) + \":\" +\r\n\t\t\t\t\tcommonspot.util.pad(date.getMinutes()) + \":\" +\r\n\t\t\t\t\tcommonspot.util.pad(date.getSeconds());\r\n\t};\r\n\r\n\t/**\r\n\t * Return true if a given object is an array\r\n\t * @return boolean\r\n\t * technique used in the next few functions is known as the Miller Device; see here:\r\n\t * \thttp://blog.360.yahoo.com/blog-TBPekxc1dLNy5DOloPfzVvFIVOWMB0li?p=916\r\n\t * obj.constructor === Array and similar fails in multi-window/multi-frame environment\r\n\t */\r\n\tcommonspot.util.isArray = function(obj)\r\n\t{\r\n\t\treturn obj && Object.prototype.toString.apply(obj) === \"[object Array]\";\r\n\t};\r\n\tcommonspot.util.isDate = function(obj)\r\n\t{\r\n\t\treturn obj && (Object.prototype.toString.apply(obj) === \"[object Date]\");\r\n\t}\r\n\tcommonspot.util.isValidDate = function(obj)\r\n\t{\r\n\t\treturn obj && commonspot.util.isDate(obj) && !(isNaN(obj));\r\n\t}\r\n\tcommonspot.util.getObjectClass = function(obj)\r\n\t{\r\n\t\tvar classStr = Object.prototype.toString.apply(obj); // \"[object Array]\", \"[object String]\", etc\r\n\t\treturn classStr.substring(8, classStr.length - 1); // \"Array\", \"String\", etc\r\n\t};\r\n\t\r\n\tcommonspot.util.arrayTest = function(_this, item, from)\r\n\t{\r\n\t   //return cs_utility.array.arrayIndexOf(_this,item,from)!=-1;\r\n\t   return _this.indexOf(item, from)!=-1;\r\n\t};\r\n\t\r\n\t/**\r\n\t * given an array of objects and the name of a keyFld, returns an object...\r\n\t * ...whose keys are the values in keyFld and whose values are the corresponding objects\r\n\t * @param objArr (array): array of objects to examine\r\n\t * @param keyFld (string): name of fld to look for in each object; values become keys in result object\r\n\t */\r\n\tcommonspot.util.objectArrayToObject = function(objArr, keyFld)\r\n\t{\r\n\t\tvar i, keyValue;\r\n\t\tvar obj = {};\r\n\t\tfor(var i = 0; i < objArr.length; i++)\r\n\t\t{\r\n\t\t\tkeyValue = objArr[i][keyFld];\r\n\t\t\tif(typeof keyValue != 'undefined')\r\n\t\t\t\tobj[keyValue] = objArr[i];\r\n\t\t}\r\n\t\treturn obj;\r\n\t};\r\n\t\r\n\t/**\r\n\t * returns a new object that's a by-value copy of passed one\r\n\t * USAGE: foo = new commonspot.util.cloneObject(someObject);\r\n\t */\r\n\tcommonspot.util.cloneObject = function (obj)\r\n\t{\r\n\t\tfor (i in obj)\r\n\t\t\tthis[i] = obj[i];\r\n\t};\r\n\t\r\n\t/**\r\n\t * Return a random integrer\r\n\t * @return integer\r\n\t */\r\n\tcommonspot.util.generateRandomInt = function()\r\n\t{\r\n\t\treturn Math.floor(Math.random() * 100000);\r\n\t};\r\n\r\n\tcommonspot.util.getFileSizeHtml = function(fileSize)\r\n\t{\r\n\t\tif (fileSize < 1024)\r\n\t\t\treturn fileSize + ' bytes';\r\n\t\t\t\r\n\t\tvar value = fileSize % 1024;\r\n\r\n\t\tif (value > 0)\r\n\t\t\treturn (fileSize / 1024).toFixed(2) + ' KB';\r\n\t\t\t\r\n\t\treturn (fileSize / 1024) + ' KB';\r\n\t};\r\n\t\r\n\tcommonspot.util.calcPreviewImgProp = function(origWidth, origHeight, maxWidth, maxHeight)\r\n\t{\r\n\t\tvar isScaled = false;\r\n\t\tvar newW = origWidth;\r\n\t\tvar newH = origHeight;\r\n\t\t\t\t\r\n\t\tif ((origWidth >= maxWidth) || (origHeight >= maxHeight))\r\n\t\t{\r\n\t\t\tvar ratioW = maxWidth / origWidth;\r\n\t\t\tvar ratioH = maxHeight / origHeight;\r\n\t\t\tvar ratio = Math.min(ratioW,ratioH);\r\n\t\r\n\t\t\tnewW = Math.max(Math.round(origWidth * ratio), 1);\t\t \r\n\t\t\tnewH = Math.max(Math.round(origHeight * ratio), 1);\t\t\t\t\r\n\t\r\n\t\t\tisScaled = true;\r\n\t\t}\t\t\r\n\t\r\n\t\tvar imgProp = {width: newW,\r\n\t\t\t\t\t\t\theight: newH,\r\n\t\t\t\t\t\t\tisScaled: isScaled}\r\n\t\t\t\t\t\t\t\t\r\n\t\treturn imgProp;\r\n\t};\r\n\t\r\n\t/*\r\n\t * rtns html dump of passed obj\r\n\t */\r\n\tcommonspot.util.getDumpHTML = function(obj, caption)\r\n\t{\r\n\t\tvar html = \"\";\r\n\t\tif(obj == undefined)\r\n\t\t\thtml = \"Object is undefined.\"\r\n\t\telse if(obj == null)\r\n\t\t\thtml = \"Object is null.\"\r\n\t\telse if(typeof obj == \"function\")\r\n\t\t\thtml = \"[function]\";\r\n\t\telse if(typeof obj !== \"object\" || commonspot.util.isDate(obj))\r\n\t\t\thtml = obj.toString().escapeHTML();\r\n\t\telse if(commonspot.util.isArray(obj))\r\n\t\t{\r\n\t\t\tvar getDumpHTML = commonspot.util.getDumpHTML;\r\n\t\t\tvar len = obj.length;\r\n\t\t\thtml = '<table class=\"dumpTable\">';\r\n\t\t\tif(caption)\r\n\t\t\t\thtml += \"<caption>\" + caption +\"</caption>\";\r\n\t\t\tfor(var i = 0; i < len; i++)\r\n\t\t\t\thtml += \"<tr><td>\" + i + \"</td><td>\" + getDumpHTML(obj[i]) + \"</td></tr>\";\r\n\t\t\thtml += \"</table>\";\r\n\t\t}\r\n\t\telse // object\r\n\t\t{\r\n\t\t\tvar getDumpHTML = commonspot.util.getDumpHTML;\r\n\t\t\thtml = '<table class=\"dumpTable\">';\r\n\t\t\tif(caption)\r\n\t\t\t\thtml += \"<caption>\" + caption +\"</caption>\";\r\n\t\t\tfor(var key in obj)\r\n\t\t\t\thtml += \"<tr><td>\" + key + \"</td><td>\" + getDumpHTML(obj[key]) + \"</td></tr>\";\r\n\t\t\thtml += \"</table>\";\r\n\t\t}\r\n\t\treturn html;\r\n\t};\r\n\t\r\n\tcommonspot.util.repeatString = function(str, count)\r\n\t{\r\n\t\tvar t = \"\";\r\n\t\tfor(var i = 1; i <= count; i++)\r\n\t\t\tt += str;\r\n\t\treturn t;\r\n\t};\r\n\t\r\n\tcommonspot.util.jsSafe = function(str) // escape same chars as cf's JSStringFormat function\r\n\t{\r\n\t\treturn str.replace(/(['\"\\\\\\b\\t\\n\\f\\r])/g, function(chr){return \"\\\\\" + commonspot.util.jsSafe.chars[chr.charCodeAt(0)];})\r\n\t};\r\n\tcommonspot.util.jsSafe.chars = \r\n\t{\r\n\t     8: \"b\",\t// backspace\r\n\t     9: \"t\",\t// tab\r\n\t    10: \"n\",\t// newline\r\n\t    12: \"f\",\t// formfeed\r\n\t    13: \"r\",\t// carriage return\r\n\t    34: '\"',\t// dbl quote\r\n\t    39: \"'\",\t// single quote\r\n\t    92: \"\\\\\"\t// backslash\r\n\t};\r\n\t\r\n\t// returns str with tokens in the form {key} replaced by the value of data[key]\r\n\t// if key isn't found in data, returns original token\r\n\t// key can contain only alphanumeric characters and underscores\r\n\tcommonspot.util.replaceTokens = function(str, data)\r\n\t{\r\n\t\treturn str.replace\r\n\t\t(\r\n\t\t\t/{(\\w+)}/g,\r\n\t\t\tfunction(fullMatch, key) // key is portion of match inside (), ie inside {} within str\r\n\t\t\t{\r\n\t\t\t\treturn (typeof data[key] === \"undefined\") ? fullMatch : data[key];\r\n\t\t\t}\r\n\t\t);\r\n\t};\r\n\t\r\n\t/**\r\n\t * commonspot.util.cookie: package for cookie-related utilities\r\n\t */\r\n\tcommonspot.util.cookie = {};\r\n\t\t\r\n\tcommonspot.util.cookie.createCookie = function(name,value,days)\r\n\t{\r\n\t\tif(days)\r\n\t\t{\r\n\t\t\tvar date = new Date();\r\n\t\t\tdate.setTime(date.getTime() + (days*24*60*60*1000));\r\n\t\t\tvar expires = \"; expires=\" + date.toGMTString();\r\n\t\t}\r\n\t\telse \r\n\t\t\tvar expires = \"\";\r\n\t\tdocument.cookie = name + \"=\" + value + expires + \"; path=/\";\t\t\t\r\n\t};\r\n\t\r\n\tcommonspot.util.cookie.readCookie = function(name)\r\n\t{\r\n\t\tvar nameEQ = name + \"=\";\r\n\t\tvar ca = document.cookie.split(';');\r\n\t\tfor (var i=0; i < ca.length; i++)\r\n\t\t{\r\n\t\t\tvar c = ca[i];\r\n\t\t\twhile (c.charAt(0) == ' ')\r\n\t\t\t{\r\n\t\t\t\tc = c.substring(1,c.length);\r\n\t\t\t}\r\n\t\t\tif (c.indexOf(nameEQ) == 0)\r\n\t\t\t{\r\n\t\t\t\treturn c.substring(nameEQ.length,c.length);\r\n\t\t\t}\t\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\t\r\n\tcommonspot.util.cookie.eraseCookie = function(name)\r\n\t{\r\n\t\tcommonspot.util.cookie.createCookie(name,\"\",-1);\r\n\t};\r\n\t\r\n\t/**\r\n\t * commonspot.util.dom: package for dom-related utilities\r\n\t */\r\n\tcommonspot.util.dom = {};\r\n\t\r\n\t/*\r\n\tencapsulation of dom createElement\r\n\tobjType, objID, objClass, objTitle, objHTML, objParent, objOnClick, objRefBefore, objRefAfter\r\n\t*/\t\r\n\tcommonspot.util.dom.addToDom = function(args)\r\n\t{\r\n\t\tvar dom = document.createElement(args.objType);\r\n\t\tif (args.objID)\r\n\t\t\tdom.id = args.objID;\r\n\t\tif (args.objTitle)\r\n\t\t\tdom.title = args.objTitle;\r\n\t\tif (args.objClass)\r\n\t\t\tdom.className = args.objClass;\r\n\t\tif (args.objHTML)\r\n\t\t\tdom.innerHTML = args.objHTML;\t\r\n\t\tif (args.objRefBefore)\r\n\t\t\targs.objParent.insertBefore(dom, args.objRefBefore);\r\n\t\telse if (args.objRefAfter){} // not implemented\r\n\t\telse\t\t\r\n\t\t\targs.objParent.appendChild(dom);\r\n\t\tif (args.objOnClick)\r\n\t\t\tcommonspot.util.event.addEvent(dom, \"click\", args.objOnClick);\r\n\t\treturn dom;\t\r\n\t}\r\n\t/**\r\n\t * commonspot.util.dom.getWinScrollSize: returns actual content size of given window; \r\n\t * @param win (object): window object. if not supplied returns value for current window\r\n\t * @return {width, height}\r\n\t */\t\r\n\tcommonspot.util.dom.getWinScrollSize = function()\r\n\t{\r\n\t\tvar sWidth=0, sHeight=0;\r\n\t\tvar winSize = commonspot.util.dom.getWinSize();\r\n\t\tvar win = self;\r\n\t\tif (win.document.body.clientHeight)\r\n\t\t{\r\n\t\t\tsHeight = win.document.body.clientHeight;\r\n\t\t\tsWidth = win.document.body.clientWidth;\r\n\t\t}\t\r\n\t\telse if (win.document.height)\r\n\t\t{\r\n\t\t\tsHeight = win.document.height;\r\n\t\t\tsWidth = win.document.width;\r\n\t\t}\r\n\t\treturn {width: Math.max(sWidth,winSize.width), height: Math.max(sHeight,winSize.height)};\r\n\t};\r\n\t\r\n\t/**\r\n\t * commonspot.util.dom.getWinSize: returns inner size of current window; from PPK\r\n\t * @return {width, height}\r\n\t */\r\n\tcommonspot.util.dom.getWinSize = function()\r\n\t{\r\n\t\tvar width, height;\r\n\t\tif (self.innerHeight) // all except Explorer\r\n\t\t{\r\n\t\t\twidth = self.innerWidth;\r\n\t\t\theight = self.innerHeight;\r\n\t\t}\r\n\t\telse if (document.documentElement && document.documentElement.clientHeight) // Explorer 6 Strict Mode\r\n\t\t{\r\n\t\t\twidth = document.documentElement.clientWidth;\r\n\t\t\theight = document.documentElement.clientHeight;\r\n\t\t}\r\n\t\telse if (document.body) // other Explorers\r\n\t\t{\r\n\t\t\twidth = document.body.clientWidth;\r\n\t\t\theight = document.body.clientHeight;\r\n\t\t}\r\n\t\treturn {width: width, height: height};\r\n\t};\r\n\t\r\n\t/**\r\n\t * removes all child nodes from passed obj\r\n\t * needed because IE won't directly set innerHTML of some tags\r\n\t * \r\n\t * @param obj (object): object to remove all children from\r\n\t */\r\n\tcommonspot.util.dom.removeAllChildren = function(obj)\r\n\t{\r\n\t\twhile(obj.firstChild)\r\n\t\t\tobj.removeChild(obj.firstChild);\r\n\t};\r\n\t\r\n\t/**\r\n\t * finds tag w requested name further up in dom hierarchy from passed obj\r\n\t * \r\n\t * @param obj (dom node): object to find an ancestor of\r\n\t * @param tagName (string): tag name to find\r\n\t * \tnot case sensitive\r\n\t * \twon't find body or anything above there; those are singletons w simpler ways to find them\r\n\t * @param level (int, optional): if passed, return level'th matching ancestor, not just first one\r\n\t */\r\n\tcommonspot.util.dom.getAncestorTag = function(obj, tagName, level)\r\n\t{\r\n\t\tif(!obj || !obj.parentNode)\r\n\t\t\treturn null;\r\n\t\t\t\r\n\t\ttagName = tagName.toUpperCase();\r\n\t\tif(typeof level == 'undefined')\r\n\t\t\tlevel = 1;\r\n\t\t\r\n\t\tvar tag = obj.parentNode;\r\n\t\tvar curLevel = 0;\r\n\t\t\r\n\t\twhile((tag.nodeName != tagName || curLevel < level) && tag.parentNode && tag.parentNode.nodeName != 'BODY')\r\n\t\t{\r\n\t\t\ttag = tag.parentNode;\r\n\t\t\tif(tag.nodeName == tagName)\r\n\t\t\t\tcurLevel++;\r\n\t\t}\r\n\t\t\r\n\t\tif(tag.nodeName != tagName || curLevel < level)\r\n\t\t\ttag = null;\r\n\t\treturn tag;\r\n\t};\r\n\t\r\n\t/**\r\n\t * returns elements w passed className inside element w passed id.\r\n\t * homegrown because Prototype 1.5's getElementsBySelector seems broken in IE7.\r\n\t * @param id (string): id of element to look inside\r\n\t * @param className (string): className to look for\r\n\t * @param tagName (string, optional): if passed, looks only at tags w this name \r\n\t * @param getAll (boolean, optional): if true, return array of all found elements, otherwise, return first one\r\n\t */\r\n\tcommonspot.util.dom.getChildrenByClassName = function(id, className, tagName, getAll)\r\n\t{\r\n\t\tvar results = [];\r\n\t\tvar classMatchRegex = new RegExp(\"(^|\\\\s)\" + className + \"(\\\\s|$)\");\r\n\t\tvar tags = document.getElementById(id).getElementsByTagName(tagName || '*');\r\n\t\tfor(var i = 0; i < tags.length; i++)\r\n\t\t{\r\n\t\t\tif(tags[i].className == className || tags[i].className.match(classMatchRegex))\r\n\t\t\t{\r\n\t\t\t\tif(getAll)\r\n\t\t\t\t\tresults.push(tags[i]);\r\n\t\t\t\telse\r\n\t\t\t\t\treturn tags[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\t// if looking for single element and found none, rtn null; w/o this, rtns an empty array\r\n\t\t// when geAll=true we always rtn an array\r\n\t\t// when it's not, rtn a dom object, or something analogous to \"no dom object\", and tests false if you do if(domObj)\r\n\t\tif((!getAll) && (results.length === 0))\r\n\t\t\treturn null;\r\n\t\treturn results;\r\n\t};\r\n\t\r\n\t/*\r\n\t* get all editable fields of the form\r\n\t*/\r\n\tcommonspot.util.dom.findAllFields = function(iform,includeHidden) {\t\r\n\t\tvar arr = [];\r\n\t\tvar elements = iform.elements;\t\r\n\t\tvar element;\r\n\t\tvar omitList = 'button,submit,reset';\r\n\t\tvar includeHidden = (typeof includeHidden != 'undefined') ? includeHidden : 1;\r\n\t\tif (includeHidden != 1)\r\n\t\t\tomitList += ',hidden';\r\n\t\tfor (var i=0; i<elements.length; i++)\r\n\t\t{\r\n\t\t\telement = elements[i];\r\n\t\t\t// get rid of bad apples first\r\n\t\t\tif((omitList).indexOf(element.type)>=0)\r\n\t\t\t\tcontinue;\r\n\t\t\tif (element.disabled || element.readOnly)\r\n\t\t\t\tcontinue;\r\n\t\t\tarr.push(element);\t\t\r\n\t\t}\r\n\r\n\t\treturn arr;\r\n\t};\r\n\r\n\t/*\r\n\t* activate all editable fields of the form\r\n\t*/\t\r\n\tcommonspot.util.dom.activateAllFields = function(iform) {\t\r\n\t\tvar elements = commonspot.util.dom.findAllFields(iform);\r\n\t\tvar curFld;\r\n\r\n\t\tfor (var i=0; i< elements.length; i++)\r\n\t\t{\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\tcurFld = eval(iform + '.' + elements[i]);\r\n\t\t\t\tif (curFld)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (curFld.activate)\r\n\t\t\t\t\t\tcurFld.activate();\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tcurFld.focus();\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcatch (ex) {}\t\r\n\t\t}\r\n\t};\r\n\t\r\n\t/*\r\n\t* Finds the first editable, non-disabled, non-hidden form field excluding buttons to set focus.\r\n\t* Takes a form as single argument. \r\n\t* This is an enhanced version of prototype's \"findFirstElement\" function\r\n\t*/\r\n\tcommonspot.util.dom.findFirstEditableField = function(iform) {\r\n\t\tvar firstByIndex = null;\r\n\r\n\t\tvar elements = commonspot.util.dom.findAllFields(iform);\r\n\t\ttry\r\n\t\t{\r\n\t\t\tif (elements.findAll)\r\n\t\t\t{\r\n\t\t\t\tfirstByIndex = elements.findAll(function(element) \r\n\t\t\t\t{\r\n\t\t\t\t  return element.hasAttribute('tabIndex') && element.tabIndex >= 0;\r\n\t\t\t\t}).sortBy(function(element) { return element.tabIndex }).first();\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch(e){}\r\n\t\treturn firstByIndex ? firstByIndex : arr[0];\r\n  \t};\r\n\t\t\r\n\t/**\r\n\t * commonspot.util.css: package for event-related utilities \r\n\t * we only need this addEvent function so adding it here instead of importing event package of prototype\r\n\t */\t\r\n\r\n\t\r\n\tcommonspot.util.event = {};\r\n\t\r\n\t/**\r\n\t*\tIrons out the IE and FF differences. Ideally we should use W3C model addEventListener,\r\n\t*\tie, when IE agrees with it\r\n\t*/\r\n\tcommonspot.util.event.addEvent = function( dObj, type, fn ) \r\n\t{\r\n\t\tif (dObj.addEventListener) \r\n\t\t{\r\n\t\t\tdObj.addEventListener( type, fn, false );\r\n\t\t\t//EventCache.add(dObj, type, fn, 1);\r\n\t\t}\r\n\t\telse if (dObj.attachEvent) \r\n\t\t{\r\n\t\t\tdObj[\"e\"+type+fn] = fn;\r\n\t\t\tdObj[type+fn] = function() \r\n\t\t\t{ \r\n\t\t\t\tdObj[\"e\"+type+fn]( window.event ); \r\n\t\t\t}\r\n\t\t\tdObj.attachEvent( \"on\"+type, dObj[type+fn] );\r\n\t\t\tEventCache.add(dObj, type, fn, 1);\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\tdObj[\"on\"+type] = dObj[\"e\"+type+fn];\r\n\t\t}\r\n\t};\r\n\t\r\n\t/**\r\n\t * commonspot.util.css: package for css-related utilities\r\n\t */\r\n\tcommonspot.util.css = {};\r\n\r\n\tcommonspot.util.css.addRemoveClassNameByIDs = function(objIDsList, className, add)\r\n\t{\r\n\t\tvar lightboxWindow = top.commonspot.lightbox.getCurrentWindow();\r\n\t\tvar objIDs = objIDsList.split(\",\");\r\n\t\tvar objs = lightboxWindow.$.apply(lightboxWindow, objIDs);\r\n\t\tif(objs)\r\n\t\t{\r\n\t\t\tif(objs.nodeName) // single element\r\n\t\t\t\tobjs = [objs];\r\n\t\t\tobjs.each(function(elem, index)\r\n\t\t\t{\r\n\t\t\t\tif(!elem)\r\n\t\t\t\t\tthrow new Error(\"[addRemoveClassNameByIDs] Element with ID '\" + objIDs[index] + \"' can't be found.\");\r\n\t\t\t\telse if(add)\r\n\t\t\t\t\telem.addClassName(className);\r\n\t\t\t\telse\r\n\t\t\t\t\telem.removeClassName(className);\r\n\t\t\t});\r\n\t\t}\r\n\t\telse // oops, bad objIDsList\r\n\t\t\tthrow new Error(\"[addRemoveClassNameByIDs] Unable to find objects with the following IDs: \" + objIDsList);\r\n\t};\r\n\t\t\r\n\t\t\r\n\t/**\r\n\t * commonspot.util.css.showHideCSSClass: shows or hides a css class\r\n\t */\r\n\tcommonspot.util.css.showHideCSSClass = function(show, stylesheetID, targetClass)\r\n\t{\r\n\t\tvar display = show ? '' : 'none';\r\n\t\tcommonspot.util.css.setStyleRuleProperty(stylesheetID, targetClass, 'display', display);\r\n\t};\r\n\t\r\n\t/**\r\n\t*\r\n\t*/\r\n\tcommonspot.util.css.setHideForMenusForAllFrames = function(stylesheetID, targetClass, propertyName, value, win)\r\n\t{\r\n\t\tvar cWin;\r\n\t\tvar win = win ? win : window;\r\n\t\tvar arrayWindows = [];\r\n\t\tvar iFrames = win.document.getElementsByTagName('iframe');\r\n\t\tfor (var i =0; i<iFrames.length; i++)\r\n\t\t{\r\n\t\t\tcWin = iFrames[i].contentWindow;\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\tif (cWin && cWin.document)\r\n\t\t\t\t\tarrayWindows[i] = cWin;\r\n\t\t\t}\r\n\t\t\tcatch(e){};\t\t\r\n\t\t}\r\n\t\t\r\n\t\tif (win.document)\r\n\t\t\tarrayWindows[iFrames.length] = win;\r\n\t\tfor (i=0; i<arrayWindows.length; i++)\r\n\t\t{\t\r\n\t\t\tcommonspot.util.css.setStyleRuleProperty(stylesheetID, targetClass, propertyName, value, arrayWindows[i]);\r\n\t\t}\t\r\n\t};\t\r\n\t\r\n\t\r\n\r\n\t\r\n\t/**\r\n\t * commonspot.util.css.setStyleRuleProperty: sets a requested property of a stylesheet class\r\n\t */\r\n\tcommonspot.util.css.setStyleRuleProperty = function(stylesheetID, targetClass, propertyName, value, win)\r\n\t{\t\r\n\t \t// note that propertyNames need to use their js-style names, ie, 'whiteSpace', not 'white-space'\r\n\t\tvar cssRules, ruleIndex;\r\n\t\tvar doc = win ? win.document : document;\r\n\t\tvar ss = doc.getElementById(stylesheetID);\r\n\t\tif(!ss)\r\n\t\t\treturn;\r\n\t\tif(!ss.sheet) // IE\r\n\t\t{\r\n\t\t\tss = doc.styleSheets[stylesheetID];\r\n\t\t\tcssRules = doc.styleSheets[stylesheetID].rules;\r\n\t\t}\r\n\t\telse // Firefox\r\n\t\t{\r\n\t\t\tcssRules = ss.sheet.cssRules;\r\n\t\t}\r\n\t\truleIndex = getCSSRuleIndex(cssRules, '.' + targetClass);\r\n\t\tif(ruleIndex != null)\r\n\t\t{\r\n\t\t\tcssRules[ruleIndex].style[propertyName] = value;\r\n\t\t}\r\n\t\treturn;\r\n\t\r\n\t\tfunction getCSSRuleIndex(cssRules, selectorText)\r\n\t\t{\r\n\t\t\tfor(var i = 0; i < cssRules.length; i++)\r\n\t\t\t{\r\n\t\t\t\tif(cssRules[i].selectorText == selectorText)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\t\r\n\tcommonspot.util.css.hideForMenus = function(hide) \r\n\t{\r\n\t\tvar prop=hide ? 'hidden' : 'visible';\r\n\t\tcommonspot.util.css.setStyleRuleProperty('cs_maincss','cpHideForMenus','visibility',prop);\r\n\t\tcommonspot.util.css.setStyleRuleProperty('cs_maincss','cpMenuSafe','visibility',prop);\r\n\t};\r\n\t\r\n\t/*\r\n\t * shows or hides any number of passed elements, passed as objects or as IDs\r\n\t * elements argument can be:\r\n\t * \t- an elementID string, comma delimited for multiple\r\n\t * \t- an object containing html elements or strings\r\n\t *\t\t- an array containing html elements or string elementIDs\r\n\t * note:\r\n\t * \tshowHideElements works by modifying inline style\r\n\t * \tshowHideElementsUsingCSSClass does the same thing by adding or removing a css class; \r\n\t * \t\tit's a better choice for table rows\r\n\t * \tcopies of these functions in util.js work on objects in the top frame, regardless of where they're called from\r\n\t * \tcopies of them in nondashboard-util.js work on local window\r\n\t */\r\n\tcommonspot.util.css.showHideElements = function(show, elements, dspType)\r\n\t{\r\n   \tif (!dspType) \r\n   \t\tdspType = 'block';\r\n   \tvar display = show ? dspType : 'none';\r\n   \tvar targets;\r\n   \tif (typeof elements == 'string') \r\n   \t\ttargets = elements.split(',');\r\n   \telse \r\n   \t\ttargets = elements;\r\n\t   targets.each(function(elem)\r\n\t\t{\r\n\t\t\t$(elem).style.display = display;\r\n\t\t});\r\n\t};\r\n\t\r\n\t// see comments above for showHideElements\r\n\tcommonspot.util.css.showHideElementsUsingCSSClass = function(show, elements)\r\n\t{\r\n\t\tvar targets = (typeof elements == 'string') ? elements.split(',') : elements;\r\n\t\tif(typeof targets !== \"array\")\r\n\t\t{\r\n\t\t\ttargets.each(function(elem)\r\n\t\t\t{\r\n\t\t\t\tif(show)\r\n\t\t\t\t\t$(elem).removeClassName('showHideElements_hide');\r\n\t\t\t\telse\r\n\t\t\t\t\t$(elem).addClassName('showHideElements_hide');\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\t\r\n\t/*\r\n\t * disables any number of passed elements, passed as objects or as IDs\r\n\t * \tdoes visual change w css class 'disabled'; set that up to look right for the look of each kind of item \r\n\t *\t\tdoes actual disabling by stashing item's onclick in onclickDisabled custom property, nulling onclick\r\n\t *\t\talso sets item's disabled property\r\n\t *\t\t\tif neither of those to methods applies (disabled parent item etc), code will need to check some other way\r\n\t */\r\n\tcommonspot.util.css.enableDisableElements = function(enable, elements)\r\n\t{\r\n\t\tif(enable)\r\n\t\t\telements.each(function(elem)\r\n\t\t\t\t{\r\n\t\t\t\t\telem.removeClassName('disabled');\r\n\t\t\t\t\telem.onclick = elem.onclickDisabled ? elem.onclickDisabled : elem.onclick;\r\n\t            elem.onmouseover = elem.onmouseoverDisabled ? elem.onmouseoverDisabled : elem.onmouseover;\r\n\t\t\t\t\telem.disabled = false;\r\n\t\t\t\t});\r\n\t\telse\r\n\t\t\telements.each(function(elem)\r\n\t\t\t\t{\r\n\t\t\t\t\telem.addClassName('disabled');\r\n\t\t\t\t\telem.onclickDisabled = elem.onclick ? elem.onclick : elem.onclickDisabled;\r\n\t            elem.onmouseoverDisabled = elem.onmouseover ? elem.onmouseover : elem.onmouseoverDisabled;\r\n\t\t\t\t\telem.onclick = null;\r\n\t            elem.onmouseover = null;\r\n\t\t\t\t\telem.disabled = true;\r\n\t\t\t\t});\r\n\t};\r\n\t\r\n\t\r\n\tcommonspot.util.css.showFromMenuFields = function(visibleMenuClassList, fieldsList, dspType)\r\n\t{\r\n\t   if(!dspType)\r\n\t      dspType = 'block';\r\n\t\tvar fld, show, selector;\r\n\t\tvar aFields = fieldsList.split(',');\r\n\t   var aData = visibleMenuClassList.split(',');\r\n\t\r\n\t\tfor(var i = 0; i < aFields.length; i++)\r\n\t\t{\r\n\t\t\tfld = aFields[i];\r\n\t      \r\n\t      show = commonspot.util.arrayTest(aData,fld,0) ? 1 : 0;\r\n\t\t\t\r\n\t\t\tselector = '.cs_' + fld + '_hide';\r\n\t\t\tcommonspot.util.css.showHideElements(show, $$(selector), dspType)\r\n\t\t} \r\n\t};\r\n\t\r\n\tcommonspot.util.css.enableFromMenuFields = function(enabledMenuClassList, fieldsList, dspType)\r\n\t{\r\n\t   if(!dspType)\r\n\t      dspType = 'block';\r\n\t\tvar fld, enable, selector;\r\n\t\tvar aFields = fieldsList.split(',');\r\n\t   var aData = enabledMenuClassList.split(',');\r\n\t\r\n\t\tfor(var i = 0; i < aFields.length; i++)\r\n\t\t{\r\n\t\t\tfld = aFields[i];\r\n\t      \r\n\t      enable = commonspot.util.arrayTest(aData,fld,0) ? 1 : 0;\r\n\t\t\t\r\n\t\t\tselector = '.cs_' + fld + '_disable';\r\n\t\t\tcommonspot.util.css.enableDisableElements(enable, $$(selector))\r\n\t\t} \r\n\t};\r\n\t\r\n\t/**\r\n\t * display effects package\r\n\t */\r\n\tcommonspot.util.effects = {};\r\n\t\r\n\t/**\r\n\t * commonspot.util.effects.blindLeft: like scriptaculous BlindUp, but to left\r\n\t */\r\n\tcommonspot.util.effects.blindLeft = function(element) {\r\n\t  element = $(element);\r\n\t  element.makeClipping();\r\n\t  return new Effect.Scale(element, 0,\r\n\t    Object.extend({ scaleContent: false, \r\n\t      scaleX: true,\r\n\t      scaleY: false,\r\n\t      restoreAfterFinish: true,\r\n\t      afterFinishInternal: function(effect) {\r\n\t        effect.element.hide().undoClipping();\r\n\t      } \r\n\t    }, arguments[1] || {})\r\n\t  );\r\n\t};\r\n\t\r\n\t/**\r\n\t * commonspot.util.effects.blindRight: like scriptaculous BlindDown, but from left\r\n\t */\r\n\tcommonspot.util.effects.blindRight = function(element) {\r\n\t  element = $(element);\r\n\t  var elementDimensions = element.getDimensions();\r\n\t  return new Effect.Scale(element, 100, Object.extend({ \r\n\t    scaleContent: false, \r\n\t    scaleX: true,\r\n\t    scaleY: false,\r\n\t    scaleFrom: 0,\r\n\t    scaleMode: {originalHeight: elementDimensions.height, originalWidth: elementDimensions.width},\r\n\t    restoreAfterFinish: true,\r\n\t    afterSetup: function(effect) {\r\n\t      effect.element.makeClipping().setStyle({width: '0px'}).show(); \r\n\t    },  \r\n\t    afterFinishInternal: function(effect) {\r\n\t      effect.element.undoClipping();\r\n\t    }\r\n\t  }, arguments[1] || {}));\r\n\t};\r\n\t\r\n\t\r\n\t/**\r\n\t * commonspot.util.menus: package for operating menus\r\n\t */\r\n\tcommonspot.util.menus = {};\r\n\t\r\n\t/*\r\n\t * checks or unchecks passed menu item\r\n\t * requires css class 'checked', with check image as background\r\n\t * item should have class 'checkableMenuItem' applied always, for correct spacing\r\n\t */\r\n\tcommonspot.util.menus.checkItem = function(checked, item)\r\n\t{\r\n\t\tvar element = $(item);\r\n\t\tif(!element)\r\n\t\t\t{}\r\n\t\telse if(checked)\r\n\t\t\telement.addClassName('checkedMenuItem');\r\n\t\telse\r\n\t\t\telement.removeClassName('checkedMenuItem');\r\n\t};\r\n\t\r\n\r\n\t\r\n\t/**\r\n\t * change StyleRule.\r\n\t * Currently the property is hardcoded for display:block.\r\n\t * We have to make it dynamic . so that it can set any property.\r\n\t */ \r\n\tcommonspot.util.css.changeStyleRule = function(document, sheetTitle, className, propertyName, value)\r\n\t{\r\n\t\tvar rules = commonspot.util.css.getStyleSheetByTitle(document, sheetTitle).rules; \r\n\t\t\r\n\t\tfor (i=0; i< rules.length; i++)\r\n\t\t{      \r\n\t\t\tif (rules[i].selectorText.toLowerCase() == className.toLowerCase())\r\n\t\t\t{ \t\r\n\t\t\t\trules[i].style.display = value; \r\n\t\t\t\tbreak; \r\n\t\t\t} \r\n\t\t}  \r\n\t};\r\n\t \r\n\t/**\r\n\t * Get Stylesheet By Title.\r\n\t */ \r\n\tcommonspot.util.css.getStyleSheetByTitle = function(doc, sheetTitle)\r\n\t{ \t\r\n\t\tvar sheet = null;\r\n\t\tvar rules = null;\r\n\t\tvar thisTitle = null;\r\n\t\t\r\n\t\tif (doc.styleSheets.length > 0)\r\n\t\t{\r\n\t\t\tfor (i = 0; i< doc.styleSheets.length; i++)\r\n\t\t\t{\r\n\t\t\t\tthisTitle = doc.styleSheets[i].title ? doc.styleSheets[i].title : null;\r\n\t\t\t\tif ( thisTitle && thisTitle.toLowerCase()  == sheetTitle)\r\n\t\t\t\t{\r\n\t\t\t\t\tsheet = doc.styleSheets[i];\r\n\t\t\t\t\trules = sheet.cssRules? sheet.cssRules: sheet.rules;\r\n\t\t\t\t\tbreak; \r\n\t\t\t\t}\t\t\t \r\n\t\t\t}  \t\r\n\t\t}\r\n\t\t\r\n\t\treturn {sheet: sheet, rules: rules};\r\n\t};\r\n\r\n\t\r\n\t/*\r\n\t * xml utilities\r\n\t */\r\n\tcommonspot.util.xml = {};\r\n\t\r\n\t/**\r\n\t * Serialize object's properties into XML tags\r\n\t * @param obj (any type ex function I think) required\r\n\t * @param nodeName (string) optional\r\n\t * \tif not passed, defaults to 'struct' for structs, and 'array' for arrays\r\n\t * \tfor other types, no root node is rendered unless nodeName is passed, in which case it's used\r\n\t * array containers have a 'class=\"array\"' attribute to tell the server side that it's an array\r\n\t * empty structs have a 'class=\"struct\"' attribute for the same reason\r\n\t * array item nodes are always <item> tags\r\n\t * array example:\r\n\t * \t<foo class=\"array\"><item>hello</item><item>world</item></foo>\r\n\t * @return an XML string\r\n\t */\r\n\t /*\r\n\t\ttest code:\r\nvar UNDEFINED;\r\ntests =\r\n[\r\n\t\"asdf & <qwer>\",\r\n\tnew Date(),\r\n\tnew Date(\"not a valid date\"),\r\n\t{a:1,b:2},\r\n\t{a:1,b:2,c:{aa:11,bb:22,cc:{aaa:111,bbb:222}}},\r\n\t[1,2],\r\n\t[1,2,\"asdf & <qwer>\",{aa:11,bb:22}],\r\n\t[1,2,[33,44,[555,666]]],\r\n\t{a:1,b:2,c:[33,44,[555,666,{aa:77,bb:88,cc:[1,2]}]]},\r\n\t{a:1,b:'foo',c:'',d:[],e:{}},\r\n\t[\"one element array\"],\r\n\t{a:1,b:2,c:[\"one element array\"]},\r\n\tfunction(){},\r\n\t{a:1,b:2,c:function(){}},\r\n\tUNDEFINED,\r\n\tnull,\r\n\t{lastName: UNDEFINED, firstName: null, birthday: new Date('not a valid date')}\r\n];\r\nfor(var i = 0; i < tests.length; i++)\r\n{\r\n\tconsole.log(i, \"TEST OBJ:\", tests[i]);\r\n\tconsole.log(i, commonspot.util.xml.objectToXml(tests[i]));\r\n\tconsole.log(i, commonspot.util.xml.objectToXml(tests[i], \"data\"));\r\n}\r\ncommonspot.util.xml.objectToXml(x);\r\n\t */\r\n\t\r\n\tcommonspot.util.xml.objectToXml = function(obj, nodeName)\r\n\t{\r\n\t\tvar xml = '';\r\n\t\tvar _nodeName = nodeName;\r\n\t\t\r\n\t\tvar type = typeof obj;\r\n\t\tif(obj === undefined)\r\n\t\t\ttype = 'undefined';\r\n\t\telse if(obj == null)\r\n\t\t\ttype = 'null';\r\n\t\telse if(type !== 'object')\r\n\t\t\t{}\r\n\t\telse if(commonspot.util.isArray(obj))\r\n\t\t\ttype = 'array';\r\n\t\telse if(commonspot.util.isDate(obj))\r\n\t\t\ttype = 'date';\r\n\r\n\t\tswitch (type)\r\n\t\t{\r\n\t\t\tcase 'number':\r\n\t\t\tcase 'boolean':\r\n\t\t\t\txml = obj;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'string':\r\n\t\t\t\txml = commonspot.util.xml.encodeEntities(obj);\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tcase 'date':\r\n\t\t\t\tif(isNaN(obj))\r\n\t\t\t\t{\r\n\t\t\t\t\txml = commonspot.err.INVALID_DATE_TOKEN;\r\n\t\t\t\t\tnodeClass = 'exception';\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\txml = commonspot.util.toCSDateFormat(obj);\r\n\t\t\t\t\tif(xml === commonspot.err.INVALID_DATE_TOKEN)\r\n\t\t\t\t\t\tnodeClass = 'exception';\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tcase 'array':\r\n\t\t\t\t_nodeName = _nodeName ? _nodeName : 'array';\r\n\t\t\t\tvar nodeClass = 'array';\r\n\t\t\t\tvar objectToXml = commonspot.util.xml.objectToXml; // local, will bang on it\r\n\t\t\t\tvar len = obj.length;\r\n\t\t\t\tfor(var i = 0; i < len; i++)\r\n\t\t\t\t\txml += objectToXml(obj[i], 'item');\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'object':\r\n\t\t\t\t_nodeName = _nodeName ? _nodeName : 'struct';\r\n\t\t\t\tnodeClass = 'struct';\r\n\t\t\t\tvar objectToXml = commonspot.util.xml.objectToXml; // local, will bang on it\r\n\t\t\t\tfor(var key in obj)\r\n\t\t\t\t{\r\n\t\t\t\t\txml += objectToXml(obj[key], key);\r\n\t\t\t\t\tnodeClass = ''; // dont' need to put a class on it if it has children\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tcase 'null':\r\n\t\t\t\txml = commonspot.err.NULL_VALUE_TOKEN;\r\n\t\t\t\tnodeClass = 'exception';\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tcase 'undefined':\r\n\t\t\t\txml = commonspot.err.UNDEFINED_VALUE_TOKEN;\r\n\t\t\t\tnodeClass = 'exception';\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tdefault:\r\n\t\t\t\txml = commonspot.err.UNSUPPORTED_TYPE_TOKEN.replace('</', ': ' + typeof obj + '</');\r\n\t\t\t\tnodeClass = 'exception';\r\n\t\t}\r\n\r\n\t\tif(_nodeName)\r\n\t\t\txml = '<' + _nodeName + (nodeClass ? ' class=\"' + nodeClass + '\"' : '') + '>' + xml + '</' + _nodeName + '>';\r\n\t\treturn xml;\r\n\t};\r\n\t\r\n\t/**\r\n\t * returns a javascript object analguous to a passed xml node\r\n\t * @param node (xml node): node to process\r\n\t * @param skip (string || object):\r\n\t * \tcan be a comma delimited list of dot-path items to omit, ie, \"item.data,item.status.data.cmd\"\r\n\t * \t\tno extra whitespace!!!\r\n\t * \tcan also be a struct w those dot-path items as keys and any value that evals as true in a boolean test\r\n\t * \tNOT xpath etc, ie, no wildcards, just simple exact match to passed skip paths\r\n\t * \tthis is recursive, and passed string gets converted to a more efficient struct, which then gets passed on\r\n\t * @param path (string || null):\r\n\t * \tDO NOT PASS THIS. calls itself recursively, passing this internally to support @param skip\r\n\t * @return (object): js object representing pass xml node\r\n\t * \r\n\t * somewhat specialized for commonspot use\r\n\t * \tdoesn't create or examine attributes, with one exception:\r\n\t * \tattribute 'class' is used to know if a container is an array, but not applied to result\r\n\t */\r\n\t/* test code\r\nxml = '<s><a>1</a><b>2</b><c class=\"array\"><item>11</item><item>22 &quot; &apos; &lt; &gt; &amp; &amp;amp; &amp;amp;amp;</item><item></item><item class=\"array\"></item><item class=\"struct\"></item></c></s>';\r\nxmlDoc = tmt.xml.stringToDOM(xml);\r\ncommonspot.util.xml.nodeToObject(xmlDoc);\r\n*/\r\n\t\r\n\tcommonspot.util.xml.nodeToObject = function(node, skip, path)\r\n\t{\r\n\t\tif(!node)\r\n\t\t\treturn null;\r\n\t\t\t\r\n\t\tif(!skip)\r\n\t\t\tskip = {};\r\n\t\telse if(typeof skip === \"string\")\r\n\t\t{\t// passed value is a string, convert to struct for efficient existance testing\r\n\t\t\tvar aSkip = skip.split(\",\");\r\n\t\t\tskip = {};\r\n\t\t\tfor(var i = 0; i < aSkip.length; i++)\r\n\t\t\t   skip[aSkip[i]] = true;\r\n\t\t}\r\n\t\t\r\n\t\t// if no path, make it \"\", and if it's not \"\", put a \".\" on end\r\n\t\tpath = path || \"\";\r\n\t\tpath = (path === \"\") ? path : (path + \".\");\r\n\t\r\n\t\tvar obj = {};\r\n\t\tvar child, typeClass, isArray, isStruct, hasChildNodes, tagName, childObj, childPath, nodeAtrs, dataType, csItemKey;\r\n\t\r\n\t\tnodeAtrs = commonspot.util.xml.getNodeAttributes(node);\r\n\t\tif(commonspot.util.xml.nodeHasValue(node)) // node has a value, use it\r\n\t\t{\r\n\t\t\tdataType = (nodeAtrs && nodeAtrs[\"type\"]) ? nodeAtrs[\"type\"].toLowerCase() : null; // we honor 'type' attribute\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\tchild = node.firstChild;\r\n\t\t\t\tswitch(child.nodeType)\r\n\t\t\t\t{\r\n\t\t\t\t\tcase 3: // TEXT_NODE\r\n\t\t\t\t\tcase 4: // CDATA_SECTION_NODE\r\n\t\t\t\t\t\tobj = child.data;\r\n\t\t\t\t\t\tif(dataType === \"bool\")\r\n\t\t\t\t\t\t\tobj = obj.toBoolean();\r\n\t\t\t\t\t\telse if(dataType === \"int\")\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tobj = parseInt(obj);\r\n\t\t\t\t\t\t\tobj = isNaN(obj) ? 0 : obj;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t/* dmerrill 9/4/09: works, not used, yet, maybe never\r\n\t\t\t\t\t\telse if(dataType === \"float\")\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tobj = parseFloat(obj);\r\n\t\t\t\t\t\t\tobj = isNaN(obj) ? 0 : obj;\r\n\t\t\t\t\t\t}*/\r\n\t\t\t\t\t\telse if(child.nodeType == 3) // TEXT_NODE\r\n\t\t\t\t\t\t\tobj = commonspot.util.xml.encodeEntities(obj);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} catch (e) { alert(\"commonspot.util.xml.nodeToObject() exception caught: \" + e); }\r\n\t\t}\r\n\t\telse // no value\r\n\t\t{\r\n\t\t\thasChildNodes = (node.childNodes && node.childNodes.length > 0);\r\n\t\t\tisArray = isStruct = false;\r\n\t\t\tif(nodeAtrs)\r\n\t\t\t{\r\n\t\t\t\tisArray = (nodeAtrs[\"class\"] === \"array\");\r\n\t\t\t\tisStruct = (nodeAtrs[\"class\"] === \"struct\");\r\n\t\t\t}\r\n\t\t\tif(!(isArray || isStruct))\r\n\t\t\t\tisStruct = hasChildNodes; // it's a struct if it isn't an array and has child nodes\r\n\t\t\tobj = isArray ? [] : isStruct ? {} : \"\";\r\n\t\t\t\r\n\t\t\tif(!hasChildNodes) // no value, no children\r\n\t\t\t\treturn obj;\r\n\t\t\t\r\n\t\t\tchild = node.firstChild;\r\n\t\t\twhile(child)\r\n\t\t\t{\r\n\t\t\t\ttagName = child.nodeName;\r\n\t\t\t\tif(tagName === 'cs_item')\r\n\t\t\t\t{\r\n\t\t\t\t\tcsItemKey = commonspot.util.xml.getNodeAttribute(child, 'key');\r\n\t\t\t\t\ttagName = csItemKey || tagName;\r\n\t\t\t\t}\r\n\t\t\t\tchildPath = path + tagName;\r\n\t\t\t\tif(child.nodeType == 1 && !skip[childPath]) // Node.ELEMENT_NODE and not skipped path\r\n\t\t\t\t{\r\n\t\t\t\t\tchildObj = commonspot.util.xml.nodeToObject(child, skip, childPath);\r\n\t\t\t\t\tif(isArray)\r\n\t\t\t\t\t\tobj.push(childObj);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tobj[tagName] = childObj;\r\n\t\t\t\t}\r\n\t\t\t\tchild = child.nextSibling;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn obj;\r\n\t};\r\n\t\r\n\tcommonspot.util.xml.getNodeAttribute = function(node, attributeName)\r\n\t{\r\n\t\tif((!node.attributes) || node.attributes.length === 0)\r\n\t\t\treturn null;\r\n\t\tattributeName = attributeName ? attributeName.toLowerCase() : null;\r\n\t\tfor(var i = 0; i < node.attributes.length; i++)\r\n\t\t{\r\n\t\t\tif(node.attributes[i].name && (node.attributes[i].name.toLowerCase() == attributeName))\r\n\t\t\t\treturn node.attributes[i].value;\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\t\r\n\tcommonspot.util.xml.getNodeAttributes = function(node)\r\n\t{\r\n\t\tif((!node.attributes) || node.attributes.length === 0)\r\n\t\t\treturn null;\r\n\t\tvar atrs = node.attributes;\r\n\t\tvar result = {};\r\n\t\tfor(var i = 0; i < atrs.length; i++)\r\n\t\t{\r\n\t\t\tif (atrs[i].name)\r\n\t\t\t\tresult[atrs[i].name.toLowerCase()] = atrs[i].value;\r\n\t\t}\t\r\n\t\treturn result;\r\n\t};\r\n\t\t\r\n\tcommonspot.util.xml.nodeHasValue = function(node)\r\n\t{\r\n\t\tif (node)\r\n\t\t{\r\n\t\t\tvar child = node.firstChild;\r\n\t\t\t// 3 = Node.TEXT_NODE, 4 = CDATA_SECTION_NODE\r\n\t\t\tif (child && child.nextSibling == null && (child.nodeType == 3 || child.nodeType == 4))\r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Unescapes special chars that the commonspot serializer escapes\r\n\t * @return string\r\n\t */\r\n\tcommonspot.util.xml.decodeEntities = function(str)\r\n\t{\r\n\t\tif(str && (str.length >= 4) && str.search(/&lt;|&gt;|&quot;|&amp;/) != -1)\r\n\t\t{\r\n\t\t\tstr = str.replace(/&lt;/gi, '<');\r\n\t\t\tstr = str.replace(/&gt;/gi, '>');\r\n\t\t\tstr = str.replace(/&quot;/gi, '\"');\r\n\t\t\tstr = str.replace(/&amp;/gi, '&');\r\n\t\t}\r\n\t\treturn str;\r\n\t};\r\n\t\r\n\tcommonspot.util.xml.encodeEntities = function(str)\r\n\t{\r\n\t\tif (str && str.search(/[&<>\"]/) != -1)\r\n\t\t{\r\n\t\t\tstr = str.replace(/&/g, '&amp;');\r\n\t\t\tstr = str.replace(/</g, '&lt;');\r\n\t\t\tstr = str.replace(/>/g, '&gt;');\r\n\t\t\tstr = str.replace(/\"/g, '&quot;');\r\n\t\t}\r\n\t\treturn str;\r\n\t};\r\n\t\r\n} // End: commonspot.util\r\n\r\n\r\n\r\n/*\r\n * Error managment tools\r\n */\r\nif(!commonspot.err) // commonspot.err not built yet\r\n{\r\n\t// NAMESPACE\r\n\tcommonspot.err = {};\r\n\t\r\n\t// CONSTANTS\r\n\tcommonspot.err.COMMAND_REFUSAL_ERROR_CODE = 409;\r\n\tcommonspot.err.AUTHORING_DISABLED_ERROR_CODE = 503;\r\n\tcommonspot.err.INTERNAL_ERROR_CODE = 560;\r\n\t\r\n\tcommonspot.err.INCOMPLETE_RETURN_VALUE_EXCEPTION = 'CSIncompleteReturnValueException';\r\n\t\r\n\tcommonspot.err.HTTP_ERROR_MSG = 'Failed to get command response, server reported a communication error.';\r\n\tcommonspot.err.FATAL_COMMAND_COLLECTION_ERROR_MSG = 'We\\'re sorry, an error has occurred.';\r\n\tcommonspot.err.EMPTY_COLLECTION_MSG = 'The command collection is empty and cannot be sent.';\r\n\tcommonspot.err.EMPTY_RESPONSE_MSG = 'The server response is empty and cannot be processed.';\r\n\tcommonspot.err.COMMAND_HANDLER_ERROR_MSG_START = 'JavaScript error in command response handler.';\r\n\tcommonspot.err.UNMAPPED_FIELD_ERROR_MSG_START = '';\r\n\tcommonspot.err.MISSING_DATASET_ERROR_MSG = 'Unable to locate dataset';\r\n\tcommonspot.err.REQUIRED_MSG = \"This field is required.\";\r\n\t\r\n\tcommonspot.err.MAPPED_FIELD_ERROR_MSGS_HEADER = 'Please correct the following:';\r\n\tcommonspot.err.INTERNAL_ERROR_MSGS_HEADER = 'We\\'re sorry, an internal error has occurred.';\r\n\t\r\n\tcommonspot.err.FIELD_ERROR_CSS_CLASS = 'CommonSpotFieldError';\r\n\tcommonspot.err.INVALID_VALUE_PREFIX = \"{!INVALID_VALUE_PREFIX!}\";\r\n\t\r\n\tcommonspot.err.NULL_VALUE_TOKEN = '<message>Attempt to pass a null value.</message>';\r\n\tcommonspot.err.UNDEFINED_VALUE_TOKEN = '<message>Attempt to pass an undefined value.</message>';\r\n\tcommonspot.err.UNSUPPORTED_TYPE_TOKEN = '<message>Attempt to pass an unsupported type.</message>';\r\n\tcommonspot.err.INVALID_DATE_TOKEN = '<message>Attempt to pass an invalid date.</message>';\r\n\t\r\n\t// STATIC METHODS\r\n\t\r\n\t/*\r\n\t * rtns passed msg w INVALID_VALUE_PREFIX prepended\r\n\t * point is that it's recognized by ErrorCollection.checkFieldValue as an invalid value\r\n\t * for an example, see /dashboard/dialogs/tools/js/advanced-search.js:\r\n\t * \tgetOwner() rtns a msg built w commonspot.err.invalidMsg() if it's invalid\r\n\t * \tcollectFormArgs() creates a new commonspot.err.ErrorCollection\r\n\t * \t\tthen checks each collected value with the collection's checkFieldValue() method\r\n\t * \t\tit then calls the collection's displayErrors() method to show them, and bails if that rtns true (were rrs)\r\n\t */\r\n\tcommonspot.err.invalidMsg = function(msg)\r\n\t{\r\n\t\treturn commonspot.err.INVALID_VALUE_PREFIX + msg;\r\n\t};\r\n\t\t\r\n\t/*\r\n\t * clears field error styling off all fields that might get it if they fail\r\n\t * relevant fields are ones whose highlightIDs are in passed fieldErrorMap or are values in errorCodeMap\r\n\t * always operates on topmost lightbox window, regardless of where it's called from\r\n\t */\r\n\tcommonspot.err.clearFieldErrorDisplay = function(fieldErrorMap, errorCodeMap)\r\n\t{\r\n\t\tvar lightboxWindow = top.commonspot.lightbox.getCurrentWindow();\r\n\t\tvar highlightIDs;\r\n\t\tfor(var fld in fieldErrorMap)\r\n\t\t{\r\n\t\t\thighlightIDs = fieldErrorMap[fld].highlightIDs;\r\n\t\t\tif(highlightIDs)\r\n\t\t\t\tcommonspot.util.css.addRemoveClassNameByIDs(highlightIDs, commonspot.err.FIELD_ERROR_CSS_CLASS, false);\r\n\t\t}\r\n\t\tfor(var code in errorCodeMap)\r\n\t\t{\r\n\t\t\thighlightIDs = errorCodeMap[code].highlightIDs;\r\n\t\t\tif(highlightIDs) // should exist, friendlyName and highlightIDs are reason for map to exist\r\n\t\t\t\tcommonspot.util.css.addRemoveClassNameByIDs(highlightIDs, commonspot.err.FIELD_ERROR_CSS_CLASS, false);\r\n\t\t}\r\n\t};\r\n\t\r\n\t// CLASSES\r\n\t\r\n\t/*\r\n\t * ErrorCollection class, holds and displays error objects\r\n\t */\r\n\tcommonspot.err.ErrorCollection = function ()\r\n\t{\r\n\t\tthis.errors = [];\r\n\t\treturn this;\r\n\t};\r\n\t\r\n\t/*\r\n\t * adds passed errorObject to this collection\r\n\t * object must support render() method\r\n\t * \tTODO: explain that more\r\n\t */\r\n\tcommonspot.err.ErrorCollection.prototype.addError = function(errorObject)\r\n\t{\r\n\t\tthis.errors.push(errorObject);\r\n\t};\r\n\t\r\n\t/**\r\n\t * checks passed value, if it starts w INVALID_PREFIX, it's an error, and rest of it is error msg\r\n\t * \tso, add corresponding FieldError object to this ErrorCollection, and rtn true\r\n\t * otherwise, it's not an error, clear its error appearance, and rtn false\r\n\t * can also validate the value here, but mostly we validate on the server side, so in general, don't\r\n\t * \r\n\t * @param value (any) required: value to check\r\n\t * @param friendlyName (string) optional: name to call it in user alerts\r\n\t * @param highlightID (string) optional: id of dom element to hilight if invalid\r\n\t * @param validator (string or function) optional:\r\n\t * \tif passed, it's used to process the value first\r\n\t * \tcan be the name of a std validator, in commonspot.err.validators namespace...\r\n\t * \t\t...or a reference to (not the name of) a custom function \r\n\t * \tvalidator functions should return passed value if it's valid, else commonspot.err.invalidMsg(\"Some message\")\r\n\t */\r\n\tcommonspot.err.ErrorCollection.prototype.checkFieldValue = function(value, friendlyName, highlightID, validator)\r\n\t{\r\n\t\tif(typeof validator === \"string\")\r\n\t\t\tvalidator = commonspot.err.validators[validator];\r\n\t\tif(typeof validator === \"function\")\r\n\t\t\tvalue = validator(value);\r\n\t\t\t\r\n\t\tvar lightboxWindow = top.commonspot.lightbox.getCurrentWindow();\r\n\t\tif((typeof value === \"string\") && (value.substr(0, commonspot.err.INVALID_VALUE_PREFIX.length) == commonspot.err.INVALID_VALUE_PREFIX))\r\n\t\t{\r\n\t\t\tif(highlightID && highlightID != \"\")\r\n\t\t\t\tlightboxWindow.$(highlightID).addClassName(commonspot.err.FIELD_ERROR_CSS_CLASS);\r\n\t\t\tvar msg = value.substr(commonspot.err.INVALID_VALUE_PREFIX.length);\r\n\t\t\tvar fieldError = new commonspot.err.FieldError(msg, friendlyName, highlightID);\r\n\t\t\tthis.addError(fieldError);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse if(highlightID && highlightID != \"\")\r\n\t\t{\r\n\t\t\tlightboxWindow.$(highlightID).removeClassName(commonspot.err.FIELD_ERROR_CSS_CLASS);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n\t\r\n\t/*\r\n\t * if collection contains errors, displays them and rtns true, else rtns false\r\n\t * TODO: explain more about responsibilities of objects in its error collection, and how instances of them get created\r\n\t */\r\n\tcommonspot.err.ErrorCollection.prototype.displayErrors = function()\r\n\t{\r\n\t\tif(this.errors.length > 0)\r\n\t\t{\r\n\t\t\tvar lightboxWindow = top.commonspot.lightbox.getCurrentWindow();\r\n\t\t\tvar fieldMsgs = \"\";\r\n\t\t\tvar userMsgs = \"\";\r\n\t\t\tvar internalMsgs = \"\";\r\n\t\t\tvar msgs;\r\n\t\t\tfor(var i = 0; i < this.errors.length; i++)\r\n\t\t\t{\r\n\t\t\t\tmsgs = this.errors[i].render(lightboxWindow);\r\n\t\t\t\tif(msgs.field && msgs.field !== \"\")\r\n\t\t\t\t\tfieldMsgs += msgs.field;\r\n\t\t\t\tif(msgs.user && msgs.user !== \"\")\r\n\t\t\t\t\tuserMsgs += msgs.user;\r\n\t\t\t\tif(msgs.internal && msgs.internal !== \"\")\r\n\t\t\t\t\tinternalMsgs += msgs.internal;\r\n\t\t\t}\r\n\t\t\tvar msg = \"\";\r\n\t\t\tif(userMsgs !== \"\")\r\n\t\t\t\tmsg += userMsgs;\r\n\t\t\tif(fieldMsgs !== \"\")\r\n\t\t\t\tmsg += \"<h2>\" + commonspot.err.MAPPED_FIELD_ERROR_MSGS_HEADER + \"</h2><dl>\" + fieldMsgs + \"</dl>\";\r\n\t\t\tif(internalMsgs !== \"\")\r\n\t\t\t\tmsg += \"<h2>\" + commonspot.err.INTERNAL_ERROR_MSGS_HEADER + \"</h2><dl>\" + internalMsgs + \"</dl>\";\r\n\t\t\tcommonspot.dialog.client.alert(msg);\r\n\t\t}\r\n\t\treturn (this.errors.length > 0); // boolean == hasErrors\r\n\t};\r\n\t\r\n\t\r\n\t/*\r\n\t * Helper function.  Checks if the passed value is empty. If so sets an invalidMsg and checks the field Value\r\n\t */\r\n\tcommonspot.err.ErrorCollection.prototype.setErrorIfEmpty = function(value, friendlyName, highlightID, msg)\r\n\t{\r\n\t\tif(value == \"\")\r\n\t\t{\r\n\t\t\tif(typeof(msg) == \"undefined\")\r\n\t\t\t\tmsg = commonspot.err.REQUIRED_MSG;\r\n\t\t\tvalue = commonspot.err.invalidMsg(msg);\r\n\t\t\tthis.checkFieldValue(value, friendlyName, highlightID);\t\t\r\n\t\t}\t\r\n\t};\r\n\t\r\n\t/*\r\n\t * CmdError class, represents a server-side error running a cmd\r\n\t * TODO: write this, document fieldErrors and fieldErrorMap members better\r\n\t * fieldErrors\r\n\t * \terrortype:\r\n\t * \tmessage:\r\n\t * \tfieldtype:\r\n\t * \tpassedtype:\r\n\t * fieldErrorMap\r\n\t * \tstruct, keyed by the lcase argument name on the server side.\r\n\t * \tfor each field, value is a struct containing...\r\n\t * \t\tfriendlyName:\r\n\t * \t\thighlightIDs:\r\n\t * \t\tposition:\r\n\t */\r\n\tcommonspot.err.CmdError = function(responseStatus, fieldErrorMap, errorCodeMap)\r\n\t{\r\n\t\tthis.cmd = responseStatus.cmd;\r\n\t\tthis.code = responseStatus.code;\r\n\t\tthis.reasonCode = responseStatus.reasoncode;\r\n\t\tthis.text = responseStatus.text;\r\n\t\tthis.hasFieldErrors = responseStatus.hasFieldErrors;\r\n\t\tif(responseStatus.data)\r\n\t\t{\r\n\t\t\tthis.exceptionType = responseStatus.data.exceptiontype;\r\n\t\t\tthis.fieldErrors = responseStatus.data.fielderrors;\r\n\t\t}\r\n\t\tthis.fieldErrorMap = fieldErrorMap;\r\n\t\tthis.errorCodeMap = errorCodeMap;\r\n\t\t\t\t\t//console.log(\"CmdError.this\", this);\r\n\t\treturn this;\r\n\t};\r\n\t\r\n\t/*\r\n\t * visually indicate field errors when applicable, and rtn struct w error msgs:\r\n\t * \t.field: user-fixable data problems\r\n\t * \t.user: other expected exception alerts\r\n\t * \t.internal: unexpected internal error (cf crash, unmapped field errors, etc)\r\n\t */\r\n\tcommonspot.err.CmdError.prototype.render = function(lightboxWindow)\r\n\t{\r\n\t\tvar map, fieldName, highlightIDs, position;\r\n\t\tvar msgs = {field: \"\", user: \"\", internal: \"\"};\r\n\t\tvar orderedFieldMsgs = [];\r\n\t\tvar unorderedFieldMsgs = [];\r\n\t\tif(this.hasFieldErrors)\r\n\t\t{\t// cmd refusal with field errors user can fix (if we have a mapping for the fld), typically validation\r\n\t\t\tfor(var fld in this.fieldErrors)\r\n\t\t\t{\r\n\t\t\t\tif(!this.fieldErrors.hasOwnProperty(fld)) // skip prototype extended methods\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t// if error is a string, not an object, it's an internal exception; so far, that's only INCOMPLETE_RETURN_VALUE_EXCEPTION\r\n\t\t\t\tif(typeof this.fieldErrors[fld] === 'string')\r\n\t\t\t\t{\r\n\t\t\t\t\tmsgs.internal += '<dt>' + this.errorSource(this.cmd, fld) + '</dt><dd>' + this.fieldErrors[fld].escapeHTML() + '</dd>';\r\n\t\t\t\t}\r\n\t\t\t\telse if(this.fieldErrorMap && this.fieldErrorMap[fld]) // have a mapping for this fld -- user-entered data they can change\r\n\t\t\t\t{\r\n\t\t\t\t\tmap = this.fieldErrorMap[fld];\r\n\t\t\t\t\tfieldName = map.friendlyName || fld;\r\n\t\t\t\t\thighlightIDs = map.highlightIDs;\r\n\t\t\t\t\tposition = map.position;\r\n\t\t\t\t\tif(highlightIDs)\r\n\t\t\t\t\t\tcommonspot.util.css.addRemoveClassNameByIDs(highlightIDs, commonspot.err.FIELD_ERROR_CSS_CLASS, true);\r\n\t\t\t\t\tmsg = (this.fieldErrors[fld].errortype == \"empty\") ? commonspot.err.REQUIRED_MSG : this.fieldErrors[fld].message;\r\n\t\t\t\t\tmsg = '<dt title=\"Data type: ' + this.fieldErrors[fld].fieldtype + '\">' + fieldName + '</dt><dd>' + msg.escapeHTML() + '</dd>';\r\n\t\t\t\t\tif(typeof position == \"undefined\") // has position only if added to cmd collection via a Command obj\r\n\t\t\t\t\t\tunorderedFieldMsgs.push(msg);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\torderedFieldMsgs[position] = msg;\r\n\t\t\t\t}\r\n\t\t\t\telse // no mapping for this fld, not something user can fix -- internal error or missing or incorrect map\r\n\t\t\t\t\tmsgs.internal += '<dt title=\"Data type: ' + this.fieldErrors[fld].fieldtype + '\">' + this.errorSource(this.cmd, fld) + '</dt><dd>' + commonspot.err.UNMAPPED_FIELD_ERROR_MSG_START + this.fieldErrors[fld].message.escapeHTML() + '</dd>';\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(this.code === commonspot.err.COMMAND_REFUSAL_ERROR_CODE) // non-field cmd refusal\r\n\t\t{\r\n\t\t\tmap = this.errorCodeMap ? this.errorCodeMap.getForCode(this.reasonCode) : null;\r\n\t\t\tif(map) // have specs for this reasonCode, alert like a field error and highlight requested flds\r\n\t\t\t{\r\n\t\t\t\tcommonspot.util.css.addRemoveClassNameByIDs(map.highlightIDs, commonspot.err.FIELD_ERROR_CSS_CLASS, true);\r\n\t\t\t\tmsg = '<dt>' + map.itemTitle + '</dt><dd>' + this.text.escapeHTML() + '</dd>';\r\n\t\t\t\tunorderedFieldMsgs.push(msg);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tmsgs.user += '<p>' + this.text.escapeHTML() + '</p>';\r\n\t\t}\r\n\t\telse if(this.code === commonspot.err.AUTHORING_DISABLED_ERROR_CODE) // authoring is disabled, just say it\r\n\t\t\tmsgs.user += '<p>' + this.text.escapeHTML() + '</p>';\r\n\t\telse // non-field internal error\r\n\t\t\tmsgs.internal += '<dt>' + this.errorSource(this.cmd) + '</dt><dd>' + this.text.escapeHTML() + '</dd>';\r\n\t\t\t\r\n\t\tmsgs.field = orderedFieldMsgs.join(\"\") + unorderedFieldMsgs.join(\"\"); // concat ordered msgs, ones w no position at end\r\n\t\treturn msgs;\r\n\t};\r\n\t\r\n\tcommonspot.err.CmdError.prototype.errorSource = function(cmd, fld)\r\n\t{\r\n\t\tswitch(this.exceptionType)\r\n\t\t{\r\n\t\t\tcase \"CSIncompleteReturnValueException\":\r\n\t\t\t\treturn cmd + \", \" + \"field '\" + fld + \"' in return value:\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn (fld ? cmd + \".\" + fld : cmd);\r\n\t\t}\r\n\t};\r\n\t\r\n\t\r\n\t/*\r\n\t * CmdHandlerError class, represents a client-side js error in a cmd response handler\r\n\t * TODO: write this\r\n\t */\r\n\tcommonspot.err.CmdHandlerError = function(cmd, error)\r\n\t{\r\n\t\tthis.cmd = cmd;\r\n\t\tthis.text = error.toString().escapeHTML();\r\n\t\treturn this;\r\n\t};\r\n\t\r\n\t/*\r\n\t * visually indicate field errors when applicable, which won't happen, and...\r\n\t * rtn struct w error msgs:\r\n\t * \t.field: user-fixable data problems; null\r\n\t * \t.user: other expected exception; null\r\n\t * \t.internal: unexpected internal error; error text\r\n\t */\r\n\tcommonspot.err.CmdHandlerError.prototype.render = function(lightboxWindow)\r\n\t{\r\n\t\tvar msgs =\r\n\t\t{\r\n\t\t\tfield: \"\",\r\n\t\t\tuser: \"\",\r\n\t\t\tinternal: \"<dt>\" + this.cmd + \"</dt><dd>\" + commonspot.err.COMMAND_HANDLER_ERROR_MSG_START + \"<br />\" + this.text.escapeHTML() + \"</dd>\"\r\n\t\t};\r\n\t\treturn msgs;\r\n\t};\r\n\t\r\n\t/*\r\n\t * FieldError class, represents a client-side validation error specific to some field\r\n\t * TODO: write this\r\n\t */\r\n\tcommonspot.err.FieldError = function(msg, friendlyName, highlightIDs)\r\n\t{\r\n\t\tthis.msg = msg;\r\n\t\tthis.friendlyName = friendlyName;\r\n\t\tthis.highlightIDs = highlightIDs;\r\n\t\treturn this;\r\n\t};\r\n\t\r\n\t/*\r\n\t * visually indicate field errors when applicable, which won't happen, and...\r\n\t * rtn struct w error msgs:\r\n\t * \t.field: user-fixable data problems; null\r\n\t * \t.user: other expected exception; null\r\n\t * \t.internal: unexpected internal error; error text\r\n\t */\r\n\tcommonspot.err.FieldError.prototype.render = function(lightboxWindow)\r\n\t{\r\n\t\tif(this.highlightIDs && this.highlightIDs != \"\")\r\n\t\t\tlightboxWindow.$\r\n\t\t\t\t.apply(lightboxWindow, this.highlightIDs.split(\",\"))\r\n\t\t\t\t.addClassName(commonspot.err.FIELD_ERROR_CSS_CLASS);\r\n\t\tvar msgs =\r\n\t\t{\r\n\t\t\tfield: \"<dt>\" + this.friendlyName + \"</dt><dd>\" + this.msg.escapeHTML() + \"</dd>\",\r\n\t\t\tuser: \"\",\r\n\t\t\tinternal: \"\"\r\n\t\t};\r\n\t\treturn msgs;\r\n\t};\r\n\r\n\t/*\r\n\t* ErrorCodeMap class, represents a mapping of error codes to error item titles and highlightIDs\r\n\t* use to handle non-validation errors (cmd refusal) as a field error when it's a known code\r\n\t* constructor args let you create first mapping immediately; call addCode to add more if needed\r\n\t*/\r\n\tcommonspot.err.ErrorCodeMap = function(code, itemTitle, highlightIDs)\r\n\t{\r\n\t\tthis.map = {};\r\n\t\tif(code)\r\n\t\t\tthis.addCode(code, itemTitle, highlightIDs);\r\n\t\treturn this;\r\n\t};\r\n\r\n\tcommonspot.err.ErrorCodeMap.prototype.addCode = function(code, itemTitle, highlightIDs)\r\n\t{\r\n\t\tthis.map[code] = {itemTitle: itemTitle, highlightIDs: highlightIDs};\r\n\t};\r\n\r\n\tcommonspot.err.ErrorCodeMap.prototype.getForCode = function(code)\r\n\t{\r\n\t\treturn this.map[code];\r\n\t};\r\n\t\r\n\t/*\r\n\t * namspace for client-side value validators\r\n\t * shouldn't be many of these, most validation is server-side\r\n\t * validators should return passed value if it's valid, else commonspot.err.invalidMsg(\"Some message\")\r\n\t * validators are used by ErrorCollection.checkFieldValue, so far\r\n\t * you can pass checkFieldValue the name of a std validator, or a reference to (not the name of) a custom function \r\n\t */\r\n\tcommonspot.err.validators = {};\r\n\t\r\n\tcommonspot.err.validators.required = function(value)\r\n\t{\r\n\t\tif(value == \"\") // assumes value has been trimmed, as by commonspotLocal.util.getValue\r\n\t\t\tvalue = commonspot.err.invalidMsg(commonspot.err.REQUIRED_MSG);\r\n\t\treturn value;\r\n\t};\r\n\r\n} // commonspot.err not built yet\r\n</script><link id=\"buttons_css\" type=\"text/css\" href=\"/commonspot/dashboard/css/buttons.css\" rel=\"stylesheet\"><link id=\"cs_lightbox_css\" type=\"text/css\" href=\"/commonspot/javascript/lightbox/lightbox.css\" rel=\"stylesheet\"><script id=\"cs_lightbox_js\" type=\"text/javascript\" src=\"/commonspot/javascript/lightbox/lightbox.js\">/**\r\n * commonspot.lightbox: lightbox package\r\n */\r\nif (typeof commonspot == 'undefined')\r\n\tcommonspot = {};\r\ncommonspot.lightbox = {};\r\n// Stack holding the currently opened lightboxes\r\ncommonspot.lightbox.stack = [];\r\n// Defaults for size and position\r\ncommonspot.lightbox.DEFAULT_TOP = 20;\r\ncommonspot.lightbox.DIALOG_DEFAULT_WIDTH = 100;\r\ncommonspot.lightbox.DIALOG_DEFAULT_HEIGHT = 100;\r\ncommonspot.lightbox.WINDOW_MARGINS = 30;\r\n// Constrains from XHTML/CSS and images\r\ncommonspot.lightbox.FURNITURE_HEIGHT = 70;\r\ncommonspot.lightbox.FURNITURE_WIDTH = 20;\r\ncommonspot.lightbox.CORNERS_WIDTH = 20;\r\n// constant to request no overlay msg\r\ncommonspot.lightbox.NO_OVERLAY_MSG = 'NONE';\r\ncommonspot.lightbox.helpDlg = null;\r\n\r\nvar _startX = 0; // mouse starting positions \r\nvar _startY = 0; \r\nvar _offsetX = 0; // current element offset \r\nvar _offsetY = 0; \r\nvar _dragElement; // needs to be passed from OnMouseDown to OnMouseMove \r\nvar _oldZIndex = 0; // we temporarily increase the z-index during drag \r\nvar _debug = top.document.getElementById('debug');\r\n\r\n/**\r\n * Adjust layout. To call if vieport's dimensions changed\r\n */\r\ncommonspot.lightbox.adjustLayout = function()\r\n{\r\n\tfor(var i = 0; i < commonspot.lightbox.stack.length; i++)\r\n\t\tcommonspot.lightbox.stack[i].adjustLayout();\r\n};\r\n\r\ncommonspot.lightbox.openURL = function(options)\r\n{\r\n\tvar options = options || {};\r\n\tvar defaultOptions =\r\n\t{\r\n\t\ttitle: \"Custom Dialog\",\r\n\t\tsubtitle: \"\",\r\n\t\thelpId: \"\",\r\n\t\twidth: 100,\r\n\t\tname: 'customDlg',\r\n\t\theight: 50,\r\n\t\thasMaximizeIcon: true,\r\n\t\thasCloseIcon: true,\r\n\t\thasHelpIcon: false,\r\n\t\thasReloadIcon: false,\r\n\t\turl: \"/commonspot/dashboard/dialogs/blank-dialog.html\",\r\n\t\tdialogType: \"dialog\"\r\n\t};\t\r\n\tcommonspot.util.merge(options, defaultOptions);\r\n\tvar hideClose = options.hasCloseIcon ? false : true;\r\n\tvar hideHelp = options.hasHelpIcon ? false : true;\r\n\tvar hideReload = options.hasReloadIcon ? false : true;\r\n\tvar dlgObj = commonspot.lightbox.openDialog(defaultOptions.url, hideClose, options.name, commonspot.lightbox.NO_OVERLAY_MSG, options.dialogType, null, hideHelp, hideReload);\r\n\r\n\tcommonspot.lightbox.initCurrent(defaultOptions.width, defaultOptions.height, {title: options.title, subtitle: options.subtitle, reload: options.hasReloadIcon, helpId: options.helpId, maximize: options.hasMaximizeIcon}); \r\n\tdlgObj.iframeNode.src = options.url;\r\n\tsetTimeout(function() {\r\n\t\tcommonspot.lightbox.resizeCurrent(options.width, options.height);\r\n\t}, 50);\r\n}\r\n\r\n/**\r\n * Open either a url or a document DOM inside a lightbox\r\n * @param url  (string). Required\r\n * @param hideClose  (boolean). Optional. Set it to true to remove the close button from furniture's top right corner\r\n * @param hideHelp (boolean). Optional. Set it to true for the dialogs that do not need the Help Button and the QAHelp Processing.\r\n */\r\ncommonspot.lightbox.openDialog = function(url, hideClose, name, customOverlayMsg, dialogType, opener, hideHelp, hideReload)\r\n{\r\n\tvar url = url ? url : null;\r\n\tvar hideClose = hideClose ? hideClose : null;\r\n\tvar hideHelp = arguments[6] ? arguments[6] : null;\r\n\tvar hideReload = arguments[7] ? arguments[7] : null;\r\n\tvar name = name ? name : null;\r\n\tif (name == 'error')\r\n\t\tname = 'dlg_error';\r\n\tvar customOverlayMsg = customOverlayMsg ? customOverlayMsg : null;\r\n\tdialogType = dialogType || 'dialog';\r\n\tvar dlgOpener = opener ? opener : null;\r\n\tvar options = {\r\n\t\turl: url,\r\n\t\thideClose: hideClose,\r\n\t\tname: name,\r\n\t\tcustomOverlayMsg: customOverlayMsg,\r\n\t\tdialogType: dialogType,\r\n\t\topener: dlgOpener,\r\n\t\thideHelp: hideHelp,\r\n\t\thideReload: hideReload\r\n\t}\r\n\tcommonspot.lightbox.stack.push(commonspot.lightbox.dialogFactory.getInstance(options));\r\n\t/*\r\n\tcommented for 6.0 this should be live in 6.x when we want spellcheck for the spry dialogs.\r\n\tcode in dashboard\\dialogs\\pageview\\create-work-request.html is left as-is as an example.\r\n\tsetTimeout(function(){\r\n\t\tif (commonspot.lightbox.stack.length)\r\n\t\t\tcommonspot.lightbox.addSpellCheckButton(commonspot.lightbox.stack.last().getWindow().document);\t\r\n\t},50);\r\n\t*/\r\n\treturn commonspot.lightbox.stack[commonspot.lightbox.stack.length - 1];\r\n};\r\n\r\n/**\r\n * Changes the URL of the lightbox to a SPRY dialog\r\n * @param url  (string). Required\r\n */\r\ncommonspot.lightbox.loadSpryURL = function(url)\r\n{\r\n\tvar win = commonspot.lightbox.stack.last().getWindow();\r\n\twin.location.href = url;\r\n};\r\n\r\n/**\r\n * Changes the URL of the lightbox to a Legacy dialog\r\n * \r\n * @param loaderParamsString (string): arguments to pass to loader\r\n * @param customVarValues (value object, optional): custom dynamic argument values\r\n * \r\n * loaderParamsString is everything after the '?', including csModule=whatever.cfm\r\n * can include {varName} placeholders to be filled in when this is called\r\n * there are two kinds of vars:\r\n * \t- standard ones we do always\r\n * \t\tpageID for now, maybe others some day\r\n * \t- custom ones whose values are passed in customVarValues value object\r\n * \t\tcustomVarValues should be in the form {fldName1: fldValue1, fldName2: fldValue2,...}\r\n * \t\t{fldName1} in loaderParamsString will be replaced with fldValue1, etc\r\n */\r\ncommonspot.lightbox.loadLegacyURL = function(loaderParamsString, customVarValues, bNewWindow)\r\n{\r\n\t// replace any std var placeholders w real values\r\n\tvar pageID = commonspot.data.uiState.lview.dsCurrentPage.getCurrentRow().pageid;\r\n\tloaderParamsString = loaderParamsString.replace('{pageID}', pageID);\r\n\t\r\n\t// replace any custom dynamic arguments with passed values\r\n\tfor(var fld in customVarValues)\r\n\t\tloaderParamsString = loaderParamsString.replace('{' + fld + '}', customVarValues[fld]);\r\n\t\r\n\tvar win = commonspot.lightbox.stack.last().getWindow();\r\n\tif( bNewWindow )\r\n\t\tcommonspot.dialog.server.show(loaderParamsString);\r\n\telse\r\n\t{\r\n\t\t// get loader, build url\r\n\t\tvar loader = commonspot.clientUI.state.location.getLoaderURL('subsiteurl');\r\n\t\tvar url = loader + '?' + loaderParamsString;\t\r\n\t\r\n\t\twin.location.href = url;\r\n\t}\r\n};\r\n\r\n/*\r\n * Loads a full url (url with /{sitename}/loader.cfm?csmodule={template}\r\n */\r\ncommonspot.lightbox.loadLegacyFullURL = function(url)\r\n{\r\n\tvar win = commonspot.lightbox.stack.last().getWindow();\r\n\twin.location.href = url;\r\n};\r\n\r\n/*\r\n * returns the lightbox object representing the topmost window, ignoring alerts if requested\r\n */\r\ncommonspot.lightbox.getCurrent = function(includeAlerts)\r\n{\r\n\tif (commonspot.lightbox.stack.length === 0)\r\n\t\treturn;\r\n\tif (typeof includeAlerts === 'undefined')\r\n\t\tincludeAlerts = true;\r\n\tif (includeAlerts)\r\n\t\treturn commonspot.lightbox.stack.last();\r\n\telse\r\n\t{\r\n\t\tvar endPos = commonspot.lightbox.stack.length - 1;\r\n\t\tfor (var i = endPos; i >= 0; i--)\r\n\t\t{\r\n\t\t\tif (commonspot.lightbox.stack[i].dialogType !== 'alert')\r\n\t\t\t\treturn commonspot.lightbox.stack[i];\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Get window object of topmost lightbox, ignoring alerts if requested\r\n */\r\ncommonspot.lightbox.getCurrentWindow = function(includeAlerts)\r\n{\r\n\tvar currentDlg = commonspot.lightbox.getCurrent(includeAlerts);\r\n\tif (currentDlg)\r\n\t\treturn currentDlg.getWindow();\r\n\telse\r\n\t\treturn window;\t\r\n};\r\n\r\n/**\r\n * Close the topmost lightbox\r\n */\r\ncommonspot.lightbox.closeCurrent = function()\r\n{\r\n\tif (commonspot.lightbox.stack.length > 0)\r\n\t{\r\n\t\tif (top.commonspot.lightbox.stack.length>1)\r\n\t\t\tactivateFields(top.commonspot.lightbox.stack[top.commonspot.lightbox.stack.length-2].getWindow());\t\r\n\t\r\n\t\tvar currentDialog = commonspot.lightbox.stack.last();\r\n\r\n\t\tcurrentDialog.close(); \r\n\t}\r\n\t\r\n\tif (commonspot.clientUI && commonspot.clientUI.isURLError)\r\n\t{\r\n\t\tcommonspot.clientUI.state.mode.urlHash.setHashFromModeAndPage();\r\n\t\tcommonspot.clientUI.isURLError = false;\r\n\t}\r\n};\r\n\r\n// function called when 'X' close btn image is clicked\r\n// tries to do what dlg's own cancel or close btn would do, else just closes\r\ncommonspot.lightbox.closeBtnOnClick = function()\r\n{\r\n\ttry\r\n\t{\r\n\t\tvar dlgWin = commonspot.lightbox.getCurrentWindow();\r\n\t\tvar doc = dlgWin.document;\r\n\t}\r\n\tcatch(e)\r\n\t{\r\n\t\tdlgWin = null;\r\n\t}\r\n\tif(!dlgWin)\r\n\t{\r\n\t\tcommonspot.lightbox.closeCurrent();\r\n\t\treturn;\r\n\t}\t\r\n\tvar closeBtn = doc.getElementById('closeButton') || doc.getElementById('Close');\r\n\tvar cancelBtn = doc.getElementById('cancelButton');\r\n\tvar btn = cancelBtn ? cancelBtn : closeBtn;\r\n\t\r\n\tif(!btn)\r\n\t\tcommonspot.lightbox.closeCurrent();\r\n\telse if(btn.onclick)\r\n\t\tbtn.onclick();\r\n\telse\r\n\t\tbtn.click();\r\n}\r\n\r\n/**\r\n * Close the topmost lightbox and reload the parent Dialog\r\n */\r\ncommonspot.lightbox.closeCurrentWithReload = function()\r\n{\r\n\tif (commonspot.lightbox.stack.length > 0)\r\n\t{\r\n\t\tvar currentDialog = commonspot.lightbox.stack.last();\r\n\t\tcurrentDialog.close();\r\n\t\t\r\n\t\t// Get next existing dialog and reload it  \r\n\t\tif (commonspot.lightbox.stack.length != 0)\r\n\t\t{\r\n\t\t \tvar nextExistingWindow = commonspot.lightbox.stack.last(); \r\n\t\t \tnextExistingWindow.getWindow().location.reload();\r\n\t\t}\r\n\t\telse\r\n\t\t\tcommonspot.lightbox.reloadPage();\r\n\t}\r\n};\r\n\r\n/**\r\n * Close the parent of topmost lightbox\r\n */\r\ncommonspot.lightbox.closeParent = function()\r\n{\r\n\tvar pos = commonspot.lightbox.stack.length - 2;\r\n\tif (pos >= 0)\r\n\t\tcommonspot.lightbox.stack[pos].close();\r\n};\r\n\r\n/**\r\n * Close all parent lightboxes\r\n */\r\ncommonspot.lightbox.closeParentDialogs = function()\r\n{\r\n\tvar endPos = commonspot.lightbox.stack.length - 2;\r\n\tfor (var i = endPos; i >= 0; i--)\r\n\t\tcommonspot.lightbox.stack[i].close();\r\n}\r\n\r\n/**\r\n * Close all lightboxes, and refresh the innermost one\r\n * @param closeCount  int is the number of child dialogs to close\r\n */\r\ncommonspot.lightbox.closeChildDialogsWithReload = function(closeCount)\r\n{\r\n\tvar curCount = 0;\r\n\tfor (var i = commonspot.lightbox.stack.length-1; i >= 0; i--)\r\n\t{\r\n\t\tif (curCount <= closeCount)\r\n\t\t{\r\n\t\t\tcommonspot.lightbox.stack[i].close();  \r\n\t\t\tcurCount++;\r\n\t\t}\t\r\n\t\telse\r\n\t\t\tbreak;\r\n\t}\r\n\t// Get next existing dialog and reload it  \r\n\tif (commonspot.lightbox.stack.length != 0)\r\n\t{\r\n\t \tvar nextExistingWindow = commonspot.lightbox.stack.last(); \r\n\t \tnextExistingWindow.getWindow().location.reload();\r\n\t}\t\t\r\n};\r\n\r\n/**\r\n * Close all lightboxes, apart the innermost one\r\n */\r\ncommonspot.lightbox.closeChildDialogs = function()\r\n{\r\n\tfor(var i = commonspot.lightbox.stack.length-1; i > 0; i--)\r\n\t{\r\n\t\tcommonspot.lightbox.stack[i].close();  \r\n\t}\r\n};\r\n\r\n/**\r\n * Close all child lightboxes from given position\r\n */\r\ncommonspot.lightbox.closeChildDlgsFromPosition = function(currPos)\r\n{\r\n\tif (typeof currPos === 'undefined')\r\n\t\tcurrPos = -1;  //if pass nothing, close all... ??\r\n\t\t\r\n\tvar endPos = commonspot.lightbox.stack.length - 1;\r\n\t\r\n\tfor (var i=endPos; i > currPos; i--)\r\n\t\tcommonspot.lightbox.stack[i].close();\r\n};\r\n\r\n/**\r\n * Close given number of lightboxes \r\n */\r\ncommonspot.lightbox.closeTopChildDialogs = function(count)\r\n{\r\n\tif (!count)\r\n\t\treturn;\r\n\tstart = commonspot.lightbox.stack.length - 1;\r\n\tend = ((start - count) > -1) ? (start - count) : -1;\r\n\r\n\tfor(var i = start; i > end; i--)\r\n\t{\r\n\t\tcommonspot.lightbox.stack[i].close();\r\n\t}\t\r\n};\r\n\r\n/**\r\n * Close all lightboxes\r\n */\r\ncommonspot.lightbox.closeAllDialogs = function()\r\n{\r\n\tvar endPos = commonspot.lightbox.stack.length - 1;\r\n\t\r\n\tfor (var i = endPos; i >= 0; i--)\r\n\t\tcommonspot.lightbox.stack[i].close();  \r\n};\r\n\r\ncommonspot.lightbox.reloadPage = function()\r\n{\r\n\tvar pFrame = top.document.getElementById('page_frame');\r\n\tif (pFrame)\r\n\t\tpFrame.contentWindow.location.reload();\t\r\n\telse if (!commonspot.lview)\r\n\t\twindow.location.reload();\r\n};\r\ncommonspot.lightbox.reloadAdmin = function()\r\n{\r\n\tvar pFrame = top.document.getElementById('admin_iframe');\r\n\tif (pFrame)\r\n\t\tpFrame.contentWindow.location.reload();\t\r\n\telse if (!commonspot.lview)\r\n\t\twindow.location.reload();\r\n};\r\n/**\r\n * Resize, setup and show the dialog inside the topmost lightbox\r\n * @param w\t\t\t  (int). Required. Width of the dialog\r\n * @param h\t\t\t  (int). Required. Height of the dialog\r\n * @param dialogInfo  (object). Required. Info about required for dialog's furniture \r\n * {title (string), subtitle (string), helpId (string), close (boolean), reload (boolean), maximize (boolean)}\r\n * @param closeCallback (string). Optional. A callback function to be called on dialog's close \r\n * @param includeAlerts (boolean). Optional, default false. Affects topmost non-alert lightbox unless this is true.\r\n */\r\ncommonspot.lightbox.initCurrent = function(w, h, dialogInfo, closeCallback, includeAlerts)\r\n{\r\n\tvar currentDialog = commonspot.lightbox.getCurrent(includeAlerts);\r\n\tif(currentDialog)\r\n\t{\r\n\t\tif ((typeof closeCallback != 'undefined') && (closeCallback != '') && (currentDialog.hasCloseButton)) \r\n\t\t\tcurrentDialog.closeImg.onclick = function(){ currentDialog.getWindow()[closeCallback]();};\r\n\t\t\r\n\t\tcurrentDialog.resize(w, h);\r\n\t\tcurrentDialog.show();\r\n\t\tif(dialogInfo)\r\n\t\t{\r\n\t\t\t// Populate the furniture\r\n\t\t\tcurrentDialog.setUpFurniture(dialogInfo);\r\n\t\t}\r\n\t\tcurrentDialog.getWindow().focus();\r\n\t\tcurrentDialog.origWidth = currentDialog.width;\r\n\t\tcurrentDialog.origHeight = currentDialog.height;\r\n\r\n\t\tif(currentDialog.showQAButtons)\r\n\t\t\tcommonspot.lightbox.getQAStatus(currentDialog);\r\n\t}\r\n};\r\n\r\n/**\r\n * Dialogs that have a DOM handler (typically server ones) should call this to let the handler do its job\r\n * Additionally, it extract info from the dialog to populate the furniture\r\n */\r\ncommonspot.lightbox.initCurrentServerDialog = function(index)\r\n{\r\n\tif (commonspot.lightbox.stack.length > 0)\r\n\t{\r\n\t\tvar currentDialog = commonspot.lightbox.stack.last();\r\n\t\tvar win = currentDialog.getWindow();\r\n\t\t// Extract info from the dialog\t\r\n\t\tvar dialogInfo = commonspot.lightbox.extractServerDialogInfo(win, index);\r\n\t\tif (dialogInfo.maximize)\r\n\t\t\tcommonspot.lightbox.stack.last().hasMaxButton = true;\r\n\t\telse\r\n\t\t\tcommonspot.lightbox.stack.last().hasMaxButton = false;\r\n\t\tif(win.onLightboxLoad)\r\n\t\t{\r\n\t\t\twin.onLightboxLoad();\r\n\t\t}\t\r\n\t\tcurrentDialog.setUpFurniture(dialogInfo);\r\n\t\tcommonspot.lightbox.stack.last().origWidth = currentDialog.width;\r\n\t\tcommonspot.lightbox.stack.last().origHeight = currentDialog.height;\r\n\t}\r\n};\r\n\r\n/**\r\n*  function called by maximize / restore button of a lighbox dialog \r\n*  @param iconObj. Required. A reference to the maximize/restore button object\r\n*/\r\ncommonspot.lightbox.callResize = function(iconObj,forceAction)\r\n{\r\n\tvar currentDialog = commonspot.lightbox.stack.last();\r\n\tif (!iconObj)\r\n\t\ticonObj = document.getElementById('restoreImg_' + currentDialog.zIndexCounter);\r\n\tvar tmpClassName = iconObj.className;\r\n\tvar curAction = forceAction ? forceAction : null;\r\n\tif (!curAction)\r\n\t\tcurAction = tmpClassName.indexOf('ico_maximize')>-1 ? 'maximize' : 'minimize';\r\n\r\n\tif (curAction == 'maximize')\r\n\t{\r\n\t\t// resize window to max size\r\n\t\ttmpClassName=tmpClassName.replace('ico_maximize','ico_pop');\r\n\t\ticonObj.title='Restore Down';\r\n\t\tvar maxVals = commonspot.lightbox.getMaxSize();\r\n\t\tcurrentDialog.resize(maxVals.width-60, maxVals.height);\r\n\t}\r\n\telse if (curAction == 'minimize')\r\n\t{\r\n\t\t// restore window to its original size\r\n\t\ttmpClassName=tmpClassName.replace('ico_pop','ico_maximize');\r\n\t\ticonObj.title='Maximize';\r\n\t\t//commonspot.lightbox.recalcLightboxSizeByPos(commonspot.lightbox.stack.length-1);\r\n\t\tcurrentDialog.resize(currentDialog.origWidth, currentDialog.origHeight);\r\n\t}\r\n\ticonObj.className = tmpClassName;\r\n\tvar win = currentDialog.getWindow();\r\n\r\n\tif (typeof win.HandleOnResize == 'function')\r\n\t\tsetTimeout(function(){\r\n\t\t\twin.HandleOnResize();\r\n\t\t}, 150);\r\n};\r\n\r\n\r\n\r\ncommonspot.lightbox.forceResizeWindow = function(forceAction)\r\n{\r\n\tvar currentDialog = commonspot.lightbox.stack.last();\r\n\tif (currentDialog)\r\n\t{\r\n\t\tvar iconObj = document.getElementById('restoreImg_' + currentDialog.zIndexCounter);\r\n\t\tif (iconObj)\r\n\t\t\tcommonspot.lightbox.callResize(iconObj,forceAction);\t\r\n\t}\r\n};\r\n\r\n/**\r\n * Extract information from a server dialog that will be used to set up the furniture (title, subtitle etc)\r\n * @param win\t\t\t(window). Required. A reference to the dialog's window object\r\n */\r\ncommonspot.lightbox.extractServerDialogInfo = function(win, index)\r\n{\r\n\tvar doc = win.document;\r\n\t// index is defined when coming from page with tabs. without this index we are not updating\r\n\t// the lightbox subtitle.\r\n\tif (typeof index == 'undefined')\r\n\t\tvar index = 0;\r\n\tvar info = {\r\n\t\ttitle: '',\r\n\t\tsubtitle: '',\r\n\t\tmaximize: false,\r\n\t\treload: true,\r\n\t\tclose: true\r\n\t};\r\n\tvar titleCell = '';\t\r\n\tvar subtitleCell = '';\r\n\tvar errorCells = '';\r\n\t\r\n\ttitleCell = getElementsByClassNameLocal(\"cs_dlgTitle\")[index];\r\n\r\n\tif(titleCell)\r\n\t{\r\n\t\tinfo.title = titleCell.innerHTML;\r\n\t\ttitleCell.style.display = 'none';\r\n\t}\r\n\t\r\n\tsubtitleCell = getElementsByClassNameLocal('cs_dlgDesc')[index];\r\n\tif(subtitleCell)\r\n\t{\r\n\t\tinfo.subtitle = '<div>' + subtitleCell.innerHTML + '</div>';\r\n\t\tsubtitleCell.style.display = 'none';\r\n\t}\r\n\t\r\n\terrorCells = getElementsByClassNameLocal('cs_lightboxServerDlgError');\r\n\tfor(var i = 0; i < errorCells.length; i++)\r\n\t{\r\n\t\tinfo.subtitle += '<div class=\"cs_dlgError\">' + errorCells[i].innerHTML + '</div>';\r\n\t\terrorCells[i].style.display = 'none';\r\n\t}\r\n\t\r\n\t// Help id should be stored inside a global JavaScript variable in the dialog\r\n\tif(win.DIALOG_HELP_ID)\r\n\t\tinfo.helpId = win.DIALOG_HELP_ID;\r\n\r\n\tvar mainTable = win.document.getElementById('MainTable');\r\n\t\r\n\tif (mainTable && mainTable.className && (mainTable.className).indexOf('allowMaximize')>-1)\r\n\t\tinfo.maximize = true;\r\n\t\t\r\n\tif (mainTable && mainTable.className && (mainTable.className).indexOf('hideReload')>-1)\r\n\t\tinfo.reload = false;\r\n\r\n\tif (mainTable && mainTable.className && (mainTable.className).indexOf('hideClose')>-1)\r\n\t\tinfo.close = false;\r\n\t\t\r\n\treturn info;\r\n\t\r\n\t\r\n\tfunction getElementsByClassNameLocal(className)\r\n\t{\r\n\t\tif (typeof win.document.getElementsByClassName == 'function')\r\n\t\t\treturn win.document.getElementsByClassName(className); // call native version of getElementsByClassName\r\n\t\telse\r\n\t\t\treturn document.getElementsByClassName(className,doc); // call prototype version\r\n\t}\r\n};\r\n\r\n/**\r\n * Resize the dialog inside the topmost lightbox\r\n * @param w\t\t\t(int). Required. Width\r\n * @param h\t\t\t(int). Required. Height\r\n */\r\ncommonspot.lightbox.resizeCurrent = function(w, h)\r\n{\r\n\tif (commonspot.lightbox.stack.length > 0)\r\n\t{\r\n\t\tvar currentDialog = commonspot.lightbox.stack.last();\r\n\t\tcurrentDialog.resize(w, h);\r\n\t\tcommonspot.lightbox.stack.last().origWidth = currentDialog.width;\r\n\t\tcommonspot.lightbox.stack.last().origHeight = currentDialog.height;\r\n\t}\r\n};\r\n\r\n/**\r\n * Resize the dialog inside the topmost lightbox\r\n * @param w\t\t\t(int). Required. Width\r\n * @param h\t\t\t(int). Required. Height\r\n */\r\ncommonspot.lightbox.recalcLightboxSizeByPos = function(pos)\r\n{\r\n\tif (commonspot.lightbox.stack.length > pos && commonspot.lightbox.stack.length > 0)\r\n\t{\r\n\t\tvar currentDialog = commonspot.lightbox.stack[pos];\r\n\t\tvar win = currentDialog.getWindow();\r\n\t\tvar maintable = win.document.getElementById('MainTable');\r\n\t\tif(maintable)\r\n\t\t\tcurrentDialog.resize(maintable.offsetWidth, maintable.offsetHeight + 65);\r\n\t\telse\r\n\t\t{\r\n\t\t\tmaintable = win.document.getElementById('pagelistContainerDiv');\r\n\t\t\tif(maintable)\r\n\t\t\t\tcurrentDialog.resize(maintable.offsetWidth - 20, maintable.offsetHeight + 81);\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/**\r\n * Return the frame name of the topmost dialog, null if no dialog is opened\r\n */\r\ncommonspot.lightbox.getFrameName = function()\r\n{\r\n\tif (commonspot.lightbox.stack.length > 0)\r\n\t{\r\n\t\tvar currentDialog = commonspot.lightbox.stack.last();\r\n\t\treturn currentDialog.getFrameName();\r\n\t}\r\n\telse\r\n\t{\r\n\t\treturn null;\r\n\t}\r\n};\r\n\r\n/**\r\n * Return the max size currently available for a lightbox\r\n * @return {width, height}\r\n */\r\ncommonspot.lightbox.getMaxSize = function()\r\n{\r\n\tvar maxSize = {};\r\n\tvar winDimensions = commonspot.lightbox.getWinSize();\r\n\tmaxSize.height = winDimensions.height - commonspot.lightbox.FURNITURE_HEIGHT - commonspot.lightbox.WINDOW_MARGINS;\r\n\tmaxSize.width = winDimensions.width - commonspot.lightbox.FURNITURE_WIDTH;\r\n\treturn maxSize;\r\n};\r\n\r\n\r\n/**\r\n * Return the opener window of the topmost dialog, null if no opener\r\n * Actually, we only know top window's real opener if it was passed into dialogFactory.getInstance or openDialog\r\n * \tmostly nobody does that, except newWindow, in overrides.js, passes the current window as opener\r\n * If we don't have real opener, or if ignoreOpenerProperty is true, we return window of next-to-top lightbox\r\n */\r\ncommonspot.lightbox.getOpenerWindow = function(ignoreOpenerProperty)\r\n{\r\n\t\tif (commonspot.lightbox.stack.length > 1)\r\n\t\t{\r\n\t\t\t// Opened by another dialog\r\n\t\t\tvar thisDialog = commonspot.lightbox.stack.last();\r\n\t\t\tif (thisDialog.opener && !ignoreOpenerProperty)\r\n\t\t\t\treturn thisDialog.opener;\r\n\t\t\tvar previousDialog = commonspot.lightbox.stack[commonspot.lightbox.stack.length - 2];\r\n\t\t\treturn previousDialog.getWindow();\r\n\t\t}\r\n\t\telse\r\n\t\t\treturn commonspot.lightbox.getVisibleFrameWindow(); // not true in admin modes, but needed to create a pg from there\r\n};\r\n\r\n/*\r\n* some cases chrome and safari need this.\r\n*/\r\ncommonspot.lightbox.getOpenerLightboxFrame = function()\r\n{\r\n\tvar iframeNode = null;\r\n\tif (commonspot.lightbox.stack.length > 1)\r\n\t\tiframeNode = commonspot.lightbox.stack[commonspot.lightbox.stack.length - 2].iframeNode;\r\n\treturn iframeNode;\r\n};\r\n\r\n/**\r\n* checks who amin-frame or lview-frame who is visible and returns that\r\n**/\r\ncommonspot.lightbox.getVisibleFrameWindow = function()\r\n{\r\n\t// for now, just returning pageFrame as there are few situations where this logic is not right.\r\n\treturn commonspot.lightbox.getPageWindow();\r\n\t\r\n\tvar cursection;\r\n\tvar modes = ['mycs','lview','admin'];\r\n\t// not sure here for mycs, returning page_frame is correct or not. when we decide what is correct, we should change the first element of the below array to it.\r\n\tvar windows = ['page_frame','page_frame','admin_iframe'];\r\n\tfor (var i=0; i<modes.length; i++)\r\n\t{\r\n\t\tcursection = top.document.getElementById(modes[i]);\r\n\t\tcurWin = top.document.getElementById(windows[i]).contentWindow;\t\r\n\t\t\t\r\n\t\ttry\r\n\t\t{\r\n\t\t\tcurDisplay = cursection.style.display;\t\t\r\n\t\t}\r\n\t\tcatch(e)\r\n\t\t{\r\n\t\t\tcurDisplay = 'none';\r\n\t\t}\r\n\t\r\n\t\tif (curDisplay != 'none')\r\n\t\t\treturn curWin;\r\n\t}\r\n};\r\n\r\n/**\r\n*\treturns contentWindow of page-frame\r\n*/\r\ncommonspot.lightbox.getPageWindow = function()\r\n{\r\n\tvar pFrame = top.document.getElementById('page_frame');\r\n\tvar win, href;\r\n\ttry\r\n\t{\r\n\t\tif (pFrame)\r\n\t\t{\r\n\t\t\twin = pFrame.contentWindow;\r\n\t\t\thref = win.location.href; // this is only a feeler to check if this is IE9 and has access denied problem\r\n\t\t\treturn win;\r\n\t\t}\r\n\t\telse\r\n\t\t\treturn top;\r\n\t}\r\n\tcatch(e)\r\n\t{\r\n\t\treturn top;\r\n\t}\r\n};\r\n\r\n/**\r\n*\treturns contentWindow of admin-frame\r\n*/\r\ncommonspot.lightbox.getAdminWindow = function()\r\n{\r\n\tvar win = top.document.getElementById('admin_iframe').contentWindow;\r\n\treturn (win ? win : null);\r\n};\r\n\r\n// returns next-to-top lightbox object (NOT its window)\r\n// DOES NOT honor explicit opener property of lightbox object\r\ncommonspot.lightbox.getNextToTopDlg = function(returnOpenerWhenEmpty)\r\n{\r\n\tvar pos = commonspot.lightbox.stack.length - 2;\r\n\tvar parentDialog = null;\r\n\tif (pos >= 0)\r\n\t\tparentDialog = commonspot.lightbox.stack[pos];\r\n\telse\r\n\t{\r\n\t\tif (returnOpenerWhenEmpty)\r\n\t\t\treturn commonspot.lightbox.getPageWindow();\r\n\t}\t\r\n\treturn parentDialog;\r\n}\r\n\r\n// keep closing parent dlgs until we find one with requested callback, then return it\r\ncommonspot.lightbox.findCallbackInAncestorWindow = function(callback)\r\n{\r\n\tvar parentDlg, dlgCallback, pWindow, shouldBreak=0;\r\n\tvar lightbox = commonspot.lightbox; // local ref, so we don't lose it as dlgs close; calling code should do the same to run callback\r\n\tvar pageWindow = lightbox.getPageWindow();\r\n\twhile((parentDlg = lightbox.getNextToTopDlg(true)) && !shouldBreak)\r\n\t{\r\n\t\t\r\n\t\tif (typeof parentDlg.getWindow == 'function')\r\n\t\t{\r\n\t\t\tpWindow = parentDlg.getWindow();\r\n\t\t\tshouldBreak = pWindow == pageWindow ? 1 : 0;\r\n\t\t\tdlgCallback = pWindow[callback];\r\n\t\t}\t\r\n\t\telse\r\n\t\t{\r\n\t\t\tshouldBreak = parentDlg == pageWindow ? 1 : 0;\r\n\t\t\tdlgCallback = parentDlg[callback];\r\n\t\t}\t\r\n\t\t\t\r\n\t\tif(dlgCallback)\r\n\t\t\treturn dlgCallback;\r\n\t\telse\r\n\t\t\tparentDlg.close();\r\n\t}\r\n\treturn null; // didn't find callback, oops\r\n}\r\n\r\n/*\r\n * Function to handle specific key presses.\r\n */\r\ncommonspot.lightbox.handleDialogKeys = function(e)\r\n{\r\n\tif(!commonspot.lightbox.getCurrent().hasCloseButton)\r\n\t\treturn;\r\n\tvar code;\r\n\t\r\n\tif (!e) \r\n\t\tvar e = window.event; // Get event.\r\n\r\n\t// Get key code.\r\n\tif (e.keyCode) \r\n\t\tcode = e.keyCode;\r\n\telse if (e.which) \r\n\t\tcode = e.which;\r\n\t\r\n\tswitch (code) \r\n\t{\r\n\t\tcase 27: // Escape key\r\n\t\t\tcommonspot.lightbox.closeBtnOnClick();\r\n\t\t\tbreak;\r\n\t}\r\n}\t\t\r\n/*\r\n* should this go in a sperate namespace and file ??\r\n*/\r\nvar commonspotData = {};\r\ncommonspot.lightbox.getQAStatus = function(dlgObj)\r\n{\r\n\tif (!e) \r\n\t\tvar e = window.event; // Get event.\r\n\tdlgObj.QAStatusUpdated = true;\t\r\n\tvar args = {};\t\r\n\tvar temp = '';\r\n\tvar obsArr = [];\r\n\tvar win = dlgObj.getWindow();\r\n\tvar frName = dlgObj.getFrameName();\r\n\tvar frObj;\r\n\t/* we should have this somewhere common\r\n\t\tthese are the titles that multiple dialogs can have. so do not expect them to be unique \r\n\t*/\r\n\tvar generalDialogTitles = ('CommonSpot Error,Debug Help Status,CommonSpot Message,About CommonSpot,CommonSpot Security Exception').split(\",\");;\r\n\tif (frName == 'error')\r\n\t\treturn;\r\n\tvar formFlds = win.document.getElementsByName(\"fromlongproc\");\r\n\tif (formFlds.length)\r\n\t{\r\n\t\t//there may be more than 1\r\n\t\tfor(var i=0;i<formFlds.length;i++)\r\n\t\t{\r\n\t\t\tif (formFlds[i].value == 1)\r\n\t\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tobsArr = document.getElementsByName(frName);\r\n\tfor (var i=0; i<obsArr.length; i++)\r\n\t{\r\n\t\tif (obsArr[i].tagName.toLowerCase() == 'iframe')\r\n\t\t\tfrObj = obsArr[i];\r\n\t}\r\n\tif (!frObj)\r\n\t\treturn;\r\n\tvar hashArgs = commonspot.util.getHashArgs();\r\n\tif (!hashArgs)\r\n\t\treturn;\r\n\tvar mode = hashArgs.mode || commonspot.clientUI.state.mode.MYCS;\t\r\n\tvar LOADER_URL;\r\n\t// Set loader appropriately (based on Server Admin mode or not).\r\n\tif (mode != 'server_admin')\r\n\t{\r\n\t\tvar url = hashArgs.url;\r\n\t\tif (url.length > 0)\r\n\t\t\tLOADER_URL = commonspot.clientUI.state.location.getPathFromUrlStr(url) + 'loader.cfm';\r\n\t}\r\n\telse\r\n\t\tLOADER_URL = '/commonspot/admin/loader.cfm';\r\n\tif (!LOADER_URL || commonspot.data.Users_GetUserInfo.getCurrentRow().name == '')\r\n\t{\t\r\n\t\tcommonspot.lightbox.hideQAElements('All');\r\n\t\treturn;\t\t\r\n\t}\r\n\targs.widgetName = dlgObj.headerTitle.innerHTML;\r\n\targs.widgetNameSrc = 'Request.params.csModule';\r\n\targs.queryString = '';\r\n\targs.statusType = \"QA\";\r\n\targs.formParams = '';\r\n\targs.helpObjectType = 'CFMDialog';\r\n\targs.helpObjectTitle = (args.widgetName != '') ? args.widgetName : win.document.title;\r\n\tif (args.widgetName == '')\r\n\t\targs.widgetName = args.helpObjectTitle;\r\n\tif ((generalDialogTitles.indexOf(win.document.title) >= 0)\r\n\t\t\t\t|| ((win.document.title).indexOf('Debug Help Status') == 0))\r\n\t{\r\n\t\tcommonspot.lightbox.hideQAElements('All');\r\n\t\treturn;\t\r\n\t}\t\r\n\targs.moduleName = unescape(frObj.src.toLowerCase());\r\n\tif (args.moduleName != '')\r\n\t{\r\n\t\t// first remove any protocol (if found) from the module name\r\n\t\tvar index = args.moduleName.match(/^\\s*https?:\\/\\/[^\\/]*/);\r\n\t\targs.moduleName = args.moduleName.replace(index,''); \r\n\t\tindex = args.moduleName.indexOf('csmodule');\r\n\t\tif (index >= 0) // legacy\r\n\t\t{\r\n\t\t\targs.widgetNameSrc = \"Request.params.csModule\";\r\n\t\t\ttemp = args.moduleName.substring(index);\r\n\t\t\t// look for csmodule=\r\n\t\t\tvar begin = temp.indexOf('csmodule=');\r\n\t\t\tif (begin >= 0)\r\n\t\t\t\tbegin = begin+9;\r\n\t\t\t// remove any query string part after csmodule value\r\n\t\t\tvar end = temp.indexOf('&');\r\n\t\t\tif (begin>=0 && end>=0 && end>begin) // get just csmodule part if there is querystring\r\n\t\t\t\targs.moduleName = temp.substring(begin,end);\r\n\t\t\telse if (begin>=0) // get csmodule part\r\n\t\t\t\targs.moduleName = temp.substring(begin);\t\r\n\t\t}\t\r\n\t\telse //spry\r\n\t\t{\r\n\t\t\tindex = args.moduleName.indexOf('/commonspot/dashboard/');\r\n\t\t\tif (index >= 0)\r\n\t\t\t{\r\n\t\t\t\targs.moduleName = args.moduleName.substring(index);\r\n\t\t\t\tindex = args.moduleName.indexOf('?');\r\n\t\t\t\tif (index >= 0)\r\n\t\t\t\t\targs.moduleName = args.moduleName.substring(0,index);\r\n\t\t\t\targs.widgetNameSrc = \"SPRY Dialog URL\";\r\n\t\t\t\targs.helpObjectType = \"AJAXDialog\";\r\n\t\t\t}\t\r\n\t\t}\r\n\t}\r\n\tif (!args.widgetName.length)\r\n\t{\r\n\t\tcommonspot.lightbox.hideQAElements('All');\r\n\t\treturn;\r\n\t}\t\r\n\tcommonspotData.DebugHelp_getHelpObjectStatus = new commonspot.spry.Dataset({ xpath: commonspot.data.ARRAY_XPATH });\t\r\n\tvar collectionOptions = {closeOnError: 0, overlayElementID: '', onCompleteCallback: commonspot.lightbox.onCompleteCallback_GetHelpObjectStatus};\r\n\tvar cmd = commonspot.ajax.commandEngine.commandCollectionFactory.getInstance(LOADER_URL, collectionOptions);\r\n\tcmdOptions = {datasetRoot: commonspotData, datasetName: 'DebugHelp_getHelpObjectStatus'};\t\r\n\tcmd.add('DebugHelp', 'getHelpObjectStatus', args,  cmdOptions); \r\n\tcmd.send();\t\t\r\n\r\n}\r\n\r\ncommonspot.lightbox.onCompleteCallback_GetHelpObjectStatus = function()\r\n{\r\n\tif(this.hasAnyError)\r\n\t{\r\n\t\tcommonspot.lightbox.hideQAElements('All');\r\n\t\treturn;  \r\n\t}\t\r\n\tvar data = commonspotData.DebugHelp_getHelpObjectStatus.getData()[0];\r\n\tif (!data)\r\n\t{\r\n\t\tcommonspot.lightbox.hideQAElements('All');\r\n\t\treturn;\r\n\t}\t\r\n\tvar frName = commonspot.lightbox.stack.last().getFrameName();\r\n\tvar statusMsg = window.document.getElementById('QAStatusMsg_' + frName);\r\n\tvar statusIcon = window.document.getElementById('statusIcon_' + frName);\r\n\tvar qaIcon = window.document.getElementById('qaIcon_' + frName);\r\n\tvar reportsIcon = window.document.getElementById('reportsIcon_' + frName);\r\n\tvar mapStatus = data[\"helpmodulestatus\"];\r\n\tvar intMapStatus;\r\n\tvar statusText = \"\";\r\n\tvar statusColor = 'green';\r\n\tswitch(mapStatus)\r\n\t{\r\n\t\tcase \"AutoMapped\":\r\n\t\t\tstatusText = \"AUTO\";\r\n\t\t\tstatusColor = 'lightgreen';\r\n\t\t\tintMapStatus = 1;\r\n\t\t\tbreak;\r\n\t\tcase \"Mapped\":\r\n\t\t\tstatusText = \"MAP\";\r\n\t\t\tstatusColor = 'lightgreen';\r\n\t\t\tintMapStatus = 2;\r\n\t\t\tbreak;\r\n\t\tcase \"MappedBroken\":\r\n\t\t\tstatusText = \"MAP-B\";\r\n\t\t\tstatusColor = 'tomato';\r\n\t\t\tintMapStatus = 3;\r\n\t\t\tbreak;\r\n\t\tcase \"MappedCanBeAuto\":\r\n\t\t\tstatusText = \"MAP-A?\";\r\n\t\t\tstatusColor = 'yellow';\r\n\t\t\tintMapStatus = 4;\r\n\t\t\tbreak;\r\n\t\tcase \"NeedsMapDuplicate\":\r\n\t\t\tstatusText = \"NO MAP-DUP\";\r\n\t\t\tstatusColor = 'tomato';\r\n\t\t\tintMapStatus = 5;\r\n\t\t\tbreak;\r\n\t\tcase \"NeedsMapNone\":\r\n\t\t\tstatusText = \"NO MAP-NONE\";\r\n\t\t\tstatusColor = 'tomato';\r\n\t\t\tintMapStatus = 6;\r\n\t\t\tbreak;\r\n\t}\r\n\tif (statusMsg)\r\n\t{\r\n\t\tstatusMsg.style.backgroundColor = statusColor;\r\n\t\tstatusMsg.innerHTML = statusText;\r\n\t\tstatusMsg.onclick = function(e) \r\n\t\t{\r\n\t\t\tvar event = e || window.event;\t\r\n\t\t   if(typeof event.stopPropagation!='undefined')\r\n\t\t      event.stopPropagation();\r\n\t\t   else\r\n\t\t      event.cancelBubble=true;\t\t\t\r\n\t\t\tcommonspot.lightbox.openDialog('/commonspot/dashboard/dialogs/common/map-dialog.html?HelpObjectID=' + data[\"helpobjectid\"],false, null, null, null, null, true);\r\n\t\t};\t\r\n\t}\r\n\tif (intMapStatus >= 5)\r\n\t{\r\n\t\tvar eleList = 'docIcon_'+frName+',qaIcon_'+frName;\r\n\t\t//commonspot.lightbox.hideQAElements(eleList);\r\n\t}\r\n\r\n\tvar color = (data[\"statuscategorycolor\"] == '' ? 'red' : data[\"statuscategorycolor\"]).toLowerCase();\r\n\tvar type = data[\"statustype\"];\r\n\tif (statusIcon)\r\n\t{\r\n\t\tstatusIcon.onclick = function(e)\r\n\t\t{\r\n\t\t\tvar event = e || window.event;\r\n\t\t\tif(typeof event.stopPropagation!='undefined')\t\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\telse\r\n\t\t\t\tevent.cancelBubble=true;\r\n\t\t\tcommonspot.lightbox.openDialog('/commonspot/dashboard/dialogs/common/module-mapping-status-report.html',false, null, null, null, null, true);\r\n\t\t}\r\n\t}\r\n\tif (qaIcon)\t\r\n\t{\r\n\t\t// if (type == 'QA' || type == '') // check current record type (can be 'QA' or 'Doc'\r\n\t\t\tqaIcon.src = '/commonspot/private/' + color + '.png';\t\r\n\t\tqaIcon.onclick = function(e)\r\n\t\t{\r\n\t\t\tvar event = e || window.event;\t\r\n\t\t   if(typeof event.stopPropagation!='undefined')\r\n\t\t      event.stopPropagation();\r\n\t\t   else\r\n\t\t      event.cancelBubble=true;\t\r\n\t\t\tcommonspot.lightbox.openDialog('/commonspot/dashboard/dialogs/common/debug-status.html' +\r\n\t\t\t\t\t\t\t\t\t\t\t'?HelpObjectID=' + data[\"helpobjectid\"] +\r\n\t\t\t\t\t\t\t\t\t\t\t'&HelpObjectTitle=' + escape(data[\"helpobjecttitle\"]) +\r\n\t\t\t\t\t\t\t\t\t\t\t'&HelpObjectType=' + data[\"helpobjecttype\"] +\r\n\t\t\t\t\t\t\t\t\t\t\t'&MappingCount=' + data[\"mappingcount\"] +\r\n\t\t\t\t\t\t\t\t\t\t\t'&WidgetName=' + escape(data[\"widgetname\"]) +\r\n\t\t\t\t\t\t\t\t\t\t\t'&StatusType=QA' +\r\n\t\t\t\t\t\t\t\t\t\t\t'&WidgetNameSource=' + escape(data[\"widgetnamesrc\"]),false, null, null, null, null, true);\r\n\t\t}\r\n\t}\r\n\tif (reportsIcon)\r\n\t{\r\n\t\treportsIcon.onclick = function(e)\r\n\t\t{\r\n\t\t\tvar event = e || window.event;\t\r\n\t\t   if(typeof event.stopPropagation!='undefined')\r\n\t\t      event.stopPropagation();\r\n\t\t   else\r\n\t\t      event.cancelBubble=true;\t\t\t\r\n\t\t\tcommonspot.lightbox.openDialog('/commonspot/dashboard/dialogs/common/help-status-report.html' +\r\n\t\t\t\t\t\t\t\t\t\t\t'?HelpObjectID=' + data[\"helpobjectid\"] +\r\n\t\t\t\t\t\t\t\t\t\t\t'&HelpObjectTitle=' + escape(data[\"helpobjecttitle\"]) +\r\n\t\t\t\t\t\t\t\t\t\t\t'&HelpObjectType=' + data[\"helpobjecttype\"] +\r\n\t\t\t\t\t\t\t\t\t\t\t'&MappingCount=' + data[\"mappingcount\"] +\r\n\t\t\t\t\t\t\t\t\t\t\t'&WidgetName=' + escape(data[\"widgetname\"]) +\r\n\t\t\t\t\t\t\t\t\t\t\t'&WidgetNameSource=' + escape(data[\"widgetnamesrc\"]),false, null, null, null, null, true);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n/**\r\n * Singleton, object factory for lightboxed dialogs\r\n */\r\ncommonspot.lightbox.dialogFactory = {};\r\ncommonspot.lightbox.dialogFactory.zIndexCounter = 1000;\r\n\r\n\r\n/**\r\n * Factory method for lightboxed dialogs\r\n * @param url\t\t\t(string). Required\r\n * @param hideClose  (boolean). Optional. Set it to true to remove the close button from furniture's top right corner\r\n */\r\ncommonspot.lightbox.dialogFactory.getInstance = function(args)\r\n{\r\n\t//url, hideClose, name, customOverlayMsg, dialogType, opener, hideHelp, hideReload\r\n\tvar dialogObj = {dialogType: args.dialogType, opener: args.opener};\r\n\tvar bodyNode = top.document.getElementsByTagName('body')[0];\r\n\tvar nextZindex = commonspot.lightbox.dialogFactory.zIndexCounter +1;\r\n\tvar overlayMsg = 'Loading...';\r\n\tvar overlayTitle = 'Loading, please wait';\r\n\tvar cVal = commonspot.util.cookie.readCookie('REGISTERDIALOGS');\r\n\tvar onClick; \r\n\tif (args.customOverlayMsg)\r\n\t\toverlayMsg = overlayTitle = args.customOverlayMsg;\r\n\tif(overlayMsg != commonspot.lightbox.NO_OVERLAY_MSG)\r\n\t\tcommonspot.lightbox.loadingMsg.show(overlayMsg, overlayTitle);\r\n\tdialogObj.zIndexCounter = nextZindex;\r\n\tdialogObj.top = commonspot.lightbox.DEFAULT_TOP;\r\n\tdialogObj.boxWidth, dialogObj.width, dialogObj.height, dialogObj.left;\r\n\tdialogObj.frameName = args.name ? args.name : 'lightboxFrame_' + nextZindex;\r\n\tdialogObj.hasCloseButton = true;\r\n\tdialogObj.showQAButtons =  cVal == 'ON' ? true : false;\r\n\tif (args.hideHelp)\r\n\t\tdialogObj.showQAButtons = false;\r\n\tdialogObj.hasMaxButton = true;\r\n\tif(args.hideClose)\r\n\t{\r\n\t\tdialogObj.hasCloseButton = false;\r\n\t\tdialogObj.hasMaxButton = false;\r\n\t}\r\n\r\n\tvar onclick = function(e) {\r\n\t   var event = e || window.event;\t \r\n\t   if(typeof event.stopPropagation!='undefined')\r\n\t      event.stopPropagation();\r\n\t   else\r\n\t      event.cancelBubble=true;\t\t\r\n\t};\r\n\t// Create the overlay layer\r\n\tdialogObj.overlayDiv = commonspot.util.dom.addToDom({objType:'DIV', objID: 'lightboxOverlay_' + nextZindex, objClass:'lightboxOverlay', objOnClick: onclick, objParent:bodyNode});\r\n\t\r\n\tdialogObj.overlayDiv.style.opacity = '.45';\r\n\tdialogObj.overlayDiv.style.filter='alpha(opacity=45);';\r\n\tdialogObj.overlayDiv.style.zIndex = nextZindex;\r\n\tdialogObj.overlayDiv.style.height = commonspot.util.dom.getWinScrollSize().height + 'px';\r\n\t\r\n\t// Main container\r\n\tdialogObj.divNode = top.document.createElement('div');\r\n\tdialogObj.divNode.className = 'lightboxContainer drag';\r\n\tdialogObj.divNode.onclick = function(e) { \r\n\t   var event = e || window.event;\t \r\n\t   if(typeof event.stopPropagation!='undefined')\r\n\t      event.stopPropagation();\r\n\t   else\r\n\t      event.cancelBubble=true;\t\r\n\t}\r\n\tdialogObj.divNode.style.zIndex = nextZindex +1;\r\n\tdialogObj.divNode.style.top = '-5000px';\r\n\tvar thisZIndex = nextZindex+2;\r\n\t\r\n\t// Top corners\r\n\tdialogObj.topCorners = commonspot.util.dom.addToDom({objType:'DIV', objID: 'lightboxTopCorner_' + nextZindex, objClass:'lightboxTopCorner', objHTML:commonspot.lightbox.generateHTMLcorners('t'), objParent:dialogObj.divNode});\t\r\n\tdialogObj.topCorners.style.zIndex = thisZIndex;\r\n\t// Header section\r\n\tdialogObj.header = top.document.createElement('div');\r\n\tdialogObj.header.className = 'lightboxHeader';\r\n\tdialogObj.header.id = 'lightboxHeader_' + nextZindex;\r\n\tdialogObj.header.onmousedown = OnMouseDown;\r\n\tdialogObj.header.onmouseup = OnMouseUp;\r\n\t\r\n\t// Title \r\n\tdialogObj.titleContainer = commonspot.util.dom.addToDom({objType:'DIV', objClass:'lightboxTitleContainer', objParent:dialogObj.header});\t\r\n\r\n\t// Header Title\r\n\tdialogObj.headerTitle = commonspot.util.dom.addToDom({objType:'H1', objParent:dialogObj.titleContainer});\t\r\n\r\n\t// Top icons\r\n\tdialogObj.iconsContainer = top.document.createElement('div');\r\n\tdialogObj.iconsContainer.className = 'lightboxIconsContainer';\r\n\r\n\t// help icon\r\n\tif (!args.hideHelp)\r\n\t{\r\n\t\tdialogObj.helpImg = commonspot.util.dom.addToDom({objType:'SPAN', objID:'help_img', objClass:'ico_help actionMontageIcon', objTitle:'Help', objParent:dialogObj.iconsContainer});\t\r\n\t}\t\r\n\r\n\t// qa icons\r\n\tif (dialogObj.showQAButtons)\r\n\t{\r\n\t\tdialogObj.QAiconsContainer = commonspot.util.dom.addToDom({objType:'DIV', objClass: 'QAIconsContainer', objParent:dialogObj.iconsContainer});\r\n\r\n\t\tdom = commonspot.util.dom.addToDom({objType:'SPAN', objID:'QAStatusMsg_'+dialogObj.frameName, objClass:'statusMsg', objParent:dialogObj.QAiconsContainer});\r\n\r\n\t\tdom = commonspot.util.dom.addToDom({objType:'IMG', objID:'statusIcon_'+dialogObj.frameName, objClass:'statusIconClass', objTitle:'Mapping Report', objParent:dialogObj.QAiconsContainer});\r\n\t\tdom.src = ('/commonspot/dashboard/icons/application_view_detail.png');\r\n\r\n\t\tdom = commonspot.util.dom.addToDom({objType:'IMG', objID:'qaIcon_'+dialogObj.frameName, objClass:'qaIconClass', objTitle:'QA status', objParent:dialogObj.QAiconsContainer});\r\n\t\tdom.src = ('/commonspot/private/white.png');\r\n\t\t\r\n\t\tdom = commonspot.util.dom.addToDom({objType:'IMG', objID:'reportsIcon_'+dialogObj.frameName, objClass:'reportIconClass', objTitle:'Status Report', objParent:dialogObj.QAiconsContainer});\r\n\t\tdom.src = ('/commonspot/dashboard/icons/table_sort.png');\r\n\t}\r\n\t\r\n\t// Reload icon\r\n\tif (!args.hideReload)\r\n\t{\t\r\n\t\tonClick = function()\r\n\t\t{\r\n\t\t\tvar dialogWin = dialogObj.getWindow();\r\n\t\t\tif(dialogWin)\r\n\t\t\t{\r\n\t\t\t\tvar dialogSrc = (dialogObj.iframeNode.src).indexOf('commonspot/dashboard/')>=0 ? 'spry' : 'legacy';\r\n\t\t\t\tif ((commonspot.util.browser.chrome || commonspot.util.browser.safari) && dialogSrc == 'legacy')\r\n\t\t\t\t{\r\n\t\t\t\t\tif (dialogWin.spanArray)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar curSpan;\r\n\t\t\t\t\t\tvar forms;\r\n\t\t\t\t\t\tvar i = 0;\r\n\t\t\t\t\t\tvar j = 0;\r\n\t\t\t\t\t\tvar refreshDone = false;\r\n\t\t\t\t\t\tvar curID;\r\n\t\t\t\t\t\twhile (j < dialogWin.spanArray.length) // multi-tab (custome element > render mode dialog)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcurID = dialogWin.spanArray[j];\r\n\t\t\t\t\t\t\tcurSpan = dialogWin.$(curID);\r\n\t\t\t\t\t\t\tif (curSpan && curSpan.style && curSpan.style.display != 'none')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tforms = eval(\"dialogWin.$$('#\" + curID + \" form')\"); //returns nodelist\r\n\t\t\t\t\t\t\t\tif (forms.length)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\twhile(i < forms.length)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tforms[i].reset();\r\n\t\t\t\t\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\t\t\t\t\trefreshDone = true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\tj++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (dialogWin.document.forms || !refreshDone) // multi-tab or single dialog with top-level form\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar j = 0;\r\n\t\t\t\t\t\twhile (j < dialogWin.document.forms.length)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdialogWin.document.forms[j].reset();\r\n\t\t\t\t\t\t\trefreshDone = true;\r\n\t\t\t\t\t\t\tj++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!refreshDone)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar iframeNode = commonspot.lightbox.stack.last().iframeNode;\r\n\t\t\t\t\t\t//debugger;\r\n\t\t\t\t\t\tif (iframeNode)\r\n\t\t\t\t\t\t\tiframeNode.src = iframeNode.src;\r\n\t\t\t\t\t\telse\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tdialogWin.location.reload();  // catch all\r\n\t\t\t\t\t}\t\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar onLoadFunction = dialogWin.document.body.onload;\r\n\t\t\t\t\t\tif (typeof onLoadFunction == 'function')\r\n\t\t\t\t\t\t\tonLoadFunction();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\tdialogWin.location.reload();\r\n\t\t\t}\r\n\t\t}\r\n\t\tdialogObj.reloadImg = commonspot.util.dom.addToDom({objType:'SPAN', objID:'reloadImg_'+nextZindex, objClass:'ico_arrow_refresh_small actionMontageIcon', objTitle:'Refresh', objParent:dialogObj.iconsContainer, objOnClick:onClick});\r\n\t}\r\n\t\t\r\n\t\r\n\t// Maximize / Restore icon\r\n\tif(dialogObj.hasMaxButton)\r\n\t{\r\n\t\tonClick = function(event){\r\n\t\t\tvar event = event || window.event;\t \r\n\t\t\tvar target = (event && event.target) || (event && event.srcElement);\r\n\t\t\tcommonspot.lightbox.callResize(target);\r\n\t\t};\r\n\t\tdialogObj.maxImg = commonspot.util.dom.addToDom({objType:'SPAN', objID:'restoreImg_' + nextZindex, objClass:'ico_maximize actionMontageIcon', objTitle:'Maximize', objParent:dialogObj.iconsContainer, objOnClick:onClick});\r\n\r\n\t\tdialogObj.maxImg.style.display = 'none';\r\n\t}\r\n\t\r\n\t// Close icon\r\n\tif(dialogObj.hasCloseButton)\r\n\t{\r\n\t\tonClick = commonspot.lightbox.closeBtnOnClick;\r\n\t\tdialogObj.closeImg = commonspot.util.dom.addToDom({objType:'SPAN', objID:'closeImg_'+nextZindex, objClass:'ico_close actionMontageIcon', objTitle:'Close', objParent:dialogObj.iconsContainer, objOnClick:onClick});\t\r\n\t}\r\n\r\n\t// blank space to right of right most icon\r\n\tdialogObj.blankImg = commonspot.util.dom.addToDom({objType:'SPAN', objClass:'ico_blank noactionMontageIcon', objParent:dialogObj.iconsContainer});\t\r\n\t\t\r\n\tdialogObj.header.appendChild(dialogObj.iconsContainer);\r\n\tif (dialogObj.showQAButtons)\r\n\t\tdialogObj.header.appendChild(dialogObj.QAiconsContainer);\r\n\tif (!args.hideHelp)\r\n\t\tdialogObj.helpImg.innerHTML = '&nbsp;';\r\n\tif (!args.hideReload)\t\r\n\t\tdialogObj.reloadImg.innerHTML = '&nbsp;';\r\n\tif(dialogObj.hasMaxButton)\r\n\t\tdialogObj.maxImg.innerHTML = '&nbsp;';\r\n\tif(dialogObj.hasCloseButton)\t\r\n\t\tdialogObj.closeImg.innerHTML = '&nbsp;';\r\n\tdialogObj.blankImg.innerHTML = '&nbsp;';\r\n\t\t\r\n\t// subtitle\r\n\tdialogObj.subTitleContainer = commonspot.util.dom.addToDom({objType:'DIV', objClass:'lightboxSubTitleContainer', objParent:dialogObj.header});\r\n\r\n\t// header subtitle\r\n\tdialogObj.headerSubtitle = commonspot.util.dom.addToDom({objType:'H2', objParent:dialogObj.subTitleContainer});\r\n\t\r\n\tdialogObj.divNode.appendChild(dialogObj.header);\r\n\t\r\n\tonclick = function(e) { \r\n\t   var event = e || window.event;\t \r\n\t   if(typeof event.stopPropagation!='undefined')\r\n\t      event.stopPropagation();\r\n\t   else\r\n\t      event.cancelBubble=true;\t\r\n\t};\r\n\r\n\t// iframe container\r\n\tdialogObj.iframeDiv = commonspot.util.dom.addToDom({objType:'DIV', objOnClick: onclick, objID: 'iframeContainer_' + nextZindex, objClass:'iframeContainer', objParent:dialogObj.divNode});\r\n\tdialogObj.divNode.id = 'lightboxContainer_' + nextZindex;\r\n\tdialogObj.iframeDiv.style.zIndex = thisZIndex;\r\n\r\n\t// iframe\r\n\tvar iframeHTML = '<iframe class=\"lightboxIframe\" scrolling=\"no\" frameborder=\"0\" src=\"' + args.url + '\" name=\"' + dialogObj.frameName + '\" id=\"' + dialogObj.frameName + '\">';\r\n\t// Here we use innerHTML instead of DOM to work around a weird IE's bug, where borders are displayed for <iframe> created with DOM methods\r\n\tdialogObj.iframeDiv.innerHTML = iframeHTML;\r\n\t// We need to store a pointer tothe <iframe> DOM node\r\n\tdialogObj.iframeNode = dialogObj.iframeDiv.childNodes[0];\r\n\r\n\t\r\n\t// Bottom corners\r\n\tdialogObj.bottomCorners = commonspot.util.dom.addToDom({objType:'DIV', objID: 'lightboxBottomCorner_' + nextZindex, objClass:'lightboxBottomCorner', objHTML:commonspot.lightbox.generateHTMLcorners('b'), objParent:dialogObj.divNode});\t\r\n\tdialogObj.bottomCorners.style.zIndex = thisZIndex;\r\n\t// Append everything to the body\r\n\tbodyNode.appendChild(dialogObj.divNode);\r\n\t\r\n\t// The header act as \"handle\" for dragging\r\n\t//dialogObj.draggable = new Draggable($(dialogObj.divNode), {handle: $(dialogObj.header), starteffect: false, endeffect: false, zindex: 9999999 });\r\n\t\r\n\t// Adjust the size of the ovelay layer to fill the whole vieport\r\n\tdialogObj.adjustLayout = function()\r\n\t{\r\n\t\tdialogObj.overlayDiv.style.height = commonspot.lightbox.getWinSize().height + 'px';\r\n\t}\r\n\t\r\n\tdialogObj.close = function()\r\n\t{\r\n\t\tcommonspot.lightbox.loadingMsg.hide();\r\n\t\ttry\r\n\t\t{\r\n\t\t\t//element.parentNode.removeChild(element);\r\n\t\t\tdialogObj.divNode.parentNode.removeChild(dialogObj.divNode);\r\n\t\t\tdialogObj.overlayDiv.parentNode.removeChild(dialogObj.overlayDiv);\r\n\t\t\t//EventCache.flushLightBoxEvents(nextZindex);\r\n\t\t}\r\n\t\tcatch(e){}\r\n\t\tvar index = commonspot.lightbox.stack.indexOf(dialogObj);\r\n\t\tcommonspot.lightbox.stack.splice(index, 1);\r\n\t\t// fix IE8 \"frozen\" fields, by focusing topmost lightbox window if there is one\r\n\t\tvar curWin = commonspot.lightbox.getCurrentWindow();\r\n\t\tif (!curWin)\r\n\t\t\tcurWin = window;\r\n\t\t\r\n\t\tactivateFields(curWin);\r\n\t\t\t\r\n\t}\r\n\t\r\n\t// This hides the lightbox dialog and overlay\r\n\tdialogObj.hideLightbox = function(delay)\t\r\n\t{\r\n\t\tsetTimeout(function(){ \r\n\t\t$(dialogObj.divNode).hide();\r\n\t\t$(dialogObj.overlayDiv).hide();\r\n\t\t}, delay );\r\n\t}\r\n\t\r\n\tdialogObj.getFrameName = function()\r\n\t{\r\n\t\treturn dialogObj.frameName;\r\n\t}\r\n\tdialogObj.getLightboxContainer = function()\r\n\t{\r\n\t\treturn dialogObj.divNode;\r\n\t}\r\n\tdialogObj.getWindow = function()\r\n\t{\r\n\t\treturn dialogObj.iframeNode.contentWindow;\r\n\t}\r\n\t\r\n\tdialogObj.resize = function(w, h)\r\n\t{\r\n\t\tvar maxHeight = commonspot.lightbox.getMaxSize().height;\r\n\t\tvar maxWidth = commonspot.lightbox.getMaxSize().width;\r\n\t\t\r\n\t\tif(h > maxHeight)\r\n\t\t\th = maxHeight;\r\n\t\t\t\r\n\t\tw = w + commonspot.lightbox.FURNITURE_WIDTH;\r\n\t\tdialogObj.boxWidth = w + commonspot.lightbox.FURNITURE_WIDTH;\r\n\t\tdialogObj.width = w;\r\n\t\tif(dialogObj.boxWidth > maxWidth)\r\n\t\t{\r\n\t\t\tdialogObj.boxWidth = maxWidth;\r\n\t\t\tdialogObj.width = maxWidth - commonspot.lightbox.FURNITURE_WIDTH;\r\n\t\t}\t\r\n\t\t\r\n\t\tdialogObj.height = h;\t\t\t\r\n\t\ttry\r\n\t\t{\r\n\t\t\tvar dialogWin = dialogObj.getWindow();\r\n\t\t\tdoc = dialogWin.doc;\r\n\t\t\t// If the dialog contains a onResize hook, call it\r\n\t\t\tif(dialogWin.onLightboxResize)\r\n\t\t\t\tdialogWin.onLightboxResize(dialogObj.width, dialogObj.height);\r\n\t\t}\r\n\t\tcatch (e){}\r\n\t\tdialogObj.left = (commonspot.lightbox.getWinSize().width / 2) - (dialogObj.boxWidth / 2);\r\n\t\tvar topSpacer = dialogObj.topCorners.childNodes[1];\r\n\t\tvar bottomSpacer = dialogObj.bottomCorners.childNodes[1];\r\n\t\ttopSpacer.style.width = (dialogObj.boxWidth -commonspot.lightbox.CORNERS_WIDTH) + 'px';\r\n\t\tbottomSpacer.style.width = (dialogObj.boxWidth -commonspot.lightbox.CORNERS_WIDTH) + 'px';\r\n\t\tdialogObj.divNode.style.left = dialogObj.left + 'px';\r\n\t\tdialogObj.divNode.style.width = dialogObj.boxWidth + 'px';\r\n\t\tdialogObj.iframeNode.style.width = dialogObj.width + 'px';\r\n\t\tdialogObj.iframeNode.style.height = dialogObj.height-3 + 'px';\r\n\t\tif (dialogObj.showQAButtons)\r\n\t\t{\r\n\t\t\tvar rr = dialogObj.iconsContainer.style.width;\r\n\t\t\tdialogObj.QAiconsContainer.style.right = rr;\r\n\t\t}\r\n\t}\r\n\t\r\n\tdialogObj.show = function()\r\n\t{\r\n\t\tif (window == top) // not in dashboard\r\n\t\t{\r\n\t\t\tvar wnd = commonspot.lightbox.getWinSize();\r\n\t\t\tif (typeof wnd.scrollY == 'number')\r\n\t\t\t\tdialogObj.divNode.style.top = (dialogObj.top + wnd.scrollY) + 'px';\r\n\t\t\telse\r\n\t\t\t\tdialogObj.divNode.style.top = dialogObj.top + 'px';\r\n\t\t}\r\n\t\telse\r\n\t\t\tdialogObj.divNode.style.top = dialogObj.top + 'px';\r\n\t\tcommonspot.lightbox.loadingMsg.hide();\r\n\t\tdialogObj.iframeNode.style.visibility = 'visible';\r\n\t\t// Handle key events at the window level\r\n\t\tvar dlgWin = dialogObj.getWindow();\r\n\t\tdlgWin.onkeydown = commonspot.lightbox.handleDialogKeys;\r\n\t//\tactivateFields(dlgWin);\r\n\t}\r\n\t\r\n\tdialogObj.setUpFurniture = function(info)\r\n\t{\r\n\t\tif(info.title)\r\n\t\t{\r\n\t\t\tdialogObj.headerTitle.innerHTML = info.title;\r\n\t\t\tif (!args.hideHelp)\r\n\t\t\t{\r\n\t\t\t\tdialogObj.helpImg.style.visibility = 'visible';\r\n\t\t\t\tdialogObj.helpImg.style.display = 'inline';\r\n\t\t\t\tvar helpId = info.helpId || info.title;\r\n\t\t\t\tif(helpId)\r\n\t\t\t\t{\r\n\t\t\t\t\tdialogObj.helpImg.onclick = function()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar loaderUrl = commonspot.clientUI.state.location.getLoaderURL('subsiteurl');\r\n\t\t\t\t\t\tvar dialogUrl = loaderUrl + '?csModule=help/openhelp&CSHelpID=' + encodeURIComponent(helpId);\r\n\t\t\t\t\t\tvar winSize = top.commonspot.util.dom.getWinSize();\t\t\t\r\n\t\t\t\t\t\tvar argsStr = \"menubar=0,location=0,scrollbars=1,status=0,resizable=1,width=\" + (winSize.width-100) + \",height=\" + (winSize.height-40);\r\n\t\t\t\t\t\tif (commonspot.lightbox.helpDlg && !commonspot.lightbox.helpDlg.closed)\r\n\t\t\t\t\t\t\tcommonspot.lightbox.helpDlg.location.href = dialogUrl;\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tcommonspot.lightbox.helpDlg = window.open(dialogUrl,'helpDlg',argsStr);\r\n\t\t\t\t\t\tcommonspot.lightbox.helpDlg.focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(info.subtitle.length)\r\n\t\t{\r\n\t\t\t(dialogObj.headerSubtitle).innerHTML = info.subtitle;\r\n\t\t\t(dialogObj.headerSubtitle).style.display = '';\r\n\t\t}\t\r\n\t\telse\r\n\t\t\t(dialogObj.headerSubtitle).style.display = 'none';\r\n\t\t\r\n\t\tif (typeof(info.close) == 'undefined')\r\n\t\t\tinfo.close = true;\r\n\r\n\t\tif (typeof(info.reload) == 'undefined')\r\n\t\t\tinfo.reload = true;\r\n\t\t\t\r\n\t\tif (args.hideReload)\r\n\t\t\tinfo.reload = false;\t\t\t\t\t\r\n\t\tif(info.maximize)\r\n\t\t{\r\n\t\t\tdialogObj.maxImg.style.visibility = 'visible';\r\n\t\t\tdialogObj.maxImg.style.display = 'inline';\r\n\t\t}\t\r\n\t\telse\r\n\t\t{\r\n\t\t\tif( dialogObj.maxImg )\r\n\t\t\t{\r\n\t\t\t\tdialogObj.maxImg.style.display = 'none';\r\n\t\t\t\tdialogObj.maxImg.style.visibility = '';\r\n\t\t\t}\r\n\t\t\tdialogObj.hasMaxButton = false;\r\n\t\t}\r\n\t\t\t\t\r\n\t\tif(info.reload)\r\n\t\t{\r\n\t\t\tdialogObj.reloadImg.style.display = 'inline';\r\n\t\t\tdialogObj.reloadImg.style.visibility = 'visible';\r\n\t\t}\r\n\r\n\t\tif(typeof dialogObj.closeImg == 'undefined'){}\r\n\t\telse if(info.close)\r\n\t\t{\r\n\t\t\tdialogObj.closeImg.style.visibility = 'visible';\r\n\t\t\tdialogObj.closeImg.style.display = 'inline';\r\n\t\t}\r\n\t\telse\r\n\t\t\tdialogObj.closeImg.style.display = 'none';\r\n\t}\r\n\t\r\n\tdialogObj.showCrash = function()\r\n\t{\r\n\t\tvar maxVals = commonspot.lightbox.getMaxSize();\r\n\t\tdialogObj.resize(maxVals.width-60, maxVals.height);\r\n\t\tdialogObj.iframeNode.style.overflow = \"scroll\";\r\n\t\tdialogObj.show();\r\n\t\tcommonspot.dialog.client.alert(\"We're sorry, an error has occurred.<br />Close this message to view the available details.<br />Please see your server logs for more information.\");\r\n\t};\r\n\t\r\n\t// Set initial size\r\n\tdialogObj.resize(commonspot.lightbox.DIALOG_DEFAULT_WIDTH, commonspot.lightbox.DIALOG_DEFAULT_HEIGHT);\r\n\t// Update z-index counter\r\n\tcommonspot.lightbox.dialogFactory.zIndexCounter = commonspot.lightbox.dialogFactory.zIndexCounter +2;\r\n\treturn dialogObj;\r\n};\r\n\r\ncommonspot.lightbox.addSpellCheckButton = function(vDoc)\r\n{\r\n\tvar forms = vDoc.forms;\r\n\tvar hasSpellcheck = false;\r\n\tvar allFields = [];\r\n\tvar noSpellCheckFlds = '';\r\n\tif (!forms.length)\r\n\t\treturn;\r\n\t\t\r\n\tvar spellCheckData = commonspot.data.SpellCheck_GetSettings.getData()[0];\t\r\n\tif(!spellCheckData || !spellCheckData.enablespellcheck)\r\n\t\treturn;\r\n\t\t\r\n\tvar fld = vDoc.getElementById('noSpellCheckFields');\r\n\tif (fld && fld.value)\r\n\t\tnoSpellCheckFlds = ',' + fld.value + ',';\r\n\t\t\r\n\tif (!hasSpellcheck)\r\n\t{\r\n\t\tfor (var i=0; i<forms[0].elements.length; i++)\r\n\t\t{\r\n\t\t\tfld = forms[0].elements[i];\r\n\t\t\tfldStr = ',' + fld.name + ',';\r\n\t\t\tif ((fld.type == \"text\" || fld.type == \"textarea\") && (noSpellCheckFlds.indexOf(fldStr) == -1))\r\n\t\t\t{\r\n\t\t\t\thasSpellcheck = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\t\r\n\t\t}\r\n\t}\t\r\n\tif (!hasSpellcheck)\r\n\t\treturn;\r\n\tfooter = vDoc.getElementById('dialogFooter');\r\n\r\n\tif (footer && hasSpellcheck)\r\n\t{\r\n\t\tvar isChecked = \"\";\r\n\t\t\tisChecked = ' checked=\"checked\"';\r\n\t\tif (spellCheckData.defaultstate == 'Enforce spell check')\r\n\t\t\tisChecked += ' disabled=\"disabled\"';\r\n\t\tvar dom = top.document.createElement('div');\r\n\t\tdom.id = 'spellCheckContainer';\r\n\t\tvar label = top.document.createElement('label');\r\n\t\tdom.appendChild(label);\r\n\t\tvar input = top.document.createElement('input');\r\n\t\tinput.type = 'checkbox';\r\n\t\tinput.id = 'SpellCheckOn';\r\n\t\tinput.name = 'SpellCheckOn';\r\n\t\tinput.value = 1;\r\n\t\tif (spellCheckData.defaultstate == 'Enforce spell check' || spellCheckData.defaultstate == 'Default On')\r\n\t\t\tinput.checked = true;\r\n\t\tif (spellCheckData.defaultstate == 'Enforce spell check')\r\n\t\t\tinput.readonly = true;\r\n\t\tlabel.appendChild(input);\r\n\t\tvar tNode = top.document.createTextNode('Spell check');\r\n\t\tlabel.appendChild(tNode);\t\t\t\t\t\t\r\n\t\tfooter.appendChild(dom);\r\n\t}\r\n};\r\ncommonspot.lightbox.loadingMsg =\r\n{\r\n\tinit: function()\r\n\t{\r\n\t\tvar dom = top.document.createElement('div');\r\n\t\tdom.id = 'loading_container';\r\n\t\tdom.style.display = 'none';\r\n\t\tvar dom2 = top.document.createElement('div');\r\n\t\tdom2.id = 'loading_content';\r\n\t\tdom2.title = 'Loading, please wait';\r\n\t\timg = top.document.createElement('img');\r\n\t\timg.id = 'loading_img';\r\n\t\timg.src = '/commonspot/dashboard/images/dialog/loading.gif';\r\n\t\timg.title = 'Loading, please wait';\r\n\t\tdom3 = top.document.createElement('div');\r\n\t\tdom3.id = 'loading_text';\r\n\t\tdom2.appendChild(img);\r\n\t\tdom2.appendChild(dom3);\r\n\t\tdom.appendChild(dom2);\r\n\t\treturn top.document.body.appendChild(dom);\r\n\t},\r\n\tonDashboardLoaded: function()\r\n\t{\r\n\t\ttop.document.getElementById('loading_container').style.display = 'none'; // kill initial Loading msg\r\n\t\t// add border, which we don't want against initial plain white, and background\r\n\t\tvar loading_content = top.document.getElementById('loading_content');\r\n\t\tloading_content.style.border = '1px solid #7E96AD';\r\n\t\tloading_content.style.background = '#fff';\r\n\t},\r\n\tshow: function(overlayMsg, overlayTitle)\r\n\t{\r\n\t\tvar loadingDiv = top.document.getElementById('loading_content');\r\n\t\tif (!loadingDiv)\r\n\t\t\tloadingDiv = commonspot.lightbox.loadingMsg.init();\r\n\t\tvar loadingImg = top.document.getElementById('loading_img');\r\n\t\tif (loadingDiv)\r\n\t\t{\r\n\t\t\tloadingDiv.title = overlayTitle;\r\n\t\t\tif (loadingImg)\r\n\t\t\t\tloadingImg.title = overlayTitle;\r\n\t\t\tsetTimeout(function()\r\n\t\t\t{\r\n\t\t\t\t// attach onclick event to close if this is there even after 3 secs.\r\n\t\t\t\tif (top.document.getElementById('loading_container').style.display != 'none')\r\n\t\t\t\t{\r\n\t\t\t\t\tloadingDiv.onclick = function(e) {\r\n\t\t\t\t\t\tvar event = e || window.event;\t\r\n\t\t\t\t\t   if(typeof event.stopPropagation!='undefined')\r\n\t\t\t\t\t      event.stopPropagation();\r\n\t\t\t\t\t   else\r\n\t\t\t\t\t      event.cancelBubble=true;\t\t\t\r\n\t\t\t\t\t\tcommonspot.lightbox.closeCurrent();\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar delayOverlayMsg = \"Loading, please wait or click to abort\";\r\n\t\t\t\t\tloadingDiv.title = delayOverlayMsg;\r\n\t\t\t\t\tif (loadingImg)\r\n\t\t\t\t\t\tloadingImg.title = delayOverlayMsg;\r\n\t\t\t\t}\r\n\t\t\t},3000);\t\r\n\t\t}\r\n\t\ttop.document.getElementById('loading_text').innerHTML = overlayMsg;\r\n\t\ttop.document.getElementById('loading_container').style.display = 'block';\r\n\t},\r\n\thide: function()\r\n\t{\r\n\t\tvar loadingContainer = top.document.getElementById('loading_container');\r\n\t\tif (loadingContainer && loadingContainer.style)\r\n\t\t\tloadingContainer.style.display = 'none';\r\n\t\tvar content = top.document.getElementById('loading_content');\t\r\n\t\tif (content)\r\n\t\t\tcontent.onclick = {};\r\n\t}\r\n};\r\n\r\n/**\r\n * Helper method generate XHTML for top and bottom corners\r\n * @param type\t(string). Required. Either 't' for top, or 'b', for bottom\r\n * @param width  (int). Required. Dimension of the dialog\r\n * @return XHTML code\r\n */\r\ncommonspot.lightbox.generateHTMLcorners = function(type)\r\n{\r\n\tvar cornersHTML = '';\r\n\tvar spacerWidth = commonspot.lightbox.DIALOG_DEFAULT_WIDTH - commonspot.lightbox.CORNERS_WIDTH;\r\n\tcornersHTML += '<img width=\"10\" height=\"10\" src=\"/commonspot/javascript/lightbox/' + type + 'l.gif\"/>';\r\n\tcornersHTML += '<img width=\"' + spacerWidth + '\" height=\"10\" src=\"/commonspot/javascript/lightbox/' + type + 'spacer.gif\"/>';\r\n\tcornersHTML += '<img width=\"10\" height=\"10\" src=\"/commonspot/javascript/lightbox/' + type + 'r.gif\"/>';\r\n\treturn cornersHTML;\r\n};\r\n\r\n\r\ncommonspot.lightbox.hideQAElements = function(objList)\r\n{\r\n\tvar frName = commonspot.lightbox.stack.last().getFrameName();\r\n\tvar elem;\r\n\tvar allObjects = \"QAStatusMsg_,statusIcon_,docIcon_,qaIcon_,reportsIcon_\";\r\n\tallObjects = allObjects.replace(/_/gi,\"_\"+frName);\r\n\tif (objList == 'All')\r\n\t{\r\n\t\tvar objList = allObjects;\r\n\t}\t\r\n\tvar elems = allObjects.split(\",\");\r\n\tfor(var i=0; i<elems.length; i++)\r\n\t{\r\n\t\telem = document.getElementById(elems[i]);\r\n\t\tif(elem)\r\n\t\t{\r\n\t\t\tif (objList.indexOf(elems[i])>=0)\r\n\t\t\t\telem.style.display='none';\r\n\t\t\telse\r\n\t\t\t\telem.style.display='';\t\r\n\t\t}\r\n\t}\r\n}\r\n\r\ncommonspot.lightbox.getResizeControlState = function(name)\r\n{\r\n\t// 1: maximized 2: normal 0: unknown\r\n\tif (typeof name == 'undefined')\r\n\t\treturn;\r\n\tvar cState = 0;\r\n\tvar btnID = name + '_' + parseInt(parseInt(commonspot.lightbox.dialogFactory.zIndexCounter)-1);\r\n\tvar btnObj = document.getElementById(btnID);\r\n\tvar cName = (btnObj && btnObj.className) ? (btnObj.className).replace('actionMontageIcon','') : '';\r\n\tif (cName.indexOf('ico_maximize') >= 0)\r\n\t\tcState = 2;\r\n\telse if (cName.indexOf('ico_pop') >= 0)\r\n\t\tcState = 1;\t\r\n\treturn cState;\r\n}\r\n/**\r\n * Utility method. Returns inner size of current viewport\r\n * @return {width, height, scrollX, scrollY}\r\n */\r\ncommonspot.lightbox.getWinSize = function(checkCurrentFrameFirst, wnd)\r\n{\r\n\tvar width, height, scrollX, scrollY, pgFrame, pgWin, checkAccess;\r\n\tif (typeof checkCurrentFrameFirst == 'undefined')\r\n\t\tvar checkCurrentFrameFirst = false;\r\n\tif (!wnd)\r\n\t\tvar wnd = top;\t\r\n\tif (checkCurrentFrameFirst)\r\n\t{\r\n\t\ttry // need this try-catch to avoid IE 'access denied' error when there is no page context.\r\n\t\t{\r\n\t\t\tif (commonspot.lightbox.stack.length)\r\n\t\t\t{\r\n\t\t\t\tpgWin = commonspot.lightbox.stack.last().getWindow();\r\n\t\t\t\tcheckAccess = commonspot.lightbox.stack.last().getFrameName();\r\n\t\t\t}\t\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tpgFrame = top.document.getElementById('page_frame');\r\n\t\t\t\tif (pgFrame)\r\n\t\t\t\t{\r\n\t\t\t\t\tpgWin = pgFrame.contentWindow;\r\n\t\t\t\t\tcheckAccess = pgWin.name;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch(e)\r\n\t\t{\t\r\n\t\t\tpgWin = null;\r\n\t\t\tcheckAccess = null;\r\n\t\t}\t\r\n\t\tif (checkAccess)\r\n\t\t\treturn commonspot.lightbox.getWinSize(false, pgWin);\r\n\t}\r\n\tif( typeof( wnd.innerWidth ) == 'number' ) \r\n\t{\r\n\t\t//Non-IE\r\n\t\twidth = wnd.innerWidth;\r\n\t\theight = wnd.innerHeight;\r\n\t} \r\n\telse if( wnd.document.documentElement && \r\n\t\t\t\t( wnd.document.documentElement.clientWidth || wnd.document.documentElement.clientHeight ) ) \r\n\t{\r\n\t\t//IE 6+ in 'standards compliant mode'\r\n\t\twidth = wnd.document.documentElement.clientWidth;\r\n\t\theight = wnd.document.documentElement.clientHeight;\r\n\t} \r\n\telse if( wnd.document.body && ( wnd.document.body.clientWidth || wnd.document.body.clientHeight ) ) \r\n\t{\r\n\t\t//IE 4 compatible\r\n\t\twidth = wnd.document.body.clientWidth;\r\n\t\theight = wnd.document.body.clientHeight;\r\n\t}\r\n\tif( typeof( wnd.pageYOffset ) == 'number' ) \r\n\t{\r\n\t\t//Netscape compliant\r\n\t\tscrollY = wnd.pageYOffset;\r\n\t\tscrollX = wnd.pageXOffset;\r\n\t} \r\n\telse if( wnd.document.body && ( wnd.document.body.scrollLeft || wnd.document.body.scrollTop ) ) \r\n\t{\r\n\t\t//DOM compliant\r\n\t\tscrollY = wnd.document.body.scrollTop;\r\n\t\tscrollX = wnd.document.body.scrollLeft;\r\n\t} \r\n\telse if( wnd.document.documentElement && \r\n\t\t\t\t( wnd.document.documentElement.scrollLeft || wnd.document.documentElement.scrollTop ) ) \r\n\t{\r\n\t\t//IE6 standards compliant mode\r\n\t\tscrollY = wnd.document.documentElement.scrollTop;\r\n\t\tscrollX = wnd.document.documentElement.scrollLeft;\r\n\t}\r\n\t\r\n\treturn {width: width, height: height, scrollX: scrollX, scrollY: scrollY};\r\n};\r\n\r\n\r\nfunction activateFields(win)\r\n{\r\n\tvar firstFld = null;\r\n\tvar cDoc = null;\r\n\tif(win.document.forms.length)\r\n\t{\r\n\t\tfor (var i=0; i<win.document.forms.length; i++)\r\n\t\t{\r\n\t\t\tcommonspot.util.dom.activateAllFields(win.document.forms[i]);\r\n\t\t}\r\n\t}\r\n\tvar iFrames = win.document.getElementsByTagName('iframe');\r\n\t// all other\r\n\tfor (i=0; i<iFrames.length; i++)\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tcDoc = (iFrames[i].contentWindow || iFrames[i].contentDocument);\r\n\t\t\tif (cDoc.document)\r\n\t\t\t\tcDoc = cDoc.document;\t\t\t\r\n\t\t}\r\n\t\tcatch(e)\r\n\t\t{\r\n\t\t\tcontinue;\r\n\t\t}\t\r\n\t\tif (cDoc && cDoc.forms && cDoc.forms.length)\r\n\t\t{\r\n\t\t\tfor (var j=0; j<cDoc.forms.length; j++)\r\n\t\t\t{\r\n\t\t\t\tcommonspot.util.dom.activateAllFields(cDoc.forms[j]);\r\n\t\t\t}\r\n\t\t\tiFrames[i].contentWindow.focus();\r\n\t\t}\r\n\t}\r\n\r\n\twin.focus();\r\n}\r\n\r\nfunction InitDragDrop() \r\n{ \r\n\tif( typeof OnMouseDown != 'undefined' ) \r\n\t{\r\n\t\tdocument.onmousedown = OnMouseDown; \r\n\t\tdocument.onmouseup = OnMouseUp; \r\n\t}\r\n\telse\r\n\t\tsetTimeout( \"InitDragDrop()\", 100 );\r\n}\r\n\r\nInitDragDrop(); \r\n\r\n</script><script id=\"cs_overrides\" type=\"text/javascript\" src=\"/commonspot/javascript/lightbox/overrides.js\">/* \r\n * overrides.js   Copyright PaperThin, Inc.\r\n */\r\n\t\r\ncheckDlg = function()\r\n{\r\n\tResizeWindow();\r\n}\r\n\r\nCloseWindow = function()\r\n{\r\n\ttop.commonspot.lightbox.closeCurrent();\r\n}\r\n\r\ncs_OpenURLinOpener = function(workUrl)\r\n{\r\n\tOpenURLInOpener(workUrl);\r\n}\r\n\r\ndoCPOpenInOpener = function(workUrl)\r\n{\r\n\tOpenURLInOpener(workUrl);\r\n}\r\n\r\nDoFocus = function(){};\r\n\r\nhandleLoad = function()\r\n{\r\n\tResizeWindow();\r\n}\r\n\r\nif (typeof handleLoad != 'function')\r\n{\r\n\thandleLoad = function()\r\n\t{\r\n\t\tResizeWindow();\r\n\t}\r\n}\t\r\n\r\ncsExtendedWindow = function(name, url, windowProps)\r\n{\r\n\tvar wnd = window.open(url, name, windowProps);\r\n}\r\n\t\r\nnewWindow = function(name, url, customOverlayMsg, openInWindow, windowProps)\r\n{\r\n\tvar customOverlayMsg = customOverlayMsg ? customOverlayMsg : null;\t\r\n\tvar openInWindow = openInWindow ? openInWindow : false;\r\n\tvar windowProps = windowProps ? windowProps : null;\r\n\tvar wnd = top;\r\n\tif (openInWindow)\r\n\t{\r\n\t\tvar wnd = window.open(url, name, windowProps);\r\n\t\treturn wnd;\r\n\t}\r\n\tif (url.indexOf('/commonspot/dashboard/') == 0 || url.indexOf('controls/imagecommon/add-image') > 0 || url.indexOf('/commonspot/dashboard/dialogs/pageview/select-page.html') >= 0)\r\n\t{\t\r\n\t\tif (!top.commonspot.util.browser.valid)\r\n\t\t{\r\n\t\t\talert('This functionality requires Internet Explorer versions 8 or 9 or Firefox 10.x Extended Support Release (ESR) or Safari 5.x (only on Mac) or Chrome 12 (or later).');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar setupComplete = checkDashboardSetup();\r\n\t\tif (!setupComplete)\r\n\t\t{\r\n\t\t\tsetTimeout(function(){\r\n\t\t\t\tnewWindow(name, url, customOverlayMsg);\r\n\t\t\t},1);\r\n\t\t\treturn;\r\n\t\t}\t\r\n\t}\t\r\n\r\n\tif (top.commonspot && top.commonspot.lightbox)\r\n\t{\r\n\t\tif (top.commonspot.lightbox.stack.length > 0)\r\n\t\t\twnd = top.commonspot.lightbox.stack.last().getWindow();\t    \r\n\t\ttop.commonspot.lightbox.openDialog(url, null, name, customOverlayMsg, null, wnd);\r\n\t}\r\n}\r\n\r\nOpenURLandClose = function(workUrl)\r\n{\r\n\tvar openerWin = top.commonspot.lightbox.getOpenerWindow();\r\n\topenerWin.location.href = workUrl;\r\n\tif (document.getElementById(\"leavewindowopen\").checked == false)\r\n\t{\r\n\t\tsetTimeout('window.close()', 250);\r\n\t}\r\n}\r\n\r\nOpenURLInOpener = function(workUrl)\r\n{\r\n\tvar openWin = top.commonspot.lightbox.getOpenerWindow();\r\n\tif (openWin)\r\n\t{\r\n\t\topenWin.location.href = workUrl;\r\n\t}\t\r\n}\r\n\r\nRefreshAndCloseWindow = function(clearQueryParams)\r\n{\r\n\tclearQueryParams = clearQueryParams ? clearQueryParams : 0;\r\n\tvar openWin, openFrame;\r\n\tif (clearQueryParams)\r\n\t{\r\n\t\tResetParentWindow();\r\n\t\treturn;\r\n\t}\r\n\ttry // without this try-catch IE throws Access Denied for dialogs called from site-admin\r\n\t{\r\n\t\tif (top.commonspot.util.browser.chrome || top.commonspot.util.browser.safari) //\r\n\t\t{\r\n\t\t\topenFrame = top.commonspot.lightbox.getOpenerLightboxFrame();\r\n\t\t\t// next line are exceptions to this special case, re accurev 17450 and 17894\r\n\t\t\tvar doSpecialCase = openFrame\r\n\t\t\t\t\t&& (openFrame.src.indexOf('/dashboard/dialogs/siteadmin/metadata-form-addedit.html') === -1)\r\n\t\t\t\t\t&& (openFrame.src.indexOf('/commonspot/dashboard/null') === -1);\r\n\t\t\tif (doSpecialCase)\r\n\t\t\t\topenFrame.src = openFrame.src;\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\topenWin = top.commonspot.lightbox.getOpenerWindow();\r\n\t\t\t\tif (openWin)\r\n\t\t\t\t\topenWin.location.reload();\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\topenWin = top.commonspot.lightbox.getOpenerWindow();\r\n\t\t\tif (openWin)\r\n\t\t\t\topenWin.location.reload();\r\n\t\t}\r\n\t}\r\n\tcatch(e) {}\t\r\n\tCloseWindow();\r\n}\r\n\r\nResetParentWindow = function()\r\n{\r\n\tvar pWin = top.commonspot.lightbox.getOpenerWindow();\r\n\ttry // without this try-catch IE throws Access Denied for dialogs called from site-admin\r\n\t{\r\n\t\tif (pWin)\r\n\t\t{\r\n\t\t\tvar addPageInLView = 0;\r\n\t\t\tvar pSearch = pWin.location.search;\r\n\t\t\tif (pSearch.indexOf('cs_pgIsInLView=1') >= 0)\r\n\t\t\t\taddPageInLView = 1;\r\n\t\t\tvar pHref = pWin.location.href;\r\n\t\t\tif (pHref.length && pSearch.length)\r\n\t\t\t\tpHref = pHref.replace(pSearch, '');\r\n\t\t\tif (addPageInLView)\r\n\t\t\t\tpHref = pHref + '?cs_pgIsInLView=1';\r\n\t\t\tif (pHref != pWin.location.href)\r\n\t\t\t\tpWin.location.href = pHref;\r\n\t\t\telse\r\n\t\t\t\tpWin.location.reload();\r\n\t\t}\t\r\n\t}\r\n\tcatch(e) {}\t\r\n\tCloseWindow();\t\r\n}\r\n\r\n\r\nRefreshParentWindow = function()\r\n{\r\n\tvar openerWin = top.commonspot.lightbox.getOpenerWindow();\r\n\tpageid = openerWin.js_gvPageID;\r\n\tif (pageid > 0)\r\n\t{\r\n\t\topenerWin.document.cookie = \"scrollPage=\" + pageid;\r\n\t\topenerWin.document.cookie = \"scrollX=\" + cd_scrollLeft;\r\n\t\topenerWin.document.cookie = \"scrollY=\" + cd_scrollTop;\r\n\t}\r\n\topenerWin.location.reload();\r\n\tDoFocus(self);\r\n\tDoFocusDone=1;\t// not done, but we don't want the focus\r\n}\r\n\r\nResizeWindow = function(doRecalc, curTab)\r\n{\r\n\tif (typeof ResizeWindowSafe != 'undefined')\t\t// this variable is set in dlgcommon-head for legacy dialogs (initially set to 0, then to 1 upon calling dlgcommon-foot)\r\n\t{ \r\n\t\tif (ResizeWindowSafe == 1)\r\n\t\t\tResizeWindow_Meat(doRecalc, curTab);  // this function is defined in over-rides.js\r\n\t\telse\r\n\t\t\tResizeWindowCalledCount = ResizeWindowCalledCount + 1;\r\n\t}\r\n\telse\r\n\t\tResizeWindow_Meat(doRecalc, curTab);  // this function is defined in over-rides.js\r\n}\r\n\r\n\r\nResizeWindow_Meat = function(doRecalc, currentTab)\r\n{\r\n\tvar maintable = document.getElementById('MainTable');\r\n\tif (maintable)\r\n\t{\r\n\t\tif (doRecalc)\r\n\t\t{\r\n\t\t\tif (top.commonspot)\r\n\t\t\t{\r\n\t\t\t\ttop.commonspot.lightbox.initCurrentServerDialog(currentTab);\r\n\t\t\t\tResizeWindow_Meat();\r\n\t\t\t}\t\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tif (maintable.offsetHeight < 130)\r\n\t\t\t\tmaintable.style.height = '130px';\r\n\t\t\telse\r\n\t\t\t\tmaintable.style.height = '';\r\n\t\t\tif (maintable.offsetWidth < 300)\r\n\t\t\t\tmaintable.style.width = '300px';\r\n\t\t\t\r\n\t\t\tif (top.commonspot)\r\n\t\t\t{\r\n\t\t\t\ttop.commonspot.lightbox.initCurrent(maintable.offsetWidth+5, maintable.offsetHeight + 42);\r\n\t\t\t\tfixFooterWidth(maintable.offsetWidth,maintable.offsetHeight + 40);\r\n\t\t\t}\t\r\n\t\t}\t\r\n\t\t// to fix IE7 insanity! without this, in ie7 the maintable is not getting its gray background set.\r\n\t\tvar mClass = maintable.className;\r\n\t\tif (mClass.indexOf('csMainTable') < 0)\r\n\t\t\tmClass += ' csMainTable';\r\n\t\tmaintable.className = mClass;\t\r\n\t}\t\r\n}\t\r\n\r\nfixFooterWidth = function() \r\n{\r\n\tvar proxyBtnTable = document.getElementById('clsProxyButtonTable');\r\n\tvar maintable = document.getElementById('MainTable');\r\n\t//debugger;\r\n\tif (proxyBtnTable && maintable && proxyBtnTable.offsetWidth > (maintable.offsetWidth+10))\r\n\t{\r\n\t\tmaintable.style.width = proxyBtnTable.offsetWidth + 'px';\r\n\t\ttop.commonspot.lightbox.initCurrent(proxyBtnTable.offsetWidth, maintable.offsetHeight + 40);\r\n\t}\r\n};\r\n\r\nsetthefocus = function(){};\r\n\r\n\r\ncheckDashboardSetup = function()\r\n{\r\n\tif (top.commonspot.clientUI && top.commonspot.dialog && top.commonspot.dialog.server)\r\n\t\treturn true;\r\n\r\n\t\r\n\tdoDashboardSetup();\r\n}\r\n\r\ndoDashboardSetup = function()\r\n{\r\n\tif (parent.window.document.getElementById(\"hiddenframeDiv\"))\r\n\t\treturn true;\r\n\tif (document.parentWindow)\r\n\t\tvar curWin = document.parentWindow;\r\n\telse\r\n\t\tvar curWin = window;\t\r\n\tvar iframeDiv = curWin.parent.parent.document.createElement('div');\r\n\tiframeDiv.id = 'hiddenframeDiv';\r\n\tiframeDiv.style.left = '-1000px';\r\n\tiframeDiv.style.top = '-1000px';\r\n\t\r\n\tvar iframeHTML = '<iframe src=\"/commonspot/dashboard/hidden_iframe.html\" name=\"hidden_frame\" id=\"hidden_frame\" width=\"1\" height=\"1\" scrolling=\"no\" frameborder=\"0\"></iframe>';\r\n\tiframeDiv.innerHTML = iframeHTML;\r\n\tvar hiddenFrame = iframeDiv.childNodes[0];\r\n\tparent.window.document.body.appendChild(iframeDiv);\r\n\treturn true;\r\n}\r\n\r\n\t\r\nif (typeof(onLightboxLoad) == \"undefined\")\r\n{\r\n\t/**\r\n\t* Hook that gets called by lightbox whenever the dialog gets loaded\r\n\t*/\r\n\tonLightboxLoad = function() \r\n\t{\t\r\n\t\ttry{\r\n\t\t\tvar rootDiv = document.getElementById('cs_commondlg')\r\n\t\t}catch(e){ \r\n\t\t\t// $ function is not defined when there is an error. \r\n\t\t\t// in that case, just return so we can show the error msg.\r\n\t\t\treturn; \r\n\t\t}\t\r\n\t\tif (rootDiv)\r\n\t\t{\t \r\n\t\t\t// Check if we have buttons\r\n\t\t\tvar outerDiv = document.getElementById('clsPushButtonsDiv');\r\n\t\t\tvar tableEle = document.getElementById('clsPushButtonsTable');\r\n\t\t\tvar otherBtns = document.getElementsByClassName('clsDialogButton');\r\n\t\t\tif (tableEle || otherBtns.length)\r\n\t\t\t{\r\n\t\t\t\t// Remove existing \"proxy\" buttons first\r\n\t\t\t\tvar btnHolder = document.getElementById('clsProxyButtonHolder');\r\n\t\t\t\tif (btnHolder)\r\n\t\t\t\t{\r\n\t\t\t\t\tbtnHolder.parentNode.removeChild(btnHolder);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// check if cf debug is on\r\n\t\t\t\tvar arr = document.getElementsByClassName('cfdebug');\r\n\t\t\t\t// Append a new <div> that will contain the \"proxy\" buttons\r\n\t\t\t\tvar dom = document.createElement('div');\r\n\t\t\t\tdom.id = \"clsProxyButtonHolder\";\r\n\t\t\t\tdom.innerHTML = '<table id=\"clsProxyButtonTable\" border=\"0\" cellspacing=\"2\" cellpadding=\"0\"><tr><td id=\"clsProxySpellCheckCell\" nowrap=\"nowrap\"></td><td id=\"clsProxyButtonCell\" nowrap=\"nowrap\"></td></tr></table>';\t\t\t\t\r\n\t\t\t\tif (arr.length > 0) \t// stick in after root div and before CF debug table\r\n\t\t\t\t{\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t\tIE has problem with appending node before a script node. to get around it we add a div node around\r\n\t\t\t\t\t\tthe script tags we have after rootDiv (dlgcommon-foot.cfm) and manipulate its innerHTML\r\n\t\t\t\t\t\thowever, non-ie browsers has problem with manipulating innerHTML so doing it ol'way\r\n\t\t\t\t\t*/\r\n\t\t\t\t\tif (top.commonspot.util.browser.ie)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar inHTML = dom.outerHTML + rootDiv.nextSibling.innerHTML;\r\n\t\t\t\t\t\trootDiv.nextSibling.innerHTML = inHTML;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\trootDiv.parentNode.insertBefore(dom, rootDiv.nextSibling);\r\n\t\t\t\t}\t\r\n\t\t\t\telse\r\n\t\t\t\t\trootDiv.parentNode.appendChild(dom);\r\n\r\n\t\t\t\tproxySpellChecker($('clsProxySpellCheckCell'));\r\n\t\t\t\tproxyPushButtons($('clsProxyButtonCell'));\r\n\t\t\t\t// Hide the \"real\" buttons\r\n\t\t\t\tif (outerDiv)\r\n\t\t\t\t\touterDiv.style.display='none';\r\n\t\t\t\tif (tableEle)\r\n\t\t\t\t\ttableEle.style.display='none';\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\t\r\n\r\nproxyPushButtons = function(targetNode)\r\n{\r\n\tvar cellNode = $('clsProxyButtonCell');\r\n\tvar buttons = $$('#clsPushButtonsTable input[type=\"submit\"]', '#clsPushButtonsTable input[type=\"button\"]');\r\n\tvar moreButtons = document.getElementsByClassName('clsDialogButton', null, 'INPUT');\r\n\tvar addClose = 0;\r\n\tfor (var i=0; i<moreButtons.length; i++)\r\n\t{\r\n\t\t// lame! but FF is not happy with concat arrays feature;\r\n\t\tbuttons.push(moreButtons[i]);\r\n\t}\r\n\tif ((buttons.length == 1 && buttons[0].value == 'Help') || buttons.length == 0)\r\n\t\taddClose = 1;\r\n\tcleanRadioAndCheckBoxes($$('#MainTable input[type=\"checkbox\"]', '#MainTable input[type=\"radio\"]'));\r\n\tvar doneButtons = [];\r\n\tvar buttonString = [];\r\n\tfor(var i=0; i<buttons.length; i++)\r\n\t{\r\n\t\tbuttons[i].style.display = 'none';\r\n\t\tvar buttonText = buttons[i].value.replace(/^\\s+|\\s+$/g, '');\r\n\t\tbuttonString[i] = buttonText.toLowerCase();\r\n\t}  \r\n\t// show prev button\r\n\tvar indexButton = arrayIndexOf(buttonString,'prev');\r\n\tvar proxyIndex = 1;\r\n\tif (indexButton != -1 && arrayIndexOf(doneButtons,'prev') == -1)    \r\n\t{\r\n\t  cellNode.appendChild(createProxyButton(buttons[indexButton],proxyIndex++));\r\n\t  doneButtons.push('prev');\r\n\t}\r\n\r\n\t// show next button\r\n\tindexButton = arrayIndexOf(buttonString,'next');\r\n\tif (indexButton != -1 && arrayIndexOf(doneButtons,'next') == -1)    \r\n\t{\r\n\t  cellNode.appendChild(createProxyButton(buttons[indexButton],proxyIndex++));\r\n\t  doneButtons.push('next');\r\n\t}      \r\n    // show all misc. buttons that are not submit and not cancel or close\r\n\tfor(var i=0; i<buttons.length; i++)\r\n\t{\r\n\t\tbuttonText = buttons[i].value.replace(/^\\s+|\\s+$/g, '');\r\n\t\tif (buttonText != 'Help' && \r\n\t\t      buttonText != 'Close' &&\r\n\t\t\t\tbuttonText != 'No' &&\r\n\t\t      buttonText != 'Cancel' &&\r\n\t\t      buttons[i].type == 'button' &&\r\n\t\t\t\tarrayIndexOf(doneButtons,buttonText) == -1)\r\n\t\t{\r\n\t\t\tcellNode.appendChild(createProxyButton(buttons[i],proxyIndex++));\r\n\t\t\tdoneButtons.push(buttonText);\r\n\t\t}\r\n\t}\r\n     \r\n     \r\n\t// show all submit buttons that are not cancel or close\r\n\tfor(var i=0; i<buttons.length; i++)\r\n\t{\r\n\t\tbuttonText = buttons[i].value.replace(/^\\s+|\\s+$/g, '');\r\n\t\tif (buttonText != 'Help' && \r\n\t\t\t\t\tbuttonText != 'Close' &&\r\n\t\t\t\t\tbuttonText != 'No' &&\r\n\t\t\t\t\tbuttonText != 'Cancel' &&\r\n\t\t\t\t\tbuttons[i].type == 'submit' &&\r\n\t\t\t\t\tarrayIndexOf(doneButtons,buttonText) == -1)\r\n\t\t{\r\n\t\t\tcellNode.appendChild(createProxyButton(buttons[i],proxyIndex++));\r\n\t\t\tdoneButtons.push(buttonText);\r\n\t\t}\r\n\t}     \r\n\r\n\t// show cancel and close buttons\r\n\tfor(var i=0; i<buttons.length; i++)\r\n\t{\r\n\t\tbuttonText = buttons[i].value.replace(/^\\s+|\\s+$/g, '');\r\n\t\tif (buttonText != 'Help' && arrayIndexOf(doneButtons,buttonText) == -1)\r\n\t\t{\r\n\t\t\tcellNode.appendChild(createProxyButton(buttons[i],proxyIndex++));\r\n\t\t\tdoneButtons.push(buttonText);\r\n\t\t}   \r\n\t}  \r\n\r\n\tif (arrayIndexOf(doneButtons, 'cancel') != -1 || arrayIndexOf(doneButtons, 'close') != -1)\r\n\t\taddClose = 0;\r\n\t\r\n\t// show close button if there are no buttons in the lighbox\r\n\tif (addClose && cellNode)\r\n\t{\r\n\t\tvar closeNode = {\r\n\t\t\tvalue: 'Close',\r\n\t\t\tclassName: 'clsCloseButton',\r\n\t\t\ttype: 'button',\r\n\t\t\tname: 'Close'\r\n\t\t};\r\n\t\tcellNode.appendChild(createProxyButton(closeNode,proxyIndex++));\r\n\t} \r\n}\r\n\r\ncleanRadioAndCheckBoxes = function(buttons)\r\n{\r\n   var cName = \"\";\r\n   for (var i=0; i<buttons.length; i++)\r\n   {\r\n      cName = buttons[i].className;\r\n      if (cName.indexOf('clsNoBorderInput')==-1)\r\n      {\r\n         buttons[i].className = cName+' clsNoBorderInput';\r\n      }\r\n   }\r\n}\r\nproxySpellChecker = function(targetNode)\r\n{\r\n\tvar boxNode = $('OldSpellCheckOn');\r\n\t// Proxy the node only if it's visible (it could be hidden)\r\n\tif (boxNode && (boxNode.type == 'checkbox'))\r\n\t{\r\n\t\tvar proxyLabel = document.createElement('label');\r\n\t\tvar proxyBox = document.createElement('input');\r\n\t\tproxyBox.setAttribute('id', 'SpellCheckOn');\r\n\t\tproxyBox.setAttribute('name', 'SpellCheckOn');\r\n\t\tproxyBox.setAttribute('type', 'checkbox');\r\n\t\tproxyBox.setAttribute('value', 1);\r\n\t\tproxyBox.className = 'clsNoBorderInput';\r\n\t\tproxyBox.onclick = function(){\r\n\t\t\tvar o = $('OldSpellCheckOn');\r\n\t\t\tif (o)\r\n\t\t\t\to.checked = this.checked;\r\n\t\t};\r\n\t\tproxyLabel.appendChild(proxyBox);\r\n\t\tproxyLabel.appendChild(document.createTextNode('Check Spelling'));\r\n\t\ttargetNode.appendChild(proxyLabel);\r\n\t\t// Reflect original's status\r\n\t\tproxyBox.checked = boxNode.checked;\r\n\t}\r\n}\r\n\t\t\t\r\n/**\r\n * Helper method. Generate a proxy DOM node out of an original button\r\n * @param buttonNode   (node). Required. The original button DOM node\r\n * @return node\r\n */\r\ncreateProxyButton = function(buttonNode,index)\r\n{\r\n\r\n\t/*\r\n\t Buttons must be styled to look as links. \r\n\t Since this can be tricky accross browsers, we wrap a <span> around the buttons \r\n\t*/\r\n\t\r\n\t// Use trimmed value for text\r\n\tvar buttonText = buttonNode.value.replace(/^\\s+|\\s+$/g, '');\r\n\tvar newButtonText = buttonText;\r\n\tif (buttonText == 'OK' || buttonText == 'Finish')\r\n\t\tnewButtonText = 'Save';    \r\n\r\n\tvar proxyContainer = document.createElement('span');\r\n\tproxyContainer.id = 'proxyButton' + index; \r\n\tif (buttonNode.title)\r\n\t\tproxyContainer.title = buttonNode.title;\r\n\tproxyContainer.className = buttonNode.className;  \r\n\tif ((buttonText == 'Cancel' || buttonText == 'Close') && \r\n\t\t\t\t(buttonNode.className.indexOf('clsPushButton') >= 0 || buttonNode.className.indexOf('clsCancelButton') >= 0 || buttonNode.className.indexOf('clsCloseButton') >= 0)){\r\n\t  proxyContainer.className = 'cls'+buttonText+'Button';\r\n\t}\r\n\r\n\tvar proxyBox = document.createElement('input');\r\n\tif (buttonNode.type == 'submit' && typeof buttonNode.click == 'function'){\r\n\t  proxyBox.setAttribute('type', 'button');\r\n\t}\r\n\telse{\r\n\t\tproxyBox.setAttribute('type', buttonNode.type);\r\n\t}   \r\n\tproxyBox.setAttribute('name', buttonNode.name);\r\n\tproxyBox.setAttribute('value', newButtonText);\r\n\tproxyBox.setAttribute('id', buttonText);\r\n\r\n\tif (newButtonText=='Cancel' || newButtonText=='Close')\r\n\t{\r\n\t  proxyContainer.onclick = function()\r\n\t  {\r\n\t\tif (typeof buttonNode.click == 'function' || typeof buttonNode.click == 'object')\r\n\t\t{\r\n\t\t\tbuttonNode.click();\r\n\t\t}\r\n\t\telse\r\n\t      top.commonspot.lightbox.closeCurrent();\r\n\t  }\r\n\t}   \r\n\telse   \r\n\t{\r\n\t\tproxyContainer.onclick = function()\r\n\t\t{\r\n\t\t\tif (typeof buttonNode.click == 'function' || typeof buttonNode.click == 'object')\r\n\t\t\t{\r\n\t\t\t\tbuttonNode.click();\r\n\t\t\t}\t\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\t\t\r\n\tproxyBox.onmouseover = function()\r\n\t{\r\n\t\tthis.style.textDecoration = 'underline';\r\n\t\treturn false;\r\n\t}\r\n\tproxyBox.onmouseout = function()\r\n\t{\r\n\t\tthis.style.textDecoration = 'none';\r\n\t\treturn false;\r\n\t}\t\r\n\tproxyContainer.appendChild(proxyBox);\r\n\treturn proxyContainer;\r\n}\r\n/**\r\n* Helper method.    Return index of an element in an array NOT case-sensitive.\r\n* @param _this      Required. Array\r\n * @param x          Required. key\r\n* @return index      \r\n*/\r\narrayIndexOf = function(_this,x) \r\n{\r\n   for(var i=0;i<_this.length;i++) \r\n   {\r\n   \tif (_this[i].toLowerCase()==x.toLowerCase()) \r\n   \t\treturn i;\r\n   }\r\n   return-1;\r\n}   \t\r\n\t\t\r\n\r\nif (typeof(onLightboxResize) == \"undefined\")\r\n{\r\n\t\r\n\t/**\r\n\t * Hook that gets called by lightbox whenever the dialog gets resized\r\n\t * @param w         (int). Required. Width\r\n\t * @param h         (int). Required. Height\r\n\t */\r\n\tonLightboxResize = function(w, h)\r\n\t{\r\n\t\t// Remove margins from the dialog's body\r\n\t\tdocument.body.style.margin = 0;\r\n\t\tdocument.body.style.padding = 0;\r\n\t\tvar rootDiv = document.getElementById('cs_commondlg');\r\n\t\tif (rootDiv)\r\n\t\t{\r\n\t\t\tmain_table = document.getElementById('MainTable');\r\n\t\t\tif (main_table && main_table.style)\r\n\t\t\t{\r\n\t\t\t\tmain_table.style.width = (w-35)+'px';\r\n\t\t\t\trootDiv.style.width = (w-10)+'px';\r\n\t\t\t\tmain_table.style.height = (h -45) + 'px';\r\n\t\t\t\tmain_table.style.marginTop = 0;\r\n\t\t\t\trootDiv.style.marginTop = '10px';\r\n\t\t\t\trootDiv.style.height = (h -37) + 'px';\r\n\t\t\t}\t\r\n\t\t\t\t\r\n\t\t\t// Add scrollbars to the main box\r\n\t\t\trootDiv.style.overflow = 'auto';\r\n\t\t}\r\n\t}\r\n\r\n}\r\n</script><script id=\"cs_windowref\" type=\"text/javascript\" src=\"/commonspot/javascript/lightbox/window_ref.js\">/*\r\nJavaScript routines to resolve references for windows inside lightbox\r\n*/\r\n\r\ngetOpener = function(ignoreOpenerProperty)\r\n{\r\n\tif ((self != top) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))\r\n\t{\r\n\t\treturn top.commonspot.lightbox.getOpenerWindow(ignoreOpenerProperty);\r\n\t}\r\n\telse\r\n\t{\r\n\t\treturn self.opener;\r\n\t}\r\n}\r\n\r\ngetOpenerWithIFrame = function(iFrameID)\r\n{\r\n\tvar wnd = getOpener();\r\n\tvar obj = wnd.document.getElementById(iFrameID);\r\n\tif (obj)\r\n\t{\r\n\t\treturn obj.contentWindow;\r\n\t}\r\n\treturn getOpener();\r\n}\r\n\r\ngetRTEopener = function(FrameName)\r\n{\r\n\t// Grab the window object out of the RTE's iframe\r\n\tif (!FrameName)\r\n\t\tFrameName = 'WebEdit';\r\n\tvar fr = null;\r\n\tvar stackLen = 0;\r\n\tif ((self != top) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))\r\n\t\tstackLen = top.commonspot.lightbox.stack.length;\r\n\tfor (var i=stackLen-1; i>=0; i--)\r\n\t{\r\n\t\tif(top.commonspot.lightbox.stack.length == 1)\r\n\t\t\tfr = top.commonspot.lightbox.getOpenerWindow().document.getElementById(FrameName);\r\n\t\telse\r\n\t\t\tfr = top.commonspot.lightbox.stack[i].getWindow().document.getElementById(FrameName);\r\n\t\tif (fr)\r\n\t\t\treturn fr.contentWindow;\r\n\t}\r\n\treturn fr;\r\n}\r\n\r\nhasLightbox = function()\r\n{\r\n\treturn ((top != self) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'));\r\n}\r\n\r\nvar cleanHTMLWnd;\r\nvar spellcheckerWnd;\r\ngetCleanHTMLTarget = function(dlgLoader)\r\n{\r\n\tvar url = dlgLoader ? dlgLoader + '?csModule=/commonspot/dhtmledit/clean_dhtml_fields' : '/commonspot/dhtmledit/clean_dhtml_fields.cfm';\r\n\r\n\tif((top != self) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))\r\n\t{\r\n\t\tvar frName;\r\n\t\tfor (var i=0; i<top.commonspot.lightbox.stack.length; i++)\r\n\t\t{\r\n\t\t\tfrName = top.commonspot.lightbox.stack[i].getFrameName();\r\n\t\t\tif (frName == 'cleanHTML')\r\n\t\t\t\treturn frName;\r\n\t\t}\t\r\n\t\tvar lightboxTarget = openEmptyLightBox(url, null, 'cleanHTML');\r\n\t\treturn top.commonspot.lightbox.getFrameName();\r\n\t}\r\n\telse\r\n\t{\r\n\t\tif (!cleanHTMLWnd || cleanHTMLWnd.closed)\r\n\t\t\tcleanHTMLWnd = newWindow( 'cleanHTML', url);\r\n\t\treturn 'cleanHTML';\t\r\n\t}\r\n\t\r\n}\r\n\r\ngetSpellCheckTarget = function(dlgLoader)\r\n{\r\n\tvar url = dlgLoader ? dlgLoader + '?csModule=/commonspot/spellchk/introscreen' : '/commonspot/spellchk/introscreen.cfm';\r\n\r\n\tif((top != self) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))\r\n\t{\r\n\t\t// Open an empty lightbox\r\n\t\tvar frName;\r\n\t\tfor (var i=0; i<top.commonspot.lightbox.stack.length; i++)\r\n\t\t{\r\n\t\t\tfrName = top.commonspot.lightbox.stack[i].getFrameName();\r\n\t\t\tif (frName == 'spellchecker')\r\n\t\t\t\treturn frName;\r\n\t\t}\t\r\n\t\tvar lightboxTarget = openEmptyLightBox(url, null, 'spellchecker');\r\n\t\treturn top.commonspot.lightbox.getFrameName();\r\n\t}\r\n\telse\r\n\t{\r\n\t\tif (!spellcheckerWnd || spellcheckerWnd.closed)\r\n\t\t\tspellcheckerWnd = newWindow( 'spellchecker', url);\r\n\t\treturn 'spellchecker';\t\r\n\t}\r\n\t\r\n}\r\n\r\ncloseEmptyChildDialogs = function(frameNameList)\r\n{\r\n\tvar frameNameList = frameNameList ? frameNameList : 'cleanHTML,spellchecker';\r\n\tif ((top != self) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))\r\n\t{\r\n\t\tvar win;\r\n\t\tfor (var i=top.commonspot.lightbox.stack.length-1; i>=0; i--)\r\n\t\t{\r\n\t\t\twin = top.commonspot.lightbox.stack[i];\r\n\t\t\tfrName = win.getFrameName();\r\n\t\t\tif (frameNameList.indexOf(frName) >= 0)\r\n\t\t\t\twin.close();\r\n\t\t}\r\n\t}\t\r\n}\r\n\r\ncloseCleanHTMLWindows = function()\r\n{\r\n\tcloseEmptyChildDialogs('cleanHTML');\r\n\t/*\r\n\tif (self.children)\r\n\t{\r\n\t\tfor(i=0;i<self.children.length;i++)\r\n\t\t\tself.children[i].close();\r\n\t}\r\n\t*/\r\n}\r\n\r\ncloseSpellCheckWindows = function()\r\n{\r\n\tcloseEmptyChildDialogs('spellchecker');\r\n}\r\n\r\nopenEmptyLightBox = function(url, hideClose, name, customOverlayMsg)\r\n{\r\n\tvar lightboxTarget;\t\r\n\tvar url = url ? url : null;\r\n\tvar hideClose = hideClose ? hideClose : null;\r\n\tvar name = name ? name : null;\r\n\tvar customOverlayMsg = customOverlayMsg ? customOverlayMsg : null;\r\n\t// If we are inside a lightbox\r\n\tif ((top != self) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))\r\n\t{\r\n\t\t// Open an empty lightbox\r\n\t\ttop.commonspot.lightbox.openDialog(url, hideClose, name, customOverlayMsg, null, null, true);\r\n\t\t\r\n\t\tlightboxTarget = top.commonspot.lightbox.getFrameName();\r\n\t\t// Form's target now must be the lightbox, not a new window\r\n\t\treturn lightboxTarget;\r\n\t}\r\n\telse\r\n\t\treturn;\r\n}\r\n\r\n// returns contentWindow of admin-frame\r\ngetAdminWindow = function()\r\n{\r\n\tvar win = null;\r\n\tif ((top != self) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))\r\n\t\twin = top.commonspot.lightbox.getAdminWindow();\r\n\treturn win;\t\r\n}\r\n\r\n\r\n\t/**\r\n\t * Generic alert to user.\r\n\t * see commonspot.dialog.client.showHTMLDialog for supported options\r\n\t * msg can be text, or can be an array, in which case it'll be rendered as an html list\r\n\t */\r\nif ((top != self) && (typeof(top.commonspot)!== 'undefined') && (typeof(top.commonspot.lightbox)!== 'undefined'))\r\n{\r\n\tif (typeof top.commonspot.dialog === 'undefined')\r\n\t\ttop.commonspot.dialog = {};\r\n\tif (typeof top.commonspot.dialog.client === 'undefined')\r\n\t{\r\n\t\ttop.commonspot.dialog.client = {};\r\n\r\n\t\ttop.commonspot.dialog.client.alert = function(msg, options)\r\n\t\t{\r\n\t\t\tvar html;\r\n\t\t\tif(msg.constructor == String)\r\n\t\t\t\thtml = msg;\r\n\t\t\telse // assumed to be an array\r\n\t\t\t{\r\n\t\t\t\tif(msg.length === 1)\r\n\t\t\t\t\thtml = msg[0];\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\thtml = \"<ul>\";\r\n\t\t\t\t\tfor(var i = 0; i < msg.length; i++)\r\n\t\t\t\t\t\thtml += \"<li>\" + msg[i] + \"</li>\";\r\n\t\t\t\t\thtml += \"</ul>\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\thtml = html.replace(/\\n/g, '<br />');\r\n\t\t\ttop.commonspot.dialog.client.showHTMLDialog(html, options, 'alert');\r\n\t\t}\r\n\r\n\t\t/*\r\n\t\t * create a lightboxed dlg containing the passed html\r\n\t\t */\r\n\t\ttop.commonspot.dialog.client.showHTMLDialog = function(html, options, dialogType)\r\n\t\t{\r\n\t\t\tvar options = options || {};\r\n\t\t\tvar defaultOptions =\r\n\t\t\t{\r\n\t\t\t\ttitle: \"CommonSpot Message\",\r\n\t\t\t\tsubtitle: \"\",\r\n\t\t\t\thelpId: \"\",\r\n\t\t\t\twidth: 500,\r\n\t\t\t\theight: 600,\r\n\t\t\t\tstyle: '',\r\n\t\t\t\tuseDefaultStyles: true,\r\n\t\t\t\tmaximize: false,\r\n\t\t\t\thideClose: false,\r\n\t\t\t\thideHelp: true,\r\n\t\t\t\thideReload: true\r\n\t\t\t};\r\n\t\t\ttop.commonspot.util.merge(options, defaultOptions);\r\n\r\n\t\t\tdialogType = dialogType || 'dialog';\r\n\r\n\t\t\tvar style = options.style;\r\n\t\t\tif(options.useDefaultStyles)\r\n\t\t\t\tstyle = top.commonspot.dialog.client.getHTMLDialogDefaultStyles() + style;\r\n\r\n\t\t\thtml = top.commonspot.dialog.client.getHTMLDialogHTML(html, style, options.title, options);\r\n\r\n\t\t\t// openDialog(url, hideClose, name, customOverlayMsg, dialogType, opener, hideHelp)\r\n\t\t\tvar dlgObj = top.commonspot.lightbox.openDialog(\"about:blank\", options.hideClose, null, top.commonspot.lightbox.NO_OVERLAY_MSG, dialogType, null, options.hideClose, options.hideReload);\r\n\t\t\tvar lightboxWindow = dlgObj.getWindow();\r\n\t\t\tlightboxWindow.document.write(html);\r\n\t\t\tlightboxWindow.document.close();\r\n\r\n\t\t\ttop.commonspot.lightbox.initCurrent\r\n\t\t\t(\r\n\t\t\t\toptions.width,\r\n\t\t\t\toptions.height,\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: options.title, subtitle: options.subtitle, helpId: options.helpId,\r\n\t\t\t\t\tclose: options.close, reload: options.reload, maximize: options.maximize\r\n\t\t\t\t},\r\n\t\t\t\t'',\r\n\t\t\t\ttrue\r\n\t\t\t);\r\n\r\n\t\t\tvar dt = lightboxWindow.document.getElementById(\"dialogContainer\");\r\n\t\t\tvar w = Math.max(dt.clientWidth + 30, 350);\r\n\t\t\tvar h = Math.max(dt.clientHeight, 70) - ((options.hideClose && !options.customButtons) ? 30 : 0);\r\n\t\t\ttop.commonspot.lightbox.resizeCurrent(w, h);\r\n\t\t\t// first wanted this to autosize, to measure it, but now want it full width so close btn is far right\r\n\t\t\tlightboxWindow.document.getElementById(\"dialogContainer\").style.width = \"100%\";\r\n\t\t};\r\n\r\n\t\ttop.commonspot.dialog.client.getHTMLDialogDefaultStyles = function()\r\n\t\t{\r\n\t\t\tvar style =\r\n\t'body {font-family: Verdana,Arial,Helvetica,sans-serif; margin: 0; overflow: scroll; text-decoration: none; font-size: 11px;}\\n\\\r\n\ta:active {text-decoration: underline; color: #1D2661;}\\n\\\r\n\ta:hover {text-decoration: underline;color: #003366;}\\n\\\r\n\ta {color: #1D2661;text-decoration: underline;}\\n\\\r\n\ta:visited {\ttext-decoration: underline;color: #1D2661;}\\n\\\r\n\t#content {margin: 15px 11px; overflow: auto; font-size: 11px;}\\n\\\r\n\t#innerdialogContainer {background-color:#F0F0F0;border-bottom:1px solid #999999;border-top:1px solid #999999;margin-top:10px;}\\n\\\r\n\t#htmlDlgTableCell h2 {font-size: 11px; margin: 15px 0 8px;}\\n\\\r\n\t#htmlDlgTableCell h2:first-child {margin-top: 0;}\\n\\\r\n\t#htmlDlgTableCell p {margin: 0 0 8px; padding: 0;}\\n\\\r\n\t#htmlDlgTableCell ul {margin: 0 0 1em 1em; padding: 0;}\\n\\\r\n\t#htmlDlgTableCell li {margin: 5px;}\\n\\\r\n\t#htmlDlgTableCell dl {margin: 0 0 1em;}\\n\\\r\n\t#htmlDlgTableCell dt {color: #013466; font-weight: bold; margin: 5px 0 0;}\\n\\\r\n\t#htmlDlgTableCell dd {margin: 0 0 0 1.5em;}\\n\\\r\n\t#dialogContainer #dialogFooter {display: block; font-weight: bold; height: 28px; line-height: 28px; margin: 5px 0 0; padding: 0 1px; text-align: right; font-size: 11px;}\\n\\\r\n\t#htmlDlgTableCell .dumpTable caption {font-size: 8pt; font-weight: bold;}\\n\\\r\n\t#htmlDlgTableCell .dumpTable td {border: 1px solid #ccc; font-size: 8pt; padding: 1px;}\\n\\\r\n\t';\r\n\t\t\treturn style;\r\n\t\t};\r\n\r\n\t\ttop.commonspot.dialog.client.getHTMLDialogHTML = function(alertHTML, styleHTML, title, options)\r\n\t\t{\r\n\t\t\tvar btnHTML = '';\r\n\t\t\tvar linkID, linkClass, linkOnClick, linkObj, linkAccessKey, linkText, linkObj;\r\n\t\t\tvar accessKeyHTML = '';\r\n\t\t\tbtnHTML += options.hideClose ? '' : '<a id=\"closeButton\" accesskey=\"C\" href=\"javascript:;\" onclick=\"top.commonspot.lightbox.closeCurrent()\">Close</a>';\r\n\t\t\tif (options.customButtons)\r\n\t\t\t{\r\n\t\t\t\tfor (var i=0; i<options.customButtons.length; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\tlinkObj = options.customButtons[i];\r\n\t\t\t\t\tlinkID = linkObj.id ? linkObj.id : 'okButton';\r\n\t\t\t\t\tlinkOnClick = linkObj.onclick ? linkObj.onclick : '';\r\n\t\t\t\t\tlinkText = linkObj.linkText ? linkObj.linkText : '';\r\n\t\t\t\t\tif (linkObj.accessKey)\r\n\t\t\t\t\t\taccessKeyHTML = ' accesskey=\"' + linkObj.accessKey + '\"';\r\n\t\t\t\t\tif (linkOnClick != '' && linkID != '' && linkText != '')\r\n\t\t\t\t\t\tbtnHTML += '<a id=\"' + linkID + '\"' + accessKeyHTML + ' href=\"javascript:;\" onclick=\"' + linkOnClick + '\">' + linkText + '</a>';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar html =\r\n\t\t\t\t'<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">' +\r\n\t\t\t\t'<html>' +\r\n\t\t\t\t'<head>' +\r\n\t\t\t\t\t'<link href=\"/commonspot/dashboard/css/dialog.css\" rel=\"stylesheet\" type=\"text/css\" id=\"dialogcss\" />' +\r\n\t\t\t\t\t'<style>' + styleHTML + '</style>' +\r\n\t\t\t\t\t(title ? '<title>' + title + '</title>' : '') +\r\n\t\t\t\t'</head>' +\r\n\t\t\t\t'<body>' +\r\n\t\t\t\t\t'<table id=\"dialogContainer\">' +\r\n\t\t\t\t\t\t'<tr><td>' +\r\n\t\t\t\t\t\t\t'<table id=\"innerdialogContainer\" width=\"100%\">' +\r\n\t\t\t\t\t\t\t\t'<tr>' +\r\n\t\t\t\t\t\t\t\t\t'<td id=\"htmlDlgTableCell\">' +\r\n\t\t\t\t\t\t\t\t\t\t'<div id=\"content\">' + alertHTML + '</div>' +\r\n\t\t\t\t\t\t\t\t\t'</td>' +\r\n\t\t\t\t\t\t\t\t'</tr>' +\r\n\t\t\t\t\t\t\t'</table>' +\r\n\t\t\t\t\t\t'</td></tr>' +\r\n\t\t\t\t\t\t'<tr><td>' +\r\n\t\t\t\t\t\t\t'<div id=\"dialogFooter\">' +\r\n\t\t\t\t\t\t\t\tbtnHTML +\r\n\t\t\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t\t'</td></tr>'\r\n\t\t\t\t\t'</table>' +\r\n\t\t\t\t'</body>' +\r\n\t\t\t\t'</html>';\r\n\t\t\treturn html;\r\n\t\t};\r\n\t}\r\n}\t \r\n</script></head><body lang=\"en\" class=\"CS_Document\"><a name=\"__topdoc__\"></a><script src=\"/commonspot/pagemode/always-include-common.js\" type=\"text/javascript\"></script><script src=\"/commonspot/pagemode/always-include-ns.js\" type=\"text/javascript\"></script><!-- Google Tag Manager -->\n<noscript>&lt;iframe src=\"//www.googletagmanager.com/ns.html?id=GTM-NDN974\"\nheight=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"&gt;&lt;/iframe&gt;</noscript>\n<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n})(window,document,'script','dataLayer','GTM-NDN974');</script>\n<!-- End Google Tag Manager --> \n\t<style type=\"text/css\" media=\"all\">\n\t@import \"/style/tooltip.css\";\n\t</style>\t\n\n\n<style>\n/*override styles for cfwindow in cf9*/\ndiv.x-window-mc {background-color: #ffffff; padding: 10px;} \n</style>\n<div id=\"siteWrapper\" class=\" home\"><a name=\"top\" style=\"text-decoration:none;\"></a>\n\n\t\n\n<script type=\"text/javascript\">\n\tjQuery.noConflict();\n\n\tjQuery(document).ready(function($) { \n\t  \n\t//auto-complete begins \t\t  \n\t\tjQuery(\"#searchtext\").autocomplete({\n\t\t\tsource: function (request, response) {\n\t\t\t\tjQuery.ajax({\n\t\t\t\t\t//url: \"http://ws.geonames.org/searchJSON?featureClass=P&style=full&maxRows=12&name_startsWith=\"+request.term,\n\t\t\t\t\turl: \"https://www.acc.com/cfc/autoSuggestGSA.cfc?method=getSuggest&returnformat=json&name_startsWith=\" + request.term,\n\t\t\t\t\tdataType: \"json\",\n\t\t\t\t\tsuccess: function (data) {\n\t\t\t\t\t\t//response( $.map( data.geonames, function( item ) {\n\t\t\t\t\t\tresponse(jQuery.map(data.results, function (item) {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tlabel: item.name\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tminLength: 2,\n\t\t\tposition: { my: \"right top\", at: \"right bottom\", collision: \"none\" },\n\t\t\tselect: function (event, ui) {},\n\t\t\tclose: function () {\n\t\t\t\tjQuery(this).removeClass(\"ui-corner-top\").addClass(\"ui-corner-all\");\n\t\t\t}\n\t\t});\n\t//auto-complete ends \n\n\t});   \n</script>\n<style>\n.ui-autocomplete-loading {\nbackground: white url('https://jqueryui.com/resources/demos/autocomplete/images/ui-anim_basic_16x16.gif') right center no-repeat;\n}\n\n.ui-autocomplete li {\n\t\t\tlist-style-type: none; \n\t\t\tbackground: none; \n\t\t\tpadding-left: 0px; \n\t\t}\t\n\n</style>\n\n\n\n  \t\t<div style=\"position:relative; padding-left:145px; background:#e7eff2;margin-top;3px;\" align=\"center\">\n        <!-- Homepage Leaderboard [async] -->\n        <script type=\"text/javascript\">if (!window.AdButler){(function(){var s = document.createElement(\"script\"); s.async = true; s.type = \"text/javascript\";s.src = 'https://servedbyadbutler.com/app.js';var n = document.getElementsByTagName(\"script\")[0]; n.parentNode.insertBefore(s, n);}());}</script>\n        <script type=\"text/javascript\">\n        var AdButler = AdButler || {}; AdButler.ads = AdButler.ads || [];\n        var abkw = window.abkw || '';\n        var plc151356 = window.plc151356 || 0;\n        document.write('<'+'div id=\"placement_151356_'+plc151356+'\" style=\"text-align:center; background:#e7eff2;margin-top;3px; \"></'+'div>');\n        AdButler.ads.push({handler: function(opt){ AdButler.register(151651, 151356, [728,90], 'placement_151356_'+opt.place, opt); }, opt: { place: plc151356++, keywords: abkw, domain: 'servedbyadbutler.com', click:'CLICK_MACRO_PLACEHOLDER' }});\n        </script><script async=\"\" type=\"text/javascript\" src=\"https://servedbyadbutler.com/adserve/;ID=151651;size=728x90;setID=151356;type=async;domid=placement_151356_0;place=0;pid=4019712;sw=1280;sh=1024;spr=1;rnd=4019712;click=CLICK_MACRO_PLACEHOLDER\"></script><div id=\"placement_151356_0\" style=\"text-align:center; background:#e7eff2;margin-top;3px; \"></div>\n\t\t</div>        \n  \n\n\n\n<img src=\"/i/acc_logo.jpg\" id=\"print-logo\">\n\n    \t<!-- header -->\n              <div id=\"header\">\n\t\t\t    \n\n\n\n<script src=\"/j/jquery.hoverIntent.min.js\"></script>\n<script>\n\tjQuery(document).ready(function(){\n\t\tvar $myACCoverlay = jQuery('#myACCoverlay');\n\t\t\n\t\tjQuery('#myACCmenu li').not('.titleItem, .topItem').hoverIntent(\n\t\t\tfunction(){ \n\t\t\t\tif(navigator.appVersion.indexOf(\"MSIE 7.\")==-1) {\n\t\t\t\t\tjQuery(this).addClass('hover'); \n\t\t\t\t}\n\t\t\t}, \n\t\t\tfunction(){ jQuery(this).removeClass('hover');jQuery('#closeBox').hide(); });\t\n\n\t\tjQuery('.overlay').hoverIntent(\n\t\t\t//function(){ if(jQuery.support.opacity == true){ $myACCoverlay.fadeIn('slow'); } }, \n\t\t\tfunction(){ $myACCoverlay.hide(); });\t\n\t\t\t\n\t});\n</script> \n<ul id=\"myACCmenu\" class=\"group\">\n\t\n<div style=\"float:left\"><span style=\"font-style:italic; color:#fff\">Get the most from your membership&nbsp;...&nbsp;</span>\n<a href=\"https://www.acc.com/login/index.cfm?page=/index.cfm&amp;qstring=\" style=\"font-weight:bold; font-size:14px; color:#fff\">Login</a>\n</div>\n<div style=\"float:right\">\n<span style=\"font-style:italic; color:#fff\">Not a member? &nbsp;&nbsp;</span>\n<a href=\"/membership/\" style=\"font-weight:bold; font-size:14px; color:#fff\">Join ACC</a>\n</div>\n    \n</ul>\n\n\n\n\n\n                   \n                <!-- link to enable return to home click on logo --> \n                <a class=\"logo-click\" title=\"Return to main page\" href=\"/\"><div class=\"logo-click\"></div></a>\n                <a id=\"aboutACClink\" class=\"note\" href=\"/aboutacc/\">About ACC</a>\n                \n                <!-- Searh Form -->\n                <ul id=\"siteSearch\">\n                  <form id=\"frm_siteSearch\" method=\"get\" action=\"/search/\">\n                    <li>\n\t\t\t\t\t\t<div id=\"searchWrapper\">\n                            <input type=\"text\" id=\"searchtext\" name=\"term\" class=\"ghost-text ui-autocomplete-input\" value=\"Search for Events, Sample Forms, News, Networking and more...\" autocomplete=\"off\"><span role=\"status\" aria-live=\"polite\" class=\"ui-helper-hidden-accessible\"></span>\n                            <input type=\"image\" id=\"searchIcon\" src=\"/i/icon/search_btn.gif\" title=\"Start Search\">\n                        </div>\n                    </li>\n                  </form>\n                </ul>\n                \n                <!-- Main Menu -->\n                <ul id=\"main-nav\" class=\"group\">\n                \n                  <!-- Resources -->\n                  <li class=\"first\" id=\"nav-resources\"><a class=\"first mainItem\" href=\"/legalresources/index.cfm\">Resources</a>\n                  \t<ul>\n                        <li><a href=\"/legalresources/index.cfm\">Search the Library</a></li>\n                        <li><a href=\"/contracts/\">Contracts Portal</a></li>\n                        <li><a href=\"/ethicsxchange/\">Compliance Portal</a></li>\n                        <li><a href=\"/legalresources/research/\">Research Portal</a></li>\n                        <li><a href=\"/crisis/\">Crisis Management Portal</a></li>\n                        <li><a href=\"/legalresources/alliance/\">ACC Alliance</a></li>                        \n                        <li><a href=\"/myacc/directory.cfm\">Membership Directory</a></li>\n                        <li class=\"last\"><a href=\"https://community.acc.com/\">Member-to-Member</a></li>\n                    </ul>\n                  </li>\n                  \n                  <!-- Education -->\n                  <li id=\"nav-education2\"><a class=\"mainItem\" href=\"/education/index.cfm\">Education</a>\n                    <ul>\n                        <li><a href=\"http://am.acc.com\">ACC Annual Meeting</a></li>\n\t\t\t\t\t\t<li><a href=\"/mym\">ACC Mid-Year Meeting</a></li>\n                        <li><a href=\"/education/inperson.cfm\">In-Person Education</a></li>\n                        <li class=\"last\"><a href=\"/education/online-education.cfm\">Online Education</a></li>\n                    </ul>\n                  </li>\n                  \n                  <!-- Membership -->\n                  <li id=\"nav-membership\"><a class=\"mainItem\" href=\"/membership/\">Membership</a>\n                    <ul>\n                        <li><a href=\"/membership/\">Join / Renew</a></li>\n                        <li><a href=\"/membership/memberbenefits.cfm\">Benefits of Membership</a></li>\n                        <li><a href=\"/membership/types_of_membership/\">Types of Membership</a></li>\n                        <li><a href=\"/membership/eligibility.cfm\">Eligibility Requirements</a></li>\n                        <li class=\"last\"><a href=\"/membership/faqs.cfm\">FAQs</a></li>\n                    </ul>\n                  </li>\n                  \n                  <!-- ACC Docket -->\n                  <li id=\"nav-docket\"><a class=\"mainItem\" href=\"http://www.accdocket.com\">ACC Docket</a>\n                    \n                  </li>\n                  \n                  <!-- Advocacy -->\n                  <li id=\"nav-advocacy2\"><a class=\"mainItem\" href=\"http://advocacy.acc.com/\">Advocacy</a>\n\n                  </li>\n                  \n                  <!-- Careers -->\n                  <li id=\"nav-careers2\"><a class=\"mainItem\" href=\"/jobline/\">Careers</a></li>\n                </ul>\n                \n                <!-- Networking Menu -->\n                <ul id=\"networking-nav\" class=\"group\">\n\t\t\t\t\t<li><img src=\"/i/nav/icon_networking.jpg\" alt=\"Networking Opportunities\"></li>                    \n                    <li><a href=\"https://community.acc.com\">eGroups</a></li>\n                    <li><a href=\"/myacc/directory.cfm\">Member Directory</a>&nbsp;&nbsp;–</li>\n                \t<li><a href=\"/committees/\">Committees</a>&nbsp;&nbsp;–</li>\n                  \t<li><a href=\"/chapters/\">Chapters</a>&nbsp;&nbsp;–</li>\n                  \t<li><a href=\"/clo/\">CLOs</a>&nbsp;&nbsp;–</li>\n\n                    <li class=\"last\"><img src=\"/i/nav/icon_networking.jpg\" alt=\"Networking Opportunities\"></li>\n                </ul>\n                \n              </div><!-- /header -->\n\n<script>\n\tjQuery.noConflict();\n\t\n\tjQuery(document).ready(function($) {\n\t\t/* validate site search form submission */\n\t\t$('#frm_siteSearch').submit(function(){\n\t\t\tvar currentVal = $('#searchtext').val();\n\t\t\tif( currentVal == '' || currentVal == 'Search for Events, Sample Forms, News, Networking and more...' ) {\n\t\t\t\talert('Please enter a search term');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t});\n</script>\n \n  <!-- Marketing Banner-->\n  <div id=\"marketingArea\">\n  \t\n    <div id=\"advertisement\" class=\"ad-wrap\">\n      <div id=\"cs_control_1281757\" class=\"cs_control CS_Element_Textblock\"> <div class=\"CS_Textblock_Text\"><script type=\"text/javascript\">if (!window.AdButler){(function(){var s = document.createElement(\"script\"); s.async = true; s.type = \"text/javascript\";s.src = 'https://servedbyadbutler.com/app.js';var n = document.getElementsByTagName(\"script\")[0]; n.parentNode.insertBefore(s, n);}());}</script> <script type=\"text/javascript\"> var AdButler = AdButler || {}; AdButler.ads = AdButler.ads || []; var abkw = window.abkw || ''; var plc196230 = window.plc196230 || 0; document.write('<'+'div id=\"placement_196230_'+plc196230+'\"></'+'div>'); AdButler.ads.push({handler: function(opt){ AdButler.register(151651, 196230, [250,250], 'placement_196230_'+opt.place, opt); }, opt: { place: plc196230++, keywords: abkw, domain: 'servedbyadbutler.com', click:'CLICK_MACRO_PLACEHOLDER' }}); </script><script async=\"\" type=\"text/javascript\" src=\"https://servedbyadbutler.com/adserve/;ID=151651;size=250x250;setID=196230;type=async;domid=placement_196230_0;place=0;pid=4019712;sw=1280;sh=1024;spr=1;rnd=4019712;click=CLICK_MACRO_PLACEHOLDER\"></script><div id=\"placement_196230_0\"><div id=\"placement_196230_0\" style=\"margin:0;padding:0;\"><a href=\"https://servedbyadbutler.com/redirect.spark?MID=151651&amp;plid=603123&amp;setID=196230&amp;channelID=0&amp;CID=172859&amp;banID=519448824&amp;PID=0&amp;textadID=0&amp;tc=1&amp;mt=1492870626574987&amp;hc=4c8103096bf1300e0c1b021383a6c3f75a3e378a&amp;location=\" target=\"_blank\" rel=\"nofollow\"><img src=\"https://servedbyadbutler.com/getad.img/;libID=334938\" alt=\"\" title=\"\" border=\"0\" width=\"250\" height=\"250\"></a></div></div></div> </div> \n      <div class=\"ad-link\"><a href=\"/advertising/\" class=\"note\">Marketing Opportunities</a></div>\n    </div>\n    <!-- /advertisement -->\n    \n    <div id=\"carousel\" class=\"group\">\n       <div id=\"cs_control_1370809\" class=\"cs_control\">  \n    <link type=\"text/css\" rel=\"stylesheet\" media=\"all\" href=\"/style/carousel_2014.css\">\n    <script src=\"/j/jquery.cycle.min.js\"></script>\n    \n     <div id=\"carousel\" class=\"home\">\n          <div id=\"acc-carousel\" class=\"view-content\" style=\"width: 687px; height: 256px;\">\n            \n                <div class=\"views-row views-row-1\" style=\"position: absolute; top: 0px; left: 0px; display: block; z-index: 5; opacity: 1;\"> \n                    <a href=\"http://www.acc.com/education/am17/?acc_source=acchome&amp;acc_medium=flash&amp;acc_content=march2017&amp;acc_campaign=am2017\" class=\"slide\">\n                    <img alt=\"AM17_Carousel_685x250_skyline\" src=\"/education/images/AM17_Carousel_685x250_skyline_2.jpg\">\n                    \n                    <div class=\"slide-caption caption-light-bottom\">\n                        <div class=\"caption-title\">Program schedule now available. Register today!</div><!-- /caption-title -->\n                        <div class=\"caption-text\"></div><!-- /caption-text -->\n                    </div><!-- /slide-caption -->\n                    </a>\n                </div>\n              \n                <div class=\"views-row views-row-2\" style=\"position: absolute; top: 0px; left: 0px; display: none; z-index: 3; opacity: 0;\"> \n                    <a href=\"http://www.acc.com/education/ccu/index.cfm/?acc_source=acchome&amp;acc_medium=flash&amp;acc_content=April2017&amp;acc_campaign=ccu2017\" class=\"slide\">\n                    <img alt=\"nov_homepage-CCU17\" src=\"/education/images/nov_homepage-CCU17_2.jpg\">\n                    \n                    <div class=\"slide-caption caption-light-bottom\">\n                        <div class=\"caption-title\">Real-Life Training For New To In-house Professionals</div><!-- /caption-title -->\n                        <div class=\"caption-text\">Register today.</div><!-- /caption-text -->\n                    </div><!-- /slide-caption -->\n                    </a>\n                </div>\n              \n                <div class=\"views-row views-row-3\" style=\"position: absolute; top: 0px; left: 0px; display: none; z-index: 2; opacity: 0;\"> \n                    <a href=\"http://www.acc-foundation.com/gwil\" class=\"slide\">\n                    <img alt=\"ACC Homepage Carousel-685x250\" src=\"/education/images/ACC-Homepage-Carousel-685x250.jpg\">\n                    \n                    <div class=\"slide-caption caption-light-bottom\">\n                        <div class=\"caption-title\"></div><!-- /caption-title -->\n                        <div class=\"caption-text\"></div><!-- /caption-text -->\n                    </div><!-- /slide-caption -->\n                    </a>\n                </div>\n              \n                <div class=\"views-row views-row-4\" style=\"position: absolute; top: 0px; left: 0px; display: none; z-index: 1; opacity: 0;\"> \n                    <a href=\"http://advocacy.acc.com/2017/03/model-information-protection-and-security-controls-for-outside-counsel-possessing-company-confidential-information?acc_source=acchome&amp;acc_medium=flash&amp;acc_content=april2017&amp;acc_campaign=CybersecurityBestPractices\" class=\"slide\">\n                    <img alt=\"apr_homepage-Advocacy-Cybersecurity\" src=\"/education/images/apr_homepage-Advocacy-Cybersecurity.jpg\">\n                    \n                    <div class=\"slide-caption caption-light-bottom\">\n                        <div class=\"caption-title\">ACC's Law Firm Cybersecurity Controls</div><!-- /caption-title -->\n                        <div class=\"caption-text\"></div><!-- /caption-text -->\n                    </div><!-- /slide-caption -->\n                    </a>\n                </div>\n              \n          </div><!-- /acc-carousel -->\n          <div id=\"carousel-direction-nav\"> \n            <a id=\"carousel-prev\" href=\"\">Previous</a> \n            <a id=\"carousel-next\" href=\"\">Next</a> \n          </div><!-- /carousel-direction-nav -->\n          \n          <div id=\"carousel-control-nav\"><a href=\"#\" class=\"activeSlide\">1</a><a href=\"#\">2</a><a href=\"#\">3</a><a href=\"#\">4</a></div><!-- /carousel-control-nav -->\n    </div><!-- /carousel -->     \n    \n    <script type=\"text/javascript\">\n        jQuery(document).ready(function() { \n            \n            // create/init the carousel object \n            var $carousel = jQuery('#acc-carousel').cycle({\n                fx:     'fade', \n                speed:   300, \n                timeout: 10000, \n                pause:   true,\n                pauseOnPagerHover: 1,\n                pager: '#carousel-control-nav',\n                next:   '#carousel-next', \n                prev:   '#carousel-prev'\n            });\n    \n            /* pause when hovering over prev-next buttons */\n            jQuery('#carousel-prev, #carousel-next').hover(function(){\n                jQuery('#acc-carousel').cycle('pause');\n            }, function(){\n                jQuery('#acc-carousel').cycle('resume');\n            });\n    \n        });\n    </script> \n  </div> \n    </div>\n    <!-- /carousel -->\n\n    <div id=\"tagline\"> <img src=\"/i/worlds_largest.jpg\" alt=\"The world's largest community of in-house counsel\"> </div>\n  </div>\n  <!-- /marketingArea --> \n\n\n  <!-- Main Content -->\n  <div id=\"content\"> \n    <!-- accLayout wrapper -->\n    <div class=\"accLayout group\"> \n      <!-- left column -->\n      <div id=\"home-leftColumn\">\n        <div class=\"acc_resource resource-home group addBG\" id=\"home_avc-highlight\">\n          <div class=\"resourceThumb\"> <img src=\"/images/articles-homepage-manage_legalspend.jpg\" class=\"resourceThumb\" alt=\"Manage Legal Spend!\"> </div>\n          <h3 class=\"avc_highlight\">Manage Legal Spend</h3>\n          <p> <a href=\"/valuechallenge/\" class=\"more\">Tools, Tips &amp; Resources</a> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href=\"/valuechallenge/LegalServiceManagement/\" class=\"more\">Training</a> </p>\n          <h4 class=\"avc_highlight\">Better outcomes • Higher predictability • Lower costs</h4>\n        </div>\n                  \n      <div class=\"acc_resource resource-home group\">\n          <div class=\"resourceThumb\">\n\t          \n              \t<img src=\"/clo/perspectives/images/Hicks_Kirkland_Headshot_2017.jpg\" class=\"resourceThumb\" alt=\"Lincoln Financial Group’s Kirkland Hicks, Executive Vice President and General Counsel, on the Changing Role of the Chief Legal Officer\" style=\"overflow:hidden; height:auto;\">              \n              \n\n          </div>\n          <h3><a href=\"/clo/perspectives/april-2017-clo-eb.cfm\">Lincoln Financial Group’s Kirkland Hicks, Executive Vice President and General Counsel, on the Changing Role of the Chief Legal Officer</a></h3>\n          <h5>2017 Apr 18</h5> <a href=\"/clo/\" class=\"more\">Chief Legal Officers</a>\n          <p>\n              \"The role has changed in terms of putting the general counsel in the crosshairs,\" says Hicks. \"General counsels now are viewed as true gatekeepers by regulators and stakeholders. They are held accountable for business failures—there is greater risk, but there are many more rewards.\"\n\n\n&nbsp; \n          </p>\n      </div>    \n\n\t\t          \n      <div class=\"acc_resource resource-home group\">\n          <div class=\"resourceThumb\">\n\t          \n              <img src=\"/aboutacc/newsroom/pressreleases/images/115x115_LI_Icon-LegalOps-copy.jpg\" class=\"resourceThumb\" alt=\"ACC Legal Operations to Address Emerging Legal Technology, Design Thinking at Third Annual Conference\">              \n              \n\n          </div>\n          <h3><a href=\"/aboutacc/newsroom/pressreleases/acc-legal-operations-third-annual-conference.cfm\">ACC Legal Operations to Address Emerging Legal Technology, Design Thinking at Third Annual Conference</a></h3>\n          <h5>2017 Apr 10</h5> <a href=\"/aboutacc/newsroom/\" class=\"more\">Newsroom</a>\n          <p>\n              ACC will host the 2017 ACC Legal Ops Conference, \"Accelerating Innovation in Legal Services,\" on June 2-4 in Chicago. \n          </p>\n      </div>    \n\n\t\t          \n      <div class=\"acc_resource resource-home group\">\n          <div class=\"resourceThumb\">\n\t          \n              \t<img src=\"/vl/public/ACCDocketArticle/images/ACC-Docket-April-2017-Cove-tumbnail.jpg\" class=\"resourceThumb\" alt=\"Vaccinate Your Company: How to Prepare for a Global Health Crisis\" style=\"overflow:hidden; height:auto;\">              \n              \n\n          </div>\n          <h3><a href=\"/legalresources/resource.cfm?show=1455395\">Vaccinate Your Company: How to Prepare for a Global Health Crisis</a></h3>\n          <h5>2017 Apr 01</h5> <a href=\"http://www.accdocket.com/\" class=\"more\">ACC Docket</a>\n          <p>\n              While the threat of an impending “doomsday” virus may seem like an outlandish prospect, real-world examples like Swine Flu and Ebola raise the question: How would your company respond to such an event? Through an understanding of key employment regulations, in-house counsel can develop precautionary strategies to help mitigate the risk of the next global health crisis. \n          </p>\n      </div>    \n\n\t\t          \n      <div class=\"acc_resource resource-home group\">\n          <div class=\"resourceThumb\">\n\t          \n              <img src=\"/legalresources/images/pexels-photo.jpg\" class=\"resourceThumb\" alt=\"The Role of General Counsel in Middle East\">              \n              \n\n          </div>\n          <h3><a href=\"/legalresources/resource.cfm?show=1455102\">The Role of General Counsel in Middle East</a></h3>\n          <h5>2017 Mar 21</h5> <a href=\"/legalresources/\" class=\"more\">Resource Library</a>\n          <p>\n              This Leading Practice Profile, The Role of General Counsel in Middle East, features the law department leading practices for three entities navigating the many challenges of meeting the regulatory and cultural standards placed on global corporations. &nbsp; \n          </p>\n      </div>    \n\n\t\t\n      </div>\n       \n      \n      <!-- right column -->\n      <div id=\"home-rightColumn\">\n        <div class=\"fieldset\">\n          <div class=\"legend\">Resources for your role as a:</div>\n          <ul class=\"noBullet\">\n            <li class=\"noBullet\">\n              <h3><a href=\"/clo/\" class=\"more\">Chief Legal Officer</a></h3>\n            </li>\n            <li class=\"noBullet\">\n              <h3><a href=\"/ldel/\" class=\"more\">Law Department Executive Leader</a></h3>\n            </li>\n            <li class=\"noBullet\">\n              <h3><a href=\"/new_to_in_house/\" class=\"more\">New To In-house Lawyer</a></h3>\n            </li>\n          </ul>\n        </div>\n        <div id=\"home_education\" class=\"fieldset group\">\n          <div class=\"legend\">Education Events</div>\n          \n      <div class=\"home_education-item group addBG\">\n          <h3><a href=\"http://webcastarchive.acc.com/detail.php?id=389987&amp;go=1&amp;hpLink=1\">The Legal Shift: How Changes Within The Corporate Law Department Are Impacting Their Relationship With Law Firms</a></h3>\n          <div class=\"right\">\n              <img src=\"/i/icon/icon-cle-small.png\" alt=\"CLE\" class=\"acc_cell\">\n          </div>                                \n          <h5>2017&nbsp;&nbsp;April&nbsp;&nbsp;25&nbsp;—&nbsp;Online</h5>\n      </div>\n    \n      <div class=\"home_education-item group \">\n          <h3><a href=\"http://webcastarchive.acc.com/detail.php?id=120046&amp;go=1&amp;hpLink=1\">US MACRA: What It Is, What It Does, What It Means</a></h3>\n          <div class=\"right\">\n              <img src=\"/i/icon/icon-cle-small.png\" alt=\"CLE\" class=\"acc_cell\">\n          </div>                                \n          <h5>2017&nbsp;&nbsp;April&nbsp;&nbsp;26&nbsp;—&nbsp;Online</h5>\n      </div>\n    \n      <div class=\"home_education-item group addBG\">\n          <h3><a href=\"http://www.acc.com/education/businessedu/programs/minimba.cfm?hpLink=1\">Mini MBA for In-House Counsel</a></h3>\n          <div class=\"right\">\n              <img src=\"/i/icon/icon-cle-small.png\" alt=\"CLE\" class=\"acc_cell\">\n          </div>                                \n          <h5>2017&nbsp;&nbsp;May&nbsp;&nbsp;09-11&nbsp;—&nbsp;Los Angeles, CA</h5>\n      </div>\n    \n      <div class=\"home_education-item group \">\n          <h3><a href=\"http://www.acc.com/legalops/?hpLink=1\">2017 ACC Legal Operations Conference</a></h3>\n          <div class=\"right\">\n              \n          </div>                                \n          <h5>2017&nbsp;&nbsp;June&nbsp;&nbsp;04-06&nbsp;—&nbsp;Chicago (Rosemont), IL</h5>\n      </div>\n    \n      <div class=\"home_education-item group addBG\">\n          <h3><a href=\"http://www.acc.com/education/businessedu/programs/minimba.cfm?hpLink=1\">Mini MBA for In-House Counsel</a></h3>\n          <div class=\"right\">\n              <img src=\"/i/icon/icon-cle-small.png\" alt=\"CLE\" class=\"acc_cell\">\n          </div>                                \n          <h5>2017&nbsp;&nbsp;June&nbsp;&nbsp;05-07&nbsp;—&nbsp;Boston, MA</h5>\n      </div>\n    \n          <div class=\"cta_links group\"> <a href=\"/education/inperson.cfm\" class=\"more\">In-Person Education</a> &nbsp;&nbsp;&nbsp; <a href=\"/education/online-education.cfm\" class=\"more\">Online Education</a> </div>\n        </div>\n        <div id=\"home_jobline\" class=\"fieldset\">\n          <div class=\"legend\">ACC Jobline</div>\n          \n<h3><a style=\"cursor:default; text-decoration:none;\">701</a> Listings <a class=\"newThisWeek\" style=\"cursor:default; text-decoration:none;\">102</a> New this week</h3>\n \n          <div class=\"cta_links group\"> <a href=\"http://jobline.acc.com/jobs\" class=\"more\">Find a job</a> &nbsp;&nbsp;&nbsp; <a href=\"http://jobline.acc.com/hr/\" class=\"more\">Post a job</a> </div>\n        </div>\n      </div>\n       \n      \n    </div>\n     \n  </div>\n   \n\n\n  \n\n\t<style type=\"text/css\">\n    \tiframe {\n\t      background-color: black;\n\t\t  color:black;\n\t    }\n\t\t#siteWrapper.home div iframe {\n\t\t\tbackground-color: transparent; \n\t\t}\n\t</style>\n\n<!-- footer -->\n            <div id=\"footer\">\n            \n            <!-- Footer Header -->\n            \t<div id=\"ftr-header\" class=\"group\">\n                \t<ul id=\"ftr_social-nav\" class=\"right\">\n                    \t<li><a href=\"http://www.facebook.com/AssnCorpCnsl\"><img src=\"/i/icon/footer_facebook.jpg\" alt=\"Facebook\" title=\"Facebook\"></a></li>\n                        <li><a href=\"http://www.linkedin.com/groups?gid=1458&amp;trk=hb_side_g\"><img src=\"/i/icon/footer_linkedin.jpg\" alt=\"Linked In\" title=\"Linked In\"></a></li>\n                        <li><a href=\"http://twitter.com/ACCinhouse\"><img src=\"/i/icon/footer_twitter.jpg\" alt=\"Twitter\" title=\"Twitter\"></a></li>\n                        <li><a href=\"http://www.inhouseaccess.com/\"><img src=\"/i/icon/footer_blog.jpg\" alt=\"ACC Blog\" title=\"ACC Blog\"></a></li>\n                    </ul>\n                </div><!-- /ftr-header -->\n                \n           <!-- Footer Content -->     \n                <div id=\"ftr-content\">\n                \t<!-- column 1 -->\n                \t<div class=\"acc_cell\">\n                    \t<ul>\n                        \t<li class=\"first\">Resources</li>\n                            <li><a href=\"/legalresources/\">Search Library</a></li>\n                            <li><a href=\"/myacc/directory.cfm\">Membership Directory</a></li>\n                            <li><a href=\"http://community.acc.com/\">Member-to-Member</a></li>\n                            <li><a href=\"/legalresources/alliance/\">ACC Alliance</a></li>\n                            <li><a href=\"http://www.accdocket.com/\">ACC Docket</a></li>\n                            <li><a href=\"http://www.inhouseaccess.com/\">In-house ACCess</a></li>\n                            <li><a href=\"/contracts/\">Contracts Portal</a></li>\n                            <li><a href=\"/ethicsxchange/\">Compliance Portal</a></li>\n                            <li><a href=\"/legalresources/globalsponsors.cfm\">Global Resource Providers</a></li>\n                            <li><a href=\"/legalresources/research/\">Research Portal</a></li>\n                            <li><a href=\"/aboutacc/copyright.cfm\">Reprint Request</a></li>\n                        </ul>\n                    </div><!-- /acc_cell col 1 -->\n                \t\n                    <!-- column 2 -->\n                    <div class=\"acc_cell\">\n                    \t<ul>\n                        \t<li class=\"first\">Education</li>\n                            <li><a href=\"http://am.acc.com\">Annual Meeting</a></li>\n                            <li><a href=\"/education/businessedu/\">Business Education</a></li>\n                            <li><a href=\"/education/eli/\">Executive Leadership</a></li>\n                            <li><a href=\"/education/inperson.cfm\">In-Person Education</a></li>\n                            <li><a href=\"/education/online-education.cfm\">Online Education</a></li>\n                        </ul>\n                        \n                    \t<ul>\n                        \t<li class=\"first\">Networking</li>\n                            <li><a href=\"/chapters/\">Chapters</a></li>\n                            <li><a href=\"/committees/\">Committees</a></li>\n                            <li><a href=\"/eGroups/\">eGroups</a></li>\n                            <li><a href=\"/customcf/vucalendar.cfm\">Event Calendar</a></li>\n                        </ul>                        \n                    </div><!-- /acc_cell col 2 -->\n                \t\n                    <!-- column 3 -->\n                    <div class=\"acc_cell\">\n                    \t<ul>\n                        \t<li class=\"first\">Membership</li>\n                            <li><a href=\"/membership/\">Join / Renew</a></li>\n                            <li><a href=\"/membership/types_of_membership/\">Types of Membership</a></li>\n                            <li><a href=\"/membership/eligibility.cfm\">Eligibility Requirements</a></li>\n                            <li><a href=\"/membership/memberbenefits.cfm\">Benefits of Membership</a></li>\n                            <li><a href=\"/membership/faqs.cfm\">Membership FAQs</a></li>\n                        </ul>\n                        \n                    \t<ul>\n                        \t<li class=\"first\">Audience</li>\n                            <li><a href=\"/clo/\">Chief Legal Officers</a></li>\n                            <li><a href=\"/new_to_in_house/\">New to In-house</a></li>\n                            <li><a href=\"/ldel/\">COOs of Large Legal Departments</a></li>\n                            <li><a href=\"/legalops/\">Legal Operations Professionals</a></li>\n                        </ul>                                \n                    </div><!-- /acc_cell col 3 -->\n                \t\n                    <!-- column 4 -->\n                    <div class=\"acc_cell\">\n                    \t<ul>\n                        \t<li class=\"first\">About ACC</li>\n                            <li><a href=\"/advertising/\">Marketing Opportunities</a></li>\n                            <li><a href=\"/aboutacc/legal.cfm\">Legal</a></li>\n                            <li><a href=\"/aboutacc/leadership/\">Board of Directors</a></li>\n                            <li><a href=\"/aboutacc/newsroom/\">Newsroom</a></li>\n                            <li><a href=\"/sitemap.cfm\">Site Map</a></li>\n                        </ul>\n                    </div><!-- /acc_cell col 4 -->\n                \t\n                    <!-- column 5 -->\n                    <div class=\"acc_cell\">\n                    \t<ul>\n                        \t<li class=\"first\">Initiatives</li>\n                            <li><a href=\"/valuechallenge/\">ACC Value Challenge</a></li>\n                            <li><a href=\"http://advocacy.acc.com/\">Advocacy</a></li>\n                            <li><a href=\"/aboutacc/history/outreach.cfm\">Diversity</a></li>\n                            <li><a href=\"/aboutacc/history/probono.cfm\">Pro Bono</a></li>\n                            <li><a href=\"http://www.acc-foundation.com\">ACC Foundation</a></li>\n                        </ul>\n                    </div><!-- /acc_cell col 5 -->\n                    \n                <!-- Contact Us Icon -->\n                    <a href=\"/aboutacc/contactus/index.cfm\"><img src=\"/i/icon/footer_contactus.jpg\" id=\"ftr-contactus\" title=\"Contact Us\" alt=\"Contact Us\"></a>\n                        \n                </div><!-- /ftr-content -->\n                \n            <!-- Footer Footer-->\n                <div id=\"ftr-footer\">\n                    <p class=\"left\">©Copyright 1998-2017 — Association of Corporate Counsel — All rights reserved.</p> \n                    <p class=\"right\">\n\t\t\t\t\t&nbsp;\n                    </p>\n                </div><!-- /ftr-footer -->\n\n\t\n    \n</div><!-- /footer -->\n\n\n<div id=\"myACCoverlay\"></div>\n\n\n\n\n      \n    <style>\n        #PLG_container {\n            width:200px;\n            height : 50px;\n            margin-bottom:465px;\n            position:fixed;\n            /*background:url(\"/i/bg_PLG-4.png\") 0 0 no-repeat;*/\n\t\t\tbackground:#fcfcfc;\n            top:55%;\n            right:10px;\t\n            text-align:center;\n            z-index:10000;\n            border:1px solid #6ba9bf;\n            border-radius:6px;\n            /*box-shadow: 1px 1px 2px #dedede;*/\n\t\t\tdisplay:none;\n        }\n        #PLG_link_wrapper {\n            position:relative;\n            padding:8px 10px;\n        }\n        #PLG_check { \n            float:right;\n            cursor:pointer;\n            margin: 0 0 0 4px;\n            padding:0;\n            zoom: 1;\n            filter: alpha(opacity=70);\n            opacity: 0.70;\n        }\n        #PLG_check img {\n            float:none; \n            padding:0;\n            margin:0;\n            display:inline;\n        }\n        #PLG_link_wrapper a, \n        #PLG_link_wrapper a:visited {\n            display:block;\n            color:#2e778e;\n            text-decoration:none;\t\n            font: italic bold 14px/1 Arial,Helvetica,sans-serif;\n            text-align:center;\n        }\t\n    </style>\n    \n    <div id=\"PLG_container\" style=\"display: block;\">\n        <div id=\"PLG_link_wrapper\">\n            <div id=\"PLG_check\" class=\"group\" title=\"Hide this\"><img src=\"/i/modal_close.png\"></div>\n            <a id=\"PLG_link\" href=\"http://info.acc.com/trialaccess/\" title=\"1 month free trial membership\">Not a member yet?<br>Sign up for a free trial.</a>\n         </div>\n    </div>\n\t   \n    <script>\n        jQuery(document).ready(function(){\t\n    \n            // global vars and object cache\n                var timeoutID;\n                /*var ACC_Cookies = Cookies.noConflict();*/\n                if( ACC_Cookies ){ var PLG_Float_State = ACC_Cookies.get('PLG_Float'); }\n                var PLG_container = jQuery(\"#PLG_container\");\n                var PLG_link_wrapper = jQuery(\"#PLG_link_wrapper\");\n                var PLG_link = jQuery(\"#PLG_link\");\n                var PLG_check = jQuery(\"#PLG_check\");\n                \n            // functions \n                var showPLG_Float = function(){\n                    PLG_container.css(\"display\", \"block\");\n                    if( ACC_Cookies ){ ACC_Cookies.set('PLG_Float', 'show', { expires: 365 }); }\n                }\n                var hidePLG_Float = function(){\n                    PLG_container.css(\"display\", \"none\");\n                    if( ACC_Cookies ){ ACC_Cookies.set('PLG_Float', 'hide', { expires: 365 }); }\n                }\n                \n            // init float on page load based on value of cookie\n                if(PLG_Float_State == undefined || PLG_Float_State == 'show'){\n                    showPLG_Float();\n                } else {\n                    hidePLG_Float();\n                }\n                \n            // event handlers \t\t\n                PLG_check.on(\"click\", function(){\n                    hidePLG_Float();\n                });\n        \n                \n        \n        });\n    </script>\n\n<style>\n#acc_opt_in_container {\n  bottom: -150px;\n  height: auto;\n  margin: 0 auto;\n  position: fixed;\n  width: 982px;\n  z-index: 99999;\n  border-top: 1px solid #6ba9bf;\n}\n#acc_opt_in_container #acc_opt_in_wrapper {\n  /*background: rgba(0, 0, 0, 0) linear-gradient(to bottom, #efefef 0%, #fff 100%) repeat scroll 0 0;*/\n  background: #fcfcfc none repeat scroll 0 0;\n  border: 0;\n  color: #1d1d1d;\n  font-family: Arial,sans-serif;\n  font-size: 12px;\n  padding: 0px 0 0px;\n  text-align: center;\n  line-height:1.5;\n}\n#acc_opt_in_container #acc_opt_in_wrapper #acc_opt_in_form {\n  margin: 0 auto;\n  max-width: 975px;\n  padding: 0;\n  width: auto;\n  display:block;\n}\n#acc_opt_in_container input#acc_opt_in_submit {\n  background: #c0143c none repeat scroll 0 0;\n  border: 0 none;\n  border-radius: 3px;\n  color: #fff;\n  margin-left: 5px;\n  padding: 3px 5px;\n  cursor:pointer;\n}\n</style>\n\n\n\n\n<div id=\"acc_opt_in_container\" style=\"bottom: -110.835px;\">\t\t\t\n\t<div id=\"acc_opt_in_wrapper\" style=\"padding-bottom:12px;\">\t\t\t\t\n        <p style=\"font-size:.6rem;\">\n            This site uses cookies to store information on your computer. \n            Some are essential to make our site work properly; others help us improve the user experience.<br> By using the site, you consent to the placement of these cookies. \n            Read our <a href=\"http://www.acc.com/aboutacc/legal.cfm#privacy\" title=\"Read our privacy policy\" target=\"_new\" style=\"text-decoration:underline;\">privacy policy</a> to learn more. \n            <a id=\"acc_opt_in_submit\" title=\"Hide this message\" name=\"acc_opt_in_submit\" style=\"cursor:pointer; float:right; padding-right:12px;\"><i class=\"fa fa-close\"></i> Hide this message</a>\n        </p>\t\t\t\t\n\t</div>\t\t\n</div>\n\n\n<script>\n\tjQuery(document).ready(function(){\t\n\t//make sure ACC_Cookies is an object\n\tif (ACC_Cookies) { \t\n\t\t// global vars and object cache\n\t\t\tvar expirationDate = new Date(2038, 1, 19);\n\t\t\tvar COOKIE_OptIn_State = ACC_Cookies.get('COOKIE_OptIn');\n\t\t\tvar acc_opt_in_container = jQuery(\"#acc_opt_in_container\");\n\t\t\tvar acc_opt_in_wrapper = jQuery(\"#acc_opt_in_wrapper\");\n\n\t\t\tvar acc_opt_in_form = jQuery(\"#acc_opt_in_form\");\n\t\t\tvar acc_opt_in_submit = jQuery(\"#acc_opt_in_submit\");\n\t\t\t\n\t\t// functions \n\t\t\tvar showCOOKIE_OptIn = function(){\n\t\t\t\t//acc_opt_in_container.css(\"display\", \"block\");\n\t\t\t\tacc_opt_in_container.animate({bottom:'-8px'},1000);\n\t\t\t\tACC_Cookies.set('COOKIE_OptIn', 'show', { expires: expirationDate });\n\t\t\t}\n\t\t\tvar hideCOOKIE_OptIn = function(){\n\t\t\t\tacc_opt_in_container.css(\"display\", \"none\");\n\t\t\t\tACC_Cookies.set('COOKIE_OptIn', 'hide', { expires: expirationDate });\n\t\t\t}\n\t\t\t\n\t\t// init float on page load based on value of cookie\n\t\t\tif(COOKIE_OptIn_State == undefined || COOKIE_OptIn_State == 'show'){\n\t\t\t\tshowCOOKIE_OptIn();\n\t\t\t} else {\n\t\t\t\thideCOOKIE_OptIn();\n\t\t\t}\n\t\t\t\n\t\t// event handlers \t\t\n\t\t\tacc_opt_in_submit.on(\"click\", function(){\n\t\t\t\thideCOOKIE_OptIn();\n\t\t\t});\n\t\t\t\n\t\t\t/* remove this line when code goes live */\n\t\t\t/*ACC_Cookies_2.set('COOKIE_OptIn', 'show', { expires: expirationDate });*/\n\t}\n\t});\n</script>\n\n\n\n<a class=\"back-to-top\" href=\"#\" title=\"Scroll to top\"><i class=\"fa fa-arrow-circle-up\"></i></a>\n<script>\n\t/*---------------------------------\n\t\tScroll back to top \n\t-----------------------------------*/\n\tjQuery(document).ready(function(){\n\t\tvar scroll_offset = 250;\n\t\tvar scroll_duration = 300;\n\t\t\n\t\tjQuery(window).scroll(function() {\n\t\t\tif (jQuery(this).scrollTop() > scroll_offset) {\n\t\t\t\tjQuery('.back-to-top').fadeIn(scroll_duration);\n\t\t\t} else {\n\t\t\t\tjQuery('.back-to-top').fadeOut(scroll_duration);\n\t\t\t}\n\t\t});\n\t\n\t\tjQuery('.back-to-top').click(function(event) {\n\t\t\tevent.preventDefault();\n\t\t\tjQuery('html, body').animate({scrollTop: 0}, scroll_duration);\n\t\t\treturn false;\n\t\t})\n\t});\n</script>\n\n\n  <script type=\"text/javascript\">\n  setTimeout(function(){var a=document.createElement(\"script\");\n  var b=document.getElementsByTagName(\"script\")[0];\n  a.src=document.location.protocol+\"//dnn506yrbagrg.cloudfront.net/pages/scripts/0021/5597.js?\"+Math.floor(new Date().getTime()/3600000);\n  a.async=true;a.type=\"text/javascript\";b.parentNode.insertBefore(a,b)}, 1);\n  </script>\n\n\n  <script type=\"text/javascript\">\n    (function(d,s,i,r) {\n      if (d.getElementById(i)){return;}\n      var n=d.createElement(s),e=d.getElementsByTagName(s)[0];\n      n.id=i;n.src='//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/88951.js';\n      e.parentNode.insertBefore(n, e);\n    })(document,\"script\",\"hs-analytics\",300000);\n\n  </script>\n\n\n\n\n \n    \n</div><div style=\"display:block; clear:left; padding:0px; font-family:Verdana,Arial; font-size:10px; color:gray;\"></div>\n\t\t<script type=\"text/javascript\">\n\t\t<!--\n\t\t\tvar jsPageContributeMode = 'read';\n\t\t\tvar jsPageSessionContributeMode = 'read';\n\t\t\t\n\t\t\tvar jsPageAuthorMode = 0;\n\t\t\tvar jsPageEditMode = 0;\n\n\t\t\t\n\t\t\tif(!commonspot)\n\t\t\t\tvar commonspot = {};\n\t\t\tcommonspot.csPage = {};\n\t\t\tcommonspot.csPage.url = '/index.cfm';\n\t\t\t\n\t\t\tcommonspot.csPage.id = 1350;\n\t\t\tcommonspot.csPage.title = 'ACC Home Page';\n\n\t\t\tcommonspot.csPage.pagetype = 0;\n\t\t\tcommonspot.csPage.publicationState = 'Published Page';\n\t\t\tcommonspot.csPage.siteRoot = '/';\n\t\t\tcommonspot.csPage.subsiteRoot = '/';\n\t\t\tcommonspot.csPage.mode = jsPageSessionContributeMode;\n\t\t\tcommonspot.csPage.authorok = 0;\n\t\t\tcommonspot.csPage.approvalstatus = 0;\n\t\t\tcommonspot.csPage.showContainerUI = 0;\n\t\t\tcommonspot.csPage.requestedVersionTimestamp = '';\n\t\t\tcommonspot.csPage.userRights = {};\n\t\t\tcommonspot.csPage.userRights.isLoggedIn = 0;\n\t\t\tcommonspot.csPage.userRights.licensedContributor = 0;\n\t\t\tcommonspot.csPage.userRights.read = 1;\n\t\t\tcommonspot.csPage.userRights.author = 0;\n\t\t\tcommonspot.csPage.userRights.edit = 0;\n\t\t\tcommonspot.csPage.userRights.approve = 0;\n\t\t\tcommonspot.csPage.userRights.history = 0;\n\t\t\tcommonspot.csPage.userRights.design = 0;\n\t\t\tcommonspot.csPage.userRights.admin = 0;\n\t\t\tcommonspot.csPage.userRights.subsiteAdmin = 0;\n\t\t\tcommonspot.csPage.userRights.siteAdmin = 0;\n\t\t\tcommonspot.csPage.userRights.customerAdmin = 0;\n\t\t\tcommonspot.csPage.userRights.serverAdmin = 0;\n\n\t\t\tcommonspot.csPage.enabledMenuClasses = '';\n\t\t\t\n\t\t\tcommonspot.csPage.visibleMenuClasses = '';\n\n\t\t\t\n\t\t\tcommonspot.csPage.subsiteContext = {};\n\t\t\tcommonspot.csPage.subsiteContext.sitetype = 1;\n\t\t\tcommonspot.csPage.subsiteContext.siteid = 1;\n\t\t\tcommonspot.csPage.subsiteContext.subsiteid = 1;\n\t\t\tcommonspot.csPage.subsiteContext.siteurl = '/';\n\t\t\tcommonspot.csPage.subsiteContext.subsiteurl = '/';\n\t\t\tcommonspot.csPage.subsiteContext.sitename = 'ACC';\n\t\t\tcommonspot.csPage.subsiteContext.subsitename = '/';\n\t\t\tcommonspot.csPage.subsiteContext.menucontexttimestamp = '1492435778535';\n\t\t\tcommonspot.csPage.serveradminurl = \"/commonspot/admin/\";\n\t\t\tif (parent.commonspot)\n\t\t\t\tparent.commonspot.csPage = commonspot.csPage;\n\t\t\tvar doLviewRedirect;\n\t\t\tif(parent &&\n\t\t\t\t\t\tparent.commonspot &&\n\t\t\t\t\t\tparent.commonspot.lview &&\n\t\t\t\t\t\t!doLviewRedirect &&\n\t\t\t\t\t\tparent.commonspot.lightbox &&\n\t\t\t\t\t\tparent.commonspot.lightbox.stack.length == 0)\n\t\t\t{\n\t\t\t\n\t\t\t\tcommonspot.csPage.showPageSubmit = false;\n\t\t\t\n\t\t\t\tonPageArrival = function()\n\t\t\t\t{\n\t\t\t\t\tparent.commonspot.lview.currentPage.onPageArrival( commonspot.csPage );\n\t\t\t\t};\n\t\t\t\tonPageUnload = function()\n\t\t\t\t{\n\t\t\t\t\tparent.commonspot.lview.currentPage.onPageUnload();\n\t\t\t\t};\n\t\t\t\tparent.Spry.Utils.addEventListener(window, 'load', onPageArrival, false);\n\t\t\t\tparent.Spry.Utils.addEventListener(window, 'unload', onPageUnload, false);\n\t\t\t}\n\t\t\n\n\t\t// -->\n\t\t</script>\n<script type=\"text/javascript\">\n<!--\n\tif (typeof parent.commonspot == 'undefined' || typeof parent.commonspot.lview == 'undefined')\n\t\tloadNonDashboardFiles();\n\telse if (parent.commonspot && typeof newWindow == 'undefined')\n\t{\n\t\tvar arrFiles = \n\t\t\t\t[\n\t\t\t\t\t{fileName: '/commonspot/javascript/lightbox/overrides.js', fileType: 'script', fileID: 'cs_overrides'},\n\t\t\t\t\t{fileName: '/commonspot/javascript/lightbox/window_ref.js', fileType: 'script', fileID: 'cs_windowref'}\n\t\t\t\t];\n\t\t\n\t\tloadDashboardFiles(arrFiles);\n\t}\t\n//-->\n</script>\n\n<div id=\"ACC_MODAL_mask\"></div><ul class=\"ui-autocomplete ui-front ui-menu ui-widget ui-widget-content ui-corner-all\" id=\"ui-id-1\" tabindex=\"0\" style=\"display: none;\"></ul>\n<script type=\"text/javascript\" id=\"\">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version=\"2.0\",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,\"script\",\"https://connect.facebook.net/en_US/fbevents.js\");fbq(\"init\",\"1403102386366748\");fbq(\"track\",\"PageView\");</script>\n<noscript>&lt;img height=\"1\" width=\"1\" style=\"display:none\" src=\"https://www.facebook.com/tr?id=1403102386366748&amp;amp;ev=PageView&amp;amp;noscript=1\"&gt;</noscript>\n\n</body>"}
