{"link":"amc.edu","html":"<!-- Content Copyright Albany Medical Center --><!-- Page generated 2017-04-22 22:17:41 on server 4 by CommonSpot Build 9.0.3.119 (2015-08-14 15:00:01) --><!-- JavaScript & DHTML Code Copyright &copy; 1998-2015, PaperThin, Inc. All Rights Reserved. --><head> <title>Albany Medical Center</title>\n<meta name=\"Description\" id=\"Description\" content=\"Albany Medical Center\">\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n<meta name=\"Keywords\" id=\"Keywords\" content=\"\">\n<meta name=\"Generator\" id=\"Generator\" content=\"CommonSpot Build 9.0.3.119\">\n<link rel=\"stylesheet\" href=\"/_thirdParty/bootstrap/css/bootstrap.min.css\" type=\"text/css\">\n<link rel=\"stylesheet\" href=\"/style/amc2012.css\" type=\"text/css\">\n<link rel=\"stylesheet\" href=\"/style/AlbanyMedSectionMain.css\" type=\"text/css\">\n<link rel=\"stylesheet\" href=\"/ADF/apps/pt_calendar/style/calendar.css\" type=\"text/css\">\n<style type=\"text/css\">\n.mw { color:#000000;font-family:Verdana,Arial,Helvetica;font-weight:bold;font-size:xx-small;text-decoration:none; }\na.mw:link\t{color:#000000;font-family:Verdana,Arial,Helvetica;font-weight:bold;font-size:xx-small;text-decoration:none;}\na.mw:visited\t{color:#000000;font-family:Verdana,Arial,Helvetica;font-weight:bold;font-size:xx-small;text-decoration:none;}\na.mw:hover\t{color:#0000FF;font-family:Verdana,Arial,Helvetica;font-weight:bold;font-size:xx-small;text-decoration:none;}\n</style> <script type=\"text/javascript\" async=\"\" src=\"//www.googleadservices.com/pagead/conversion_async.js\"></script><script type=\"text/javascript\" async=\"\" src=\"//www.googleadservices.com/pagead/conversion_async.js\"></script><script type=\"text/javascript\" async=\"\" src=\"//www.googleadservices.com/pagead/conversion_async.js\"></script><script type=\"text/javascript\" async=\"\" src=\"https://www.google-analytics.com/analytics.js\"></script><script async=\"\" src=\"https://www.google-analytics.com/analytics.js\"></script><script async=\"\" src=\"https://www.googletagmanager.com/gtm.js?id=GTM-5TQTBQ\"></script><script type=\"text/javascript\">\n<!--\nvar gMenuControlID = 0;\nvar menus_included = 0;\nvar jsDlgLoader = '/loader.cfm';\nvar jsSiteID = 2;\nvar jsSubSiteID = 1;\nvar js_gvPageID = 131576;\nvar jsPageID = 131576;\nvar jsPageSetID = 0;\nvar jsPageType = 0;\nvar jsControlsWithRenderHandlers = \",4,23,23,23,23,31,51,51,51,51,51,51,51,55,55,55,55,55,55,55,1392,1521,1521,1521,1521,1521,1521,1796,2885,2987,3005,3033,3033,3033,3052,3052,3435,6861,6890,6890,15893,15893,15893,15893,15893,15927,27562,27577,27577,27577,27577,27577,27577,27577,96583,96583,97695,148941,833169,858842,\";\nvar jsDefaultRenderHandlerProps = \",,\";\nvar jsAuthorizedControls = \",1,2,3,4,6,7,8,9,10,11,16,18,20,21,22,23,25,26,27,28,29,30,31,36,37,38,39,40,41,42,43,45,46,47,50,51,52,53,55,1392,1397,1427,1472,1495,1512,1521,1535,1571,1585,1774,1796,2885,2987,3005,3033,3052,3435,6861,6890,6907,6925,6932,13089,15893,15927,27384,27435,27456,27464,27498,27542,27562,27577,27612,27660,96560,96583,97695,122023,122051,134419,134469,134564,134699,135024,135046,135052,135179,135227,135391,148941,149112,150151,150363,154488,155457,156316,156672,156675,156684,157008,159342,599162,605322,626206,817779,817860,818017,818190,818205,820660,820722,821152,821186,821206,821791,821961,823223,823244,823311,823318,823348,823387,823392,823397,823403,825165,825170,825282,825316,825390,827203,833165,833169,838386,843364,843425,858842,858863,\";\nvar jsCustomRenderHandlerPairs = \"\";\nvar jsStandardRenderHandlers = \"\";\nvar jsSiteSecurityCreateControls = 0;\nvar jsShowRejectForApprover = 0;\n// -->\n</script><script type=\"text/javascript\" src=\"/commonspot/javascript/browser-all.js\"></script>\n<!-- Google Tag Manager -->\n<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n})(window,document,'script','dataLayer','GTM-5TQTBQ');</script>\n<!-- End Google Tag Manager -->\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<script type=\"text/javascript\">\nif(typeof scriptsLoaded === 'undefined')\n{\nvar scriptsLoaded= new Array();\n}\n//Load jQuery only once.\nif(!(\"jQuery\" in scriptsLoaded))\n{\ndocument.write('<script type=\"text\\/javascript\" src=\"\\/ADF\\/thirdParty\\/jquery\\/jquery-1.11.js\"><\\/script>'+'<script type=\"text/javascript\"><\\/script>');\nscriptsLoaded[\"jQuery\"] = true;\n}\n</script><script type=\"text/javascript\" src=\"/ADF/thirdParty/jquery/jquery-1.11.js\"></script><script type=\"text/javascript\"></script> <script type=\"text/javascript\">\nif(typeof scriptsLoaded === 'undefined')\n{\nvar scriptsLoaded= new Array();\n}\n//Load jQueryMigrate only once.\nif(!(\"jQueryMigrate\" in scriptsLoaded))\n{\ndocument.write('<script src=\"\\/ADF\\/thirdParty\\/jquery\\/migrate\\/jquery-migrate-1.2.js\"><\\/script>'+'<script type=\"text/javascript\"><\\/script>');\nscriptsLoaded[\"jQueryMigrate\"] = true;\n}\n</script><script src=\"/ADF/thirdParty/jquery/migrate/jquery-migrate-1.2.js\"></script><script type=\"text/javascript\"></script> <script type=\"text/javascript\">\nif(typeof scriptsLoaded === 'undefined')\n{\nvar scriptsLoaded= new Array();\n}\n//Load jcycle only once.\nif(!(\"jcycle\" in scriptsLoaded))\n{\ndocument.write('<script type=\\'text\\/javascript\\' src=\\'\\/ADF\\/thirdParty\\/jquery\\/jcycle\\/jquery.cycle.all-2.9.js\\'><\\/script>'+'<script type=\"text/javascript\"><\\/script>');\nscriptsLoaded[\"jcycle\"] = true;\n}\n</script><script type=\"text/javascript\" src=\"/ADF/thirdParty/jquery/jcycle/jquery.cycle.all-2.9.js\"></script><script type=\"text/javascript\"></script>\n<script src=\"/ADF/thirdParty/jquery/migrate/jquery-migrate-1.2.js\"></script>\n<script type=\"text/javascript\" src=\"/ADF/thirdParty/jquery/easing/jquery.easing.1.3.js\"></script>\n<script type=\"text/javascript\" src=\"/modal/js/jquery.cookie.js\"></script>\n<script src=\"/_thirdParty/bootstrap/js/bootstrap.js\"></script>\n<script type=\"text/javascript\" src=\"/Style/scripts/scripts.js\"></script>\n<script>\n(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\nm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');\nga('create', 'UA-24787255-1', 'auto');\nga('send', 'pageview');\n</script>\n<link rel=\"stylesheet\" media=\"print\" href=\"/Style/printfriendly.css\">\n<link href=\"https://plus.google.com/107286224511318747101\" rel=\"publisher\">\n<link href=\"/modal/css/style.css?v=4\" rel=\"stylesheet\">\n<script type=\"text/javascript\">\nvar date = new Date();\nvar minutes = 20;\ndate.setTime(date.getTime() + (minutes * 60 * 1000));\n$(document).ready(function() {\n// Check the value of the cookie, if one is even set\nvar visited = $.cookie('generalSurveyDisplayed');\nif (visited == 'yes') {\n// Cookie existed, do not show survey\nreturn false;\n} else {\n// No cookie existed, show a survey after 15s\nloadSurvey();\n}\nfunction loadSurvey(){\nsetTimeout(function(){\nopenSurveyModal();\n$.cookie('generalSurveyDisplayed', 'yes', { expires: date, path: '/' });\n}, 15000);\n}\n$('#noReminder').click(function(){\n$.cookie('generalSurveyDisplayed', 'yes', { expires: 365, path: '/' });\n$( \"#survey1\" ).click();\n});\n$('#notNow').click(function(){\n$.cookie('generalSurveyDisplayed', 'yes', { expires: date, path: '/' });\n$( \"#survey1\" ).click();\n});\n$('#takeSurvey').click(function(){\n$.cookie('generalSurveyDisplayed', 'yes', { expires: 365, path: '/' });\n$( \"#survey1\" ).click();\nwindow.open('https://04daic7r.optimalworkshop.com/treejack/u04u0em6');\n});\n});\nfunction openSurveyModal () {\n$( \"#survey1\" ).click();\n}\n</script>\n<link rel=\"stylesheet\" href=\"/commonspot/commonspot.css\" type=\"text/css\" id=\"cs_maincss\"> <script id=\"cs_util_js\" type=\"text/javascript\" src=\"/commonspot/javascript/util.js\">/*\r\n * bring browser up to speed somewhat\r\n * NOTE: THESE PROTOTYPE METHODS ARE DUPLICATED IN util.js AND nondashboard-utils.js\r\n * \t\tKEEP THEM IDENTICAL\r\n */\r\nif(!String.prototype.trim)\r\n{\r\n\tString.prototype.trim = function()\r\n\t{\r\n\t\tvar start = -1;\r\n\t\tvar end = this.length;\r\n\t\twhile(this.charCodeAt(--end) < 33);\r\n\t\twhile(this.charCodeAt(++start) < 33);\r\n\t\treturn this.slice(start, end + 1);\r\n\t};\r\n}\r\nif(!String.prototype.toBoolean)\r\n{\r\n\tString.prototype.toBoolean = function()\r\n\t{\r\n\t\tswitch(this.valueOf())\r\n\t\t{\r\n\t\t\tcase \"1\":\r\n\t\t\t\treturn true;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"0\": case \"\": case \"no\": case \"false\":\r\n\t\t\tcase \"No\": case \"False\": case \"NO\": case \"FALSE\":\r\n\t\t\t\treturn false;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t};\r\n}\r\nif(!Array.prototype.indexOf)\r\n{\r\n\tArray.prototype.indexOf = function(value, fromIndex)\r\n\t{\r\n\t\tvar len = this.length;\r\n\t\tif(fromIndex == null)\r\n\t\t\tfromIndex = 0;\r\n\t\telse if(fromIndex < 0)\r\n\t\t\tfromIndex = Math.max(0, len + fromIndex);\r\n\t\tfor(var i = fromIndex; i < len; i++)\r\n\t\t{\r\n\t\t\tif(this[i] === value)\r\n\t\t\t\treturn i;\r\n\t\t}\r\n\t\treturn -1;\r\n\t};\r\n}\r\nvar EventCache=function() \r\n{\r\n\tvar listEvents=[];\r\n\treturn{\r\n\t\tlistEvents: listEvents,\r\n\t\tadd: function(node,sEventName,fHandler,bCapture)\r\n\t\t{\r\n\t\t\tlistEvents.push(arguments);\r\n\t\t},\r\n\t\t\r\n\t\tflush: function()\r\n\t\t{\r\n\t\t\tvar i, item;\r\n\t\t\tfor(i=listEvents.length-1;i>=0;i=i-1) \r\n\t\t\t{\t\r\n\t\t\t\titem=listEvents[i];\r\n\t\t\t\tif(!item) \r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tif(item[0].removeEventListener) \r\n\t\t\t\t\titem[0].removeEventListener(item[1],item[2],item[3]);\r\n\t\t\t\tvar logical_type='';\r\n\t\t\t\tif(item[1].substring(0,2)!=\"on\") \r\n\t\t\t\t{\r\n\t\t\t\t\tlogical_type=item[1];\r\n\t\t\t\t\titem[1]=\"on\"+item[1];\r\n\t\t\t\t}\r\n\t\t\t\telse \r\n\t\t\t\t\tlogical_type=item[1].substring(2,event_name_without_on.length);\r\n\t\t\t\tif(typeof item[0].__eventHandlers!='undefined'&&typeof item[0].__eventHandlers[logical_type]!='undefined') \r\n\t\t\t\t\titem[0].__eventHandlers[logical_type]=null;\r\n\t\t\t\tif(item[0].detachEvent) \r\n\t\t\t\t\titem[0].detachEvent(item[1],item[2]);\r\n\t\t\t\titem[0][item[1]]=null;\r\n\t\t\t};\r\n\t\t\tlistEvents=null;\r\n\t\t}\r\n\t}\r\n}();\r\n\r\nfunction flashMsg(msg, width)\r\n{\r\n\tvar FLASH_MSG_ID = 'cs_flashMsg'; // id of html object that shows the msg\r\n\tif(!width)\r\n\t\tvar width = 200;\r\n\tvar div = document.createElement('div');\r\n\tdiv.id = FLASH_MSG_ID;\r\n\tdiv.style.width = width + 'px';\r\n\tdiv.style.marginLeft = (-width / 2) + 'px'; // minus half the width, to center on pg\r\n\tdiv.className = 'cs_flashMsg';\r\n\tdiv.innerHTML = msg;\r\n\tdiv.onclick = close; // let user close it; probably not needed, but safe\r\n\tdocument.body.appendChild(div);\r\n\tsetTimeout(close, 2000); // kill msg after a while in case page isn't going to reload\r\n\t\r\n\tfunction close()\r\n\t{\r\n\t\tvar div = document.getElementById(FLASH_MSG_ID);\r\n\t\tif(div)\r\n\t\t\tdiv.parentNode.removeChild(div);\r\n\t}\r\n}\r\n\r\n/* start functions used by lightbox */\r\nfunction OnMouseDown(e)\r\n{\r\n\t// IE is retarded and doesn't pass the event object\r\n\tif (e == null) \r\n\t\te = window.event; \r\n   if(typeof e.stopPropagation!='undefined')\r\n      e.stopPropagation();\r\n   else\r\n      e.cancelBubble=true;\t\t\r\n\t// IE uses srcElement, others use target\r\n\tvar target = e.target != null ? e.target : e.srcElement;\r\n\tif (_debug)\r\n\t\t_debug.innerHTML = target.className == 'drag' \r\n\t\t? 'draggable element clicked' \r\n\t\t: 'NON-draggable element clicked';\r\n\ttarget = getDraggableTarget(target);\r\n\t// for IE, left click == 1\r\n\t// for Firefox, left click == 0\r\n\tif ((e.button == 1 && window.event != null || \r\n\t\te.button == 0) && target)\r\n\t{\r\n\t\t// grab the mouse position\r\n\t\t_startX = e.clientX;\r\n\t\t_startY = e.clientY;\r\n\t\t\r\n\t\t// grab the clicked element's position\r\n\t\t_offsetX = ExtractNumber(target.style.left);\r\n\t\t_offsetY = ExtractNumber(target.style.top);\r\n\t\t\r\n\t\t// bring the clicked element to the front while it is being dragged\r\n\t\t_oldZIndex = target.style.zIndex;\r\n\t\ttarget.style.zIndex = 10000;\r\n\t\t\r\n\t\t// we need to access the element in OnMouseMove\r\n\t\t_dragElement = target;\r\n\r\n\t\t// tell our code to start moving the element with the mouse\r\n\t\tdocument.onmousemove = OnMouseMove;\r\n\t\t\r\n\t\t// cancel out any text selections\r\n\t\tdocument.body.focus();\r\n\t\t\r\n\t\t// prevent text selection in IE\r\n\t\tdocument.onselectstart = function () { return false; };\r\n\t\t// prevent IE from trying to drag an image\r\n\t\ttarget.ondragstart = function() { return false; };\r\n\t\t\r\n\t\t// prevent text selection (except IE)\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nfunction OnMouseUp(e)\r\n{\r\n\tif (_dragElement != null)\r\n\t{\r\n\t\t_dragElement.style.zIndex = _oldZIndex;\r\n\r\n\t\t// we're done with these events until the next OnMouseDown\r\n\t\tdocument.onmousemove = null;\r\n\t\tdocument.onselectstart = null;\r\n\t\t_dragElement.ondragstart = null;\r\n\r\n\t\t// this is how we know we're not dragging\r\n\t\t_dragElement = null;\r\n\t\tif (_debug)\r\n\t\t\t_debug.innerHTML = 'mouse up';\r\n\t}\r\n}\r\n\r\nfunction OnMouseMove(e)\r\n{\r\n\tif (e == null) \r\n\t\tvar e = window.event; \r\n   if(typeof e.stopPropagation!='undefined')\r\n      e.stopPropagation();\r\n   else\r\n      e.cancelBubble=true;\t\t\t\t\r\n\r\n\t// this is the actual \"drag code\"\r\n\t_dragElement.style.left = (_offsetX + e.clientX - _startX) + 'px';\r\n\t_dragElement.style.top = (_offsetY + e.clientY - _startY) + 'px';\r\n\tif (_debug)\r\n\t\t_debug.innerHTML = '(' + _dragElement.style.left + ', ' + _dragElement.style.top + ')';\t\r\n}\r\n\r\nfunction ExtractNumber(value)\r\n{\r\n\tvar n = parseInt(value);\r\n\t\r\n\treturn n == null || isNaN(n) ? 0 : n;\r\n}\r\n\r\nfunction getDraggableTarget(obj)\r\n{\r\n\tif (obj.className.indexOf('drag') >= 0)\r\n\t\treturn obj;\r\n\tif (obj.offsetParent)\r\n\t{\t\r\n\t\twhile(obj=obj.offsetParent)\r\n\t\t{\r\n\t\t\tif (obj.className.indexOf('drag') >= 0)\r\n\t\t\t\treturn obj;\t\t\t\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n}\r\n/* END functions used by lightbox */\r\n\r\n// this function is duplicated in browser-all.js and util.js; if you change one, change the other!\r\nfunction BrowserCheck()\r\n{\r\n\tvar b = navigator.appName.toString();\r\n\tvar b_ver;\r\n\tvar up = navigator.platform.toString();\r\n\tvar ua = navigator.userAgent.toString().toLowerCase();\r\n\tvar re_opera = /Opera.([0-9\\.]*)/i;\r\n\tvar re_msie = /MSIE.([0-9\\.]*)/i;\r\n\tvar re_gecko = /gecko/i;\r\n\t// IE11 user-agent string ------ mozilla/5.0 (windows nt 6.1; wow64; trident/7.0; slcc2; .net clr 2.0.50727; rv:11.0) like gecko\r\n\tvar re_msie_11 = /rv:([0-9\\.]*)/i;\r\n\t// mozilla/5.0 (macintosh; u; intel mac os x 10_6_7; en-us) applewebkit/533.20.25 (khtml, like gecko) version/5.0.4 safari/533.20.27\r\n\tvar re_safari = /safari\\/([\\d\\.]*)/i;\r\n\tvar re_mozilla = /firefox\\/([\\d\\.]*)/i;\r\n\tvar re_chrome = /chrome\\/([\\d\\.]*)/i;\r\n\tvar ie_documentMode = 0;\r\n\tvar browserType = {};\r\n\tvar ie11 = !!ua.match(/trident.*rv[ :]*11\\./);\r\n\tbrowserType.mozilla = browserType.ie = browserType.opera = r = false;\r\n\tbrowserType.version = (ua.match(/.+(?:rv|it|ra|ie|me)[\\/: ]([\\d.]+)/) || [])[1];\r\n\tbrowserType.chrome = /chrome/.test(ua);\r\n\tbrowserType.safari = /webkit/.test(ua) && !/chrome/.test(ua);\r\n\tbrowserType.opera = /opera/.test(ua);\r\n\tbrowserType.ie = /msie/.test(ua) && !/opera/.test(ua);\r\n\tbrowserType.mozilla = /mozilla/.test(ua) && !/(compatible|webkit)/.test(ua) && !/trident/.test(ua);\r\n\tbrowserType.ie_documentMode = 0;\r\n\tif (ua.match(re_opera))\r\n\t{\r\n\t    r = ua.match(re_opera);\r\n\t    browserType.version = parseFloat(r[1]);\r\n\t}\r\n\telse if (ua.match(re_msie))\r\n\t{\r\n\t    r = ua.match(re_msie);\r\n\t    browserType.version = parseFloat(r[1]);\r\n\t    ie_documentMode = browserType.version;\r\n\t    if (browserType.version <= 7)\r\n\t    {\r\n\t        re_ver = /trident\\/([\\d\\.]*)/i;\r\n\t        r = ua.match(re_ver);\r\n\t        // in IE compat mode, trident=4.0 (IE8), =5.0 (IE9), =6.0 (IE10) etc, i.e, version=trident+4.\r\n\t        if (r && parseFloat(r[1]) >= 4)\r\n\t        {\r\n\t            browserType.version = parseFloat(r[1]) + 4;\r\n\t            ie_documentMode = document.documentMode;\r\n\t        }\r\n\t    }\r\n\t}\r\n\telse if ((ua.match(re_msie_11) && /trident/.test(ua)) || ie11) // IE browser, version higher than 10\r\n\t{\r\n\t\tr = ua.match(re_msie_11);\r\n\t\tbrowserType.ie = true;\r\n\t\tbrowserType.mozilla = false;\r\n\t\tbrowserType.version = parseFloat(r[1]);\r\n\t\tie_documentMode = browserType.version;\r\n\t\tre_ver = /trident\\/([\\d\\.]*)/i;\r\n\t\tr = ua.match(re_ver);\r\n\t\t// in IE compat mode, trident=4.0 (IE8), =5.0 (IE9), =6.0 (IE10) etc, i.e, version=trident+4.\r\n\t\tif (r && parseFloat(r[1]) >= 4)\r\n\t\t{\r\n\t\t    browserType.version = parseFloat(r[1]) + 4;\r\n\t\t    ie_documentMode = document.documentMode;\r\n\t\t}\r\n\t}\r\n\telse if (browserType.safari && !browserType.chrome)\r\n\t{\r\n\t    re_ver = /version\\/([\\d\\.]*)/i;\r\n\t    if (ua.match(re_ver))\r\n\t    {\r\n\t        r = ua.match(re_ver);\r\n\t        browserType.version = parseFloat(r[1]);\r\n\t    }\r\n\t}\r\n\telse if (browserType.chrome)\r\n\t{\r\n\t    b_ver = ua.match(re_chrome);\r\n\t    r = b_ver[1].split('.');\r\n\t    browserType.version = parseFloat(r[0]);\r\n\t}\r\n\telse if (ua.match(re_gecko))\r\n\t{\r\n\t    var re_gecko_version = /rv:\\s*([0-9\\.]+)/i;\r\n\t    r = ua.match(re_gecko_version);\r\n\t    browserType.version = parseFloat(r[1]);\r\n\t    if (ua.match(re_mozilla))\r\n\t    {\r\n\t        r = ua.match(re_mozilla);\r\n\t        browserType.version = parseFloat(r[1]);\r\n\t    }\r\n\t}\r\n\telse if (ua.match(re_mozilla))\r\n\t{\r\n\t    r = ua.match(re_mozilla);\r\n\t    browserType.version = parseFloat(r[1]);\r\n\t}\r\n\tbrowserType.windows = browserType.mac = browserType.linux = false;\r\n\tbrowserType.Platform = ua.match(/windows/i) ? \"windows\" : (ua.match(/linux/i) ? \"linux\" : (ua.match(/mac/i) ? \"mac\" : ua.match(/unix/i) ? \"unix\" : \"unknown\"));\r\n\tthis[browserType.Platform] = true;\r\n\tbrowserType.v = browserType.version;\r\n\tbrowserType.valid = browserType.ie && browserType.v >= 6 || browserType.mozilla && browserType.v >= 1.4 || browserType.safari && browserType.v >= 5 || browserType.chrome && browserType.v >= 12;\r\n\tbrowserType.okToAuthor = (browserType.ie && browserType.v >= 8 && ie_documentMode >= 7) || browserType.mozilla && browserType.v >= 3.6 || browserType.safari && browserType.v >= 5 || browserType.chrome && browserType.v >= 12;\r\n\tbrowserType.ie_documentMode = ie_documentMode;\r\n\tif (browserType.safari && browserType.mac && browserType.mozilla) \r\n\t\tbrowserType.mozilla=false;\t\r\n\treturn browserType;\r\n};\r\n\r\nfunction removeDuplicateParams(qParams)\r\n{\r\n\tvar nParams = '';\r\n\tvar qParams = qParams.replace('&amp;', '&');\r\n\tvar fLtr = qParams.substr(0,1);\r\n\tif (fLtr == '&')\r\n\t\tnParams = fLtr;\r\n\telse if (fLtr == '?')\r\n\t{\r\n\t\tnParams = fLtr;\r\n\t\tqParams = qParams.replace('?', '');\r\n\t}\t\r\n\tvar qArr = qParams.split('&');\r\n\tvar cArr = '';\r\n\tfor (var i=0; i<qArr.length; i++)\r\n\t{\r\n\t\tcArr = qArr[i].split('=');\r\n\t\tif (cArr[0] == '')\r\n\t\t\tcontinue;\r\n\t\tif (nParams.toLowerCase().indexOf(cArr[0].toLowerCase()) == -1)\r\n\t\t{\r\n\t\t\tif (cArr.length == 2)\r\n\t\t\t\tnParams = nParams + cArr[0] + '=' + cArr[1] + '&';\r\n\t\t\telse if (cArr.length == 1)\r\n\t\t\t\tnParams = nParams + cArr[0] + '=&';\t\r\n\t\t}\t\r\n\t\telse\r\n\t\t\talert('Multiple instances of ' + cArr[0] + ' argument found in the URL query parameter.');\r\n\t}\r\n\treturn nParams;\r\n}\r\n// make sure we have our namespace\r\n// must be called AFTER code to relocate if not in dashboard, if that's used\r\nvar commonspot = window.commonspot || parent.commonspot || {};\r\n\r\n/**\r\n * commonspot.util: utility package\r\n */\r\nif(typeof commonspot.util == 'undefined')\r\n{\r\n\tcommonspot.util = {};\r\n\t\r\n\tcommonspot.util.browser = BrowserCheck();\t\r\n\tcommonspot.util.removeDuplicateParams = removeDuplicateParams;\r\n\tcommonspot.util.checkDashboard = function()\r\n\t{\r\n\t\treturn (typeof(commonspot.lview) != 'undefined');\r\n\t}\r\n\t\r\n\t/**\r\n\t * Encode string properly for html charactor\r\n\t * @return string\r\n\t */\r\n\tcommonspot.util.encodeString = function(str)\r\n\t{\t\r\n\t\tvar regExp = /&amp;#39;|&amp;amp;|&amp;nbsp;|&lt;br \\/&gt;&lt;br \\/&gt;/;\r\n\t\t  \t\r\n\t\tif (str && str.search(regExp) != -1)\t\t\r\n\t\t{ \r\n\t\t\tstr = str.replace(/&amp;amp;/, '&amp;');\r\n\t\t\tstr = str.replace(/&amp;#39;/, '&#39;');  \r\n\t\t\tstr = str.replace(/&amp;nbsp;/, '&nbsp;'); \r\n\t\t\tstr = str.replace(/&lt;br \\/&gt;&lt;br \\/&gt;/, ' '); \t\t\r\n\t\t}  \t\r\n\t\t\t \r\n\t\treturn str;\r\n\t};\r\n\t\t\r\n\t/**\r\n\t * Escape special XML characters with the equivalent entities\r\n\t * @return string\r\n\t */\r\n\tcommonspot.util.encodeXmlEntities = function(str)\r\n\t{\r\n\t\tif(str && str.search(/[&<>\"]/) != -1)\r\n\t\t{\r\n\t\t\tstr = str.replace(/&/g, '&amp;');\r\n\t\t\tstr = str.replace(/</g, '&lt;');\r\n\t\t\tstr = str.replace(/>/g, '&gt;');\r\n\t\t\tstr = str.replace(/\"/g, '&quot;');\r\n\t\t}\r\n\t\t// dmerrill 3/12/09: don't know why we do this, not xml spec\r\n\t\treturn encodeURIComponent(str);\r\n\t};\r\n\t\t\r\n\t/**\r\n\t * format a std commonspot date (yyyy-mm-dd hh:mm:ss) for display as a date only\r\n\t * default format is yyyy-mm-dd\r\n\t * if USFormat is true, returns it as mm/dd/yyyy\r\n\t */\r\n\tcommonspot.util.formatCSDate = function(csDateStr, USFormat)\r\n\t{\r\n\t   if(!csDateStr)\r\n\t      return;\r\n\t\tif(USFormat)\r\n\t\t{\r\n\t\t\tvar aDateParts = csDateStr.split(/[- :]/);\r\n\t\t\tif(aDateParts.length < 3)\r\n\t\t\t\tthrow(\"[formatCSDate(USFormat)] invalid date: \" + csDateStr);\r\n\t\t\treturn aDateParts[1] + \"/\" + aDateParts[2] + \"/\" + aDateParts[0];\r\n\t\t}\r\n\t\treturn csDateStr.substr(0, 10);\r\n\t};\r\n\t\r\n\t/**\r\n\t * for ea passed field in passed object, creates a new field w orig fld value converted to std date format\r\n\t * @param row (object): object to process\r\n\t * \t\tit's assumed to contain each of the fields in dateFieldsList, ea w date data\r\n\t * @param dateFieldsList (string): comma-delimited list of fields to process\r\n\t * @param fieldNameSuffix (string): appended to end of processed fld name to create name of formated fld\r\n\t * \tif not passed, '_display' is used\r\n\t * \tto overwrite orig fld w formatted version, pass ''\r\n\t */\r\n\tcommonspot.util.formatCSDateFields = function(obj, dateFieldsList, fieldNameSuffix)\r\n\t{\r\n\t\tif(!fieldNameSuffix)\r\n\t\t\tfieldNameSuffix = '_display';\r\n\t\tvar aDateFlds = dateFieldsList.split(',');\r\n\t\tfor(var i = 0; i < aDateFlds.length; i++)\r\n\t\t\tobj[aDateFlds[i] + fieldNameSuffix] = commonspot.util.formatCSDate(obj[aDateFlds[i]]);\r\n\t};\r\n\t\r\n\t\r\n\t/*\r\n\t * @return object: returns an object with values from url hash, interpreted as query string format\r\n\t */\r\n\tcommonspot.util.getHashArgs = function()\r\n\t{\r\n\t\tvar argStr = document.location.hash.replace(/^#+/, ''); // strip all leading #\r\n\t\tif (!argStr.toQueryParams)\r\n\t\t\treturn null;\r\n\t\tvar qstring = window.location.search;\r\n\t\tvar qmPos = argStr.indexOf('?');\r\n\t\tvar args;\r\n\t\tif (qmPos >= 0)\r\n\t\t{\r\n\t\t\tqstring = argStr.substr(qmPos);\r\n\t\t\targStr = argStr.substr(0, qmPos);\r\n\t\t\targs = argStr.toQueryParams();\r\n\t\t}\r\n\t\telse\r\n\t\t\targs = argStr.toQueryParams();\r\n\t\targs.qstring = qstring;\r\n\t\tif (args.mode)\r\n\t\t\targs.mode = args.mode.toLowerCase();\r\n\t\treturn args;\r\n\t};\r\n\t\r\n\tcommonspot.util.getObjFieldLCase = function(obj, name)\r\n\t{\r\n\t\tif (name)\r\n\t\t\treturn obj[name.toLowerCase()];\r\n\t\telse\r\n\t\t\treturn null;\r\n\t};\r\n\r\n\t// return true if any item in permissionNeededList is in permissionList\r\n\tcommonspot.util.hasAnyPermission = function(permissionNeededList, permissionList)\r\n\t{\r\n\t\tif( (!permissionNeededList) || (!permissionList) )\r\n\t\t\treturn false;\t\t\t\r\n\t\t\t\r\n\t\taPermsNeeded = permissionNeededList.toLowerCase().split(',');\r\n\t\taPermsYouHave = permissionList.toLowerCase().split(',');\r\n\t\t\r\n\t\tfor(var i = 0; i < aPermsNeeded.length; i++)\r\n\t\t{\r\n\t\t\tif(aPermsYouHave.indexOf(aPermsNeeded[i]) != -1) \r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\t\t\r\n\t\r\n\t/*\r\n\t * returns true if passed array or object has members\r\n\t */\r\n\tcommonspot.util.hasMembers = function(obj)\r\n\t{\r\n\t\tfor(var f in obj)\r\n\t\t{\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\tif(obj.hasOwnProperty(f))\r\n\t\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tcatch(e)\r\n\t\t\t{\r\n\t\t\t\treturn false;\t\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Return boolean (true/false) as per the permission.\r\n\t */\t\r\n\tcommonspot.util.hasPermission = function(permission, permissionList)\r\n\t{\r\n\t\tif( ! permissionList )\r\n\t\t\treturn false;\t\t\t\r\n\t\t\t\r\n\t\tpermissionList = ',' + permissionList.toLowerCase() + ',';\r\n\t\treturn (permissionList.indexOf(',' + permission.toLowerCase() + ',') != -1)\r\n\t};\r\n\r\n\t/*\r\n\t * adds members of src to dest, returning dest\r\n\t * overwrites existing members if overwrite is true\r\n\t * ignores prototype members of either src or dest\r\n\t * \tmeans it won't copy from src prototype, and it will overwrite dest prototype members\r\n\t */\r\n\tcommonspot.util.merge = function(dest, src, overwrite, lcaseDestField)\r\n\t{\r\n\t\tvar destFld;\r\n\t\tfor(var fld in src)\r\n\t\t{\r\n\t\t\tdestFld = lcaseDestField ? fld.toLowerCase() : fld;\r\n\t\t   if(src.hasOwnProperty(fld) && (overwrite || (!dest.hasOwnProperty(destFld)) || dest[destFld] === null))\r\n\t\t      dest[destFld] = src[fld];\r\n\t\t}\r\n\t\treturn dest;\r\n\t};\r\n\t\r\n\t/*\r\n\t * pads passed value to a minimum of len chars; no effect if it's already that long or more\r\n\t */\r\n\tcommonspot.util.pad = function (val, len)\r\n\t{\r\n\t\tval = String(val);\r\n\t\tlen = len || 2;\r\n\t\twhile (val.length < len) val = \"0\" + val;\r\n\t\treturn val;\r\n\t};\r\n\t\t\r\n\t/**\r\n\t * commonspot.util.plural\r\n\t * returns a string with passed count, a space, and count-appropriate form of noun\r\n\t * @see \\cs\\devdocs\\javascript-function-docs.js\r\n\t */\r\n\tcommonspot.util.plural = function(count, noun, specialPlural, specialZero)\r\n\t{\r\n\t\tswitch(count)\r\n\t\t{\r\n\t\t\tcase 0:\r\n\t\t\t\treturn count + \" \" + (specialZero || specialPlural || (noun + \"s\"));\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1:\r\n\t\t\t\treturn count + \" \" + noun;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\treturn count + \" \" + (specialPlural || (noun + \"s\"));\r\n\t\t}\r\n\t};\r\n\t\t\r\n\tcommonspot.util.setOptions = function(dest, src)\r\n\t{\r\n\t\tfor(var fld in src)\r\n\t\t\tdest[fld] = src[fld];\r\n\t};\r\n\t\t\t\t\t\t\t\r\n\t\r\n\t/*\r\n\t * converts a date, or a string parsable as one, to commonspot's std yyyy-mm-dd hh:mm:ss format\r\n\t * rtns commonspot.err.INVALID_DATE_TOKEN if not a valid date\r\n\t */\r\n\tcommonspot.util.toCSDateFormat = function(date)\r\n\t{\r\n\t\tdate = new Date(date); // applies Date.parse if necessary\r\n\t\tif(isNaN(date))\r\n\t\t\treturn commonspot.err.INVALID_DATE_TOKEN;\r\n\t\treturn\tdate.getFullYear() + \"-\" +\r\n\t\t\t\t\tcommonspot.util.pad((date.getMonth() + 1)) + \"-\" +\r\n\t\t\t\t\tcommonspot.util.pad(date.getDay()) + \" \" +\r\n\t\t\t\t\tcommonspot.util.pad(date.getHours()) + \":\" +\r\n\t\t\t\t\tcommonspot.util.pad(date.getMinutes()) + \":\" +\r\n\t\t\t\t\tcommonspot.util.pad(date.getSeconds());\r\n\t};\r\n\r\n\t/**\r\n\t * Return true if a given object is an array\r\n\t * @return boolean\r\n\t * technique used in the next few functions is known as the Miller Device; see here:\r\n\t * \thttp://blog.360.yahoo.com/blog-TBPekxc1dLNy5DOloPfzVvFIVOWMB0li?p=916\r\n\t * obj.constructor === Array and similar fails in multi-window/multi-frame environment\r\n\t */\r\n\tcommonspot.util.isArray = function(obj)\r\n\t{\r\n\t\treturn obj && Object.prototype.toString.apply(obj) === \"[object Array]\";\r\n\t};\r\n\tcommonspot.util.isDate = function(obj)\r\n\t{\r\n\t\treturn obj && (Object.prototype.toString.apply(obj) === \"[object Date]\");\r\n\t}\r\n\tcommonspot.util.isValidDate = function(obj)\r\n\t{\r\n\t\treturn obj && commonspot.util.isDate(obj) && !(isNaN(obj));\r\n\t}\r\n\tcommonspot.util.getObjectClass = function(obj)\r\n\t{\r\n\t\tvar classStr = Object.prototype.toString.apply(obj); // \"[object Array]\", \"[object String]\", etc\r\n\t\treturn classStr.substring(8, classStr.length - 1); // \"Array\", \"String\", etc\r\n\t};\r\n\t\r\n\tcommonspot.util.arrayTest = function(_this, item, from)\r\n\t{\r\n\t   //return cs_utility.array.arrayIndexOf(_this,item,from)!=-1;\r\n\t   return _this.indexOf(item, from)!=-1;\r\n\t};\r\n\t\r\n\t/**\r\n\t * given an array of objects and the name of a keyFld, returns an object...\r\n\t * ...whose keys are the values in keyFld and whose values are the corresponding objects\r\n\t * @param objArr (array): array of objects to examine\r\n\t * @param keyFld (string): name of fld to look for in each object; values become keys in result object\r\n\t */\r\n\tcommonspot.util.objectArrayToObject = function(objArr, keyFld)\r\n\t{\r\n\t\tvar i, keyValue;\r\n\t\tvar obj = {};\r\n\t\tfor(var i = 0; i < objArr.length; i++)\r\n\t\t{\r\n\t\t\tkeyValue = objArr[i][keyFld];\r\n\t\t\tif(typeof keyValue != 'undefined')\r\n\t\t\t\tobj[keyValue] = objArr[i];\r\n\t\t}\r\n\t\treturn obj;\r\n\t};\r\n\t\r\n\t/**\r\n\t * returns a new object that's a by-value copy of passed one\r\n\t * USAGE: foo = new commonspot.util.cloneObject(someObject);\r\n\t */\r\n\tcommonspot.util.cloneObject = function (obj)\r\n\t{\r\n\t\tfor (i in obj)\r\n\t\t\tthis[i] = obj[i];\r\n\t};\r\n\t\r\n\t/**\r\n\t * Return a random integrer\r\n\t * @return integer\r\n\t */\r\n\tcommonspot.util.generateRandomInt = function()\r\n\t{\r\n\t\treturn Math.floor(Math.random() * 100000);\r\n\t};\r\n\r\n\tcommonspot.util.getFileSizeHtml = function(fileSize, precision)\r\n\t{\r\n\t\tprecision = (typeof precision === 'undefined') ? 0 : precision;\r\n\t\tvar pos = 0;\r\n\t\tif (fileSize == 0)\r\n\t\t\treturn '';\r\n\t\twhile ( fileSize >= 1024 )\r\n\t\t{\r\n\t\t\tpos++;\r\n\t\t\tfileSize = fileSize / 1024;\r\n\t\t}\r\n\t\treturn fileSize.toFixed(precision) + ' ' + commonspot.util.getFileSizeHtml.sizes[pos];\r\n\t};\r\n\tcommonspot.util.getFileSizeHtml.sizes = ['bytes', 'KB', 'MB', 'GB', 'TB'];\r\n\t\r\n\tcommonspot.util.calcPreviewImgProp = function(origWidth, origHeight, maxWidth, maxHeight)\r\n\t{\r\n\t\tvar isScaled = false;\r\n\t\tvar newW = origWidth;\r\n\t\tvar newH = origHeight;\r\n\t\t\t\t\r\n\t\tif ((origWidth >= maxWidth) || (origHeight >= maxHeight))\r\n\t\t{\r\n\t\t\tvar ratioW = maxWidth / origWidth;\r\n\t\t\tvar ratioH = maxHeight / origHeight;\r\n\t\t\tvar ratio = Math.min(ratioW,ratioH);\r\n\t\r\n\t\t\tnewW = Math.max(Math.round(origWidth * ratio), 1);\t\t \r\n\t\t\tnewH = Math.max(Math.round(origHeight * ratio), 1);\t\t\t\t\r\n\t\r\n\t\t\tisScaled = true;\r\n\t\t}\t\t\r\n\t\r\n\t\tvar imgProp = {width: newW,\r\n\t\t\t\t\t\t\theight: newH,\r\n\t\t\t\t\t\t\tisScaled: isScaled}\r\n\t\t\t\t\t\t\t\t\r\n\t\treturn imgProp;\r\n\t};\r\n\t\r\n\t/*\r\n\t * rtns html dump of passed obj\r\n\t */\r\n\tcommonspot.util.getDumpHTML = function(obj, caption)\r\n\t{\r\n\t\tvar html = \"\";\r\n\t\tif(obj == undefined)\r\n\t\t\thtml = \"Object is undefined.\"\r\n\t\telse if(obj == null)\r\n\t\t\thtml = \"Object is null.\"\r\n\t\telse if(typeof obj == \"function\")\r\n\t\t\thtml = \"[function]\";\r\n\t\telse if(typeof obj !== \"object\" || commonspot.util.isDate(obj))\r\n\t\t\thtml = obj.toString().escapeHTML();\r\n\t\telse if(commonspot.util.isArray(obj))\r\n\t\t{\r\n\t\t\tvar getDumpHTML = commonspot.util.getDumpHTML;\r\n\t\t\tvar len = obj.length;\r\n\t\t\thtml = '<table class=\"dumpTable\">';\r\n\t\t\tif(caption)\r\n\t\t\t\thtml += \"<caption>\" + caption +\"</caption>\";\r\n\t\t\tfor(var i = 0; i < len; i++)\r\n\t\t\t\thtml += \"<tr><td>\" + i + \"</td><td>\" + getDumpHTML(obj[i]) + \"</td></tr>\";\r\n\t\t\thtml += \"</table>\";\r\n\t\t}\r\n\t\telse // object\r\n\t\t{\r\n\t\t\tvar getDumpHTML = commonspot.util.getDumpHTML;\r\n\t\t\thtml = '<table class=\"dumpTable\">';\r\n\t\t\tif(caption)\r\n\t\t\t\thtml += \"<caption>\" + caption +\"</caption>\";\r\n\t\t\tfor(var key in obj)\r\n\t\t\t\thtml += \"<tr><td>\" + key + \"</td><td>\" + getDumpHTML(obj[key]) + \"</td></tr>\";\r\n\t\t\thtml += \"</table>\";\r\n\t\t}\r\n\t\treturn html;\r\n\t};\r\n\t\r\n\tcommonspot.util.repeatString = function(str, count)\r\n\t{\r\n\t\tvar t = \"\";\r\n\t\tfor(var i = 1; i <= count; i++)\r\n\t\t\tt += str;\r\n\t\treturn t;\r\n\t};\r\n\t\r\n\tcommonspot.util.jsSafe = function(str) // escape same chars as cf's JSStringFormat function\r\n\t{\r\n\t\treturn str.replace(/(['\"\\\\\\b\\t\\n\\f\\r])/g, function(chr){return \"\\\\\" + commonspot.util.jsSafe.chars[chr.charCodeAt(0)];})\r\n\t};\r\n\tcommonspot.util.jsSafe.chars = \r\n\t{\r\n\t     8: \"b\",\t// backspace\r\n\t     9: \"t\",\t// tab\r\n\t    10: \"n\",\t// newline\r\n\t    12: \"f\",\t// formfeed\r\n\t    13: \"r\",\t// carriage return\r\n\t    34: '\"',\t// dbl quote\r\n\t    39: \"'\",\t// single quote\r\n\t    92: \"\\\\\"\t// backslash\r\n\t};\r\n\t\r\n\t// returns str with tokens in the form {key} replaced by the value of data[key]\r\n\t// if key isn't found in data, returns original token\r\n\t// key can contain only alphanumeric characters and underscores\r\n\tcommonspot.util.replaceTokens = function(str, data)\r\n\t{\r\n\t\treturn str.replace\r\n\t\t(\r\n\t\t\t/{(\\w+)}/g,\r\n\t\t\tfunction(fullMatch, key) // key is portion of match inside (), ie inside {} within str\r\n\t\t\t{\r\n\t\t\t\treturn (typeof data[key] === \"undefined\") ? fullMatch : data[key];\r\n\t\t\t}\r\n\t\t);\r\n\t};\r\n\t\r\n\t\r\n\tcommonspot.util.hasContributorUI = function()\r\n\t{\r\n\t\tif (typeof commonspot.clientUI != 'undefined' && \r\n\t\t\t\t\t\ttypeof commonspot.dialog != 'undefined'  && \r\n\t\t\t\t\t\ttypeof commonspot.dialog.server != 'undefined' && \r\n\t\t\t\t\t\ttypeof commonspot.admin != 'undefined')\r\n\t\t\treturn true;\r\n\t\telse\r\n\t\t\treturn false;\t\r\n\t};\r\n\t/**\r\n\t * commonspot.util.cookie: package for cookie-related utilities\r\n\t */\r\n\tcommonspot.util.cookie = {};\r\n\t\t\r\n\tcommonspot.util.cookie.createCookie = function(name,value,days,hours)\r\n\t{\r\n\t\tif (days)\r\n\t\t{\r\n\t\t\tvar date = new Date();\r\n\t\t\tdate.setTime(date.getTime() + (days*24*60*60*1000));\r\n\t\t\tvar expires = \"; expires=\" + date.toGMTString();\r\n\t\t}\r\n\t\telse if (hours)\r\n\t\t{\r\n\t\t\tvar date = new Date();\r\n\t\t\tdate.setHours(date.getHours() + hours);\r\n\t\t\tvar expires = \"; expires=\" + date.toGMTString();\t\t\r\n\t\t}\r\n\t\telse \r\n\t\t\tvar expires = \"\";\r\n\t\tdocument.cookie = name + \"=\" + value + expires + \"; path=/\";\t\t\t\r\n\t};\r\n\t\r\n\tcommonspot.util.cookie.readCookie = function(name)\r\n\t{\r\n\t\tvar nameEQ = name + \"=\";\r\n\t\tvar ca = document.cookie.split(';');\r\n\t\tfor (var i=0; i < ca.length; i++)\r\n\t\t{\r\n\t\t\tvar c = ca[i];\r\n\t\t\twhile (c.charAt(0) == ' ')\r\n\t\t\t{\r\n\t\t\t\tc = c.substring(1,c.length);\r\n\t\t\t}\r\n\t\t\tif (c.indexOf(nameEQ) == 0)\r\n\t\t\t{\r\n\t\t\t\treturn c.substring(nameEQ.length,c.length);\r\n\t\t\t}\t\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\t\r\n\tcommonspot.util.cookie.eraseCookie = function(name)\r\n\t{\r\n\t\tcommonspot.util.cookie.createCookie(name,\"\",-1);\r\n\t};\r\n\t\r\n\t/**\r\n\t * commonspot.util.dom: package for dom-related utilities\r\n\t */\r\n\tcommonspot.util.dom = {};\r\n\t\r\n\t/*\r\n\tencapsulation of dom createElement\r\n\tobjType, objID, objClass, objTitle, objHTML, objParent, objOnClick, objRefBefore, objRefAfter\r\n\t*/\t\r\n\tcommonspot.util.dom.addToDom = function(args)\r\n\t{\r\n\t\tvar dom = document.createElement(args.objType);\r\n\t\tif (args.objID)\r\n\t\t\tdom.id = args.objID;\r\n\t\tif (args.objTitle)\r\n\t\t\tdom.title = args.objTitle;\r\n\t\tif (args.objClass)\r\n\t\t\tdom.className = args.objClass;\r\n\t\tif (args.objHTML)\r\n\t\t\tdom.innerHTML = args.objHTML;\t\r\n\t\tif (args.objRefBefore)\r\n\t\t\targs.objParent.insertBefore(dom, args.objRefBefore);\r\n\t\telse if (args.objRefAfter){} // not implemented\r\n\t\telse\t\t\r\n\t\t\targs.objParent.appendChild(dom);\r\n\t\tif (args.objOnClick)\r\n\t\t\tcommonspot.util.event.addEvent(dom, \"click\", args.objOnClick);\r\n\t\treturn dom;\t\r\n\t}\r\n\t/**\r\n\t * commonspot.util.dom.getWinScrollSize: returns actual content size of given window; \r\n\t * @param win (object): window object. if not supplied returns value for current window\r\n\t * @return {width, height}\r\n\t */\t\r\n\tcommonspot.util.dom.getWinScrollSize = function()\r\n\t{\r\n\t\tvar sWidth=0, sHeight=0;\r\n\t\tvar winSize = commonspot.util.dom.getWinSize();\r\n\t\tvar win = self;\r\n\t\tif (win.document.body.clientHeight)\r\n\t\t{\r\n\t\t\tsHeight = win.document.body.clientHeight;\r\n\t\t\tsWidth = win.document.body.clientWidth;\r\n\t\t}\t\r\n\t\telse if (win.document.height)\r\n\t\t{\r\n\t\t\tsHeight = win.document.height;\r\n\t\t\tsWidth = win.document.width;\r\n\t\t}\r\n\t\treturn {width: Math.max(sWidth,winSize.width), height: Math.max(sHeight,winSize.height)};\r\n\t};\r\n\t\r\n\t/**\r\n\t * commonspot.util.dom.getWinSize: returns inner size of current window; from PPK\r\n\t * @return {width, height}\r\n\t */\r\n\tcommonspot.util.dom.getWinSize = function()\r\n\t{\r\n\t\tvar width, height;\r\n\t\tif (self.innerHeight) // all except Explorer\r\n\t\t{\r\n\t\t\twidth = self.innerWidth;\r\n\t\t\theight = self.innerHeight;\r\n\t\t}\r\n\t\telse if (document.documentElement && document.documentElement.clientHeight) // Explorer 6 Strict Mode\r\n\t\t{\r\n\t\t\twidth = document.documentElement.clientWidth;\r\n\t\t\theight = document.documentElement.clientHeight;\r\n\t\t}\r\n\t\telse if (document.body) // other Explorers\r\n\t\t{\r\n\t\t\twidth = document.body.clientWidth;\r\n\t\t\theight = document.body.clientHeight;\r\n\t\t}\r\n\t\treturn {width: width, height: height};\r\n\t};\r\n\t\r\n\t/**\r\n\t * removes all child nodes from passed obj\r\n\t * needed because IE won't directly set innerHTML of some tags\r\n\t * \r\n\t * @param obj (object): object to remove all children from\r\n\t */\r\n\tcommonspot.util.dom.removeAllChildren = function(obj)\r\n\t{\r\n\t\twhile(obj.firstChild)\r\n\t\t\tobj.removeChild(obj.firstChild);\r\n\t};\r\n\t\r\n\t/**\r\n\t * finds tag w requested name further up in dom hierarchy from passed obj\r\n\t * \r\n\t * @param obj (dom node): object to find an ancestor of\r\n\t * @param tagName (string): tag name to find\r\n\t * \tnot case sensitive\r\n\t * \twon't find body or anything above there; those are singletons w simpler ways to find them\r\n\t * @param level (int, optional): if passed, return level'th matching ancestor, not just first one\r\n\t */\r\n\tcommonspot.util.dom.getAncestorTag = function(obj, tagName, level)\r\n\t{\r\n\t\tif(!obj || !obj.parentNode)\r\n\t\t\treturn null;\r\n\t\t\t\r\n\t\ttagName = tagName.toUpperCase();\r\n\t\tif(typeof level == 'undefined')\r\n\t\t\tlevel = 1;\r\n\t\t\r\n\t\tvar tag = obj.parentNode;\r\n\t\tvar curLevel = 0;\r\n\t\t\r\n\t\twhile((tag.nodeName != tagName || curLevel < level) && tag.parentNode && tag.parentNode.nodeName != 'BODY')\r\n\t\t{\r\n\t\t\ttag = tag.parentNode;\r\n\t\t\tif(tag.nodeName == tagName)\r\n\t\t\t\tcurLevel++;\r\n\t\t}\r\n\t\t\r\n\t\tif(tag.nodeName != tagName || curLevel < level)\r\n\t\t\ttag = null;\r\n\t\treturn tag;\r\n\t};\r\n\t\r\n\t/**\r\n\t * returns elements w passed className inside element w passed id.\r\n\t * homegrown because Prototype 1.5's getElementsBySelector seems broken in IE7.\r\n\t * @param id (string): id of element to look inside\r\n\t * @param className (string): className to look for\r\n\t * @param tagName (string, optional): if passed, looks only at tags w this name \r\n\t * @param getAll (boolean, optional): if true, return array of all found elements, otherwise, return first one\r\n\t */\r\n\tcommonspot.util.dom.getChildrenByClassName = function(id, className, tagName, getAll)\r\n\t{\r\n\t\tvar results = [];\r\n\t\tvar classMatchRegex = new RegExp(\"(^|\\\\s)\" + className + \"(\\\\s|$)\");\r\n\t\tvar tags = document.getElementById(id).getElementsByTagName(tagName || '*');\r\n\t\tfor(var i = 0; i < tags.length; i++)\r\n\t\t{\r\n\t\t\tif(tags[i].className == className || tags[i].className.match(classMatchRegex))\r\n\t\t\t{\r\n\t\t\t\tif(getAll)\r\n\t\t\t\t\tresults.push(tags[i]);\r\n\t\t\t\telse\r\n\t\t\t\t\treturn tags[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\t// if looking for single element and found none, rtn null; w/o this, rtns an empty array\r\n\t\t// when geAll=true we always rtn an array\r\n\t\t// when it's not, rtn a dom object, or something analogous to \"no dom object\", and tests false if you do if(domObj)\r\n\t\tif((!getAll) && (results.length === 0))\r\n\t\t\treturn null;\r\n\t\treturn results;\r\n\t};\r\n\t\r\n\t\r\n\tcommonspot.util.dom.getElementsByClassName = function(searchClass,node,tag) \r\n\t{\r\n\t\tif ( node == null )\r\n\t\t\tnode = document;\r\n\t\tif ( tag == null )\r\n\t\t\ttag = '*';\r\n\t\tvar classElements = new Array();\r\n\t\ttry\r\n\t\t{\r\n\t\t\tclassElements = node.getElementsByClassName(searchClass);\r\n\t\t}\r\n\t\tcatch (e)\r\n\t\t{\r\n\t\t\tvar els = node.getElementsByTagName(tag);\r\n\t\t\tvar elsLen = els.length;\r\n\t\t\tvar pattern = new RegExp(\"(^|\\\\s)\"+searchClass+\"(\\\\s|$)\");\r\n\t\t\tclassElements = new Array();\r\n\t\t\tfor (i = 0, j = 0; i < elsLen; i++) \r\n\t\t\t{\r\n\t\t\t\tif ( pattern.test(els[i].className) ) \r\n\t\t\t\t{\r\n\t\t\t\t        classElements[j] = els[i];\r\n\t\t\t\t        j++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn classElements;\r\n\t};\r\n\t\r\n\t/*\r\n\t* get all editable fields of the form\r\n\t*/\r\n\tcommonspot.util.dom.findAllFields = function(iform,includeHidden) {\t\r\n\t\tvar arr = [];\r\n\t\tvar elements = iform.elements;\t\r\n\t\tvar element;\r\n\t\tvar omitList = 'button,submit,reset';\r\n\t\tvar includeHidden = (typeof includeHidden != 'undefined') ? includeHidden : 1;\r\n\t\tif (includeHidden != 1)\r\n\t\t\tomitList += ',hidden';\r\n\t\tfor (var i=0; i<elements.length; i++)\r\n\t\t{\r\n\t\t\telement = elements[i];\r\n\t\t\t// get rid of bad apples first\r\n\t\t\tif((omitList).indexOf(element.type)>=0)\r\n\t\t\t\tcontinue;\r\n\t\t\tif (element.disabled || element.readOnly)\r\n\t\t\t\tcontinue;\r\n\t\t\tarr.push(element);\t\t\r\n\t\t}\r\n\r\n\t\treturn arr;\r\n\t};\r\n\r\n\t/*\r\n\t* activate all editable fields of the form\r\n\t*/\t\r\n\tcommonspot.util.dom.activateAllFields = function(iform) {\t\r\n\t\tvar elements = commonspot.util.dom.findAllFields(iform);\r\n\t\tvar curFld;\r\n\r\n\t\tfor (var i=0; i< elements.length; i++)\r\n\t\t{\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\tcurFld = eval(iform + '.' + elements[i]);\r\n\t\t\t\tif (curFld)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (curFld.activate)\r\n\t\t\t\t\t\tcurFld.activate();\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tcurFld.focus();\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcatch (ex) {}\t\r\n\t\t}\r\n\t};\r\n\t\r\n\t/*\r\n\t* Finds the first editable, non-disabled, non-hidden form field excluding buttons to set focus.\r\n\t* Takes a form as single argument. \r\n\t* This is an enhanced version of prototype's \"findFirstElement\" function\r\n\t*/\r\n\tcommonspot.util.dom.findFirstEditableField = function(iform) {\r\n\t\tvar firstByIndex = null;\r\n\r\n\t\tvar elements = commonspot.util.dom.findAllFields(iform);\r\n\t\ttry\r\n\t\t{\r\n\t\t\tif (elements.findAll)\r\n\t\t\t{\r\n\t\t\t\tfirstByIndex = elements.findAll(function(element) \r\n\t\t\t\t{\r\n\t\t\t\t  return element.hasAttribute('tabIndex') && element.tabIndex >= 0;\r\n\t\t\t\t}).sortBy(function(element) { return element.tabIndex }).first();\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch(e){}\r\n\t\treturn firstByIndex ? firstByIndex : arr[0];\r\n  \t};\r\n\t\t\r\n\t/**\r\n\t * commonspot.util.css: package for event-related utilities \r\n\t * we only need this addEvent function so adding it here instead of importing event package of prototype\r\n\t */\t\r\n\r\n\t\r\n\tcommonspot.util.event = {};\r\n\t\r\n\t/**\r\n\t*\tIrons out the IE and FF differences. Ideally we should use W3C model addEventListener,\r\n\t*\tie, when IE agrees with it\r\n\t*/\r\n\tcommonspot.util.event.addEvent = function( dObj, type, fn ) \r\n\t{\r\n\t\tif (dObj.addEventListener) \r\n\t\t{\r\n\t\t\tdObj.addEventListener( type, fn, false );\r\n\t\t\t//EventCache.add(dObj, type, fn, 1);\r\n\t\t}\r\n\t\telse if (dObj.attachEvent) \r\n\t\t{\r\n\t\t\tdObj[\"e\"+type+fn] = fn;\r\n\t\t\tdObj[type+fn] = function() \r\n\t\t\t{ \r\n\t\t\t\tdObj[\"e\"+type+fn]( window.event ); \r\n\t\t\t}\r\n\t\t\tdObj.attachEvent( \"on\"+type, dObj[type+fn] );\r\n\t\t\tEventCache.add(dObj, type, fn, 1);\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\tdObj[\"on\"+type] = dObj[\"e\"+type+fn];\r\n\t\t}\r\n\t};\r\n\t\r\n\t/**\r\n\t * commonspot.util.css: package for css-related utilities\r\n\t */\r\n\tcommonspot.util.css = {};\r\n\r\n\tcommonspot.util.css.addRemoveClassNameByIDs = function(objIDsList, className, add, contextWindow)\r\n\t{\r\n\t\tcontextWindow = contextWindow || top.commonspot.lightbox.getCurrentWindow();\r\n\t\tvar objIDs = objIDsList.split(\",\");\r\n\t\tvar objs = contextWindow.$.apply(contextWindow, objIDs);\r\n\t\tif(objs)\r\n\t\t{\r\n\t\t\tif(objs.nodeName) // single element\r\n\t\t\t\tobjs = [objs];\r\n\t\t\tobjs.each(function(elem, index)\r\n\t\t\t{\r\n\t\t\t\tif(!elem)\r\n\t\t\t\t\tthrow new Error(\"[addRemoveClassNameByIDs] Element with ID '\" + objIDs[index] + \"' can't be found.\");\r\n\t\t\t\telse if(add)\r\n\t\t\t\t\telem.addClassName(className);\r\n\t\t\t\telse\r\n\t\t\t\t\telem.removeClassName(className);\r\n\t\t\t});\r\n\t\t}\r\n\t\telse // oops, bad objIDsList\r\n\t\t\tthrow new Error(\"[addRemoveClassNameByIDs] Unable to find objects with the following IDs: \" + objIDsList);\r\n\t};\r\n\t\t\r\n\t\t\r\n\t/**\r\n\t * commonspot.util.css.showHideCSSClass: shows or hides a css class\r\n\t */\r\n\tcommonspot.util.css.showHideCSSClass = function(show, stylesheetID, targetClass)\r\n\t{\r\n\t\tvar display = show ? '' : 'none';\r\n\t\tcommonspot.util.css.setStyleRuleProperty(stylesheetID, targetClass, 'display', display);\r\n\t};\r\n\t\r\n\t/**\r\n\t*\r\n\t*/\r\n\tcommonspot.util.css.setHideForMenusForAllFrames = function(stylesheetID, targetClass, propertyName, value, win)\r\n\t{\r\n\t\tvar cWin;\r\n\t\tvar win = win ? win : window;\r\n\t\tvar arrayWindows = [];\r\n\t\tvar iFrames = win.document.getElementsByTagName('iframe');\r\n\t\tfor (var i =0; i<iFrames.length; i++)\r\n\t\t{\r\n\t\t\tcWin = iFrames[i].contentWindow;\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\tif (cWin && cWin.document)\r\n\t\t\t\t\tarrayWindows[i] = cWin;\r\n\t\t\t}\r\n\t\t\tcatch(e){};\t\t\r\n\t\t}\r\n\t\t\r\n\t\tif (win.document)\r\n\t\t\tarrayWindows[iFrames.length] = win;\r\n\t\tfor (i=0; i<arrayWindows.length; i++)\r\n\t\t{\t\r\n\t\t\tcommonspot.util.css.setStyleRuleProperty(stylesheetID, targetClass, propertyName, value, arrayWindows[i]);\r\n\t\t}\t\r\n\t};\t\r\n\t\r\n\t\r\n\r\n\t\r\n\t/**\r\n\t * commonspot.util.css.setStyleRuleProperty: sets a requested property of a stylesheet class\r\n\t */\r\n\tcommonspot.util.css.setStyleRuleProperty = function(stylesheetID, targetClass, propertyName, value, win)\r\n\t{\t\r\n\t \t// note that propertyNames need to use their js-style names, ie, 'whiteSpace', not 'white-space'\r\n\t\tvar cssRules, ruleIndex;\r\n\t\tvar doc = win ? win.document : document;\r\n\t\tvar ss = doc.getElementById(stylesheetID);\r\n\t\tif(!ss)\r\n\t\t\treturn;\r\n\t\tif(!ss.sheet) // IE\r\n\t\t{\r\n\t\t\tss = doc.styleSheets[stylesheetID];\r\n\t\t\tcssRules = doc.styleSheets[stylesheetID].rules;\r\n\t\t}\r\n\t\telse // Firefox\r\n\t\t{\r\n\t\t\tcssRules = ss.sheet.cssRules;\r\n\t\t}\r\n\t\truleIndex = getCSSRuleIndex(cssRules, '.' + targetClass);\r\n\t\tif(ruleIndex != null)\r\n\t\t{\r\n\t\t\tcssRules[ruleIndex].style[propertyName] = value;\r\n\t\t}\r\n\t\treturn;\r\n\t\r\n\t\tfunction getCSSRuleIndex(cssRules, selectorText)\r\n\t\t{\r\n\t\t\tfor(var i = 0; i < cssRules.length; i++)\r\n\t\t\t{\r\n\t\t\t\tif(cssRules[i].selectorText == selectorText)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\t\r\n\tcommonspot.util.css.hideForMenus = function(hide) \r\n\t{\r\n\t\tvar prop=hide ? 'hidden' : 'visible';\r\n\t\tcommonspot.util.css.setStyleRuleProperty('cs_maincss','cpHideForMenus','visibility',prop);\r\n\t\tcommonspot.util.css.setStyleRuleProperty('cs_maincss','cpMenuSafe','visibility',prop);\r\n\t};\r\n\t\r\n\t/*\r\n\t * shows or hides any number of passed elements, passed as objects or as IDs\r\n\t * elements argument can be:\r\n\t * \t- an elementID string, comma delimited for multiple\r\n\t * \t- an object containing html elements or strings\r\n\t *\t\t- an array containing html elements or string elementIDs\r\n\t * note:\r\n\t * \tshowHideElements works by modifying inline style\r\n\t * \tshowHideElementsUsingCSSClass does the same thing by adding or removing a css class; \r\n\t * \t\tit's a better choice for table rows\r\n\t * \tcopies of these functions in util.js work on objects in the top frame, regardless of where they're called from\r\n\t * \tcopies of them in nondashboard-util.js work on local window\r\n\t */\r\n\tcommonspot.util.css.showHideElements = function(show, elements, dspType)\r\n\t{\r\n   \tif (!dspType) \r\n   \t\tdspType = 'block';\r\n   \tvar display = show ? dspType : 'none';\r\n   \tvar targets;\r\n   \tif (typeof elements == 'string') \r\n   \t\ttargets = elements.split(',');\r\n   \telse \r\n   \t\ttargets = elements;\r\n\t   targets.each(function(elem)\r\n\t\t{\r\n\t\t\t$(elem).style.display = display;\r\n\t\t});\r\n\t};\r\n\t\r\n\t// see comments above for showHideElements\r\n\tcommonspot.util.css.showHideElementsUsingCSSClass = function(show, elements)\r\n\t{\r\n\t\tvar targets = (typeof elements == 'string') ? elements.split(',') : elements;\r\n\t\tif(typeof targets !== \"array\")\r\n\t\t{\r\n\t\t\ttargets.each(function(elem)\r\n\t\t\t{\r\n\t\t\t\tif(show)\r\n\t\t\t\t\t$(elem).removeClassName('showHideElements_hide');\r\n\t\t\t\telse\r\n\t\t\t\t\t$(elem).addClassName('showHideElements_hide');\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\t\r\n\t/*\r\n\t * disables any number of passed elements, passed as objects or as IDs\r\n\t * \tdoes visual change w css class 'disabled'; set that up to look right for the look of each kind of item \r\n\t *\t\tdoes actual disabling by stashing item's onclick in onclickDisabled custom property, nulling onclick\r\n\t *\t\talso sets item's disabled property\r\n\t *\t\t\tif neither of those to methods applies (disabled parent item etc), code will need to check some other way\r\n\t */\r\n\tcommonspot.util.css.enableDisableElements = function(enable, elements)\r\n\t{\r\n\t\tif(enable)\r\n\t\t\telements.each(function(elem)\r\n\t\t\t\t{\r\n\t\t\t\t\telem.removeClassName('disabled');\r\n\t\t\t\t\telem.onclick = elem.onclickDisabled ? elem.onclickDisabled : elem.onclick;\r\n\t            elem.onmouseover = elem.onmouseoverDisabled ? elem.onmouseoverDisabled : elem.onmouseover;\r\n\t\t\t\t\telem.disabled = false;\r\n\t\t\t\t});\r\n\t\telse\r\n\t\t\telements.each(function(elem)\r\n\t\t\t\t{\r\n\t\t\t\t\telem.addClassName('disabled');\r\n\t\t\t\t\telem.onclickDisabled = elem.onclick ? elem.onclick : elem.onclickDisabled;\r\n\t            elem.onmouseoverDisabled = elem.onmouseover ? elem.onmouseover : elem.onmouseoverDisabled;\r\n\t\t\t\t\telem.onclick = null;\r\n\t            elem.onmouseover = null;\r\n\t\t\t\t\telem.disabled = true;\r\n\t\t\t\t});\r\n\t};\r\n\t\r\n\t\r\n\tcommonspot.util.css.showFromMenuFields = function(visibleMenuClassList, fieldsList, dspType)\r\n\t{\r\n\t   if(!dspType)\r\n\t      dspType = 'block';\r\n\t\tvar fld, show, selector;\r\n\t\tvar aFields = fieldsList.split(',');\r\n\t   var aData = visibleMenuClassList.split(',');\r\n\t\r\n\t\tfor(var i = 0; i < aFields.length; i++)\r\n\t\t{\r\n\t\t\tfld = aFields[i];\r\n\t      \r\n\t      show = commonspot.util.arrayTest(aData,fld,0) ? 1 : 0;\r\n\t\t\t\r\n\t\t\tselector = '.cs_' + fld + '_hide';\r\n\t\t\tcommonspot.util.css.showHideElements(show, $$(selector), dspType)\r\n\t\t} \r\n\t};\r\n\t\r\n\tcommonspot.util.css.enableFromMenuFields = function(enabledMenuClassList, fieldsList, dspType)\r\n\t{\r\n\t   if(!dspType)\r\n\t      dspType = 'block';\r\n\t\tvar fld, enable, selector;\r\n\t\tvar aFields = fieldsList.split(',');\r\n\t   var aData = enabledMenuClassList.split(',');\r\n\t\tfor(var i = 0; i < aFields.length; i++)\r\n\t\t{\r\n\t\t\tfld = aFields[i];\r\n\t      \r\n\t      enable = commonspot.util.arrayTest(aData,fld,0) ? 1 : 0;\r\n\t\t\t\r\n\t\t\tselector = '.cs_' + fld + '_disable';\r\n\t\t\tcommonspot.util.css.enableDisableElements(enable, $$(selector))\r\n\t\t} \r\n\t\t\r\n\r\n\t};\r\n\t\r\n\t/**\r\n\t * display effects package\r\n\t */\r\n\tcommonspot.util.effects = {};\r\n\t\r\n\t/**\r\n\t * commonspot.util.effects.blindLeft: like scriptaculous BlindUp, but to left\r\n\t */\r\n\tcommonspot.util.effects.blindLeft = function(element) {\r\n\t  element = $(element);\r\n\t  element.makeClipping();\r\n\t  return new Effect.Scale(element, 0,\r\n\t    Object.extend({ scaleContent: false, \r\n\t      scaleX: true,\r\n\t      scaleY: false,\r\n\t      restoreAfterFinish: true,\r\n\t      afterFinishInternal: function(effect) {\r\n\t        effect.element.hide().undoClipping();\r\n\t      } \r\n\t    }, arguments[1] || {})\r\n\t  );\r\n\t};\r\n\t\r\n\t/**\r\n\t * commonspot.util.effects.blindRight: like scriptaculous BlindDown, but from left\r\n\t */\r\n\tcommonspot.util.effects.blindRight = function(element) {\r\n\t  element = $(element);\r\n\t  var elementDimensions = element.getDimensions();\r\n\t  return new Effect.Scale(element, 100, Object.extend({ \r\n\t    scaleContent: false, \r\n\t    scaleX: true,\r\n\t    scaleY: false,\r\n\t    scaleFrom: 0,\r\n\t    scaleMode: {originalHeight: elementDimensions.height, originalWidth: elementDimensions.width},\r\n\t    restoreAfterFinish: true,\r\n\t    afterSetup: function(effect) {\r\n\t      effect.element.makeClipping().setStyle({width: '0px'}).show(); \r\n\t    },  \r\n\t    afterFinishInternal: function(effect) {\r\n\t      effect.element.undoClipping();\r\n\t    }\r\n\t  }, arguments[1] || {}));\r\n\t};\r\n\t\r\n\t\r\n\t/**\r\n\t * commonspot.util.menus: package for operating menus\r\n\t */\r\n\tcommonspot.util.menus = {};\r\n\t\r\n\t/*\r\n\t * checks or unchecks passed menu item\r\n\t * requires css class 'checked', with check image as background\r\n\t * item should have class 'checkableMenuItem' applied always, for correct spacing\r\n\t */\r\n\tcommonspot.util.menus.checkItem = function(checked, item)\r\n\t{\r\n\t\tvar element = $(item);\r\n\t\tif(!element)\r\n\t\t\t{}\r\n\t\telse if(checked)\r\n\t\t\telement.addClassName('checkedMenuItem');\r\n\t\telse\r\n\t\t\telement.removeClassName('checkedMenuItem');\r\n\t};\r\n\t\r\n\r\n\t\r\n\t/**\r\n\t * change StyleRule.\r\n\t * Currently the property is hardcoded for display:block.\r\n\t * We have to make it dynamic . so that it can set any property.\r\n\t */ \r\n\tcommonspot.util.css.changeStyleRule = function(document, sheetTitle, className, propertyName, value)\r\n\t{\r\n\t\tvar rules = commonspot.util.css.getStyleSheetByTitle(document, sheetTitle).rules; \r\n\t\t\r\n\t\tfor (i=0; i< rules.length; i++)\r\n\t\t{      \r\n\t\t\tif (rules[i].selectorText.toLowerCase() == className.toLowerCase())\r\n\t\t\t{ \t\r\n\t\t\t\trules[i].style.display = value; \r\n\t\t\t\tbreak; \r\n\t\t\t} \r\n\t\t}  \r\n\t};\r\n\t \r\n\t/**\r\n\t * Get Stylesheet By Title.\r\n\t */ \r\n\tcommonspot.util.css.getStyleSheetByTitle = function(doc, sheetTitle)\r\n\t{ \t\r\n\t\tvar sheet = null;\r\n\t\tvar rules = null;\r\n\t\tvar thisTitle = null;\r\n\t\t\r\n\t\tif (doc.styleSheets.length > 0)\r\n\t\t{\r\n\t\t\tfor (i = 0; i< doc.styleSheets.length; i++)\r\n\t\t\t{\r\n\t\t\t\tthisTitle = doc.styleSheets[i].title ? doc.styleSheets[i].title : null;\r\n\t\t\t\tif ( thisTitle && thisTitle.toLowerCase()  == sheetTitle)\r\n\t\t\t\t{\r\n\t\t\t\t\tsheet = doc.styleSheets[i];\r\n\t\t\t\t\trules = sheet.cssRules? sheet.cssRules: sheet.rules;\r\n\t\t\t\t\tbreak; \r\n\t\t\t\t}\t\t\t \r\n\t\t\t}  \t\r\n\t\t}\r\n\t\t\r\n\t\treturn {sheet: sheet, rules: rules};\r\n\t};\r\n\r\n\t\r\n\t/*\r\n\t * xml utilities\r\n\t */\r\n\tcommonspot.util.xml = {};\r\n\t\r\n\t/**\r\n\t * Serialize object's properties into XML tags\r\n\t * @param obj (any type ex function I think) required\r\n\t * @param nodeName (string) optional\r\n\t * \tif not passed, defaults to 'struct' for structs, and 'array' for arrays\r\n\t * \tfor other types, no root node is rendered unless nodeName is passed, in which case it's used\r\n\t * array containers have a 'class=\"array\"' attribute to tell the server side that it's an array\r\n\t * empty structs have a 'class=\"struct\"' attribute for the same reason\r\n\t * array item nodes are always <item> tags\r\n\t * array example:\r\n\t * \t<foo class=\"array\"><item>hello</item><item>world</item></foo>\r\n\t * @return an XML string\r\n\t */\r\n\t /*\r\n\t\ttest code:\r\nvar UNDEFINED;\r\ntests =\r\n[\r\n\t\"asdf & <qwer>\",\r\n\tnew Date(),\r\n\tnew Date(\"not a valid date\"),\r\n\t{a:1,b:2},\r\n\t{a:1,b:2,c:{aa:11,bb:22,cc:{aaa:111,bbb:222}}},\r\n\t[1,2],\r\n\t[1,2,\"asdf & <qwer>\",{aa:11,bb:22}],\r\n\t[1,2,[33,44,[555,666]]],\r\n\t{a:1,b:2,c:[33,44,[555,666,{aa:77,bb:88,cc:[1,2]}]]},\r\n\t{a:1,b:'foo',c:'',d:[],e:{}},\r\n\t[\"one element array\"],\r\n\t{a:1,b:2,c:[\"one element array\"]},\r\n\tfunction(){},\r\n\t{a:1,b:2,c:function(){}},\r\n\tUNDEFINED,\r\n\tnull,\r\n\t{lastName: UNDEFINED, firstName: null, birthday: new Date('not a valid date')}\r\n];\r\nfor(var i = 0; i < tests.length; i++)\r\n{\r\n\tconsole.log(i, \"TEST OBJ:\", tests[i]);\r\n\tconsole.log(i, commonspot.util.xml.objectToXml(tests[i]));\r\n\tconsole.log(i, commonspot.util.xml.objectToXml(tests[i], \"data\"));\r\n}\r\ncommonspot.util.xml.objectToXml(x);\r\n\t */\r\n\t\r\n\tcommonspot.util.xml.objectToXml = function(obj, nodeName)\r\n\t{\r\n\t\tvar xml = '';\r\n\t\tvar _nodeName = nodeName;\r\n\t\t\r\n\t\tvar type = typeof obj;\r\n\t\tif(obj === undefined)\r\n\t\t\ttype = 'undefined';\r\n\t\telse if(obj == null)\r\n\t\t\ttype = 'null';\r\n\t\telse if(type !== 'object')\r\n\t\t\t{}\r\n\t\telse if(commonspot.util.isArray(obj))\r\n\t\t\ttype = 'array';\r\n\t\telse if(commonspot.util.isDate(obj))\r\n\t\t\ttype = 'date';\r\n\r\n\t\tswitch (type)\r\n\t\t{\r\n\t\t\tcase 'number':\r\n\t\t\tcase 'boolean':\r\n\t\t\t\txml = obj;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'string':\r\n\t\t\t\txml = commonspot.util.xml.encodeEntities(obj);\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tcase 'date':\r\n\t\t\t\tif(isNaN(obj))\r\n\t\t\t\t{\r\n\t\t\t\t\txml = commonspot.err.INVALID_DATE_TOKEN;\r\n\t\t\t\t\tnodeClass = 'exception';\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\txml = commonspot.util.toCSDateFormat(obj);\r\n\t\t\t\t\tif(xml === commonspot.err.INVALID_DATE_TOKEN)\r\n\t\t\t\t\t\tnodeClass = 'exception';\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tcase 'array':\r\n\t\t\t\t_nodeName = _nodeName ? _nodeName : 'array';\r\n\t\t\t\tvar nodeClass = 'array';\r\n\t\t\t\tvar objectToXml = commonspot.util.xml.objectToXml; // local, will bang on it\r\n\t\t\t\tvar len = obj.length;\r\n\t\t\t\tfor(var i = 0; i < len; i++)\r\n\t\t\t\t\txml += objectToXml(obj[i], 'item');\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'object':\r\n\t\t\t\t_nodeName = _nodeName ? _nodeName : 'struct';\r\n\t\t\t\tnodeClass = 'struct';\r\n\t\t\t\tvar objectToXml = commonspot.util.xml.objectToXml; // local, will bang on it\r\n\t\t\t\tfor(var key in obj)\r\n\t\t\t\t{\r\n\t\t\t\t\txml += objectToXml(obj[key], key);\r\n\t\t\t\t\tnodeClass = ''; // dont' need to put a class on it if it has children\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tcase 'null':\r\n\t\t\t\txml = commonspot.err.NULL_VALUE_TOKEN;\r\n\t\t\t\tnodeClass = 'exception';\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tcase 'undefined':\r\n\t\t\t\txml = commonspot.err.UNDEFINED_VALUE_TOKEN;\r\n\t\t\t\tnodeClass = 'exception';\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tdefault:\r\n\t\t\t\txml = commonspot.err.UNSUPPORTED_TYPE_TOKEN.replace('</', ': ' + typeof obj + '</');\r\n\t\t\t\tnodeClass = 'exception';\r\n\t\t}\r\n\r\n\t\tif(_nodeName)\r\n\t\t\txml = '<' + _nodeName + (nodeClass ? ' class=\"' + nodeClass + '\"' : '') + '>' + xml + '</' + _nodeName + '>';\r\n\t\treturn xml;\r\n\t};\r\n\t\r\n\t/**\r\n\t * returns a javascript object analguous to a passed xml node\r\n\t * @param node (xml node): node to process\r\n\t * @param skip (string || object):\r\n\t * \tcan be a comma delimited list of dot-path items to omit, ie, \"item.data,item.status.data.cmd\"\r\n\t * \t\tno extra whitespace!!!\r\n\t * \tcan also be a struct w those dot-path items as keys and any value that evals as true in a boolean test\r\n\t * \tNOT xpath etc, ie, no wildcards, just simple exact match to passed skip paths\r\n\t * \tthis is recursive, and passed string gets converted to a more efficient struct, which then gets passed on\r\n\t * @param path (string || null):\r\n\t * \tDO NOT PASS THIS. calls itself recursively, passing this internally to support @param skip\r\n\t * @return (object): js object representing pass xml node\r\n\t * \r\n\t * somewhat specialized for commonspot use\r\n\t * \tdoesn't create or examine attributes, with one exception:\r\n\t * \tattribute 'class' is used to know if a container is an array, but not applied to result\r\n\t */\r\n\t/* test code\r\nxml = '<s><a>1</a><b>2</b><c class=\"array\"><item>11</item><item>22 &quot; &apos; &lt; &gt; &amp; &amp;amp; &amp;amp;amp;</item><item></item><item class=\"array\"></item><item class=\"struct\"></item></c></s>';\r\nxmlDoc = tmt.xml.stringToDOM(xml);\r\ncommonspot.util.xml.nodeToObject(xmlDoc);\r\n*/\r\n\t\r\n\tcommonspot.util.xml.nodeToObject = function(node, skip, path)\r\n\t{\r\n\t\tif(!node)\r\n\t\t\treturn null;\r\n\t\t\t\r\n\t\tif(!skip)\r\n\t\t\tskip = {};\r\n\t\telse if(typeof skip === \"string\")\r\n\t\t{\t// passed value is a string, convert to struct for efficient existance testing\r\n\t\t\tvar aSkip = skip.split(\",\");\r\n\t\t\tskip = {};\r\n\t\t\tfor(var i = 0; i < aSkip.length; i++)\r\n\t\t\t   skip[aSkip[i]] = true;\r\n\t\t}\r\n\t\t\r\n\t\t// if no path, make it \"\", and if it's not \"\", put a \".\" on end\r\n\t\tpath = path || \"\";\r\n\t\tpath = (path === \"\") ? path : (path + \".\");\r\n\t\r\n\t\tvar obj = {};\r\n\t\tvar child, typeClass, isArray, isStruct, hasChildNodes, tagName, childObj, childPath, nodeAtrs, dataType, csItemKey;\r\n\t\r\n\t\tnodeAtrs = commonspot.util.xml.getNodeAttributes(node);\r\n\t\tif(commonspot.util.xml.nodeHasValue(node)) // node has a value, use it\r\n\t\t{\r\n\t\t\tdataType = (nodeAtrs && nodeAtrs[\"type\"]) ? nodeAtrs[\"type\"].toLowerCase() : null; // we honor 'type' attribute\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\tchild = node.firstChild;\r\n\t\t\t\tswitch(child.nodeType)\r\n\t\t\t\t{\r\n\t\t\t\t\tcase 3: // TEXT_NODE\r\n\t\t\t\t\tcase 4: // CDATA_SECTION_NODE\r\n\t\t\t\t\t\tobj = child.data;\r\n\t\t\t\t\t\tif(dataType === \"bool\")\r\n\t\t\t\t\t\t\tobj = obj.toBoolean();\r\n\t\t\t\t\t\telse if(dataType === \"int\")\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tobj = parseInt(obj);\r\n\t\t\t\t\t\t\tobj = isNaN(obj) ? 0 : obj;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t/* dmerrill 9/4/09: works, not used, yet, maybe never\r\n\t\t\t\t\t\telse if(dataType === \"float\")\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tobj = parseFloat(obj);\r\n\t\t\t\t\t\t\tobj = isNaN(obj) ? 0 : obj;\r\n\t\t\t\t\t\t}*/\r\n\t\t\t\t\t\telse if(child.nodeType == 3) // TEXT_NODE\r\n\t\t\t\t\t\t\tobj = commonspot.util.xml.encodeEntities(obj);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} catch (e) { alert(\"commonspot.util.xml.nodeToObject() exception caught: \" + e); }\r\n\t\t}\r\n\t\telse // no value\r\n\t\t{\r\n\t\t\thasChildNodes = (node.childNodes && node.childNodes.length > 0);\r\n\t\t\tisArray = isStruct = false;\r\n\t\t\tif(nodeAtrs)\r\n\t\t\t{\r\n\t\t\t\tisArray = (nodeAtrs[\"class\"] === \"array\");\r\n\t\t\t\tisStruct = (nodeAtrs[\"class\"] === \"struct\");\r\n\t\t\t}\r\n\t\t\tif(!(isArray || isStruct))\r\n\t\t\t\tisStruct = hasChildNodes; // it's a struct if it isn't an array and has child nodes\r\n\t\t\tobj = isArray ? [] : isStruct ? {} : \"\";\r\n\t\t\t\r\n\t\t\tif(!hasChildNodes) // no value, no children\r\n\t\t\t\treturn obj;\r\n\t\t\t\r\n\t\t\tchild = node.firstChild;\r\n\t\t\twhile(child)\r\n\t\t\t{\r\n\t\t\t\ttagName = child.nodeName;\r\n\t\t\t\tif(tagName === 'cs_item')\r\n\t\t\t\t{\r\n\t\t\t\t\tcsItemKey = commonspot.util.xml.getNodeAttribute(child, 'key');\r\n\t\t\t\t\ttagName = csItemKey || tagName;\r\n\t\t\t\t}\r\n\t\t\t\tchildPath = path + tagName;\r\n\t\t\t\tif(child.nodeType == 1 && !skip[childPath]) // Node.ELEMENT_NODE and not skipped path\r\n\t\t\t\t{\r\n\t\t\t\t\tchildObj = commonspot.util.xml.nodeToObject(child, skip, childPath);\r\n\t\t\t\t\tif(isArray)\r\n\t\t\t\t\t\tobj.push(childObj);\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tobj[tagName] = childObj;\r\n\t\t\t\t}\r\n\t\t\t\tchild = child.nextSibling;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn obj;\r\n\t};\r\n\t\r\n\tcommonspot.util.xml.getNodeAttribute = function(node, attributeName)\r\n\t{\r\n\t\tif((!node.attributes) || node.attributes.length === 0)\r\n\t\t\treturn null;\r\n\t\tattributeName = attributeName ? attributeName.toLowerCase() : null;\r\n\t\tfor(var i = 0; i < node.attributes.length; i++)\r\n\t\t{\r\n\t\t\tif(node.attributes[i].name && (node.attributes[i].name.toLowerCase() == attributeName))\r\n\t\t\t\treturn node.attributes[i].value;\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\t\r\n\tcommonspot.util.xml.getNodeAttributes = function(node)\r\n\t{\r\n\t\tif((!node.attributes) || node.attributes.length === 0)\r\n\t\t\treturn null;\r\n\t\tvar atrs = node.attributes;\r\n\t\tvar result = {};\r\n\t\tfor(var i = 0; i < atrs.length; i++)\r\n\t\t{\r\n\t\t\tif (atrs[i].name)\r\n\t\t\t\tresult[atrs[i].name.toLowerCase()] = atrs[i].value;\r\n\t\t}\t\r\n\t\treturn result;\r\n\t};\r\n\t\t\r\n\tcommonspot.util.xml.nodeHasValue = function(node)\r\n\t{\r\n\t\tif (node)\r\n\t\t{\r\n\t\t\tvar child = node.firstChild;\r\n\t\t\t// 3 = Node.TEXT_NODE, 4 = CDATA_SECTION_NODE\r\n\t\t\tif (child && child.nextSibling == null && (child.nodeType == 3 || child.nodeType == 4))\r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\t\r\n\t/**\r\n\t * Unescapes special chars that the commonspot serializer escapes\r\n\t * @return string\r\n\t */\r\n\tcommonspot.util.xml.decodeEntities = function(str)\r\n\t{\r\n\t\tif(str && (str.length >= 4) && str.search(/&lt;|&gt;|&quot;|&amp;/) != -1)\r\n\t\t{\r\n\t\t\tstr = str.replace(/&lt;/gi, '<');\r\n\t\t\tstr = str.replace(/&gt;/gi, '>');\r\n\t\t\tstr = str.replace(/&quot;/gi, '\"');\r\n\t\t\tstr = str.replace(/&amp;/gi, '&');\r\n\t\t}\r\n\t\treturn str;\r\n\t};\r\n\t\r\n\tcommonspot.util.xml.encodeEntities = function(str)\r\n\t{\r\n\t\tif (str && str.search(/[&<>\"]/) != -1)\r\n\t\t{\r\n\t\t\tstr = str.replace(/&/g, '&amp;');\r\n\t\t\tstr = str.replace(/</g, '&lt;');\r\n\t\t\tstr = str.replace(/>/g, '&gt;');\r\n\t\t\tstr = str.replace(/\"/g, '&quot;');\r\n\t\t}\r\n\t\treturn str;\r\n\t};\r\n\t\r\n} // End: commonspot.util\r\n\r\n\r\n\r\n/*\r\n * Error managment tools\r\n */\r\nif(!commonspot.err) // commonspot.err not built yet\r\n{\r\n\t// NAMESPACE\r\n\tcommonspot.err = {};\r\n\t\r\n\t// CONSTANTS\r\n\tcommonspot.err.COMMAND_REFUSAL_ERROR_CODE = 409;\r\n\tcommonspot.err.AUTHORING_DISABLED_ERROR_CODE = 503;\r\n\tcommonspot.err.INTERNAL_ERROR_CODE = 560;\r\n\t\r\n\tcommonspot.err.INCOMPLETE_RETURN_VALUE_EXCEPTION = 'CSIncompleteReturnValueException';\r\n\t\r\n\tcommonspot.err.HTTP_ERROR_MSG = 'Failed to get command response, server reported a communication error.';\r\n\tcommonspot.err.FATAL_COMMAND_COLLECTION_ERROR_MSG = 'We\\'re sorry, an error has occurred.';\r\n\tcommonspot.err.EMPTY_COLLECTION_MSG = 'The command collection is empty and cannot be sent.';\r\n\tcommonspot.err.EMPTY_RESPONSE_MSG = 'The server response is empty and cannot be processed.';\r\n\tcommonspot.err.COMMAND_HANDLER_ERROR_MSG_START = 'JavaScript error in command response handler.';\r\n\tcommonspot.err.UNMAPPED_FIELD_ERROR_MSG_START = '';\r\n\tcommonspot.err.MISSING_DATASET_ERROR_MSG = 'Unable to locate dataset';\r\n\tcommonspot.err.REQUIRED_MSG = \"This field is required.\";\r\n\t\r\n\tcommonspot.err.MAPPED_FIELD_ERROR_MSGS_HEADER = 'Please correct the following:';\r\n\tcommonspot.err.INTERNAL_ERROR_MSGS_HEADER = 'We\\'re sorry, an internal error has occurred.';\r\n\t\r\n\tcommonspot.err.FIELD_ERROR_CSS_CLASS = 'CommonSpotFieldError';\r\n\tcommonspot.err.INVALID_VALUE_PREFIX = \"{!INVALID_VALUE_PREFIX!}\";\r\n\t\r\n\tcommonspot.err.NULL_VALUE_TOKEN = '<message>Attempt to pass a null value.</message>';\r\n\tcommonspot.err.UNDEFINED_VALUE_TOKEN = '<message>Attempt to pass an undefined value.</message>';\r\n\tcommonspot.err.UNSUPPORTED_TYPE_TOKEN = '<message>Attempt to pass an unsupported type.</message>';\r\n\tcommonspot.err.INVALID_DATE_TOKEN = '<message>Attempt to pass an invalid date.</message>';\r\n\t\r\n\t// STATIC METHODS\r\n\t\r\n\t/*\r\n\t * rtns passed msg w INVALID_VALUE_PREFIX prepended\r\n\t * point is that it's recognized by ErrorCollection.checkFieldValue as an invalid value\r\n\t * for an example, see /dashboard/dialogs/tools/js/advanced-search.js:\r\n\t * \tgetOwner() rtns a msg built w commonspot.err.invalidMsg() if it's invalid\r\n\t * \tcollectFormArgs() creates a new commonspot.err.ErrorCollection\r\n\t * \t\tthen checks each collected value with the collection's checkFieldValue() method\r\n\t * \t\tit then calls the collection's displayErrors() method to show them, and bails if that rtns true (were rrs)\r\n\t */\r\n\tcommonspot.err.invalidMsg = function(msg)\r\n\t{\r\n\t\treturn commonspot.err.INVALID_VALUE_PREFIX + msg;\r\n\t};\r\n\t\t\r\n\t/*\r\n\t * clears field error styling off all fields that might get it if they fail\r\n\t * relevant fields are ones whose highlightIDs are in passed fieldErrorMap or are values in errorCodeMap\r\n\t * always operates on topmost lightbox window, regardless of where it's called from\r\n\t */\r\n\tcommonspot.err.clearFieldErrorDisplay = function(fieldErrorMap, errorCodeMap, fieldErrorContext)\r\n\t{\r\n\t\tvar contextWindow = commonspot.err.getFieldErrorContextWindow(fieldErrorContext);\r\n\t\tvar highlightIDs;\r\n\t\tfor(var fld in fieldErrorMap)\r\n\t\t{\r\n\t\t\thighlightIDs = fieldErrorMap[fld].highlightIDs;\r\n\t\t\tif(highlightIDs)\r\n\t\t\t\tcommonspot.util.css.addRemoveClassNameByIDs(highlightIDs, commonspot.err.FIELD_ERROR_CSS_CLASS, false, contextWindow);\r\n\t\t}\r\n\t\tfor(var code in errorCodeMap)\r\n\t\t{\r\n\t\t\thighlightIDs = errorCodeMap[code].highlightIDs;\r\n\t\t\tif(highlightIDs) // should exist, friendlyName and highlightIDs are reason for map to exist\r\n\t\t\t\tcommonspot.util.css.addRemoveClassNameByIDs(highlightIDs, commonspot.err.FIELD_ERROR_CSS_CLASS, false, contextWindow);\r\n\t\t}\r\n\t};\r\n\t\r\n\tcommonspot.err.getFieldErrorContextWindow = function(fieldErrorContext)\r\n\t{\r\n\t\tvar contextWindow;\r\n\t\tswitch(fieldErrorContext) // may need more cases in here some day\r\n\t\t{\r\n\t\t\tcase 'admin':\r\n\t\t\t\tcontextWindow = commonspot.lightbox.getAdminWindow();\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tcontextWindow = top.commonspot.lightbox.getCurrentWindow();\r\n\t\t}\r\n\t\t\t\t\r\n\t\treturn contextWindow;\r\n\t};\r\n\t\r\n\t// CLASSES\r\n\t\r\n\t/*\r\n\t * ErrorCollection class, holds and displays error objects\r\n\t */\r\n\tcommonspot.err.ErrorCollection = function ()\r\n\t{\r\n\t\tthis.errors = [];\r\n\t\treturn this;\r\n\t};\r\n\t\r\n\t/*\r\n\t * adds passed errorObject to this collection\r\n\t * object must support render() method\r\n\t * \tTODO: explain that more\r\n\t */\r\n\tcommonspot.err.ErrorCollection.prototype.addError = function(errorObject)\r\n\t{\r\n\t\tthis.errors.push(errorObject);\r\n\t};\r\n\t\r\n\t/**\r\n\t * checks passed value, if it starts w INVALID_PREFIX, it's an error, and rest of it is error msg\r\n\t * \tso, add corresponding FieldError object to this ErrorCollection, and rtn true\r\n\t * otherwise, it's not an error, clear its error appearance, and rtn false\r\n\t * can also validate the value here, but mostly we validate on the server side, so in general, don't\r\n\t * \r\n\t * @param value (any) required: value to check\r\n\t * @param friendlyName (string) optional: name to call it in user alerts\r\n\t * @param highlightID (string) optional: id of dom element to hilight if invalid\r\n\t * @param validator (string or function) optional:\r\n\t * \tif passed, it's used to process the value first\r\n\t * \tcan be the name of a std validator, in commonspot.err.validators namespace...\r\n\t * \t\t...or a reference to (not the name of) a custom function \r\n\t * \tvalidator functions should return passed value if it's valid, else commonspot.err.invalidMsg(\"Some message\")\r\n\t */\r\n\tcommonspot.err.ErrorCollection.prototype.checkFieldValue = function(value, friendlyName, highlightID, validator)\r\n\t{\r\n\t\tif(typeof validator === \"string\")\r\n\t\t\tvalidator = commonspot.err.validators[validator];\r\n\t\tif(typeof validator === \"function\")\r\n\t\t\tvalue = validator(value);\r\n\t\t\t\r\n\t\tvar lightboxWindow = top.commonspot.lightbox.getCurrentWindow();\r\n\t\tif((typeof value === \"string\") && (value.substr(0, commonspot.err.INVALID_VALUE_PREFIX.length) == commonspot.err.INVALID_VALUE_PREFIX))\r\n\t\t{\r\n\t\t\tif(highlightID && highlightID != \"\")\r\n\t\t\t\tlightboxWindow.$(highlightID).addClassName(commonspot.err.FIELD_ERROR_CSS_CLASS);\r\n\t\t\tvar msg = value.substr(commonspot.err.INVALID_VALUE_PREFIX.length);\r\n\t\t\tvar fieldError = new commonspot.err.FieldError(msg, friendlyName, highlightID);\r\n\t\t\tthis.addError(fieldError);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse if(highlightID && highlightID != \"\")\r\n\t\t{\r\n\t\t\tlightboxWindow.$(highlightID).removeClassName(commonspot.err.FIELD_ERROR_CSS_CLASS);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n\t\r\n\t/*\r\n\t * if collection contains errors, displays them and rtns true, else rtns false\r\n\t * TODO: explain more about responsibilities of objects in its error collection, and how instances of them get created\r\n\t */\r\n\tcommonspot.err.ErrorCollection.prototype.displayErrors = function(fieldErrorContext)\r\n\t{\r\n\t\tif(this.errors.length > 0)\r\n\t\t{\r\n\t\t\tvar contextWindow = fieldErrorContext\r\n\t\t\t\t\t? commonspot.err.getFieldErrorContextWindow(fieldErrorContext)\r\n\t\t\t\t\t: top.commonspot.lightbox.getCurrentWindow();\r\n\t\t\tvar fieldMsgs = \"\";\r\n\t\t\tvar userMsgs = \"\";\r\n\t\t\tvar internalMsgs = \"\";\r\n\t\t\tvar msgs;\r\n\t\t\tfor(var i = 0; i < this.errors.length; i++)\r\n\t\t\t{\r\n\t\t\t\tmsgs = this.errors[i].render(contextWindow);\r\n\t\t\t\tif(msgs.field && msgs.field !== \"\")\r\n\t\t\t\t\tfieldMsgs += msgs.field;\r\n\t\t\t\tif(msgs.user && msgs.user !== \"\")\r\n\t\t\t\t\tuserMsgs += msgs.user;\r\n\t\t\t\tif(msgs.internal && msgs.internal !== \"\")\r\n\t\t\t\t\tinternalMsgs += msgs.internal;\r\n\t\t\t}\r\n\t\t\tvar msg = \"\";\r\n\t\t\tif(userMsgs !== \"\")\r\n\t\t\t\tmsg += userMsgs;\r\n\t\t\tif(fieldMsgs !== \"\")\r\n\t\t\t\tmsg += \"<h2>\" + commonspot.err.MAPPED_FIELD_ERROR_MSGS_HEADER + \"</h2><dl>\" + fieldMsgs + \"</dl>\";\r\n\t\t\tif(internalMsgs !== \"\")\r\n\t\t\t\tmsg += \"<h2>\" + commonspot.err.INTERNAL_ERROR_MSGS_HEADER + \"</h2><dl>\" + internalMsgs + \"</dl>\";\r\n\t\t\tcommonspot.dialog.client.alert(msg);\r\n\t\t}\r\n\t\treturn (this.errors.length > 0); // boolean == hasErrors\r\n\t};\r\n\t\r\n\t\r\n\t/*\r\n\t * Helper function.  Checks if the passed value is empty. If so sets an invalidMsg and checks the field Value\r\n\t */\r\n\tcommonspot.err.ErrorCollection.prototype.setErrorIfEmpty = function(value, friendlyName, highlightID, msg)\r\n\t{\r\n\t\tif(value == \"\")\r\n\t\t{\r\n\t\t\tif(typeof(msg) == \"undefined\")\r\n\t\t\t\tmsg = commonspot.err.REQUIRED_MSG;\r\n\t\t\tvalue = commonspot.err.invalidMsg(msg);\r\n\t\t\tthis.checkFieldValue(value, friendlyName, highlightID);\t\t\r\n\t\t}\t\r\n\t};\r\n\t\r\n\t/*\r\n\t * CmdError class, represents a server-side error running a cmd\r\n\t * TODO: write this, document fieldErrors and fieldErrorMap members better\r\n\t * fieldErrors\r\n\t * \terrortype:\r\n\t * \tmessage:\r\n\t * \tfieldtype:\r\n\t * \tpassedtype:\r\n\t * fieldErrorMap\r\n\t * \tstruct, keyed by the lcase argument name on the server side.\r\n\t * \tfor each field, value is a struct containing...\r\n\t * \t\tfriendlyName:\r\n\t * \t\thighlightIDs:\r\n\t * \t\tposition:\r\n\t */\r\n\tcommonspot.err.CmdError = function(responseStatus, fieldErrorMap, errorCodeMap)\r\n\t{\r\n\t\tthis.cmd = responseStatus.cmd;\r\n\t\tthis.code = responseStatus.code;\r\n\t\tthis.reasonCode = responseStatus.reasoncode;\r\n\t\tthis.text = responseStatus.text;\r\n\t\tthis.hasFieldErrors = responseStatus.hasFieldErrors;\r\n\t\tif(responseStatus.data)\r\n\t\t{\r\n\t\t\tthis.exceptionType = responseStatus.data.exceptiontype;\r\n\t\t\tthis.fieldErrors = responseStatus.data.fielderrors;\r\n\t\t}\r\n\t\tthis.fieldErrorMap = fieldErrorMap;\r\n\t\tthis.errorCodeMap = errorCodeMap;\r\n\t\t\t\t\t//console.log(\"CmdError.this\", this);\r\n\t\treturn this;\r\n\t};\r\n\t\r\n\t/*\r\n\t * visually indicate field errors when applicable, and rtn struct w error msgs:\r\n\t * \t.field: user-fixable data problems\r\n\t * \t.user: other expected exception alerts\r\n\t * \t.internal: unexpected internal error (cf crash, unmapped field errors, etc)\r\n\t */\r\n\tcommonspot.err.CmdError.prototype.render = function(contextWindow)\r\n\t{\r\n\t\tvar map, fieldName, highlightIDs, position;\r\n\t\tvar msgs = {field: \"\", user: \"\", internal: \"\"};\r\n\t\tvar orderedFieldMsgs = [];\r\n\t\tvar unorderedFieldMsgs = [];\r\n\t\tif (this.hasFieldErrors)\r\n\t\t{\t// cmd refusal with field errors user can fix (if we have a mapping for the fld), typically validation\r\n\t\t\tif (this.fieldErrorMap)\r\n\t\t\t{\r\n\t\t\t\t// fieldErrorMap entries have position only if added to cmd collection via a Command obj; want to fill in the rest using order added to the map\r\n\t\t\t\t// find highest position spec'd in map\r\n\t\t\t\tposition = -1;\r\n\t\t\t\tfor (fieldName in this.fieldErrorMap)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof this.fieldErrorMap[fieldName].position !== 'undefined')\r\n\t\t\t\t\t\tposition = this.fieldErrorMap[fieldName].position;\r\n\t\t\t\t}\r\n\t\t\t\t// starting one higher than highest existing position, number all unnumbered ones, in order defined in map\r\n\t\t\t\tposition++;\r\n\t\t\t\tfor (fieldName in this.fieldErrorMap)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof this.fieldErrorMap[fieldName].position === 'undefined')\r\n\t\t\t\t\t\tthis.fieldErrorMap[fieldName].position = position++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (var fld in this.fieldErrors)\r\n\t\t\t{\r\n\t\t\t\tif (!this.fieldErrors.hasOwnProperty(fld)) // skip prototype extended methods\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t// if error is a string, not an object, it's an internal exception; so far, that's only INCOMPLETE_RETURN_VALUE_EXCEPTION\r\n\t\t\t\tif (typeof this.fieldErrors[fld] === 'string')\r\n\t\t\t\t{\r\n\t\t\t\t\tmsgs.internal += '<dt>' + this.errorSource(this.cmd, fld) + '</dt><dd>' + this.fieldErrors[fld].escapeHTML() + '</dd>';\r\n\t\t\t\t}\r\n\t\t\t\telse if (this.fieldErrorMap && this.fieldErrorMap[fld]) // have a mapping for this fld -- user-entered data they can change\r\n\t\t\t\t{\r\n\t\t\t\t\tmap = this.fieldErrorMap[fld];\r\n\t\t\t\t\tfieldName = map.friendlyName || fld;\r\n\t\t\t\t\thighlightIDs = map.highlightIDs;\r\n\t\t\t\t\tposition = map.position;\r\n\t\t\t\t\tif(highlightIDs)\r\n\t\t\t\t\t\tcommonspot.util.css.addRemoveClassNameByIDs(highlightIDs, commonspot.err.FIELD_ERROR_CSS_CLASS, true, contextWindow);\r\n\t\t\t\t\tmsg = (this.fieldErrors[fld].errortype == \"empty\") ? commonspot.err.REQUIRED_MSG : this.fieldErrors[fld].message;\r\n\t\t\t\t\tmsg = '<dt title=\"Data type: ' + this.fieldErrors[fld].fieldtype + '\">' + fieldName + '</dt><dd>' + msg.escapeHTML() + '</dd>';\r\n\t\t\t\t\tif (typeof position !== 'undefined' && typeof orderedFieldMsgs[position] === 'undefined')\r\n\t\t\t\t\t\torderedFieldMsgs[position] = msg;\r\n\t\t\t\t\telse // shouldn't happen I think, but don't want to die if there's a way it can\r\n\t\t\t\t\t\tunorderedFieldMsgs.push(msg);\r\n\t\t\t\t}\r\n\t\t\t\telse // no mapping for this fld, not something user can fix -- internal error or missing or incorrect map\r\n\t\t\t\t\tmsgs.internal += '<dt title=\"Data type: ' + this.fieldErrors[fld].fieldtype + '\">' + this.errorSource(this.cmd, fld) + '</dt><dd>' + commonspot.err.UNMAPPED_FIELD_ERROR_MSG_START + this.fieldErrors[fld].message.escapeHTML() + '</dd>';\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (this.code === commonspot.err.COMMAND_REFUSAL_ERROR_CODE) // non-field cmd refusal\r\n\t\t{\r\n\t\t\tmap = this.errorCodeMap ? this.errorCodeMap.getForCode(this.reasonCode) : null;\r\n\t\t\tif(map) // have specs for this reasonCode, alert like a field error and highlight requested flds\r\n\t\t\t{\r\n\t\t\t\tcommonspot.util.css.addRemoveClassNameByIDs(map.highlightIDs, commonspot.err.FIELD_ERROR_CSS_CLASS, true, contextWindow);\r\n\t\t\t\tmsg = '<dt>' + map.itemTitle + '</dt><dd>' + this.text.escapeHTML() + '</dd>';\r\n\t\t\t\tunorderedFieldMsgs.push(msg);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tmsgs.user += '<p>' + this.text.escapeHTML() + '</p>';\r\n\t\t}\r\n\t\telse if (this.code === commonspot.err.AUTHORING_DISABLED_ERROR_CODE) // authoring is disabled, just say it\r\n\t\t\tmsgs.user += '<p>' + this.text.escapeHTML() + '</p>';\r\n\t\telse // non-field internal error\r\n\t\t\tmsgs.internal += '<dt>' + this.errorSource(this.cmd) + '</dt><dd>' + this.text + '</dd>';\r\n\t\t\t\r\n\t\tmsgs.field = orderedFieldMsgs.join(\"\") + unorderedFieldMsgs.join(\"\"); // concat ordered msgs, ones w no position at end\r\n\t\treturn msgs;\r\n\t};\r\n\t\r\n\tcommonspot.err.CmdError.prototype.errorSource = function(cmd, fld)\r\n\t{\r\n\t\tswitch(this.exceptionType)\r\n\t\t{\r\n\t\t\tcase \"CSIncompleteReturnValueException\":\r\n\t\t\t\treturn cmd + \", \" + \"field '\" + fld + \"' in return value:\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn (fld ? cmd + \".\" + fld : cmd);\r\n\t\t}\r\n\t};\r\n\t\r\n\t\r\n\t/*\r\n\t * CmdHandlerError class, represents a client-side js error in a cmd response handler\r\n\t * TODO: write this\r\n\t */\r\n\tcommonspot.err.CmdHandlerError = function(cmd, error)\r\n\t{\r\n\t\tthis.cmd = cmd;\r\n\t\tthis.text = error.toString().escapeHTML();\r\n\t\treturn this;\r\n\t};\r\n\t\r\n\t/*\r\n\t * visually indicate field errors when applicable, which won't happen, and...\r\n\t * rtn struct w error msgs:\r\n\t * \t.field: user-fixable data problems; null\r\n\t * \t.user: other expected exception; null\r\n\t * \t.internal: unexpected internal error; error text\r\n\t */\r\n\tcommonspot.err.CmdHandlerError.prototype.render = function(lightboxWindow)\r\n\t{\r\n\t\tvar msgs =\r\n\t\t{\r\n\t\t\tfield: \"\",\r\n\t\t\tuser: \"\",\r\n\t\t\tinternal: \"<dt>\" + this.cmd + \"</dt><dd>\" + commonspot.err.COMMAND_HANDLER_ERROR_MSG_START + \"<br />\" + this.text.escapeHTML() + \"</dd>\"\r\n\t\t};\r\n\t\treturn msgs;\r\n\t};\r\n\t\r\n\t/*\r\n\t * FieldError class, represents a client-side validation error specific to some field\r\n\t * TODO: write this\r\n\t */\r\n\tcommonspot.err.FieldError = function(msg, friendlyName, highlightIDs)\r\n\t{\r\n\t\tthis.msg = msg;\r\n\t\tthis.friendlyName = friendlyName;\r\n\t\tthis.highlightIDs = highlightIDs;\r\n\t\treturn this;\r\n\t};\r\n\t\r\n\t/*\r\n\t * visually indicate field errors when applicable, which won't happen, and...\r\n\t * rtn struct w error msgs:\r\n\t * \t.field: user-fixable data problems; null\r\n\t * \t.user: other expected exception; null\r\n\t * \t.internal: unexpected internal error; error text\r\n\t */\r\n\tcommonspot.err.FieldError.prototype.render = function(lightboxWindow)\r\n\t{\r\n\t\tif(this.highlightIDs && this.highlightIDs != \"\")\r\n\t\t\tlightboxWindow.$\r\n\t\t\t\t.apply(lightboxWindow, this.highlightIDs.split(\",\"))\r\n\t\t\t\t.addClassName(commonspot.err.FIELD_ERROR_CSS_CLASS);\r\n\t\tvar msgs =\r\n\t\t{\r\n\t\t\tfield: \"<dt>\" + this.friendlyName + \"</dt><dd>\" + this.msg.escapeHTML() + \"</dd>\",\r\n\t\t\tuser: \"\",\r\n\t\t\tinternal: \"\"\r\n\t\t};\r\n\t\treturn msgs;\r\n\t};\r\n\r\n\t/*\r\n\t* ErrorCodeMap class, represents a mapping of error codes to error item titles and highlightIDs\r\n\t* use to handle non-validation errors (cmd refusal) as a field error when it's a known code\r\n\t* constructor args let you create first mapping immediately; call addCode to add more if needed\r\n\t*/\r\n\tcommonspot.err.ErrorCodeMap = function(code, itemTitle, highlightIDs)\r\n\t{\r\n\t\tthis.map = {};\r\n\t\tif(code)\r\n\t\t\tthis.addCode(code, itemTitle, highlightIDs);\r\n\t\treturn this;\r\n\t};\r\n\r\n\tcommonspot.err.ErrorCodeMap.prototype.addCode = function(code, itemTitle, highlightIDs)\r\n\t{\r\n\t\tthis.map[code] = {itemTitle: itemTitle, highlightIDs: highlightIDs};\r\n\t};\r\n\r\n\tcommonspot.err.ErrorCodeMap.prototype.getForCode = function(code)\r\n\t{\r\n\t\treturn this.map[code];\r\n\t};\r\n\t\r\n\t/*\r\n\t * namspace for client-side value validators\r\n\t * shouldn't be many of these, most validation is server-side\r\n\t * validators should return passed value if it's valid, else commonspot.err.invalidMsg(\"Some message\")\r\n\t * validators are used by ErrorCollection.checkFieldValue, so far\r\n\t * you can pass checkFieldValue the name of a std validator, or a reference to (not the name of) a custom function \r\n\t */\r\n\tcommonspot.err.validators = {};\r\n\t\r\n\tcommonspot.err.validators.required = function(value)\r\n\t{\r\n\t\tif(value == \"\") // assumes value has been trimmed, as by commonspotLocal.util.getValue\r\n\t\t\tvalue = commonspot.err.invalidMsg(commonspot.err.REQUIRED_MSG);\r\n\t\treturn value;\r\n\t};\r\n\r\n} // commonspot.err not built yet\r\n</script><link id=\"buttons_css\" type=\"text/css\" href=\"/commonspot/dashboard/css/buttons.css\" rel=\"stylesheet\"><link id=\"cs_lightbox_css\" type=\"text/css\" href=\"/commonspot/javascript/lightbox/lightbox.css\" rel=\"stylesheet\"></head><body lang=\"en\" class=\"CS_Document\"><a name=\"__topdoc__\"></a><script src=\"/commonspot/pagemode/always-include-common.js\" type=\"text/javascript\"></script><script src=\"/commonspot/pagemode/always-include-ns.js\" type=\"text/javascript\"></script><div id=\"cs_control_131576\" class=\"cs_control CS_Element_DHTML_Menu\"><script src=\"/commonspot/menu_common.js\" type=\"text/javascript\"></script><script src=\"/dhtmlmenu_pgdefs_2.js\" type=\"text/javascript\"></script><script src=\"/dhtmlmenu_staticmenus_2.js\" type=\"text/javascript\"></script><script src=\"/commonspot/controls/dhtmlmenu/HM_Loader.js\" type=\"text/javascript\"></script><script language=\"JavaScript1.2\" src=\"/commonspot/controls/dhtmlmenu/HM_ScriptDOM.js\" type=\"text/javascript\"></script></div>\n<noscript>\n&lt;iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5TQTBQ\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"&gt;&lt;/iframe&gt;\n</noscript>\n<div id=\"header\">\n<div class=\"wrap-content\">\n<div id=\"header-drop\">\n<div id=\"cs_control_96836\" class=\"cs_control CS_Element_SearchForm\"> <form class=\"CS_SF_Form\" action=\"/Search-Results.cfm\" method=\"POST\" name=\"dlgform96836\" id=\"dlgform96836\" onsubmit=\"doSubmit96836();\" role=\"search\">\n<table class=\"clsControlBorder\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" summary=\"\"> <tbody><tr>\n<td width=\"100%\" valign=\"top\" style=\"text-align:left\"><input id=\"searchType\" name=\"searchType\" type=\"hidden\" value=\"text\"> <div><input id=\"incl_subsites\" name=\"incl_subsites\" type=\"hidden\" value=\"0\">\n<script type=\"text/javascript\">\n<!--\nfunction doLink96836()\n{\nwindow.location.href = '';\n}\nfunction SubmitForm96836()\n{\nretval = doSubmit96836();\nif (retval == true)\ndocument.dlgform96836.submit();\n}\nfunction doSubmit96836()\n{\ndocument.dlgform96836.srchString.value = document.dlgform96836.srchString96836.value;\nif (document.dlgform96836.srchString.value.length == 0)\n{\nalert (\"Please enter something to search for\");\nreturn false;\n}\ndocument.dlgform96836.startpage.value=1;\ndocument.dlgform96836.curpage.value=1;\nreturn true;\n}\n// -->\n</script> <input type=\"text\" name=\"srchString96836\" value=\"Search\" class=\"searchbar-bg\" onclick=\"this.value='';\" onblur=\"this.value=!this.value?'':this.value;\" id=\"cs_search_form\" size=\"20\">\n&nbsp;<input id=\"srchString\" name=\"srchString\" type=\"hidden\" value=\"\"> <input type=\"button\" name=\"searchbutton\" value=\"Go\" onclick=\"SubmitForm96836();\" class=\"searchbar-bg-submit\" size=\"10\">\n</div></td>\n</tr> </tbody></table><input id=\"showSummaryCheckBox\" name=\"showSummaryCheckBox\" type=\"hidden\" value=\"0\"><input id=\"UserSelectedSubSites\" name=\"UserSelectedSubSites\" type=\"hidden\" value=\"\"><input id=\"startpage\" name=\"startpage\" type=\"hidden\" value=\"1\"><input id=\"curpage\" name=\"curpage\" type=\"hidden\" value=\"1\"></form> </div>\n</div>\n<div>\n<div id=\"cs_control_1695\" class=\"CS_Element_Schedule\"><div title=\"\" id=\"CS_Element_logo\"><div id=\"cs_control_122134\" class=\"cs_control CS_Element_Custom\">\n<script type=\"text/javascript\">\n$(document).ready(function() {\n// Get Effect from metadata\neffect = \"none\";\n// Get slide transition speed from metadata\nlogoSpeed = 1 * 1000;\n// Get slide delay time from metadata\ndelayspeed = 5 * 1000;\n$('.slideshow').cycle({\nfx: effect, // choose your transition type, ex: fade, scrollUp, shuffle, etc...\nspeed: logoSpeed,\ntimeout: delayspeed\n});\n});\n</script>\n<div class=\"slideshow\" style=\"position: relative; width: 578px; height: 83px;\">\n<a href=\"/index.cfm\" style=\"position: absolute; top: 0px; left: 0px; display: block; z-index: 3; opacity: 1;\"><img src=\"/images/image.jpg\"></a>\n<a href=\"/index.cfm\" style=\"position: absolute; top: 0px; left: 0px; display: none; z-index: 2;\"><img src=\"/images/image_2.jpg\"></a>\n<a href=\"/index.cfm\" style=\"position: absolute; top: 0px; left: 0px; display: none; z-index: 1;\"><img src=\"/images/image_1_2.jpg\"></a>\n</div>\n</div></div></div>\n</div>\n</div>\n</div>\n<!--googleoff: all-->\n<div id=\"nav-wrap\">\n<div class=\"wrap-content\">\n<ul id=\"nav\">\n<li>\n<a href=\"/Patient/index.cfm\">Patient Care</a>\n<div class=\"dropdown\">\n<div class=\"dropdown-top\"> </div>\n<div class=\"dropdown-bottom\"> </div>\n<div class=\"dropdown-middle clearfix\">\n<ul class=\"dropdown-col dropdown-col-1\">\n<li><h6>Search by Medical Services</h6></li>\n<li><a href=\"/Patient/adult.cfm\">Adult Medical and Surgical</a></li>\n<li><a href=\"/Patient/pediatric.cfm\">Pediatric Medical and Surgical</a></li>\n<li><a href=\"/Patient/other.cfm\">Other Services</a></li>\n<li><a href=\"http://www.emurgentcare.com/\" target=\"_blank\">EmUrgentCare</a></li>\n<li><a href=\"/communitydivision/index.cfm\">Community Providers</a></li>\n<li><hr></li>\n<li><h6>Additional Services</h6></li>\n<li><a href=\"/pathology_labservices/patient_index.cfm\">Laboratory Services</a></li>\n<li><a href=\"/patient/services/pastoralcare/\">Pastoral Care</a></li>\n<li><a href=\"https://www.amc.edu/sPBS/\">Patient Billing</a></li>\n<li><hr></li>\n<li><h6>Main Switchboard</h6></li>\n<li>\nAvailable 24/7 to connect you to all departments and services.<br>\n(518) 262-3125<br><br>\n</li>\n<li><h6>Medical Emergency</h6></li>\n<li>\nEmergency Room at Albany Med<br>\n<a href=\"http://maps.google.com/maps?&amp;daddr=(Emergency Room at Albany Medical Center)&amp;saddr=Place+your+street,+city,+and+state+abbreviation+here&amp;hl=en&amp;sll=42.654059,-73.773687&amp;sspn=0.004506,0.010718&amp;geocode=FaUJjAId0Neb-yFiP0sX20W6zA%3BFTXYigIdFkia-w&amp;mra=dme&amp;mrsp=1&amp;sz=17&amp;t=m&amp;z=17\" target=\"_blank\">Map</a> | (518) 262-3131<br>\nAlways Open<br>\n<br>\n</li>\n<li><h6>Malta Med</h6></li>\n<li>\n6 Medical Park Drive<br>\nMalta NY 12020<br>\n<a href=\"http://maltamed.org/map/\" target=\"_blank\">Map</a> | (518) 289-2024<br>\nOpen 7 Days a Week\n</li>\n</ul>\n<ul class=\"dropdown-col \">\n<li><h6>Find a Doctor</h6></li>\n<li><a href=\"/PhysicianDirectory/index.cfm?event=browseNames&amp;perpage=15&amp;lastNameStartsWith=&amp;who=amc&amp;orderBy=faculty&amp;orderRev=0\">Albany Med Physicians</a></li>\n<li><hr></li>\n<li><h6>Why Choose an Albany Med Faculty Physician?</h6></li>\n<li><a href=\"/Patient/services/albany_med_faculty_physicians/\">Learn More</a></li>\n<li><hr></li>\n<li><h6>Plan Your Visit</h6></li>\n<li><a href=\"/Patient/patient_guide/\">Patient &amp; Visitor Guide</a></li>\n<li><a href=\"/maps_directions/\">Directions &amp; Locations</a></li>\n<li><a href=\"/Patient/forms_policy.cfm\">Faculty Physicians Patient Forms</a></li>\n<li><a href=\"/Patient/services/anesthesiology/videos/preop_screening_video.cfm\">Preparing for Surgery</a></li>\n<li><hr></li>\n<li><h6>Patient Portal</h6></li>\n<li><a href=\"/myalbanymed/\">myAlbanyMed</a></li>\n<li><hr></li>\n<li><h6>Healthy Community</h6></li>\n<li><a href=\"/healthy_life/\">Seminars &amp; Screenings</a></li>\n<li><a href=\"/Calendar/\">Online Calendar</a></li>\n<li><hr></li>\n<li><h6>Contact Us</h6></li>\n<li>\n<a href=\"/ContactUs/index.cfm\">Albany Medical Center Phone Directory</a>\n</li>\n</ul>\n</div>\n</div>\n</li>\n<li>\n<a class=\"two-line\" href=\"/Physicians/index.cfm\">For Medical<br>Professionals</a>\n<div class=\"dropdown\">\n<div class=\"dropdown-top\"> </div>\n<div class=\"dropdown-bottom\"> </div>\n<div class=\"dropdown-middle clearfix\">\n<ul class=\"dropdown-col dropdown-col-1\">\n<li><h6>Find a Doctor</h6></li>\n<li><a href=\"/PhysicianDirectory/index.cfm?event=browseNames&amp;perpage=15&amp;lastNameStartsWith=&amp;who=amc&amp;orderBy=faculty&amp;orderRev=0\">Online Physicians Directory</a></li>\n<li><hr></li>\n<li><h6>For Physicians</h6></li>\n<li><a href=\"/for_physicians/index.cfm\">Information for Referring Physicians</a></li>\n<li><a href=\"/for_physicians/referring_patients.cfm\">Referring a Patient</a></li>\n<li><hr></li>\n<li><h6>Access Center</h6></li>\n<li>\n24/7 Access Made Easy<br>\nThe Access Center at Albany Med facilitates patient transfers from other health care facilities to Albany Medical Center Hospital.\t\t\t</li>\n<li><a href=\"/for_physicians/access_center/index.cfm\">Learn More</a></li>\n</ul>\n<ul class=\"dropdown-col \">\n<li><h6>Health Care Professionals Recruitment</h6></li>\n<li><a href=\"/physicianrecruitment/\">Physician Recruitment</a></li>\n<li><a href=\"/nursingrecruitment/\">Nursing Recruitment</a></li>\n<li><hr></li>\n<li><h6>Additional Links</h6></li>\n<li><a href=\"/for_physicians/training_resources.cfm\">Education and Training Opportunities</a></li>\n<li><a href=\"/Academic/EMS/\">Emergency Medical Services</a></li>\n<li><a href=\"/emergency_preparedness/\">Emergency Preparedness</a></li>\n<li><a href=\"/physicianrecruitment/new_provider_docs.cfm\">New Provider Documents</a></li>\n<li><a href=\"/pathology_labservices/index.cfm\">Pathology and Laboratory Services</a></li>\n<li><hr></li>\n<li><h6>Contact Us</h6></li>\n<li><a href=\"/ContactUs/index.cfm\">Albany Medical Center Phone Directory</a></li>\n</ul>\n</div>\n</div>\n</li>\n<li>\n<a class=\"two-line\" href=\"/Academic/index.cfm\">Education &amp; Training</a>\n<div class=\"dropdown\">\n<div class=\"dropdown-top\"> </div>\n<div class=\"dropdown-bottom\"> </div>\n<div class=\"dropdown-middle clearfix\">\n<ul class=\"dropdown-col dropdown-col-1\">\n<li><h6>Our Programs</h6></li>\n<li><a href=\"/Academic/Undergraduate/\">Undergraduate Medical Education</a></li>\n<li><a href=\"/Academic/GraduateStudies/\">Graduate Studies</a></li>\n<li><a href=\"/Academic/GME/\">GME Residencies and Fellowships</a></li>\n<li><a href=\"/Academic/bioethics/\">Alden March Bioethics Institute</a></li>\n<li><a href=\"/Academic/PsychologyInternship/\">Albany Psychology Internship Consortium</a></li>\n<li><hr></li>\n<li><h6>Contact Us</h6></li>\n<li><a href=\"/ContactUs/College_Phone_Directory.cfm\">Albany Medical College Phone Directory</a></li>\n<li><hr></li>\n<li><h6>Campus Safety</h6></li>\n<li><a href=\"/CampusSafety/\">Campus Safety at Albany Medical Center and Albany Medical College</a></li>\n</ul>\n<ul class=\"dropdown-col \">\n<li><h6>Additional Links</h6></li>\n<li><a href=\"/Academic/DeansMessage/\">A Message From the Dean</a></li>\n<li><a href=\"/Academic/academic_leadership/\">Academic Leadership</a></li>\n<li><a href=\"http://alumni.amc.edu/\">Alumni Association</a></li>\n<li><a href=\"/AnatomicalGift/\">Anatomical Gift Program </a></li>\n<li><a href=\"/Academic/Commencement/\">Commencement Ceremony</a></li>\n<li><a href=\"/Academic/PSCCC/\">Patient Safety and Clinical Competency Center</a></li>\n<li><a href=\"/Academic/upload/Consumer-Information-AMC-Matriculated-Student-Enrollment-tables.pdf\" target=\"_blank\">Consumer Information - Student Enrollment Tables (PDF)</a></li>\n<li><a href=\"/patient/services/PastoralCare/clinical_pastoral_education.cfm\">Pastoral Care</a></li>\n<li><a href=\"/Academic/CME/\">Continuing Medical Education</a></li>\n<li><a href=\"/Academic/Schaffer/\">Schaffer Library of Health Sciences</a></li>\n<li><a href=\"http://www.amcbacc.org/\">Biomedical Acceleration and Commercialization Center</a></li>\n<li><a href=\"/NursingRecruitment/nurse_education.cfm\">Center for Learning and Development</a></li>\n<li><a href=\"/Academic/STEP/\">STEP - New York State Science and Technology Entry Program</a></li>\n</ul>\n</div>\n</div>\n</li>\n<li>\n<a href=\"/Research/index.cfm\">Research</a>\n<div class=\"dropdown\">\n<div class=\"dropdown-top\"> </div>\n<div class=\"dropdown-bottom\"> </div>\n<div class=\"dropdown-middle clearfix\">\n<ul class=\"dropdown-col dropdown-col-1\">\n<li><h6>Basic Science Departments</h6></li>\n<li><a href=\"/Research/IMD/\">Immunology and Microbial Disease</a></li>\n<li><a href=\"/Research/MCP/\">Molecular and Cellular Physiology</a></li>\n<li><a href=\"/Research/DNET/\">Neuroscience and Experimental Therapeutics</a></li>\n<li><a href=\"/Research/RCCB/\">Regenerative and Cancer Cell Biology</a></li>\n<li><hr></li>\n<li><h6>Advancing the Quest for Cures</h6></li>\n<li><a href=\"/Research/clinTrials.cfm\">Clinical Trials</a></li>\n<li><hr></li>\n<li><h6>Services</h6></li>\n<li><a href=\"/Research/histology/\">Histology Core Services</a></li>\n<li><hr></li>\n<li><h6>Faculty Research</h6></li>\n<li><a href=\"/Profiles/researcher/faculty_research_directory.cfm\">Faculty Research Directory</a></li>\n</ul>\n<ul class=\"dropdown-col \">\n<li><h6>Albany Medical Center Prize in Medicine</h6></li>\n<li><a href=\"/Academic/AlbanyPrize/\">Introduction</a></li>\n<li><a href=\"/Academic/AlbanyPrize/prize_criteria.cfm\">Prize Criteria</a></li>\n<li><hr></li>\n<li><h6>Albany Medical College</h6></li>\n<li><a href=\"/Academic/bioethics/\">Alden March Bioethics Institute</a></li>\n<li><a href=\"http://alumni.amc.edu/\">Alumni Association</a></li>\n<li><a href=\"/Academic/GraduateStudies/\">Graduate Studies</a></li>\n<li><a href=\"/Academic/Schaffer/\">Schaffer Library of Health Sciences</a></li>\n<li><a href=\"/Academic/SosaAcademy/\">Sosa Academy of Medical Sciences</a></li>\n<li><h6>Additional Links</h6></li>\n<li><a href=\"http://www.amcbacc.org/\">Biomedical Acceleration and Commercialization Center</a></li>\n</ul>\n</div>\n</div>\n</li>\n</ul>\n<a class=\"btn btn-amc\" href=\"/PhysicianDirectory/index.cfm?event=browseNames&amp;perpage=15&amp;lastNameStartsWith=&amp;who=amc&amp;orderBy=faculty&amp;orderRev=0\">Find a Doctor</a>\n<a class=\"btn btn-amc\" href=\"/myalbanymed/\">myAlbanyMed</a>\n</div>\n</div>\n<div id=\"sub-header\">\n<div class=\"wrap-content\">\n<a name=\"DepartmentLinkBar\" id=\"DepartmentLinkBar\"></a><a name=\"CP_JUMP_3394\" id=\"CP_JUMP_3394\"></a><div id=\"cs_control_3394\" class=\"cs_control CS_Element_LinkBar\">\n<div id=\"sub-header\">\n<a onmouseover=\"setStatbar('/index.cfm');return true;\" onmouseout=\" setStatbar('');return true;\" class=\"CS_LinkBar_Item\" href=\"/index.cfm\">\nHome\n</a>\n<span class=\"CS_LinkBar_Separator\"> &nbsp;|&nbsp; </span>\n<a onmouseover=\"setStatbar('/maps_directions/index.cfm');return true;\" onmouseout=\" setStatbar('');return true;\" class=\"CS_LinkBar_Item\" href=\"/maps_directions/index.cfm\">\nDirections\n</a>\n<span class=\"CS_LinkBar_Separator\"> &nbsp;|&nbsp; </span>\n<a onmouseover=\"setStatbar('/HR/index.cfm');return true;\" onmouseout=\" setStatbar('');return true;\" class=\"CS_LinkBar_Item\" href=\"/HR/index.cfm\">\nFind a Job\n</a>\n<span class=\"CS_LinkBar_Separator\"> &nbsp;|&nbsp; </span>\n<a onmouseover=\"setStatbar('/PR/index.cfm');return true;\" onmouseout=\" setStatbar('');return true;\" class=\"CS_LinkBar_Item\" href=\"/PR/index.cfm\">\nNews\n</a>\n<span class=\"CS_LinkBar_Separator\"> &nbsp;|&nbsp; </span>\n<a onmouseover=\"setStatbar('/foundation/index.cfm');return true;\" onmouseout=\" setStatbar('');return true;\" class=\"CS_LinkBar_Item\" href=\"/foundation/index.cfm\">\nGive Now\n</a>\n<span class=\"CS_LinkBar_Separator\"> &nbsp;|&nbsp; </span>\n<a onmouseover=\"setStatbar('/video/video_library.cfm');return true;\" onmouseout=\" setStatbar('');return true;\" class=\"CS_LinkBar_Item\" href=\"/video/video_library.cfm\">\nVideo\n</a>\n<span class=\"CS_LinkBar_Separator\"> &nbsp;|&nbsp; </span>\n<a onmouseover=\"setStatbar('http://www.emurgentcare.com');return true;\" onmouseout=\" setStatbar('');return true;\" class=\"CS_LinkBar_Item\" href=\"http://www.emurgentcare.com\">\nEmUrgentCare\n</a>\n<span class=\"CS_LinkBar_Separator\"> &nbsp;|&nbsp; </span>\n<span id=\"deptbutton8\" class=\"CS_LinkBar_Item deptbutton\" onmouseout=\"document.getElementById('sub-nav').style.visibility='hidden'; document.getElementById('deptbutton8').style.backgroundImage='none'\" onmouseover=\"document.getElementById('sub-nav').style.visibility='visible'; document.getElementById('deptbutton8').style.backgroundImage='url(/images/dropdown-middle.png)'\" style=\"background-image: none;\">\nChoose a Department\n</span>\n<ul id=\"sub-nav\" onmouseout=\"document.getElementById('sub-nav').style.visibility='hidden'; document.getElementById('deptbutton8').style.backgroundImage='none'\" onmouseover=\"document.getElementById('sub-nav').style.visibility='visible'; document.getElementById('deptbutton8').style.backgroundImage='url(/images/dropdown-middle.png)'\" style=\"visibility: hidden;\">\n<li>\n<div class=\"subnav-dropdown\">\n<div class=\"subnav-dropdown-top\"> </div>\n<div class=\"subnav-dropdown-bottom\"> </div>\n<div class=\"subnav-dropdown-middle clearfix\">\n<div>\n<ul class=\"subnav-dropdown-col subnav-dropdown-col-1\">\n<li style=\"color: red;\"><a href=\"/Departments/Anesthesiology/index.cfm\">Anesthesiology</a></li>\n<li style=\"color: red;\"><a href=\"/Departments/Emergency_Medicine/index.cfm\">Emergency Medicine</a></li>\n<li style=\"color: red;\"><a href=\"/Departments/Family_Practice/index.cfm\">Family Practice</a></li>\n<li style=\"color: red;\"><a href=\"/Departments/Medicine/index.cfm\">Medicine</a></li>\n<li style=\"color: red;\"><a href=\"/Departments/neurology/index.cfm\">Neurology</a></li>\n<li style=\"color: red;\"><a href=\"/Departments/neurosurgery/index.cfm\">Neurosurgery</a></li>\n<li style=\"color: red;\"><a href=\"/Departments/obgyn/index.cfm\">OB/GYN</a></li>\n<li style=\"color: red;\"><a href=\"/Departments/pathology/index.cfm\">Pathology</a></li>\n<li style=\"color: red;\"><a href=\"/Departments/pediatrics/index.cfm\">Pediatrics</a></li>\n<li style=\"color: red;\"><a href=\"/Departments/pmr/index.cfm\">Physical Medicine and Rehabilitation</a></li>\n<li style=\"color: red;\"><a href=\"/Departments/psychiatry/index.cfm\">Psychiatry</a></li>\n<li style=\"color: red;\"><a href=\"/Departments/radiology/index.cfm\">Radiology</a></li>\n<li style=\"color: red;\"><a href=\"/Departments/surgery/index.cfm\">Surgery</a></li>\n</ul>\n</div>\n</div>\n</div>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n\n<!--googleon: all-->\n<!-- General survey -->\n<div class=\"modal fade\" id=\"generalSurvey\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\">\n<div class=\"modal-dialog\">\n<div id=\"generalSurveyContent\" class=\"modal-content\">\n<div class=\"modalHeader\">\n<div class=\"buttonWrapper\">\n<div class=\"surveyButton\">\n<img src=\"/modal/images/take-survey.png\" id=\"takeSurvey\" alt=\"Yes, take survey\">\n</div>\n<div class=\"surveyButton\">\n<img src=\"/modal/images/not-now.png\" id=\"notNow\" alt=\"Not now\">\n</div>\n<div class=\"surveyButton\">\n<img src=\"/modal/images/no-thanks.png\" id=\"noReminder\" alt=\"No thanks\">\n</div>\n</div>\n</div>\n<div class=\"modalButtons\">\n</div>\n</div>\n</div>\n</div>\n<!-- Provider search survey -->\n<div class=\"modal fade\" id=\"providerSearchSurvey\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\">\n<div class=\"modal-dialog\">\n<div id=\"providerSurveyContent\" class=\"modal-content\">\n<div class=\"modalHeaderProvider\">\n<div class=\"buttonWrapper\">\n<div class=\"surveyButton\">\n<img src=\"/modal/images/take-survey.png\" id=\"providerTakeSurvey\" alt=\"Yes, take survey\">\n</div>\n<div class=\"surveyButton\">\n<img src=\"/modal/images/not-now.png\" id=\"providerNotNow\" alt=\"Not now\">\n</div>\n<div class=\"surveyButton\">\n<img src=\"/modal/images/no-thanks.png\" id=\"providerNoReminder\" alt=\"No thanks\">\n</div>\n</div>\n</div>\n<div class=\"modalButtons\">\n</div>\n</div>\n</div>\n</div>\n<a href=\"\" style=\"display:none;\" id=\"survey1\" class=\"btn btn-primary btn-lg\" data-toggle=\"modal\" data-target=\"#generalSurvey\" data-backdrop=\"static\" data-keyboard=\"false\"></a>\n<a href=\"\" style=\"display:none;\" id=\"survey2\" class=\"btn btn-primary btn-lg\" data-toggle=\"modal\" data-target=\"#providerSearchSurvey\" data-backdrop=\"static\" data-keyboard=\"false\"></a>\n<!-- Main Body Content starts here -->\n<div id=\"content-main-wrap-inner\" class=\"inner-page\">\n<div id=\"cs_control_1662\" class=\"CS_Element_Schedule\"><div title=\"\" id=\"CS_Element_mainbodycontent\"><div id=\"cs_control_3016\" class=\"cs_control CS_Element_Custom\">\n<div id=\"slideshow\">\n<div id=\"slideshow-window\" class=\"wrap-content\">\n<a id=\"slideshow-nav-left\" href=\"javascript:void(0)\">&nbsp;</a>\n<a id=\"slideshow-nav-right\" href=\"javascript:void(0)\">&nbsp;</a>\n<div id=\"slideshow-text-wrap\">\n<ul id=\"slideshow-text\">\n<li id=\"slideshow-slide1-text\" style=\"display: list-item; opacity: 0.860622;\">\n<h2>Put Your Money Where the Miracles Are!</h2>\n<p>Tune in to News Radio 810 &amp; 103.1 WGY and 99.5 The River May 4-5 to help raise funds for the Bernard &amp; Millie Duker Children’s Hospital at Albany Medical Center. Be a miracle maker!</p>\n<a class=\"btn btn-amc\" href=\"javascript:;\" onclick=\"csExtendedWindow('_blank','https://community.amc.edu/radiothon','');\"><span><span>Learn More </span></span></a>\n</li>\n<li id=\"slideshow-slide2-text\" style=\"display: none;\">\n<h2>New Niskayuna Medical Facility Will Serve Many Needs</h2>\n<p>The new 1769 Union Street facility will offer urgent care, laboratory services and outpatient surgery, as well as gastroenterology and cardiac care. </p>\n<a class=\"btn btn-amc\" href=\"/news/niskayuna_emurgentcare_ribbon_cutting.cfm\"><span><span>Learn More</span></span></a>\n</li>\n<li id=\"slideshow-slide3-text\" style=\"display: none;\">\n<h2>Albany Med Voted Best Hospital in Capital Region</h2>\n<p>For three years in a row, Capital Region residents have chosen Albany Med as the “best hospital” through the Albany Times Union’s “Best of” Survey. Thank you!</p>\n<a class=\"btn btn-amc\" href=\"/aboutus/best_hospital_in_capital_region/index.cfm\"><span><span>Learn More</span></span></a>\n</li>\n<li id=\"slideshow-slide4-text\" style=\"display: none;\">\n<h2>Albany Med Announces Groundbreaking Collaboration</h2>\n<p>Albany Med joins forces with the American Heart Association to be part of the first-ever “Life is Why” campaign in the Capital Region. </p>\n<a class=\"btn btn-amc\" href=\"/American-Heart-Association-Collaboration/index.cfm\"><span><span>Learn More</span></span></a>\n</li>\n<li id=\"slideshow-slide5-text\" style=\"display: none;\">\n<h2>Plans Announced for New Pediatric Emergency Department</h2>\n<p>Albany Med announces details for the only Pediatric Emergency Department in northeastern New York and western New England.</p>\n<a class=\"btn btn-amc\" href=\"/news/first-pediatric-emergency-department-in-region.cfm\"><span><span>Learn More</span></span></a>\n</li>\n</ul>\n<ul id=\"slideshow-control\">\n<li>\n<a rel=\"slideshow-slide1\" href=\"javascript:void(0);\" class=\"selected\">&nbsp;</a>\n</li>\n<li>\n<a rel=\"slideshow-slide2\" href=\"javascript:void(0);\">&nbsp;</a>\n</li>\n<li>\n<a rel=\"slideshow-slide3\" href=\"javascript:void(0);\">&nbsp;</a>\n</li>\n<li>\n<a rel=\"slideshow-slide4\" href=\"javascript:void(0);\">&nbsp;</a>\n</li>\n<li>\n<a rel=\"slideshow-slide5\" href=\"javascript:void(0);\">&nbsp;</a>\n</li>\n</ul>\n</div>\n<ul id=\"slideshow-images\">\n<li id=\"slideshow-slide1\" style=\"display: block; opacity: 0.528489;\">\n<a href=\"javascript:;\" onclick=\"csExtendedWindow('_blank','https://community.amc.edu/radiothon','');\"><img src=\"/images/RadioThon17_webBillboard_880x400.jpg\" alt=\"Learn More \" width=\"880\" height=\"400\"></a>\n</li>\n<li id=\"slideshow-slide2\" style=\"display: none;\">\n<a href=\"/news/niskayuna_emurgentcare_ribbon_cutting.cfm\"><img src=\"/images/nisky_ribbon_cutting.jpg\" alt=\"Learn More\" width=\"880\" height=\"400\"></a>\n</li>\n<li id=\"slideshow-slide3\" style=\"display: none;\">\n<a href=\"/aboutus/best_hospital_in_capital_region/index.cfm\"><img src=\"/images/Bestof17_billboard.jpg\" alt=\"Learn More\" width=\"880\" height=\"400\"></a>\n</li>\n<li id=\"slideshow-slide4\" style=\"display: none;\">\n<a href=\"/American-Heart-Association-Collaboration/index.cfm\"><img src=\"/images/life_is_why_billboard.jpg\" alt=\"Learn More\" width=\"880\" height=\"400\"></a>\n</li>\n<li id=\"slideshow-slide5\" style=\"display: none;\">\n<a href=\"/news/first-pediatric-emergency-department-in-region.cfm\"><img src=\"/images/peds_ed_billboard.jpg\" alt=\"Learn More\" width=\"880\" height=\"400\"></a>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"clearer\"></div>\n</div>\n<div class=\"clearer\"></div>\n</div>\n</div></div>\n<div id=\"content-main-wrap\" class=\"clearfix\">\n<div id=\"content-main\" class=\"wrap-content three-col clearfix\">\n<div class=\"col col-1 col-color-gray clearfix\">\n<div class=\"text-wrap-outside\">\n<div class=\"text-wrap\" style=\"min-height: 689px; height: 709px;\">\n<div id=\"cs_control_1722\" class=\"cs_control CS_Element_Textblock\"> <div class=\"CS_Textblock_Text\"><section id=\"csPasteInner\">\n<h3>Why Albany Med?</h3>\n<div>\n<div>\n<p align=\"center\"><img title=\"why albany med 01\" border=\"0\" hspace=\"0\" alt=\"why albany med 01\" vspace=\"0\" src=\"/images/why_albany_med_01.jpg\" width=\"138\" height=\"140\">&nbsp;&nbsp;<img title=\"why albany med 02\" border=\"0\" hspace=\"0\" alt=\"why albany med 02\" vspace=\"0\" src=\"/images/why_albany_med_02.jpg\" width=\"138\" height=\"140\"><br></p><p>\nAlbany Medical Center is the only academic medical center in the\nregion. It is our commitment to provide the highest level of\npatient care, education and biomedical research to the people of\nour community and beyond.&nbsp;</p><a class=\"CP___PAGEID_129975 amcBtn\" href=\"/aboutus/index.cfm\">About Us</a><a class=\"CP___PAGEID_15670 amcBtn\" href=\"/PhysicianDirectory/index.cfm\">Physician Directory</a><a class=\"CP___PAGEID_124877 amcBtn\" href=\"/PR/index.cfm\">Latest News</a>\n<a class=\"CP___PAGEID_129993 amcBtn\" href=\"/video/index.cfm\">Latest Videos</a><hr title=\"\" align=\"center\" color=\"#000000\" size=\"1\"><p align=\"center\">\n&nbsp;&nbsp;&nbsp;&nbsp;\t<a class=\"CP___PAGEID_25717\" onmouseover=\"return self.status='/patient/services/childrens_hospital/index.cfm'\" href=\"/patient/services/childrens_hospital/index.cfm\"><img class=\"CP___PAGEID_25717\" title=\"Childrens Hospital Logo\" border=\"0\" hspace=\"0\" alt=\"Childrens Hospital Logo\" vspace=\"0\" src=\"/images/ch_hospital_duker_286x145_1.png\" width=\"286\" height=\"145\"></a><a href=\"/patient/services/childrens_hospital/index.cfm\"></a></p><p>\n<a href=\"http://www.amc.edu/Patient/services/childrens_hospital/\"></a></p><a class=\"CP___PAGEID_25717 amcBtn\" href=\"/patient/services/childrens_hospital/index.cfm\">The Children's Hospital at Albany Med</a>\n</div>\n</div>\n</section></div> </div>\n</div>\n</div>\n</div>\n<div class=\"col col-2 col-color-dark-blue clearfix\">\n<div class=\"text-wrap-outside\">\n<div class=\"text-wrap\" style=\"min-height: 689px; height: 709px;\">\n<div id=\"cs_control_1724\" class=\"cs_control CS_Element_Textblock\"> <div class=\"CS_Textblock_Text\"><section id=\"csPasteInner\">\n<h3><font color=\"#ffffff\">Find an Albany Med Doctor</font></h3><p align=\"center\">\n<img src=\"/images/cardiac_surgeon.jpg\" alt=\"Cardiac Surgeon\" title=\"Cardiac Surgeon\" border=\"0\" height=\"150\" hspace=\"0\" vspace=\"0\" width=\"286\"><br>\n</p>\n<div>\n<div>\n<h4>Find a Doctor</h4>\n<p>\nAlbany Med has more than 450 board-certified physicians who are among the most expert in their field.\n</p>\n<p>\n<a style=\"\" class=\"CP___PAGEID_15670 amcBtn\" href=\"/PhysicianDirectory/index.cfm\">Find a Doctor</a></p><hr><h4>Why Choose an Albany Med Faculty Physician?\n</h4><p>\nAlbany Med Faculty Physicians, an elite group of experts, offer\ninpatient and outpatient consultations and treatments covering a wide\nrange of specialties and care for patients from a simple health check up\nto emergency treatment.</p><p>\n<a style=\"\" class=\"CP___PAGEID_130305 amcBtn\" href=\"/patient/services/albany_med_faculty_physicians/index.cfm\">Learn More</a></p><p align=\"center\">\n<img src=\"/images/home-find-doctor.jpg\" alt=\"Find a Doctor\" title=\"Find a Doctor\" border=\"0\" height=\"150\" hspace=\"0\" vspace=\"0\" width=\"286\"><br>\n</p></div>\n</div>\n</section></div> </div>\n</div>\n</div>\n</div>\n<div class=\"col col-3 col-color-gray clearfix\">\n<div class=\"text-wrap-outside\">\n<div class=\"text-wrap\" style=\"min-height: 689px; height: 709px;\">\n<div id=\"cs_control_1726\" class=\"cs_control CS_Element_Textblock\"> <div class=\"CS_Textblock_Text\"><section id=\"csPasteInner\">\n<div>\n<h4>Careers</h4><p align=\"center\">\n<img title=\"Main 3\" alt=\"Main 3\" src=\"/images/main_3.jpg\" width=\"286\" vspace=\"0\" border=\"0\" hspace=\"0\" height=\"150\"><br>\n</p><h4>Join Our Team</h4>\n<p>\nWith over 9,000 employees, Albany Medical Center is committed to advancing our\nworkforce and providing exciting job opportunities for individuals.<a class=\"CP___PAGEID_52021 amcBtn\" href=\"/HR/index.cfm\">Search Job Openings</a>\n</p><hr><br><h4>Albany Med is My Lifeline</h4><span><strong><em><a class=\"CP___PAGEID_137062\" onmouseover=\"return self.status='/foundation/lifeline/Patient_Stories/michelle_woodley_video.cfm'\" href=\"/foundation/lifeline/Patient_Stories/michelle_woodley_video.cfm\"><img class=\"CP___PAGEID_137062\" title=\"Michelle Woodley\" alt=\"Michelle Woodley\" src=\"/images/michelle_woodley_button_138.jpg\" width=\"138\" vspace=\"0\" border=\"0\" hspace=\"0\" height=\"140\"></a> <a class=\"CP___PAGEID_137192\" onmouseover=\"return self.status='/foundation/lifeline/Patient_Stories/ralph_erenzo_video.cfm'\" href=\"/foundation/lifeline/Patient_Stories/ralph_erenzo_video.cfm\"><img class=\"CP___PAGEID_137192\" title=\"Ralph Erenzo\" alt=\"Ralph Erenzo\" src=\"/images/ralph_erenzo_button_138.jpg\" width=\"138\" vspace=\"0\" border=\"0\" hspace=\"0\" height=\"140\"></a><br><br>\"We are thankful that Albany Med is here. It's our lifeline.\"</em></strong>\n</span>\n<p> Hear the stories of patients who have counted on Albany Med\nfor life-saving care. Please click below to watch and read their\nstories.<a href=\"http://www.amc.edu/foundation/lifeline/patient_stories/lifeline_patient_videos.cfm?bcpid=3297171087001&amp;bclid=3840493898001&amp;bctid=4193939661001\">&nbsp;&nbsp;\n</a><a class=\"CP___PAGEID_848205 amcBtn\" href=\"/foundation/lifeline/Patient_Stories/index.cfm\" style=\"\">Albany Med is My Lifeline</a>\n</p></div>\n</section></div> </div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<!-- Main Body Content Ends here -->\n\n&nbsp;\n<div id=\"footer-top\">\n<div class=\"wrap-content\">\n<div id=\"footer-top-tagline\">\nSupport Albany Medical Center:\n</div>\n<a class=\"icon-lifeline\" href=\"/foundation/\">Give Now</a>\n</div>\n</div>\n<div id=\"footer\">\n<div class=\"clearfix\">\n<div class=\"footer-bottom block-center\" align=\"center\">\n<a href=\"/AboutUs/best_hospital_in_capital_region/\">\n<img alt=\"Best of The Capital Region\" src=\"/images/Best_Of_Capital_Region_2.png\" style=\"padding:0 40px 20px 0\">\n</a>\n<a href=\"/American-Heart-Association-Collaboration/index.cfm\">\n<img alt=\"life is why\" src=\"/images/life-is-why-footer.png\" style=\"padding-left:80px\">\n</a>\n</div>\n</div>\n<!-- FOOTER LINKS begin -->\n<div class=\"wrap-content\">\n<div class=\"footer-top-sec clearfix\">\n<div class=\"footer-link-block\">\n<h5>\n<div id=\"cs_control_1671\" class=\"cs_control CS_Element_Textblock\"> <div class=\"CS_Textblock_Text\">Sections and Services</div> </div>\n</h5>\n<div id=\"cs_control_1677\" class=\"cs_control CS_Element_LinkBar\">\n<ul>\n<li>\n<a href=\"/patient/index.cfm\">\nPatients\n</a>\n</li>\n<li>\n<a href=\"/sPBS/index.cfm\">\nPatient Billing\n</a>\n</li>\n<li>\n<a href=\"/MedicalProfessionals/index.cfm\">\nFor Medical Professionals\n</a>\n</li>\n<li>\n<a href=\"/academic/index.cfm\">\nEducation &amp; Training\n</a>\n</li>\n<li>\n<a href=\"/Research\">\nResearch\n</a>\n</li>\n<li>\n<a href=\"/PhysicianDirectory/index.cfm\">\nFind a Doctor\n</a>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"footer-link-block\">\n<h5>\n<div id=\"cs_control_1673\" class=\"cs_control CS_Element_Textblock\"> <div class=\"CS_Textblock_Text\">Information For</div> </div>\n</h5>\n<div id=\"cs_control_1678\" class=\"cs_control CS_Element_LinkBar\">\n<ul>\n<li>\n<a href=\"/HR/careers.cfm\">\nCareer Opportunities\n</a>\n</li>\n<li>\n<a href=\"/patient/Volunteer/index.cfm\">\nVolunteer Opportunities\n</a>\n</li>\n<li>\n<a href=\"/patient/patient_guide/index.cfm\">\nPatients &amp; Family\n</a>\n</li>\n<li>\n<a href=\"http://alumni.amc.edu\">\nAlumni Assoc. Members\n</a>\n</li>\n<li>\n<a href=\"/foundation/make_a_gift.cfm\">\nDonors\n</a>\n</li>\n<li>\n<a href=\"/purchasing/index.cfm\">\nVendors\n</a>\n</li>\n<li>\n<a href=\"https://wcms.amc.edu/login.cfm\">\nEditors\n</a>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"footer-link-block\">\n<h5>\n<div id=\"cs_control_1674\" class=\"cs_control CS_Element_Textblock\"> <div class=\"CS_Textblock_Text\">About Us</div> </div>\n</h5>\n<div id=\"cs_control_1679\" class=\"cs_control CS_Element_LinkBar\">\n<ul>\n<li>\n<a href=\"/aboutus/index.cfm\">\nAbout Albany Med\n</a>\n</li>\n<li>\n<a href=\"/maps_directions/index.cfm\">\nDirections &amp; Locations\n</a>\n</li>\n<li>\n<a href=\"/maps_directions/maps.cfm\">\nMaps\n</a>\n</li>\n<li>\n<a href=\"/aboutus/publicpolicy/index.cfm\">\nPolicies, Notices &amp; Terms\n</a>\n</li>\n<li>\n<a href=\"/leadership/JamesJBarba/index.cfm\">\nAlbany Med Leadership\n</a>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"footer-link-block\">\n<h5>\n<div id=\"cs_control_1675\" class=\"cs_control CS_Element_Textblock\"> <div class=\"CS_Textblock_Text\">What's New</div> </div>\n</h5>\n<div id=\"cs_control_1680\" class=\"cs_control CS_Element_LinkBar\">\n<ul>\n<li>\n<a href=\"/PR/index.cfm\">\nLatest News\n</a>\n</li>\n<li>\n<a href=\"/video/video_library.cfm\">\nLatest Videos\n</a>\n</li>\n<li>\n<a href=\"/PR/albany_med_today/index.cfm\">\nAlbany Med Today\n</a>\n</li>\n<li>\n<a href=\"/Calendar\">\nCalendar: Events &amp; Classes\n</a>\n</li>\n<li>\n<a href=\"/foundation/events/index.cfm\">\nFund Raising Events\n</a>\n</li>\n</ul>\n</div>\n</div>\n<div class=\"footer-link-block\">\n<h5>\n<div id=\"cs_control_1676\" class=\"cs_control CS_Element_Textblock\"> <div class=\"CS_Textblock_Text\">We're Here for You</div> </div>\n</h5>\n<div id=\"cs_control_1681\" class=\"cs_control CS_Element_LinkBar\">\n<ul>\n<li>\n<a href=\"/contactus/index.cfm\">\nContact Albany Medical Center\n</a>\n</li>\n<li>\n<a href=\"/contactus/College_Phone_Directory.cfm\">\nContact Albany Medical College\n</a>\n</li>\n<li>\n<a href=\"/AskAQuestion/index.cfm\">\nAsk a Question\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<!-- FOOTER LINKS end -->\n<div class=\"clearfix wrap-content\">\n<div class=\"footer-bottom block-center-bottom\">\n<a href=\"/AboutUs/best_hospital_in_capital_region/\">\n<img alt=\"Albany Medical Center\" src=\"/images/brandmark_2color_horizontal_footer.png\">\n</a>\n<br> 43 New Scotland Avenue &nbsp;&nbsp; Albany, NY 12208 &nbsp;&nbsp;<strong>518-262-3125</strong>\n<br>© 2017 Albany Medical Center. Some Rights Reserved. <p></p>\n<div class=\"copyright\" style=\"display:none\">\n<img src=\"/images/brandmark_2color_horizontal_footer.png\">\n<br>43 New Scotland Avenue &nbsp;&nbsp; Albany, NY 12208 &nbsp;&nbsp;<strong>518-262-3125</strong>\n<br> © 2017 Albany Medical Center. Some Rights Reserved.\n</div>\n</div>\n<div class=\"footer-bottom block-center-bottom footer-bottom-searchbar-wrap\">\n<div id=\"cs_control_96847\" class=\"cs_control CS_Element_SearchForm\"> <form class=\"CS_SF_Form\" action=\"/Search-Results.cfm\" method=\"POST\" name=\"dlgform96847\" id=\"dlgform96847\" onsubmit=\"doSubmit96847();\" role=\"search\">\n<table class=\"clsControlBorder\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" summary=\"\"> <tbody><tr>\n<td width=\"100%\" valign=\"top\" style=\"text-align:left\"><input id=\"searchType\" name=\"searchType\" type=\"hidden\" value=\"text\"> <div><input id=\"incl_subsites\" name=\"incl_subsites\" type=\"hidden\" value=\"0\">\n<script type=\"text/javascript\">\n<!--\nfunction doLink96847()\n{\nwindow.location.href = '';\n}\nfunction SubmitForm96847()\n{\nretval = doSubmit96847();\nif (retval == true)\ndocument.dlgform96847.submit();\n}\nfunction doSubmit96847()\n{\ndocument.dlgform96847.srchString.value = document.dlgform96847.srchString96847.value;\nif (document.dlgform96847.srchString.value.length == 0)\n{\nalert (\"Please enter something to search for\");\nreturn false;\n}\ndocument.dlgform96847.startpage.value=1;\ndocument.dlgform96847.curpage.value=1;\nreturn true;\n}\n// -->\n</script> <input type=\"text\" name=\"srchString96847\" value=\"search criteria\" class=\"searchbar-sm\" onclick=\"this.value='';\" onblur=\"this.value=!this.value?'':this.value;\" id=\"cs_search_form\" size=\"20\">\n&nbsp;<input id=\"srchString\" name=\"srchString\" type=\"hidden\" value=\"\"> <input type=\"button\" name=\"searchbutton\" value=\"Go\" onclick=\"SubmitForm96847();\" class=\"searchbar-sm-submit\" size=\"10\">\n</div></td>\n</tr> </tbody></table><input id=\"showSummaryCheckBox\" name=\"showSummaryCheckBox\" type=\"hidden\" value=\"0\"><input id=\"UserSelectedSubSites\" name=\"UserSelectedSubSites\" type=\"hidden\" value=\"\"><input id=\"startpage\" name=\"startpage\" type=\"hidden\" value=\"1\"><input id=\"curpage\" name=\"curpage\" type=\"hidden\" value=\"1\"></form> </div>\n<div class=\"social\"> Socialize with us:<br>\n<a class=\"icon-facebook\" href=\"http://www.facebook.com/AlbanyMedicalCenter\">Facebook</a>\n<a class=\"icon-twitter\" href=\"https://www.twitter.com/AlbanyMed\">Twitter</a>\n<a class=\"icon-youtube\" href=\"http://www.youtube.com/albanymedicalcenter\">Youtube</a>\n<a class=\"icon-linkedin\" href=\"http://www.linkedin.com/company/albany-medical-center\">LinkedIn</a>\n</div>\n</div>\n</div>\n</div>\n<p class=\"footer-tagline\"></p>\n<div style=\"display:block; clear:left; padding:0px; font-family:Verdana,Arial; font-size:10px; color:gray;\"></div>\n\t\t<script type=\"text/javascript\">\n\t\t<!--\n\t\t\tvar jsPageContributeMode = 'read';\n\t\t\tvar jsPageSessionContributeMode = 'read';\n\t\t\t\n\t\t\tvar jsPageAuthorMode = 0;\n\t\t\tvar jsPageEditMode = 0;\n\n\t\t\t\n\t\t\tif(!commonspot)\n\t\t\t\tvar commonspot = {};\n\t\t\tcommonspot.csPage = {};\n\n\t\t\t\n\t\t\t\tcommonspot.csPage.url = '/index.cfm';\n\t\t\t\n\n\t\t\tcommonspot.csPage.id = 131576;\n\t\t\tcommonspot.csPage.title = 'Albany Medical Center';\n\n\t\t\tcommonspot.csPage.pagetype = 0;\n\t\t\tcommonspot.csPage.publicationState = 'Published Page';\n\t\t\tcommonspot.csPage.siteRoot = '/';\n\t\t\tcommonspot.csPage.subsiteRoot = '/';\n\t\t\tcommonspot.csPage.mode = jsPageSessionContributeMode;\n\t\t\tcommonspot.csPage.authorok = 0;\n\t\t\tcommonspot.csPage.approvalstatus = 0;\n\t\t\tcommonspot.csPage.showContainerUI = 0;\n\t\t\tcommonspot.csPage.requestedVersionTimestamp = '';\n\t\t\tcommonspot.csPage.userRights = {};\n\t\t\tcommonspot.csPage.userRights.isLoggedIn = 0;\n\t\t\tcommonspot.csPage.userRights.licensedContributor = 0;\n\t\t\tcommonspot.csPage.userRights.read = 1;\n\t\t\tcommonspot.csPage.userRights.author = 0;\n\t\t\tcommonspot.csPage.userRights.edit = 0;\n\t\t\tcommonspot.csPage.userRights.approve = 0;\n\t\t\tcommonspot.csPage.userRights.history = 0;\n\t\t\tcommonspot.csPage.userRights.design = 0;\n\t\t\tcommonspot.csPage.userRights.admin = 0;\n\t\t\tcommonspot.csPage.userRights.subsiteAdmin = 0;\n\t\t\tcommonspot.csPage.userRights.siteAdmin = 0;\n\t\t\tcommonspot.csPage.userRights.customerAdmin = 0;\n\t\t\tcommonspot.csPage.userRights.serverAdmin = 0;\n\t\t\tcommonspot.csPage.userRights.enableLogout = 0;\n\n\t\t\tcommonspot.csPage.enabledMenuClasses = '';\n\t\t\t\n\t\t\tcommonspot.csPage.visibleMenuClasses = '';\n\n\t\t\t\n\t\t\tcommonspot.csPage.subsiteContext = {};\n\t\t\tcommonspot.csPage.subsiteContext.sitetype = 1;\n\t\t\tcommonspot.csPage.subsiteContext.siteid = 2;\n\t\t\tcommonspot.csPage.subsiteContext.subsiteid = 1;\n\t\t\tcommonspot.csPage.subsiteContext.siteurl = '/';\n\t\t\tcommonspot.csPage.subsiteContext.subsiteurl = '/';\n\t\t\tcommonspot.csPage.subsiteContext.sitename = 'AMCwww';\n\t\t\tcommonspot.csPage.subsiteContext.subsitename = '/';\n\t\t\tcommonspot.csPage.subsiteContext.menucontexttimestamp = '1492182532137';\n\t\t\tcommonspot.csPage.serveradminurl = \"/commonspot/admin/\";\n\t\t\tif (parent.commonspot)\n\t\t\t\tparent.commonspot.csPage = commonspot.csPage;\n\t\t\tvar doLviewRedirect;\n\t\t\tif(parent &&\n\t\t\t\t\t\tparent.commonspot &&\n\t\t\t\t\t\tparent.commonspot.lview &&\n\t\t\t\t\t\t!doLviewRedirect &&\n\t\t\t\t\t\tparent.commonspot.lightbox &&\n\t\t\t\t\t\tparent.commonspot.lightbox.stack.length == 0)\n\t\t\t{\n\t\t\t\n\t\t\t\tcommonspot.csPage.showPageSubmit = false;\n\t\t\t\n\t\t\t\tonPageArrival = function()\n\t\t\t\t{\n\t\t\t\t\tparent.commonspot.lview.currentPage.onPageArrival( commonspot.csPage );\n\t\t\t\t};\n\t\t\t\tonPageUnload = function()\n\t\t\t\t{\n\t\t\t\t\tparent.commonspot.lview.currentPage.onPageUnload();\n\t\t\t\t};\n\t\t\t\tparent.Spry.Utils.addEventListener(window, 'load', onPageArrival, false);\n\t\t\t\tparent.Spry.Utils.addEventListener(window, 'unload', onPageUnload, false);\n\t\t\t}\n\t\t\n\n\t\t// -->\n\t\t</script>\n<script type=\"text/javascript\">\n<!--\n\tif (typeof parent.commonspot == 'undefined' || typeof parent.commonspot.lview == 'undefined')\n\t\tloadNonDashboardFiles();\n\telse if (parent.commonspot && typeof newWindow == 'undefined')\n\t{\n\t\tvar arrFiles = \n\t\t\t\t[\n\t\t\t\t\t{fileName: '/commonspot/javascript/lightbox/overrides.js', fileType: 'script', fileID: 'cs_overrides'},\n\t\t\t\t\t{fileName: '/commonspot/javascript/lightbox/window_ref.js', fileType: 'script', fileID: 'cs_windowref'}\n\t\t\t\t];\n\t\t\n\t\tloadDashboardFiles(arrFiles);\n\t}\t\n//-->\n</script>\n\n</body>"}
